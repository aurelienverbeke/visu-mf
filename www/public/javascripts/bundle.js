(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _colorName=_interopRequireDefault(require("color-name"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var _default=exports.default=parse,baseHues={red:0,orange:60,yellow:120,green:180,blue:240,purple:300};function parse(e){var r,a,t=[],l=1;if("number"==typeof e)return{space:"rgb",values:[e>>>16,(65280&e)>>>8,255&e],alpha:1};if("number"==typeof e)return{space:"rgb",values:[e>>>16,(65280&e)>>>8,255&e],alpha:1};if(e=String(e).toLowerCase(),_colorName.default[e])t=_colorName.default[e].slice(),a="rgb";else if("transparent"===e)l=0,a="rgb",t=[0,0,0];else if("#"===e[0]){var s=e.slice(1),n=s.length;l=1,n<=4?(t=[parseInt(s[0]+s[0],16),parseInt(s[1]+s[1],16),parseInt(s[2]+s[2],16)],4===n&&(l=parseInt(s[3]+s[3],16)/255)):(t=[parseInt(s[0]+s[1],16),parseInt(s[2]+s[3],16),parseInt(s[4]+s[5],16)],8===n&&(l=parseInt(s[6]+s[7],16)/255)),t[0]||(t[0]=0),t[1]||(t[1]=0),t[2]||(t[2]=0),a="rgb"}else if(r=/^((?:rgba?|hs[lvb]a?|hwba?|cmyk?|xy[zy]|gray|lab|lchu?v?|[ly]uv|lms|oklch|oklab|color))\s*\(([^\)]*)\)/.exec(e)){var o=r[1],u="cmyk"===(a=o.replace(/a$/,""))?4:"gray"===a?1:3;t=r[2].trim().split(/\s*[,\/]\s*|\s+/),"color"===a&&(a=t.shift()),l=(t=t.map(function(e,r){if("%"===e[e.length-1])return e=parseFloat(e)/100,3===r?e:"rgb"===a?255*e:"h"===a[0]?100*e:"l"!==a[0]||r?"lab"===a?125*e:"lch"===a?r<2?150*e:360*e:"o"!==a[0]||r?"oklab"===a?.4*e:"oklch"===a?r<2?.4*e:360*e:e:e:100*e;if("h"===a[r]||2===r&&"h"===a[a.length-1]){if(void 0!==baseHues[e])return baseHues[e];if(e.endsWith("deg"))return parseFloat(e);if(e.endsWith("turn"))return 360*parseFloat(e);if(e.endsWith("grad"))return 360*parseFloat(e)/400;if(e.endsWith("rad"))return 180*parseFloat(e)/Math.PI}return"none"===e?0:parseFloat(e)})).length>u?t.pop():1}else if(/[0-9](?:\s|\/|,)/.test(e)){var i;t=e.match(/([0-9]+)/g).map(function(e){return parseFloat(e)}),a=(null===(i=e.match(/([a-z])/gi))||void 0===i||null===(i=i.join(""))||void 0===i?void 0:i.toLowerCase())||"rgb"}return{space:a,values:t,alpha:l}}

},{"color-name":2}],2:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _default=exports.default={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};

},{}],3:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=rgba;var _colorParse=_interopRequireDefault(require("color-parse")),_rgb=_interopRequireDefault(require("color-space/rgb.js")),_hsl=_interopRequireDefault(require("color-space/hsl.js"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function rgba(e){var r;Array.isArray(e)&&e.raw&&(e=String.raw.apply(String,arguments)),e instanceof Number&&(e=+e);var a=(0,_colorParse.default)(e);if(!a.space)return[];var t="h"===a.space[0]?_hsl.default.min:_rgb.default.min,u="h"===a.space[0]?_hsl.default.max:_rgb.default.max;return(r=Array(3))[0]=Math.min(Math.max(a.values[0],t[0]),u[0]),r[1]=Math.min(Math.max(a.values[1],t[1]),u[1]),r[2]=Math.min(Math.max(a.values[2],t[2]),u[2]),"h"===a.space[0]&&(r=_hsl.default.rgb(r)),r.push(Math.min(Math.max(a.alpha,0),1)),r}

},{"color-parse":1,"color-space/hsl.js":4,"color-space/rgb.js":7}],4:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _rgb=_interopRequireDefault(require("./rgb.js"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var _default=exports.default={name:"hsl",min:[0,0,0],max:[360,100,100],channel:["hue","saturation","lightness"],alias:["HSL"],rgb:function(e){var r,t,a,u,n,i=e[0]/360,l=e[1]/100,o=e[2]/100,s=0;if(0===l)return[n=255*o,n,n];for(r=2*o-(t=o<.5?o*(1+l):o+l-o*l),u=[0,0,0];s<3;)(a=i+1/3*-(s-1))<0?a++:a>1&&a--,n=6*a<1?r+6*(t-r)*a:2*a<1?t:3*a<2?r+(t-r)*(2/3-a)*6:r,u[s++]=255*n;return u}};_rgb.default.hsl=function(e){var r,t,a=e[0]/255,u=e[1]/255,n=e[2]/255,i=Math.min(a,u,n),l=Math.max(a,u,n),o=l-i;return l===i?r=0:a===l?r=(u-n)/o:u===l?r=2+(n-a)/o:n===l&&(r=4+(a-u)/o),(r=Math.min(60*r,360))<0&&(r+=360),t=(i+l)/2,[r,100*(l===i?0:t<=.5?o/(l+i):o/(2-l-i)),100*t]};

},{"./rgb.js":7}],5:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _luv2=_interopRequireDefault(require("./luv.js")),_xyz=_interopRequireDefault(require("./xyz.js"));function _interopRequireDefault(u){return u&&u.__esModule?u:{default:u}}var lchuv={name:"lchuv",channel:["lightness","chroma","hue"],alias:["LCHuv","cielchuv"],min:[0,0,0],max:[100,100,360],luv:function(u){var e,t=u[0],l=u[1];return e=u[2]/360*2*Math.PI,[t,l*Math.cos(e),l*Math.sin(e)]},xyz:function(u){return _luv2.default.xyz(lchuv.luv(u))}},_default=exports.default=lchuv;_luv2.default.lchuv=function(u){var e=u[0],t=u[1],l=u[2],r=Math.sqrt(t*t+l*l),a=360*Math.atan2(l,t)/2/Math.PI;return a<0&&(a+=360),[e,r,a]},_xyz.default.lchuv=function(u){return _luv2.default.lchuv(_xyz.default.luv(u))};

},{"./luv.js":6,"./xyz.js":8}],6:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _xyz2=_interopRequireDefault(require("./xyz.js"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var _default=exports.default={name:"luv",min:[0,-134,-140],max:[100,224,122],channel:["lightness","u","v"],alias:["LUV","cieluv","cie1976"],xyz:function(e,t,u){var i,a,r,n,l,o,f,d,_;if(r=e[0],n=e[1],l=e[2],0===r)return[0,0,0];return t=t||"D65",u=u||2,i=n/(13*r)+4*(f=_xyz2.default.whitepoint[u][t][0])/(f+15*(d=_xyz2.default.whitepoint[u][t][1])+3*(_=_xyz2.default.whitepoint[u][t][2]))||0,a=l/(13*r)+9*d/(f+15*d+3*_)||0,[9*(o=r>8?d*Math.pow((r+16)/116,3):d*r*.0011070564598794539)*i/(4*a)||0,o,o*(12-3*i-20*a)/(4*a)||0]}};_xyz2.default.luv=function(e,t,u){var i,a,r,n,l,o,f,d,_,p,x;t=t||"D65",u=u||2,p=4*(f=_xyz2.default.whitepoint[u][t][0])/(f+15*(d=_xyz2.default.whitepoint[u][t][1])+3*(_=_xyz2.default.whitepoint[u][t][2])),x=9*d/(f+15*d+3*_),i=4*(n=e[0])/(n+15*(l=e[1])+3*(o=e[2]))||0,a=9*l/(n+15*l+3*o)||0;var s=l/d;return[r=s<=.008856451679035631?903.2962962962961*s:116*Math.pow(s,1/3)-16,13*r*(i-p),13*r*(a-x)]};

},{"./xyz.js":8}],7:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _default=exports.default={name:"rgb",min:[0,0,0],max:[255,255,255],channel:["red","green","blue"],alias:["RGB"]};

},{}],8:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _rgb=_interopRequireDefault(require("./rgb.js"));function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}var xyz={name:"xyz",min:[0,0,0],channel:["X","Y","Z"],alias:["XYZ","ciexyz","cie1931"],whitepoint:{2:{A:[109.85,100,35.585],C:[98.074,100,118.232],D50:[96.422,100,82.521],D55:[95.682,100,92.149],D65:[95.045592705167,100,108.9057750759878],D75:[94.972,100,122.638],F2:[99.187,100,67.395],F7:[95.044,100,108.755],F11:[100.966,100,64.37],E:[100,100,100]},10:{A:[111.144,100,35.2],C:[97.285,100,116.145],D50:[96.72,100,81.427],D55:[95.799,100,90.926],D65:[94.811,100,107.304],D75:[94.416,100,120.641],F2:[103.28,100,69.026],F7:[95.792,100,107.687],F11:[103.866,100,65.627],E:[100,100,100]}}};xyz.max=xyz.whitepoint[2].D65,xyz.rgb=function(t,e){e=e||xyz.whitepoint[2].E;var a,r,i,n=t[0]/e[0],o=t[1]/e[1],u=t[2]/e[2];return r=-.96924363628087*n+1.87596750150772*o+.041555057407175*u,i=.055630079696993*n+-.20397695888897*o+1.056971514242878*u,a=(a=3.240969941904521*n+-1.537383177570093*o+-.498610760293*u)>.0031308?1.055*Math.pow(a,1/2.4)-.055:a*=12.92,r=r>.0031308?1.055*Math.pow(r,1/2.4)-.055:r*=12.92,i=i>.0031308?1.055*Math.pow(i,1/2.4)-.055:i*=12.92,[255*(a=Math.min(Math.max(0,a),1)),255*(r=Math.min(Math.max(0,r),1)),255*(i=Math.min(Math.max(0,i),1))]},_rgb.default.xyz=function(t,e){var a=t[0]/255,r=t[1]/255,i=t[2]/255,n=.21263900587151*(a=a>.04045?Math.pow((a+.055)/1.055,2.4):a/12.92)+.71516867876775*(r=r>.04045?Math.pow((r+.055)/1.055,2.4):r/12.92)+.072192315360733*(i=i>.04045?Math.pow((i+.055)/1.055,2.4):i/12.92),o=.019330818715591*a+.11919477979462*r+.95053215224966*i;return[(.41239079926595*a+.35758433938387*r+.18048078840183*i)*(e=e||xyz.whitepoint[2].E)[0],n*e[1],o*e[2]]};var _default=exports.default=xyz;

},{"./rgb.js":7}],9:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=exports.CollectionEvent=void 0;var _Object=_interopRequireDefault(require("./Object.js")),_CollectionEventType=_interopRequireDefault(require("./CollectionEventType.js")),_Event2=_interopRequireDefault(require("./events/Event.js"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey(n.key),n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var Property={LENGTH:"length"},CollectionEvent=exports.CollectionEvent=function(e){function t(e,r,n){var o;return _classCallCheck(this,t),(o=_callSuper(this,t,[e])).element=r,o.index=n,o}return _inherits(t,_Event2["default"]),_createClass(t)}(),Collection=function(e){function t(e,r){var n;if(_classCallCheck(this,t),(n=_callSuper(this,t)).on,n.once,n.un,r=r||{},n.unique_=!!r.unique,n.array_=e||[],n.unique_)for(var o=0,i=n.array_.length;o<i;++o)n.assertUnique_(n.array_[o],o);return n.updateLength_(),n}return _inherits(t,_Object["default"]),_createClass(t,[{key:"clear",value:function(){for(;this.getLength()>0;)this.pop()}},{key:"extend",value:function(e){for(var t=0,r=e.length;t<r;++t)this.push(e[t]);return this}},{key:"forEach",value:function(e){for(var t=this.array_,r=0,n=t.length;r<n;++r)e(t[r],r,t)}},{key:"getArray",value:function(){return this.array_}},{key:"item",value:function(e){return this.array_[e]}},{key:"getLength",value:function(){return this.get(Property.LENGTH)}},{key:"insertAt",value:function(e,t){if(e<0||e>this.getLength())throw new Error("Index out of bounds: "+e);this.unique_&&this.assertUnique_(t),this.array_.splice(e,0,t),this.updateLength_(),this.dispatchEvent(new CollectionEvent(_CollectionEventType.default.ADD,t,e))}},{key:"pop",value:function(){return this.removeAt(this.getLength()-1)}},{key:"push",value:function(e){this.unique_&&this.assertUnique_(e);var t=this.getLength();return this.insertAt(t,e),this.getLength()}},{key:"remove",value:function(e){for(var t=this.array_,r=0,n=t.length;r<n;++r)if(t[r]===e)return this.removeAt(r)}},{key:"removeAt",value:function(e){if(!(e<0||e>=this.getLength())){var t=this.array_[e];return this.array_.splice(e,1),this.updateLength_(),this.dispatchEvent(new CollectionEvent(_CollectionEventType.default.REMOVE,t,e)),t}}},{key:"setAt",value:function(e,t){if(e>=this.getLength())this.insertAt(e,t);else{if(e<0)throw new Error("Index out of bounds: "+e);this.unique_&&this.assertUnique_(t,e);var r=this.array_[e];this.array_[e]=t,this.dispatchEvent(new CollectionEvent(_CollectionEventType.default.REMOVE,r,e)),this.dispatchEvent(new CollectionEvent(_CollectionEventType.default.ADD,t,e))}}},{key:"updateLength_",value:function(){this.set(Property.LENGTH,this.array_.length)}},{key:"assertUnique_",value:function(e,t){for(var r=0,n=this.array_.length;r<n;++r)if(this.array_[r]===e&&r!==t)throw new Error("Duplicate item added to a unique collection")}}])}(),_default=exports.default=Collection;

},{"./CollectionEventType.js":10,"./Object.js":25,"./events/Event.js":52}],10:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _default=exports.default={ADD:"add",REMOVE:"remove"};

},{}],11:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.asArrayLike=asArrayLike,exports.asImageLike=asImageLike,exports.disposedError=exports.default=void 0,exports.toArray=toArray;var _Tile2=_interopRequireDefault(require("./Tile.js")),_TileState=_interopRequireDefault(require("./TileState.js")),_dom=require("./dom.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _superPropGet(e,t,r,o){var n=_get(_getPrototypeOf(1&o?e.prototype:e),t,r);return 2&o?function(e){return n.apply(r,e)}:n}function _get(){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var o=_superPropBase(e,t);if(o){var n=Object.getOwnPropertyDescriptor(o,t);return n.get?n.get.call(arguments.length<3?e:r):n.value}}).apply(null,arguments)}function _superPropBase(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf(e)););return e}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function asImageLike(e){return e instanceof Image||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||e instanceof ImageBitmap?e:null}function asArrayLike(e){return e instanceof Uint8Array||e instanceof Uint8ClampedArray||e instanceof Float32Array||e instanceof DataView?e:null}var disposedError=exports.disposedError=new Error("disposed"),sharedContext=null;function toArray(e){sharedContext||(sharedContext=(0,_dom.createCanvasContext2D)(e.width,e.height,void 0,{willReadFrequently:!0}));var t=sharedContext.canvas,r=e.width;t.width!==r&&(t.width=r);var o=e.height;return t.height!==o&&(t.height=o),sharedContext.clearRect(0,0,r,o),sharedContext.drawImage(e,0,0),sharedContext.getImageData(0,0,r,o).data}var defaultSize=[256,256],DataTile=function(e){function t(e){var r;_classCallCheck(this,t);var o=_TileState.default.IDLE;return(r=_callSuper(this,t,[e.tileCoord,o,{transition:e.transition,interpolate:e.interpolate}])).loader_=e.loader,r.data_=null,r.error_=null,r.size_=e.size||null,r.controller_=e.controller||null,r}return _inherits(t,_Tile2["default"]),_createClass(t,[{key:"getSize",value:function(){if(this.size_)return this.size_;var e=asImageLike(this.data_);return e?[e.width,e.height]:defaultSize}},{key:"getData",value:function(){return this.data_}},{key:"getError",value:function(){return this.error_}},{key:"load",value:function(){if(this.state===_TileState.default.IDLE||this.state===_TileState.default.ERROR){this.state=_TileState.default.LOADING,this.changed();var e=this;this.loader_().then(function(t){e.data_=t,e.state=_TileState.default.LOADED,e.changed()}).catch(function(t){e.error_=t,e.state=_TileState.default.ERROR,e.changed()})}}},{key:"disposeInternal",value:function(){this.controller_&&(this.controller_.abort(disposedError),this.controller_=null),_superPropGet(t,"disposeInternal",this,3)([])}}])}(),_default=exports.default=DataTile;

},{"./Tile.js":28,"./TileState.js":32,"./dom.js":49}],12:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var o=0;o<t.length;o++){var r=t[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,_toPropertyKey(r.key),r)}}function _createClass(e,t,o){return t&&_defineProperties(e.prototype,t),o&&_defineProperties(e,o),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var r=o.call(e,t||"default");if("object"!=_typeof(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var Disposable=function(){return _createClass(function e(){_classCallCheck(this,e),this.disposed=!1},[{key:"dispose",value:function(){this.disposed||(this.disposed=!0,this.disposeInternal())}},{key:"disposeInternal",value:function(){}}])}(),_default=exports.default=Disposable;

},{}],13:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.createStyleFunction=createStyleFunction,exports.default=void 0;var _Object=_interopRequireDefault(require("./Object.js")),_EventType=_interopRequireDefault(require("./events/EventType.js")),_asserts=require("./asserts.js"),_events=require("./events.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _readOnlyError(e){throw new TypeError('"'+e+'" is read-only')}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey(n.key),n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var Feature=function(e){function t(e){var r;if(_classCallCheck(this,t),(r=_callSuper(this,t)).on,r.once,r.un,r.id_=void 0,r.geometryName_="geometry",r.style_=null,r.styleFunction_=void 0,r.geometryChangeKey_=null,r.addChangeListener(r.geometryName_,r.handleGeometryChanged_),e)if("function"==typeof e.getSimplifiedGeometry){var n=e;r.setGeometry(n)}else{var o=e;r.setProperties(o)}return r}return _inherits(t,_Object["default"]),_createClass(t,[{key:"clone",value:function(){var e=new t(this.hasProperties()?this.getProperties():null);e.setGeometryName(this.getGeometryName());var r=this.getGeometry();r&&e.setGeometry(r.clone());var n=this.getStyle();return n&&e.setStyle(n),e}},{key:"getGeometry",value:function(){return this.get(this.geometryName_)}},{key:"getId",value:function(){return this.id_}},{key:"getGeometryName",value:function(){return this.geometryName_}},{key:"getStyle",value:function(){return this.style_}},{key:"getStyleFunction",value:function(){return this.styleFunction_}},{key:"handleGeometryChange_",value:function(){this.changed()}},{key:"handleGeometryChanged_",value:function(){this.geometryChangeKey_&&((0,_events.unlistenByKey)(this.geometryChangeKey_),this.geometryChangeKey_=null);var e=this.getGeometry();e&&(this.geometryChangeKey_=(0,_events.listen)(e,_EventType.default.CHANGE,this.handleGeometryChange_,this)),this.changed()}},{key:"setGeometry",value:function(e){this.set(this.geometryName_,e)}},{key:"setStyle",value:function(e){this.style_=e,this.styleFunction_=e?createStyleFunction(e):void 0,this.changed()}},{key:"setId",value:function(e){this.id_=e,this.changed()}},{key:"setGeometryName",value:function(e){this.removeChangeListener(this.geometryName_,this.handleGeometryChanged_),this.geometryName_=e,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),this.handleGeometryChanged_()}}])}();function createStyleFunction(e){if("function"==typeof e)return e;var t;Array.isArray(e)?t=e:((0,_asserts.assert)("function"==typeof e.getZIndex,"Expected an `ol/style/Style` or an array of `ol/style/Style.js`"),t=[e]);return function(){return t}}var _default=exports.default=Feature;

},{"./Object.js":25,"./asserts.js":37,"./events.js":51,"./events/EventType.js":53}],14:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.decode=decode,exports.decodeFallback=decodeFallback,exports.default=void 0,exports.listenImage=listenImage,exports.load=load;var _Target=_interopRequireDefault(require("./events/Target.js")),_EventType=_interopRequireDefault(require("./events/EventType.js")),_ImageState=_interopRequireDefault(require("./ImageState.js")),_has=require("./has.js"),_events=require("./events.js"),_functions=require("./functions.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,_toPropertyKey(r.key),r)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=_typeof(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,n){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,n||[],_getPrototypeOf(e).constructor):t.apply(e,n))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var ImageWrapper=function(e){function t(e,n,r,o){var i;return _classCallCheck(this,t),(i=_callSuper(this,t)).extent=e,i.pixelRatio_=r,i.resolution=n,i.state="function"==typeof o?_ImageState.default.IDLE:o,i.image_=null,i.loader="function"==typeof o?o:null,i}return _inherits(t,_Target["default"]),_createClass(t,[{key:"changed",value:function(){this.dispatchEvent(_EventType.default.CHANGE)}},{key:"getExtent",value:function(){return this.extent}},{key:"getImage",value:function(){return this.image_}},{key:"getPixelRatio",value:function(){return this.pixelRatio_}},{key:"getResolution",value:function(){return this.resolution}},{key:"getState",value:function(){return this.state}},{key:"load",value:function(){var e=this;if(this.state==_ImageState.default.IDLE&&this.loader){this.state=_ImageState.default.LOADING,this.changed();var t=this.getResolution(),n=Array.isArray(t)?t[0]:t;(0,_functions.toPromise)(function(){return e.loader(e.getExtent(),n,e.getPixelRatio())}).then(function(t){"image"in t&&(e.image_=t.image),"extent"in t&&(e.extent=t.extent),"resolution"in t&&(e.resolution=t.resolution),"pixelRatio"in t&&(e.pixelRatio_=t.pixelRatio),(t instanceof HTMLImageElement||t instanceof ImageBitmap||t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement)&&(e.image_=t),e.state=_ImageState.default.LOADED}).catch(function(t){e.state=_ImageState.default.ERROR,console.error(t)}).finally(function(){return e.changed()})}}},{key:"setImage",value:function(e){this.image_=e}},{key:"setResolution",value:function(e){this.resolution=e}}])}();function listenImage(e,t,n){var r=e,o=!0,i=!1,a=!1,u=[(0,_events.listenOnce)(r,_EventType.default.LOAD,function(){a=!0,i||t()})];return r.src&&_has.IMAGE_DECODE?(i=!0,r.decode().then(function(){o&&t()}).catch(function(e){o&&(a?t():n())})):u.push((0,_events.listenOnce)(r,_EventType.default.ERROR,n)),function(){o=!1,u.forEach(_events.unlistenByKey)}}function load(e,t){return new Promise(function(n,r){function o(){a(),n(e)}function i(){a(),r(new Error("Image load error"))}function a(){e.removeEventListener("load",o),e.removeEventListener("error",i)}e.addEventListener("load",o),e.addEventListener("error",i),t&&(e.src=t)})}function decodeFallback(e,t){return t&&(e.src=t),e.src&&_has.IMAGE_DECODE?new Promise(function(t,n){return e.decode().then(function(){return t(e)}).catch(function(r){return e.complete&&e.width?t(e):n(r)})}):load(e)}function decode(e,t){return t&&(e.src=t),e.src&&_has.IMAGE_DECODE&&_has.CREATE_IMAGE_BITMAP?e.decode().then(function(){return createImageBitmap(e)}).catch(function(t){if(e.complete&&e.width)return e;throw t}):decodeFallback(e)}var _default=exports.default=ImageWrapper;

},{"./ImageState.js":15,"./events.js":51,"./events/EventType.js":53,"./events/Target.js":55,"./functions.js":62,"./has.js":93}],15:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _default=exports.default={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4};

},{}],16:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _Tile2=_interopRequireDefault(require("./Tile.js")),_TileState=_interopRequireDefault(require("./TileState.js")),_dom=require("./dom.js"),_Image=require("./Image.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,_toPropertyKey(i.key),i)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var ImageTile=function(e){function t(e,r,i,n,o,a){var s;return _classCallCheck(this,t),(s=_callSuper(this,t,[e,r,a])).crossOrigin_=n,s.src_=i,s.key=i,s.image_=new Image,null!==n&&(s.image_.crossOrigin=n),s.unlisten_=null,s.tileLoadFunction_=o,s}return _inherits(t,_Tile2["default"]),_createClass(t,[{key:"getImage",value:function(){return this.image_}},{key:"setImage",value:function(e){this.image_=e,this.state=_TileState.default.LOADED,this.unlistenImage_(),this.changed()}},{key:"handleImageError_",value:function(){this.state=_TileState.default.ERROR,this.unlistenImage_(),this.image_=getBlankImage(),this.changed()}},{key:"handleImageLoad_",value:function(){var e=this.image_;e.naturalWidth&&e.naturalHeight?this.state=_TileState.default.LOADED:this.state=_TileState.default.EMPTY,this.unlistenImage_(),this.changed()}},{key:"load",value:function(){this.state==_TileState.default.ERROR&&(this.state=_TileState.default.IDLE,this.image_=new Image,null!==this.crossOrigin_&&(this.image_.crossOrigin=this.crossOrigin_)),this.state==_TileState.default.IDLE&&(this.state=_TileState.default.LOADING,this.changed(),this.tileLoadFunction_(this,this.src_),this.unlisten_=(0,_Image.listenImage)(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))}},{key:"unlistenImage_",value:function(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)}}])}();function getBlankImage(){var e=(0,_dom.createCanvasContext2D)(1,1);return e.fillStyle="rgba(0,0,0,0)",e.fillRect(0,0,1,1),e.canvas}var _default=exports.default=ImageTile;

},{"./Image.js":14,"./Tile.js":28,"./TileState.js":32,"./dom.js":49}],17:[function(require,module,exports){
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,_toPropertyKey(n.key),n)}}function _createClass(t,e,i){return e&&_defineProperties(t.prototype,e),i&&_defineProperties(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,e||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var Kinetic=function(){return _createClass(function t(e,i,n){_classCallCheck(this,t),this.decay_=e,this.minVelocity_=i,this.delay_=n,this.points_=[],this.angle_=0,this.initialVelocity_=0},[{key:"begin",value:function(){this.points_.length=0,this.angle_=0,this.initialVelocity_=0}},{key:"update",value:function(t,e){this.points_.push(t,e,Date.now())}},{key:"end",value:function(){if(this.points_.length<6)return!1;var t=Date.now()-this.delay_,e=this.points_.length-3;if(this.points_[e+2]<t)return!1;for(var i=e-3;i>0&&this.points_[i+2]>t;)i-=3;var n=this.points_[e+2]-this.points_[i+2];if(n<1e3/60)return!1;var o=this.points_[e]-this.points_[i],r=this.points_[e+1]-this.points_[i+1];return this.angle_=Math.atan2(r,o),this.initialVelocity_=Math.sqrt(o*o+r*r)/n,this.initialVelocity_>this.minVelocity_}},{key:"getDistance",value:function(){return(this.minVelocity_-this.initialVelocity_)/this.decay_}},{key:"getAngle",value:function(){return this.angle_}}])}(),_default=exports.default=Kinetic;

},{}],18:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _Object=_interopRequireDefault(require("./Object.js")),_Collection=_interopRequireDefault(require("./Collection.js")),_CollectionEventType=_interopRequireDefault(require("./CollectionEventType.js")),_Composite=_interopRequireDefault(require("./renderer/Composite.js")),_EventType=_interopRequireDefault(require("./events/EventType.js")),_Layer=_interopRequireDefault(require("./layer/Layer.js")),_Group=_interopRequireWildcard(require("./layer/Group.js")),_MapBrowserEvent=_interopRequireDefault(require("./MapBrowserEvent.js")),_MapBrowserEventHandler=_interopRequireDefault(require("./MapBrowserEventHandler.js")),_MapBrowserEventType=_interopRequireDefault(require("./MapBrowserEventType.js")),_MapEvent=_interopRequireDefault(require("./MapEvent.js")),_MapEventType=_interopRequireDefault(require("./MapEventType.js")),_MapProperty=_interopRequireDefault(require("./MapProperty.js")),_ObjectEventType=_interopRequireDefault(require("./ObjectEventType.js")),_EventType2=_interopRequireDefault(require("./pointer/EventType.js")),_EventType3=_interopRequireDefault(require("./render/EventType.js")),_TileQueue=_interopRequireWildcard(require("./TileQueue.js")),_View=_interopRequireDefault(require("./View.js")),_ViewHint=_interopRequireDefault(require("./ViewHint.js")),_has=require("./has.js"),_functions=require("./functions.js"),_transform=require("./transform.js"),_asserts=require("./asserts.js"),_extent=require("./extent.js"),_defaults=require("./control/defaults.js"),_defaults2=require("./interaction/defaults.js"),_array=require("./array.js"),_proj=require("./proj.js"),_util=require("./util.js"),_size=require("./size.js"),_events=require("./events.js"),_console=require("./console.js");function _getRequireWildcardCache(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(_getRequireWildcardCache=function(e){return e?r:t})(e)}function _interopRequireWildcard(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=_typeof(e)&&"function"!=typeof e)return{default:e};var r=_getRequireWildcardCache(t);if(r&&r.has(e))return r.get(e);var n={__proto__:null},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&{}.hasOwnProperty.call(e,a)){var o=i?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(n,a,o):n[a]=e[a]}return n.default=e,r&&r.set(e,n),n}function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey(n.key),n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _superPropGet(e,t,r,n){var i=_get(_getPrototypeOf(1&n?e.prototype:e),t,r);return 2&n?function(e){return i.apply(r,e)}:i}function _get(){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=_superPropBase(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(arguments.length<3?e:r):i.value}}).apply(null,arguments)}function _superPropBase(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf(e)););return e}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function removeLayerMapProperty(e){e instanceof _Layer.default?e.setMapInternal(null):e instanceof _Group.default&&e.getLayers().forEach(removeLayerMapProperty)}function setLayerMapProperty(e,t){if(e instanceof _Layer.default)e.setMapInternal(t);else if(e instanceof _Group.default)for(var r=e.getLayers().getArray(),n=0,i=r.length;n<i;++n)setLayerMapProperty(r[n],t)}var Map=function(e){function t(e){var r;_classCallCheck(this,t),e=e||{},(r=_callSuper(this,t)).on,r.once,r.un;var n=createOptionsInternal(e);r.renderComplete_=!1,r.loaded_=!0,r.boundHandleBrowserEvent_=r.handleBrowserEvent.bind(r),r.maxTilesLoading_=void 0!==e.maxTilesLoading?e.maxTilesLoading:16,r.pixelRatio_=void 0!==e.pixelRatio?e.pixelRatio:_has.DEVICE_PIXEL_RATIO,r.postRenderTimeoutHandle_,r.animationDelayKey_,r.animationDelay_=r.animationDelay_.bind(r),r.coordinateToPixelTransform_=(0,_transform.create)(),r.pixelToCoordinateTransform_=(0,_transform.create)(),r.frameIndex_=0,r.frameState_=null,r.previousExtent_=null,r.viewPropertyListenerKey_=null,r.viewChangeListenerKey_=null,r.layerGroupPropertyListenerKeys_=null,r.viewport_=document.createElement("div"),r.viewport_.className="ol-viewport"+("ontouchstart"in window?" ol-touch":""),r.viewport_.style.position="relative",r.viewport_.style.overflow="hidden",r.viewport_.style.width="100%",r.viewport_.style.height="100%",r.overlayContainer_=document.createElement("div"),r.overlayContainer_.style.position="absolute",r.overlayContainer_.style.zIndex="0",r.overlayContainer_.style.width="100%",r.overlayContainer_.style.height="100%",r.overlayContainer_.style.pointerEvents="none",r.overlayContainer_.className="ol-overlaycontainer",r.viewport_.appendChild(r.overlayContainer_),r.overlayContainerStopEvent_=document.createElement("div"),r.overlayContainerStopEvent_.style.position="absolute",r.overlayContainerStopEvent_.style.zIndex="0",r.overlayContainerStopEvent_.style.width="100%",r.overlayContainerStopEvent_.style.height="100%",r.overlayContainerStopEvent_.style.pointerEvents="none",r.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent",r.viewport_.appendChild(r.overlayContainerStopEvent_),r.mapBrowserEventHandler_=null,r.moveTolerance_=e.moveTolerance,r.keyboardEventTarget_=n.keyboardEventTarget,r.targetChangeHandlerKeys_=null,r.targetElement_=null,r.resizeObserver_=new ResizeObserver(function(){return r.updateSize()}),r.controls=n.controls||(0,_defaults.defaults)(),r.interactions=n.interactions||(0,_defaults2.defaults)({onFocusOnly:!0}),r.overlays_=n.overlays,r.overlayIdIndex_={},r.renderer_=null,r.postRenderFunctions_=[],r.tileQueue_=new _TileQueue.default(r.getTilePriority.bind(r),r.handleTileChange_.bind(r)),r.addChangeListener(_MapProperty.default.LAYERGROUP,r.handleLayerGroupChanged_),r.addChangeListener(_MapProperty.default.VIEW,r.handleViewChanged_),r.addChangeListener(_MapProperty.default.SIZE,r.handleSizeChanged_),r.addChangeListener(_MapProperty.default.TARGET,r.handleTargetChanged_),r.setProperties(n.values);var i=r;return!e.view||e.view instanceof _View.default||e.view.then(function(e){i.setView(new _View.default(e))}),r.controls.addEventListener(_CollectionEventType.default.ADD,function(e){e.element.setMap(r)}),r.controls.addEventListener(_CollectionEventType.default.REMOVE,function(e){e.element.setMap(null)}),r.interactions.addEventListener(_CollectionEventType.default.ADD,function(e){e.element.setMap(r)}),r.interactions.addEventListener(_CollectionEventType.default.REMOVE,function(e){e.element.setMap(null)}),r.overlays_.addEventListener(_CollectionEventType.default.ADD,function(e){r.addOverlayInternal_(e.element)}),r.overlays_.addEventListener(_CollectionEventType.default.REMOVE,function(e){var t=e.element.getId();void 0!==t&&delete r.overlayIdIndex_[t.toString()],e.element.setMap(null)}),r.controls.forEach(function(e){e.setMap(r)}),r.interactions.forEach(function(e){e.setMap(r)}),r.overlays_.forEach(r.addOverlayInternal_.bind(r)),r}return _inherits(t,_Object["default"]),_createClass(t,[{key:"addControl",value:function(e){this.getControls().push(e)}},{key:"addInteraction",value:function(e){this.getInteractions().push(e)}},{key:"addLayer",value:function(e){this.getLayerGroup().getLayers().push(e)}},{key:"handleLayerAdd_",value:function(e){setLayerMapProperty(e.layer,this)}},{key:"addOverlay",value:function(e){this.getOverlays().push(e)}},{key:"addOverlayInternal_",value:function(e){var t=e.getId();void 0!==t&&(this.overlayIdIndex_[t.toString()]=e),e.setMap(this)}},{key:"disposeInternal",value:function(){this.controls.clear(),this.interactions.clear(),this.overlays_.clear(),this.resizeObserver_.disconnect(),this.setTarget(null),_superPropGet(t,"disposeInternal",this,3)([])}},{key:"forEachFeatureAtPixel",value:function(e,t,r){if(this.frameState_&&this.renderer_){var n=this.getCoordinateFromPixelInternal(e),i=void 0!==(r=void 0!==r?r:{}).hitTolerance?r.hitTolerance:0,a=void 0!==r.layerFilter?r.layerFilter:_functions.TRUE,o=!1!==r.checkWrapped;return this.renderer_.forEachFeatureAtCoordinate(n,this.frameState_,i,o,t,null,a,null)}}},{key:"getFeaturesAtPixel",value:function(e,t){var r=[];return this.forEachFeatureAtPixel(e,function(e){r.push(e)},t),r}},{key:"getAllLayers",value:function(){var e=[];return function t(r){r.forEach(function(r){r instanceof _Group.default?t(r.getLayers()):e.push(r)})}(this.getLayers()),e}},{key:"hasFeatureAtPixel",value:function(e,t){if(!this.frameState_||!this.renderer_)return!1;var r=this.getCoordinateFromPixelInternal(e),n=void 0!==(t=void 0!==t?t:{}).layerFilter?t.layerFilter:_functions.TRUE,i=void 0!==t.hitTolerance?t.hitTolerance:0,a=!1!==t.checkWrapped;return this.renderer_.hasFeatureAtCoordinate(r,this.frameState_,i,a,n,null)}},{key:"getEventCoordinate",value:function(e){return this.getCoordinateFromPixel(this.getEventPixel(e))}},{key:"getEventCoordinateInternal",value:function(e){return this.getCoordinateFromPixelInternal(this.getEventPixel(e))}},{key:"getEventPixel",value:function(e){var t=this.viewport_.getBoundingClientRect(),r=this.getSize(),n=t.width/r[0],i=t.height/r[1],a="changedTouches"in e?e.changedTouches[0]:e;return[(a.clientX-t.left)/n,(a.clientY-t.top)/i]}},{key:"getTarget",value:function(){return this.get(_MapProperty.default.TARGET)}},{key:"getTargetElement",value:function(){return this.targetElement_}},{key:"getCoordinateFromPixel",value:function(e){return(0,_proj.toUserCoordinate)(this.getCoordinateFromPixelInternal(e),this.getView().getProjection())}},{key:"getCoordinateFromPixelInternal",value:function(e){var t=this.frameState_;return t?(0,_transform.apply)(t.pixelToCoordinateTransform,e.slice()):null}},{key:"getControls",value:function(){return this.controls}},{key:"getOverlays",value:function(){return this.overlays_}},{key:"getOverlayById",value:function(e){var t=this.overlayIdIndex_[e.toString()];return void 0!==t?t:null}},{key:"getInteractions",value:function(){return this.interactions}},{key:"getLayerGroup",value:function(){return this.get(_MapProperty.default.LAYERGROUP)}},{key:"setLayers",value:function(e){var t=this.getLayerGroup();if(e instanceof _Collection.default)t.setLayers(e);else{var r=t.getLayers();r.clear(),r.extend(e)}}},{key:"getLayers",value:function(){return this.getLayerGroup().getLayers()}},{key:"getLoadingOrNotReady",value:function(){for(var e=this.getLayerGroup().getLayerStatesArray(),t=0,r=e.length;t<r;++t){var n=e[t];if(n.visible){var i=n.layer.getRenderer();if(i&&!i.ready)return!0;var a=n.layer.getSource();if(a&&a.loading)return!0}}return!1}},{key:"getPixelFromCoordinate",value:function(e){var t=(0,_proj.fromUserCoordinate)(e,this.getView().getProjection());return this.getPixelFromCoordinateInternal(t)}},{key:"getPixelFromCoordinateInternal",value:function(e){var t=this.frameState_;return t?(0,_transform.apply)(t.coordinateToPixelTransform,e.slice(0,2)):null}},{key:"getRenderer",value:function(){return this.renderer_}},{key:"getSize",value:function(){return this.get(_MapProperty.default.SIZE)}},{key:"getView",value:function(){return this.get(_MapProperty.default.VIEW)}},{key:"getViewport",value:function(){return this.viewport_}},{key:"getOverlayContainer",value:function(){return this.overlayContainer_}},{key:"getOverlayContainerStopEvent",value:function(){return this.overlayContainerStopEvent_}},{key:"getOwnerDocument",value:function(){var e=this.getTargetElement();return e?e.ownerDocument:document}},{key:"getTilePriority",value:function(e,t,r,n){return(0,_TileQueue.getTilePriority)(this.frameState_,e,t,r,n)}},{key:"handleBrowserEvent",value:function(e,t){t=t||e.type;var r=new _MapBrowserEvent.default(t,this,e);this.handleMapBrowserEvent(r)}},{key:"handleMapBrowserEvent",value:function(e){if(this.frameState_){var t=e.originalEvent,r=t.type;if(r===_EventType2.default.POINTERDOWN||r===_EventType.default.WHEEL||r===_EventType.default.KEYDOWN){var n=this.getOwnerDocument(),i=this.viewport_.getRootNode?this.viewport_.getRootNode():n,a=t.target;if(this.overlayContainerStopEvent_.contains(a)||!(i===n?n.documentElement:i).contains(a))return}if(e.frameState=this.frameState_,!1!==this.dispatchEvent(e))for(var o=this.getInteractions().getArray().slice(),s=o.length-1;s>=0;s--){var l=o[s];if(l.getMap()===this&&l.getActive()&&this.getTargetElement())if(!l.handleEvent(e)||e.propagationStopped)break}}}},{key:"handlePostRender",value:function(){var e=this.frameState_,t=this.tileQueue_;if(!t.isEmpty()){var r=this.maxTilesLoading_,n=r;if(e){var i=e.viewHints;if(i[_ViewHint.default.ANIMATING]||i[_ViewHint.default.INTERACTING]){var a=Date.now()-e.time>8;r=a?0:8,n=a?0:2}}t.getTilesLoading()<r&&(t.reprioritize(),t.loadMoreTiles(r,n))}e&&this.renderer_&&!e.animate&&(this.renderComplete_?(this.hasListener(_EventType3.default.RENDERCOMPLETE)&&this.renderer_.dispatchRenderEvent(_EventType3.default.RENDERCOMPLETE,e),!1===this.loaded_&&(this.loaded_=!0,this.dispatchEvent(new _MapEvent.default(_MapEventType.default.LOADEND,this,e)))):!0===this.loaded_&&(this.loaded_=!1,this.dispatchEvent(new _MapEvent.default(_MapEventType.default.LOADSTART,this,e))));for(var o=this.postRenderFunctions_,s=0,l=o.length;s<l;++s)o[s](this,e);o.length=0}},{key:"handleSizeChanged_",value:function(){this.getView()&&!this.getView().getAnimating()&&this.getView().resolveConstraints(0),this.render()}},{key:"handleTargetChanged_",value:function(){if(this.mapBrowserEventHandler_){for(var e=0,t=this.targetChangeHandlerKeys_.length;e<t;++e)(0,_events.unlistenByKey)(this.targetChangeHandlerKeys_[e]);this.targetChangeHandlerKeys_=null,this.viewport_.removeEventListener(_EventType.default.CONTEXTMENU,this.boundHandleBrowserEvent_),this.viewport_.removeEventListener(_EventType.default.WHEEL,this.boundHandleBrowserEvent_),this.mapBrowserEventHandler_.dispose(),this.mapBrowserEventHandler_=null,this.viewport_.remove()}if(this.targetElement_){this.resizeObserver_.unobserve(this.targetElement_);var r=this.targetElement_.getRootNode();r instanceof ShadowRoot&&this.resizeObserver_.unobserve(r.host),this.setSize(void 0)}var n=this.getTarget(),i="string"==typeof n?document.getElementById(n):n;if(this.targetElement_=i,i){for(var a in i.appendChild(this.viewport_),this.renderer_||(this.renderer_=new _Composite.default(this)),this.mapBrowserEventHandler_=new _MapBrowserEventHandler.default(this,this.moveTolerance_),_MapBrowserEventType.default)this.mapBrowserEventHandler_.addEventListener(_MapBrowserEventType.default[a],this.handleMapBrowserEvent.bind(this));this.viewport_.addEventListener(_EventType.default.CONTEXTMENU,this.boundHandleBrowserEvent_,!1),this.viewport_.addEventListener(_EventType.default.WHEEL,this.boundHandleBrowserEvent_,!!_has.PASSIVE_EVENT_LISTENERS&&{passive:!1});var o=this.keyboardEventTarget_?this.keyboardEventTarget_:i;this.targetChangeHandlerKeys_=[(0,_events.listen)(o,_EventType.default.KEYDOWN,this.handleBrowserEvent,this),(0,_events.listen)(o,_EventType.default.KEYPRESS,this.handleBrowserEvent,this)];var s=i.getRootNode();s instanceof ShadowRoot&&this.resizeObserver_.observe(s.host),this.resizeObserver_.observe(i)}else this.renderer_&&(clearTimeout(this.postRenderTimeoutHandle_),this.postRenderTimeoutHandle_=void 0,this.postRenderFunctions_.length=0,this.renderer_.dispose(),this.renderer_=null),this.animationDelayKey_&&(cancelAnimationFrame(this.animationDelayKey_),this.animationDelayKey_=void 0);this.updateSize()}},{key:"handleTileChange_",value:function(){this.render()}},{key:"handleViewPropertyChanged_",value:function(){this.render()}},{key:"handleViewChanged_",value:function(){this.viewPropertyListenerKey_&&((0,_events.unlistenByKey)(this.viewPropertyListenerKey_),this.viewPropertyListenerKey_=null),this.viewChangeListenerKey_&&((0,_events.unlistenByKey)(this.viewChangeListenerKey_),this.viewChangeListenerKey_=null);var e=this.getView();e&&(this.updateViewportSize_(this.getSize()),this.viewPropertyListenerKey_=(0,_events.listen)(e,_ObjectEventType.default.PROPERTYCHANGE,this.handleViewPropertyChanged_,this),this.viewChangeListenerKey_=(0,_events.listen)(e,_EventType.default.CHANGE,this.handleViewPropertyChanged_,this),e.resolveConstraints(0)),this.render()}},{key:"handleLayerGroupChanged_",value:function(){this.layerGroupPropertyListenerKeys_&&(this.layerGroupPropertyListenerKeys_.forEach(_events.unlistenByKey),this.layerGroupPropertyListenerKeys_=null);var e=this.getLayerGroup();e&&(this.handleLayerAdd_(new _Group.GroupEvent("addlayer",e)),this.layerGroupPropertyListenerKeys_=[(0,_events.listen)(e,_ObjectEventType.default.PROPERTYCHANGE,this.render,this),(0,_events.listen)(e,_EventType.default.CHANGE,this.render,this),(0,_events.listen)(e,"addlayer",this.handleLayerAdd_,this),(0,_events.listen)(e,"removelayer",this.handleLayerRemove_,this)]),this.render()}},{key:"isRendered",value:function(){return!!this.frameState_}},{key:"animationDelay_",value:function(){this.animationDelayKey_=void 0,this.renderFrame_(Date.now())}},{key:"renderSync",value:function(){this.animationDelayKey_&&cancelAnimationFrame(this.animationDelayKey_),this.animationDelay_()}},{key:"redrawText",value:function(){for(var e=this.getLayerGroup().getLayerStatesArray(),t=0,r=e.length;t<r;++t){var n=e[t].layer;n.hasRenderer()&&n.getRenderer().handleFontsChanged()}}},{key:"render",value:function(){this.renderer_&&void 0===this.animationDelayKey_&&(this.animationDelayKey_=requestAnimationFrame(this.animationDelay_))}},{key:"removeControl",value:function(e){return this.getControls().remove(e)}},{key:"removeInteraction",value:function(e){return this.getInteractions().remove(e)}},{key:"removeLayer",value:function(e){return this.getLayerGroup().getLayers().remove(e)}},{key:"handleLayerRemove_",value:function(e){removeLayerMapProperty(e.layer)}},{key:"removeOverlay",value:function(e){return this.getOverlays().remove(e)}},{key:"renderFrame_",value:function(e){var t=this,r=this.getSize(),n=this.getView(),i=this.frameState_,a=null;if(void 0!==r&&(0,_size.hasArea)(r)&&n&&n.isDef()){var o=n.getHints(this.frameState_?this.frameState_.viewHints:void 0),s=n.getState();if(a={animate:!1,coordinateToPixelTransform:this.coordinateToPixelTransform_,declutter:null,extent:(0,_extent.getForViewAndSize)(s.center,s.resolution,s.rotation,r),index:this.frameIndex_++,layerIndex:0,layerStatesArray:this.getLayerGroup().getLayerStatesArray(),pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:r,tileQueue:this.tileQueue_,time:e,usedTiles:{},viewState:s,viewHints:o,wantedTiles:{},mapId:(0,_util.getUid)(this),renderTargets:{}},s.nextCenter&&s.nextResolution){var l=isNaN(s.nextRotation)?s.rotation:s.nextRotation;a.nextExtent=(0,_extent.getForViewAndSize)(s.nextCenter,s.nextResolution,l,r)}}if(this.frameState_=a,this.renderer_.renderFrame(a),a){if(a.animate&&this.render(),Array.prototype.push.apply(this.postRenderFunctions_,a.postRenderFunctions),i)(!this.previousExtent_||!(0,_extent.isEmpty)(this.previousExtent_)&&!(0,_extent.equals)(a.extent,this.previousExtent_))&&(this.dispatchEvent(new _MapEvent.default(_MapEventType.default.MOVESTART,this,i)),this.previousExtent_=(0,_extent.createOrUpdateEmpty)(this.previousExtent_));this.previousExtent_&&!a.viewHints[_ViewHint.default.ANIMATING]&&!a.viewHints[_ViewHint.default.INTERACTING]&&!(0,_extent.equals)(a.extent,this.previousExtent_)&&(this.dispatchEvent(new _MapEvent.default(_MapEventType.default.MOVEEND,this,a)),(0,_extent.clone)(a.extent,this.previousExtent_))}this.dispatchEvent(new _MapEvent.default(_MapEventType.default.POSTRENDER,this,a)),this.renderComplete_=(this.hasListener(_MapEventType.default.LOADSTART)||this.hasListener(_MapEventType.default.LOADEND)||this.hasListener(_EventType3.default.RENDERCOMPLETE))&&!this.tileQueue_.getTilesLoading()&&!this.tileQueue_.getCount()&&!this.getLoadingOrNotReady(),this.postRenderTimeoutHandle_||(this.postRenderTimeoutHandle_=setTimeout(function(){t.postRenderTimeoutHandle_=void 0,t.handlePostRender()},0))}},{key:"setLayerGroup",value:function(e){var t=this.getLayerGroup();t&&this.handleLayerRemove_(new _Group.GroupEvent("removelayer",t)),this.set(_MapProperty.default.LAYERGROUP,e)}},{key:"setSize",value:function(e){this.set(_MapProperty.default.SIZE,e)}},{key:"setTarget",value:function(e){this.set(_MapProperty.default.TARGET,e)}},{key:"setView",value:function(e){if(!e||e instanceof _View.default)this.set(_MapProperty.default.VIEW,e);else{this.set(_MapProperty.default.VIEW,new _View.default);var t=this;e.then(function(e){t.setView(new _View.default(e))})}}},{key:"updateSize",value:function(){var e=this.getTargetElement(),t=void 0;if(e){var r=getComputedStyle(e),n=e.offsetWidth-parseFloat(r.borderLeftWidth)-parseFloat(r.paddingLeft)-parseFloat(r.paddingRight)-parseFloat(r.borderRightWidth),i=e.offsetHeight-parseFloat(r.borderTopWidth)-parseFloat(r.paddingTop)-parseFloat(r.paddingBottom)-parseFloat(r.borderBottomWidth);isNaN(n)||isNaN(i)||(t=[Math.max(0,n),Math.max(0,i)],!(0,_size.hasArea)(t)&&(e.offsetWidth||e.offsetHeight||e.getClientRects().length)&&(0,_console.warn)("No map visible because the map container's width or height are 0."))}var a=this.getSize();!t||a&&(0,_array.equals)(t,a)||(this.setSize(t),this.updateViewportSize_(t))}},{key:"updateViewportSize_",value:function(e){var t=this.getView();t&&t.setViewportSize(e)}}])}();function createOptionsInternal(e){var t=null;void 0!==e.keyboardEventTarget&&(t="string"==typeof e.keyboardEventTarget?document.getElementById(e.keyboardEventTarget):e.keyboardEventTarget);var r,n,i,a={},o=e.layers&&"function"==typeof e.layers.getLayers?e.layers:new _Group.default({layers:e.layers});return a[_MapProperty.default.LAYERGROUP]=o,a[_MapProperty.default.TARGET]=e.target,a[_MapProperty.default.VIEW]=e.view instanceof _View.default?e.view:new _View.default,void 0!==e.controls&&(Array.isArray(e.controls)?r=new _Collection.default(e.controls.slice()):((0,_asserts.assert)("function"==typeof e.controls.getArray,"Expected `controls` to be an array or an `ol/Collection.js`"),r=e.controls)),void 0!==e.interactions&&(Array.isArray(e.interactions)?n=new _Collection.default(e.interactions.slice()):((0,_asserts.assert)("function"==typeof e.interactions.getArray,"Expected `interactions` to be an array or an `ol/Collection.js`"),n=e.interactions)),void 0!==e.overlays?Array.isArray(e.overlays)?i=new _Collection.default(e.overlays.slice()):((0,_asserts.assert)("function"==typeof e.overlays.getArray,"Expected `overlays` to be an array or an `ol/Collection.js`"),i=e.overlays):i=new _Collection.default,{controls:r,interactions:n,keyboardEventTarget:t,overlays:i,values:a}}var _default=exports.default=Map;

},{"./Collection.js":9,"./CollectionEventType.js":10,"./MapBrowserEvent.js":19,"./MapBrowserEventHandler.js":20,"./MapBrowserEventType.js":21,"./MapEvent.js":22,"./MapEventType.js":23,"./MapProperty.js":24,"./Object.js":25,"./ObjectEventType.js":26,"./TileQueue.js":30,"./View.js":33,"./ViewHint.js":34,"./array.js":36,"./asserts.js":37,"./console.js":41,"./control/defaults.js":46,"./events.js":51,"./events/EventType.js":53,"./extent.js":59,"./functions.js":62,"./has.js":93,"./interaction/defaults.js":107,"./layer/Group.js":112,"./layer/Layer.js":114,"./pointer/EventType.js":122,"./proj.js":123,"./render/EventType.js":133,"./renderer/Composite.js":150,"./size.js":167,"./transform.js":203,"./util.js":205}],19:[function(require,module,exports){
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _MapEvent2=_interopRequireDefault(require("./MapEvent.js"));function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,_toPropertyKey(o.key),o)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var o=r.call(t,e||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _callSuper(t,e,r){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,r||[],_getPrototypeOf(t).constructor):e.apply(t,r))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _superPropGet(t,e,r,o){var n=_get(_getPrototypeOf(1&o?t.prototype:t),e,r);return 2&o?function(t){return n.apply(r,t)}:n}function _get(){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,r){var o=_superPropBase(t,e);if(o){var n=Object.getOwnPropertyDescriptor(o,e);return n.get?n.get.call(arguments.length<3?t:r):n.value}}).apply(null,arguments)}function _superPropBase(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=_getPrototypeOf(t)););return t}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var MapBrowserEvent=function(t){function e(t,r,o,n,i,u){var p;return _classCallCheck(this,e),(p=_callSuper(this,e,[t,r,i])).originalEvent=o,p.pixel_=null,p.coordinate_=null,p.dragging=void 0!==n&&n,p.activePointers=u,p}return _inherits(e,_MapEvent2["default"]),_createClass(e,[{key:"pixel",get:function(){return this.pixel_||(this.pixel_=this.map.getEventPixel(this.originalEvent)),this.pixel_},set:function(t){this.pixel_=t}},{key:"coordinate",get:function(){return this.coordinate_||(this.coordinate_=this.map.getCoordinateFromPixel(this.pixel)),this.coordinate_},set:function(t){this.coordinate_=t}},{key:"preventDefault",value:function(){_superPropGet(e,"preventDefault",this,3)([]),"preventDefault"in this.originalEvent&&this.originalEvent.preventDefault()}},{key:"stopPropagation",value:function(){_superPropGet(e,"stopPropagation",this,3)([]),"stopPropagation"in this.originalEvent&&this.originalEvent.stopPropagation()}}])}(),_default=exports.default=MapBrowserEvent;

},{"./MapEvent.js":22}],20:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _EventType=_interopRequireDefault(require("./events/EventType.js")),_MapBrowserEvent=_interopRequireDefault(require("./MapBrowserEvent.js")),_MapBrowserEventType=_interopRequireDefault(require("./MapBrowserEventType.js")),_EventType2=_interopRequireDefault(require("./pointer/EventType.js")),_Target2=_interopRequireDefault(require("./events/Target.js")),_has=require("./has.js"),_events=require("./events.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,_toPropertyKey(r.key),r)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=_typeof(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,n){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,n||[],_getPrototypeOf(e).constructor):t.apply(e,n))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _superPropGet(e,t,n,r){var i=_get(_getPrototypeOf(1&r?e.prototype:e),t,n);return 2&r?function(e){return i.apply(n,e)}:i}function _get(){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=_superPropBase(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(arguments.length<3?e:n):i.value}}).apply(null,arguments)}function _superPropBase(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf(e)););return e}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var MapBrowserEventHandler=function(e){function t(e,n){var r;_classCallCheck(this,t),(r=_callSuper(this,t,[e])).map_=e,r.clickTimeoutId_,r.emulateClicks_=!1,r.dragging_=!1,r.dragListenerKeys_=[],r.moveTolerance_=void 0===n?1:n,r.down_=null;var i=r.map_.getViewport();return r.activePointers_=[],r.trackedTouches_={},r.element_=i,r.pointerdownListenerKey_=(0,_events.listen)(i,_EventType2.default.POINTERDOWN,r.handlePointerDown_,r),r.originalPointerMoveEvent_,r.relayedListenerKey_=(0,_events.listen)(i,_EventType2.default.POINTERMOVE,r.relayMoveEvent_,r),r.boundHandleTouchMove_=r.handleTouchMove_.bind(r),r.element_.addEventListener(_EventType.default.TOUCHMOVE,r.boundHandleTouchMove_,!!_has.PASSIVE_EVENT_LISTENERS&&{passive:!1}),r}return _inherits(t,_Target2["default"]),_createClass(t,[{key:"emulateClick_",value:function(e){var t=this,n=new _MapBrowserEvent.default(_MapBrowserEventType.default.CLICK,this.map_,e);this.dispatchEvent(n),void 0!==this.clickTimeoutId_?(clearTimeout(this.clickTimeoutId_),this.clickTimeoutId_=void 0,n=new _MapBrowserEvent.default(_MapBrowserEventType.default.DBLCLICK,this.map_,e),this.dispatchEvent(n)):this.clickTimeoutId_=setTimeout(function(){t.clickTimeoutId_=void 0;var n=new _MapBrowserEvent.default(_MapBrowserEventType.default.SINGLECLICK,t.map_,e);t.dispatchEvent(n)},250)}},{key:"updateActivePointers_",value:function(e){var t=e,n=t.pointerId;if(t.type==_MapBrowserEventType.default.POINTERUP||t.type==_MapBrowserEventType.default.POINTERCANCEL){for(var r in delete this.trackedTouches_[n],this.trackedTouches_)if(this.trackedTouches_[r].target!==t.target){delete this.trackedTouches_[r];break}}else t.type!=_MapBrowserEventType.default.POINTERDOWN&&t.type!=_MapBrowserEventType.default.POINTERMOVE||(this.trackedTouches_[n]=t);this.activePointers_=Object.values(this.trackedTouches_)}},{key:"handlePointerUp_",value:function(e){this.updateActivePointers_(e);var t=new _MapBrowserEvent.default(_MapBrowserEventType.default.POINTERUP,this.map_,e,void 0,void 0,this.activePointers_);this.dispatchEvent(t),this.emulateClicks_&&!t.defaultPrevented&&!this.dragging_&&this.isMouseActionButton_(e)&&this.emulateClick_(this.down_),0===this.activePointers_.length&&(this.dragListenerKeys_.forEach(_events.unlistenByKey),this.dragListenerKeys_.length=0,this.dragging_=!1,this.down_=null)}},{key:"isMouseActionButton_",value:function(e){return 0===e.button}},{key:"handlePointerDown_",value:function(e){this.emulateClicks_=0===this.activePointers_.length,this.updateActivePointers_(e);var t=new _MapBrowserEvent.default(_MapBrowserEventType.default.POINTERDOWN,this.map_,e,void 0,void 0,this.activePointers_);if(this.dispatchEvent(t),this.down_=new PointerEvent(e.type,e),Object.defineProperty(this.down_,"target",{writable:!1,value:e.target}),0===this.dragListenerKeys_.length){var n=this.map_.getOwnerDocument();this.dragListenerKeys_.push((0,_events.listen)(n,_MapBrowserEventType.default.POINTERMOVE,this.handlePointerMove_,this),(0,_events.listen)(n,_MapBrowserEventType.default.POINTERUP,this.handlePointerUp_,this),(0,_events.listen)(this.element_,_MapBrowserEventType.default.POINTERCANCEL,this.handlePointerUp_,this)),this.element_.getRootNode&&this.element_.getRootNode()!==n&&this.dragListenerKeys_.push((0,_events.listen)(this.element_.getRootNode(),_MapBrowserEventType.default.POINTERUP,this.handlePointerUp_,this))}}},{key:"handlePointerMove_",value:function(e){if(this.isMoving_(e)){this.updateActivePointers_(e),this.dragging_=!0;var t=new _MapBrowserEvent.default(_MapBrowserEventType.default.POINTERDRAG,this.map_,e,this.dragging_,void 0,this.activePointers_);this.dispatchEvent(t)}}},{key:"relayMoveEvent_",value:function(e){this.originalPointerMoveEvent_=e;var t=!(!this.down_||!this.isMoving_(e));this.dispatchEvent(new _MapBrowserEvent.default(_MapBrowserEventType.default.POINTERMOVE,this.map_,e,t))}},{key:"handleTouchMove_",value:function(e){var t=this.originalPointerMoveEvent_;t&&!t.defaultPrevented||"boolean"==typeof e.cancelable&&!0!==e.cancelable||e.preventDefault()}},{key:"isMoving_",value:function(e){return this.dragging_||Math.abs(e.clientX-this.down_.clientX)>this.moveTolerance_||Math.abs(e.clientY-this.down_.clientY)>this.moveTolerance_}},{key:"disposeInternal",value:function(){this.relayedListenerKey_&&((0,_events.unlistenByKey)(this.relayedListenerKey_),this.relayedListenerKey_=null),this.element_.removeEventListener(_EventType.default.TOUCHMOVE,this.boundHandleTouchMove_),this.pointerdownListenerKey_&&((0,_events.unlistenByKey)(this.pointerdownListenerKey_),this.pointerdownListenerKey_=null),this.dragListenerKeys_.forEach(_events.unlistenByKey),this.dragListenerKeys_.length=0,this.element_=null,_superPropGet(t,"disposeInternal",this,3)([])}}])}(),_default=exports.default=MapBrowserEventHandler;

},{"./MapBrowserEvent.js":19,"./MapBrowserEventType.js":21,"./events.js":51,"./events/EventType.js":53,"./events/Target.js":55,"./has.js":93,"./pointer/EventType.js":122}],21:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _EventType=_interopRequireDefault(require("./events/EventType.js"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var _default=exports.default={SINGLECLICK:"singleclick",CLICK:_EventType.default.CLICK,DBLCLICK:_EventType.default.DBLCLICK,POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"};

},{"./events/EventType.js":53}],22:[function(require,module,exports){
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _Event2=_interopRequireDefault(require("./events/Event.js"));function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,_toPropertyKey(o.key),o)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var o=r.call(t,e||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _callSuper(t,e,r){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,r||[],_getPrototypeOf(t).constructor):e.apply(t,r))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var MapEvent=function(t){function e(t,r,o){var n;return _classCallCheck(this,e),(n=_callSuper(this,e,[t])).map=r,n.frameState=void 0!==o?o:null,n}return _inherits(e,_Event2["default"]),_createClass(e)}(),_default=exports.default=MapEvent;

},{"./events/Event.js":52}],23:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _default=exports.default={POSTRENDER:"postrender",MOVESTART:"movestart",MOVEEND:"moveend",LOADSTART:"loadstart",LOADEND:"loadend"};

},{}],24:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _default=exports.default={LAYERGROUP:"layergroup",SIZE:"size",TARGET:"target",VIEW:"view"};

},{}],25:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=exports.ObjectEvent=void 0;var _Event2=_interopRequireDefault(require("./events/Event.js")),_ObjectEventType=_interopRequireDefault(require("./ObjectEventType.js")),_Observable2=_interopRequireDefault(require("./Observable.js")),_util=require("./util.js"),_obj=require("./obj.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey(n.key),n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var ObjectEvent=exports.ObjectEvent=function(e){function t(e,r,n){var o;return _classCallCheck(this,t),(o=_callSuper(this,t,[e])).key=r,o.oldValue=n,o}return _inherits(t,_Event2["default"]),_createClass(t)}(),BaseObject=function(e){function t(e){var r;return _classCallCheck(this,t),(r=_callSuper(this,t)).on,r.once,r.un,(0,_util.getUid)(r),r.values_=null,void 0!==e&&r.setProperties(e),r}return _inherits(t,_Observable2["default"]),_createClass(t,[{key:"get",value:function(e){var t;return this.values_&&this.values_.hasOwnProperty(e)&&(t=this.values_[e]),t}},{key:"getKeys",value:function(){return this.values_&&Object.keys(this.values_)||[]}},{key:"getProperties",value:function(){return this.values_&&Object.assign({},this.values_)||{}}},{key:"getPropertiesInternal",value:function(){return this.values_}},{key:"hasProperties",value:function(){return!!this.values_}},{key:"notify",value:function(e,t){var r;r="change:".concat(e),this.hasListener(r)&&this.dispatchEvent(new ObjectEvent(r,e,t)),r=_ObjectEventType.default.PROPERTYCHANGE,this.hasListener(r)&&this.dispatchEvent(new ObjectEvent(r,e,t))}},{key:"addChangeListener",value:function(e,t){this.addEventListener("change:".concat(e),t)}},{key:"removeChangeListener",value:function(e,t){this.removeEventListener("change:".concat(e),t)}},{key:"set",value:function(e,t,r){var n=this.values_||(this.values_={});if(r)n[e]=t;else{var o=n[e];n[e]=t,o!==t&&this.notify(e,o)}}},{key:"setProperties",value:function(e,t){for(var r in e)this.set(r,e[r],t)}},{key:"applyProperties",value:function(e){e.values_&&Object.assign(this.values_||(this.values_={}),e.values_)}},{key:"unset",value:function(e,t){if(this.values_&&e in this.values_){var r=this.values_[e];delete this.values_[e],(0,_obj.isEmpty)(this.values_)&&(this.values_=null),t||this.notify(e,r)}}}])}(),_default=exports.default=BaseObject;

},{"./ObjectEventType.js":26,"./Observable.js":27,"./events/Event.js":52,"./obj.js":121,"./util.js":205}],26:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _default=exports.default={PROPERTYCHANGE:"propertychange"};

},{}],27:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0,exports.unByKey=unByKey;var _Target=_interopRequireDefault(require("./events/Target.js")),_EventType=_interopRequireDefault(require("./events/EventType.js")),_events=require("./events.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey(n.key),n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var Observable=function(e){function t(){var e;return _classCallCheck(this,t),(e=_callSuper(this,t)).on=e.onInternal,e.once=e.onceInternal,e.un=e.unInternal,e.revision_=0,e}return _inherits(t,_Target["default"]),_createClass(t,[{key:"changed",value:function(){++this.revision_,this.dispatchEvent(_EventType.default.CHANGE)}},{key:"getRevision",value:function(){return this.revision_}},{key:"onInternal",value:function(e,t){if(Array.isArray(e)){for(var r=e.length,n=new Array(r),o=0;o<r;++o)n[o]=(0,_events.listen)(this,e[o],t);return n}return(0,_events.listen)(this,e,t)}},{key:"onceInternal",value:function(e,t){var r;if(Array.isArray(e)){var n=e.length;r=new Array(n);for(var o=0;o<n;++o)r[o]=(0,_events.listenOnce)(this,e[o],t)}else r=(0,_events.listenOnce)(this,e,t);return t.ol_key=r,r}},{key:"unInternal",value:function(e,t){var r=t.ol_key;if(r)unByKey(r);else if(Array.isArray(e))for(var n=0,o=e.length;n<o;++n)this.removeEventListener(e[n],t);else this.removeEventListener(e,t)}}])}();function unByKey(e){if(Array.isArray(e))for(var t=0,r=e.length;t<r;++t)(0,_events.unlistenByKey)(e[t]);else(0,_events.unlistenByKey)(e)}Observable.prototype.on,Observable.prototype.once,Observable.prototype.un;var _default=exports.default=Observable;

},{"./events.js":51,"./events/EventType.js":53,"./events/Target.js":55}],28:[function(require,module,exports){
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _Target=_interopRequireDefault(require("./events/Target.js")),_EventType=_interopRequireDefault(require("./events/EventType.js")),_TileState=_interopRequireDefault(require("./TileState.js")),_util=require("./util.js"),_easing=require("./easing.js");function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,_toPropertyKey(n.key),n)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _callSuper(t,e,r){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,r||[],_getPrototypeOf(t).constructor):e.apply(t,r))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var Tile=function(t){function e(t,r,n){var i;return _classCallCheck(this,e),n=n||{},(i=_callSuper(this,e)).tileCoord=t,i.state=r,i.key="",i.transition_=void 0===n.transition?250:n.transition,i.transitionStarts_={},i.interpolate=!!n.interpolate,i}return _inherits(e,_Target["default"]),_createClass(e,[{key:"changed",value:function(){this.dispatchEvent(_EventType.default.CHANGE)}},{key:"release",value:function(){this.state===_TileState.default.ERROR&&this.setState(_TileState.default.EMPTY)}},{key:"getKey",value:function(){return this.key+"/"+this.tileCoord}},{key:"getTileCoord",value:function(){return this.tileCoord}},{key:"getState",value:function(){return this.state}},{key:"setState",value:function(t){if(this.state!==_TileState.default.ERROR&&this.state>t)throw new Error("Tile load sequence violation");this.state=t,this.changed()}},{key:"load",value:function(){(0,_util.abstract)()}},{key:"getAlpha",value:function(t,e){if(!this.transition_)return 1;var r=this.transitionStarts_[t];if(r){if(-1===r)return 1}else r=e,this.transitionStarts_[t]=r;var n=e-r+1e3/60;return n>=this.transition_?1:(0,_easing.easeIn)(n/this.transition_)}},{key:"inTransition",value:function(t){return!!this.transition_&&-1!==this.transitionStarts_[t]}},{key:"endTransition",value:function(t){this.transition_&&(this.transitionStarts_[t]=-1)}}])}(),_default=exports.default=Tile;

},{"./TileState.js":32,"./easing.js":50,"./events/EventType.js":53,"./events/Target.js":55,"./util.js":205}],29:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _LRUCache2=_interopRequireDefault(require("./structs/LRUCache.js")),_tilecoord=require("./tilecoord.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _superPropGet(e,t,r,o){var n=_get(_getPrototypeOf(1&o?e.prototype:e),t,r);return 2&o?function(e){return n.apply(r,e)}:n}function _get(){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var o=_superPropBase(e,t);if(o){var n=Object.getOwnPropertyDescriptor(o,t);return n.get?n.get.call(arguments.length<3?e:r):n.value}}).apply(null,arguments)}function _superPropBase(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf(e)););return e}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var TileCache=function(e){function t(){return _classCallCheck(this,t),_callSuper(this,t,arguments)}return _inherits(t,_LRUCache2["default"]),_createClass(t,[{key:"clear",value:function(){for(;this.getCount()>0;)this.pop().release();_superPropGet(t,"clear",this,3)([])}},{key:"expireCache",value:function(e){for(;this.canExpireCache();){if(this.peekLast().getKey()in e)break;this.pop().release()}}},{key:"pruneExceptNewestZ",value:function(){var e=this;if(0!==this.getCount()){var t=this.peekFirstKey(),r=(0,_tilecoord.fromKey)(t)[0];this.forEach(function(t){t.tileCoord[0]!==r&&(e.remove((0,_tilecoord.getKey)(t.tileCoord)),t.release())})}}}])}(),_default=exports.default=TileCache;

},{"./structs/LRUCache.js":183,"./tilecoord.js":197}],30:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0,exports.getTilePriority=getTilePriority;var _EventType=_interopRequireDefault(require("./events/EventType.js")),_PriorityQueue2=_interopRequireWildcard(require("./structs/PriorityQueue.js")),_TileState=_interopRequireDefault(require("./TileState.js"));function _getRequireWildcardCache(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(_getRequireWildcardCache=function(e){return e?r:t})(e)}function _interopRequireWildcard(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=_typeof(e)&&"function"!=typeof e)return{default:e};var r=_getRequireWildcardCache(t);if(r&&r.has(e))return r.get(e);var n={__proto__:null},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&{}.hasOwnProperty.call(e,o)){var u=i?Object.getOwnPropertyDescriptor(e,o):null;u&&(u.get||u.set)?Object.defineProperty(n,o,u):n[o]=e[o]}return n.default=e,r&&r.set(e,n),n}function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey(n.key),n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _superPropGet(e,t,r,n){var i=_get(_getPrototypeOf(1&n?e.prototype:e),t,r);return 2&n?function(e){return i.apply(r,e)}:i}function _get(){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=_superPropBase(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(arguments.length<3?e:r):i.value}}).apply(null,arguments)}function _superPropBase(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf(e)););return e}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var TileQueue=function(e){function t(e,r){var n;return _classCallCheck(this,t),(n=_callSuper(this,t,[function(t){return e.apply(null,t)},function(e){return e[0].getKey()}])).boundHandleTileChange_=n.handleTileChange.bind(n),n.tileChangeCallback_=r,n.tilesLoading_=0,n.tilesLoadingKeys_={},n}return _inherits(t,_PriorityQueue2["default"]),_createClass(t,[{key:"enqueue",value:function(e){var r=_superPropGet(t,"enqueue",this,3)([e]);r&&e[0].addEventListener(_EventType.default.CHANGE,this.boundHandleTileChange_);return r}},{key:"getTilesLoading",value:function(){return this.tilesLoading_}},{key:"handleTileChange",value:function(e){var t=e.target,r=t.getState();if(r===_TileState.default.LOADED||r===_TileState.default.ERROR||r===_TileState.default.EMPTY){r!==_TileState.default.ERROR&&t.removeEventListener(_EventType.default.CHANGE,this.boundHandleTileChange_);var n=t.getKey();n in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[n],--this.tilesLoading_),this.tileChangeCallback_()}}},{key:"loadMoreTiles",value:function(e,t){for(var r=0;this.tilesLoading_<e&&r<t&&this.getCount()>0;){var n=this.dequeue()[0],i=n.getKey();n.getState()!==_TileState.default.IDLE||i in this.tilesLoadingKeys_||(this.tilesLoadingKeys_[i]=!0,++this.tilesLoading_,++r,n.load())}}}])}(),_default=exports.default=TileQueue;function getTilePriority(e,t,r,n,i){if(!(e&&r in e.wantedTiles))return _PriorityQueue2.DROP;if(!e.wantedTiles[r][t.getKey()])return _PriorityQueue2.DROP;var o=e.viewState.center,u=n[0]-o[0],a=n[1]-o[1];return 65536*Math.log(i)+Math.sqrt(u*u+a*a)/i}

},{"./TileState.js":32,"./events/EventType.js":53,"./structs/PriorityQueue.js":184}],31:[function(require,module,exports){
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,_toPropertyKey(n.key),n)}}function _createClass(t,e,i){return e&&_defineProperties(t.prototype,e),i&&_defineProperties(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,e||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.createOrUpdate=createOrUpdate,exports.default=void 0;var TileRange=function(){return _createClass(function t(e,i,n,r){_classCallCheck(this,t),this.minX=e,this.maxX=i,this.minY=n,this.maxY=r},[{key:"contains",value:function(t){return this.containsXY(t[1],t[2])}},{key:"containsTileRange",value:function(t){return this.minX<=t.minX&&t.maxX<=this.maxX&&this.minY<=t.minY&&t.maxY<=this.maxY}},{key:"containsXY",value:function(t,e){return this.minX<=t&&t<=this.maxX&&this.minY<=e&&e<=this.maxY}},{key:"equals",value:function(t){return this.minX==t.minX&&this.minY==t.minY&&this.maxX==t.maxX&&this.maxY==t.maxY}},{key:"extend",value:function(t){t.minX<this.minX&&(this.minX=t.minX),t.maxX>this.maxX&&(this.maxX=t.maxX),t.minY<this.minY&&(this.minY=t.minY),t.maxY>this.maxY&&(this.maxY=t.maxY)}},{key:"getHeight",value:function(){return this.maxY-this.minY+1}},{key:"getSize",value:function(){return[this.getWidth(),this.getHeight()]}},{key:"getWidth",value:function(){return this.maxX-this.minX+1}},{key:"intersects",value:function(t){return this.minX<=t.maxX&&this.maxX>=t.minX&&this.minY<=t.maxY&&this.maxY>=t.minY}}])}();function createOrUpdate(t,e,i,n,r){return void 0!==r?(r.minX=t,r.maxX=e,r.minY=i,r.maxY=n,r):new TileRange(t,e,i,n)}var _default=exports.default=TileRange;

},{}],32:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _default=exports.default={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4};

},{}],33:[function(require,module,exports){
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.createCenterConstraint=createCenterConstraint,exports.createResolutionConstraint=createResolutionConstraint,exports.createRotationConstraint=createRotationConstraint,exports.default=void 0,exports.isNoopAnimation=isNoopAnimation;var _Object=_interopRequireDefault(require("./Object.js")),_ViewHint=_interopRequireDefault(require("./ViewHint.js")),_ViewProperty=_interopRequireDefault(require("./ViewProperty.js")),_common=require("./tilegrid/common.js"),_proj=require("./proj.js"),_functions=require("./functions.js"),_coordinate=require("./coordinate.js"),_asserts=require("./asserts.js"),_centerconstraint=require("./centerconstraint.js"),_math=require("./math.js"),_resolutionconstraint=require("./resolutionconstraint.js"),_rotationconstraint=require("./rotationconstraint.js"),_easing=require("./easing.js"),_extent2=require("./extent.js"),_array=require("./array.js"),_Polygon=require("./geom/Polygon.js");function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,_toPropertyKey(o.key),o)}}function _createClass(t,e,n){return e&&_defineProperties(t.prototype,e),n&&_defineProperties(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _callSuper(t,e,n){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,n||[],_getPrototypeOf(t).constructor):e.apply(t,n))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var DEFAULT_MIN_ZOOM=0,View=function(t){function e(t){var n;return _classCallCheck(this,e),(n=_callSuper(this,e)).on,n.once,n.un,t=Object.assign({},t),n.hints_=[0,0],n.animations_=[],n.updateAnimationKey_,n.projection_=(0,_proj.createProjection)(t.projection,"EPSG:3857"),n.viewportSize_=[100,100],n.targetCenter_=null,n.targetResolution_,n.targetRotation_,n.nextCenter_=null,n.nextResolution_,n.nextRotation_,n.cancelAnchor_=void 0,t.projection&&(0,_proj.disableCoordinateWarning)(),t.center&&(t.center=(0,_proj.fromUserCoordinate)(t.center,n.projection_)),t.extent&&(t.extent=(0,_proj.fromUserExtent)(t.extent,n.projection_)),n.applyOptions_(t),n}return _inherits(e,_Object["default"]),_createClass(e,[{key:"applyOptions_",value:function(t){var e=Object.assign({},t);for(var n in _ViewProperty.default)delete e[n];this.setProperties(e,!0);var o=createResolutionConstraint(t);this.maxResolution_=o.maxResolution,this.minResolution_=o.minResolution,this.zoomFactor_=o.zoomFactor,this.resolutions_=t.resolutions,this.padding_=t.padding,this.minZoom_=o.minZoom;var i=createCenterConstraint(t),r=o.constraint,a=createRotationConstraint(t);this.constraints_={center:i,resolution:r,rotation:a},this.setRotation(void 0!==t.rotation?t.rotation:0),this.setCenterInternal(void 0!==t.center?t.center:null),void 0!==t.resolution?this.setResolution(t.resolution):void 0!==t.zoom&&this.setZoom(t.zoom)}},{key:"padding",get:function(){return this.padding_},set:function(t){var e=this.padding_;this.padding_=t;var n=this.getCenterInternal();if(n){var o=t||[0,0,0,0];e=e||[0,0,0,0];var i=this.getResolution(),r=i/2*(o[3]-e[3]+e[1]-o[1]),a=i/2*(o[0]-e[0]+e[2]-o[2]);this.setCenterInternal([n[0]+r,n[1]-a])}}},{key:"getUpdatedOptions_",value:function(t){var e=this.getProperties();return void 0!==e.resolution?e.resolution=this.getResolution():e.zoom=this.getZoom(),e.center=this.getCenterInternal(),e.rotation=this.getRotation(),Object.assign({},e,t)}},{key:"animate",value:function(t){this.isDef()&&!this.getAnimating()&&this.resolveConstraints(0);for(var e=new Array(arguments.length),n=0;n<e.length;++n){var o=arguments[n];o.center&&((o=Object.assign({},o)).center=(0,_proj.fromUserCoordinate)(o.center,this.getProjection())),o.anchor&&((o=Object.assign({},o)).anchor=(0,_proj.fromUserCoordinate)(o.anchor,this.getProjection())),e[n]=o}this.animateInternal.apply(this,e)}},{key:"animateInternal",value:function(t){var e,n=arguments.length;n>1&&"function"==typeof arguments[n-1]&&(e=arguments[n-1],--n);for(var o=0;o<n&&!this.isDef();++o){var i=arguments[o];i.center&&this.setCenterInternal(i.center),void 0!==i.zoom?this.setZoom(i.zoom):i.resolution&&this.setResolution(i.resolution),void 0!==i.rotation&&this.setRotation(i.rotation)}if(o!==n){for(var r=Date.now(),a=this.targetCenter_.slice(),s=this.targetResolution_,u=this.targetRotation_,l=[];o<n;++o){var c=arguments[o],h={start:r,complete:!1,anchor:c.anchor,duration:void 0!==c.duration?c.duration:1e3,easing:c.easing||_easing.inAndOut,callback:e};if(c.center&&(h.sourceCenter=a,h.targetCenter=c.center.slice(),a=h.targetCenter),void 0!==c.zoom?(h.sourceResolution=s,h.targetResolution=this.getResolutionForZoom(c.zoom),s=h.targetResolution):c.resolution&&(h.sourceResolution=s,h.targetResolution=c.resolution,s=h.targetResolution),void 0!==c.rotation){h.sourceRotation=u;var _=(0,_math.modulo)(c.rotation-u+Math.PI,2*Math.PI)-Math.PI;h.targetRotation=u+_,u=h.targetRotation}isNoopAnimation(h)?h.complete=!0:r+=h.duration,l.push(h)}this.animations_.push(l),this.setHint(_ViewHint.default.ANIMATING,1),this.updateAnimations_()}else e&&animationCallback(e,!0)}},{key:"getAnimating",value:function(){return this.hints_[_ViewHint.default.ANIMATING]>0}},{key:"getInteracting",value:function(){return this.hints_[_ViewHint.default.INTERACTING]>0}},{key:"cancelAnimations",value:function(){var t;this.setHint(_ViewHint.default.ANIMATING,-this.hints_[_ViewHint.default.ANIMATING]);for(var e=0,n=this.animations_.length;e<n;++e){var o=this.animations_[e];if(o[0].callback&&animationCallback(o[0].callback,!1),!t)for(var i=0,r=o.length;i<r;++i){var a=o[i];if(!a.complete){t=a.anchor;break}}}this.animations_.length=0,this.cancelAnchor_=t,this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN}},{key:"updateAnimations_",value:function(){if(void 0!==this.updateAnimationKey_&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0),this.getAnimating()){for(var t=Date.now(),e=!1,n=this.animations_.length-1;n>=0;--n){for(var o=this.animations_[n],i=!0,r=0,a=o.length;r<a;++r){var s=o[r];if(!s.complete){var u=t-s.start,l=s.duration>0?u/s.duration:1;l>=1?(s.complete=!0,l=1):i=!1;var c=s.easing(l);if(s.sourceCenter){var h=s.sourceCenter[0],_=s.sourceCenter[1],g=s.targetCenter[0],f=s.targetCenter[1];this.nextCenter_=s.targetCenter;var v=h+c*(g-h),p=_+c*(f-_);this.targetCenter_=[v,p]}if(s.sourceResolution&&s.targetResolution){var d=1===c?s.targetResolution:s.sourceResolution+c*(s.targetResolution-s.sourceResolution);if(s.anchor){var m=this.getViewportSize_(this.getRotation()),R=this.constraints_.resolution(d,0,m,!0);this.targetCenter_=this.calculateCenterZoom(R,s.anchor)}this.nextResolution_=s.targetResolution,this.targetResolution_=d,this.applyTargetState_(!0)}if(void 0!==s.sourceRotation&&void 0!==s.targetRotation){var y=1===c?(0,_math.modulo)(s.targetRotation+Math.PI,2*Math.PI)-Math.PI:s.sourceRotation+c*(s.targetRotation-s.sourceRotation);if(s.anchor){var C=this.constraints_.rotation(y,!0);this.targetCenter_=this.calculateCenterRotate(C,s.anchor)}this.nextRotation_=s.targetRotation,this.targetRotation_=y}if(this.applyTargetState_(!0),e=!0,!s.complete)break}}if(i){this.animations_[n]=null,this.setHint(_ViewHint.default.ANIMATING,-1),this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN;var j=o[0].callback;j&&animationCallback(j,!0)}}this.animations_=this.animations_.filter(Boolean),e&&void 0===this.updateAnimationKey_&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_.bind(this)))}}},{key:"calculateCenterRotate",value:function(t,e){var n,o=this.getCenterInternal();return void 0!==o&&(n=[o[0]-e[0],o[1]-e[1]],(0,_coordinate.rotate)(n,t-this.getRotation()),(0,_coordinate.add)(n,e)),n}},{key:"calculateCenterZoom",value:function(t,e){var n,o=this.getCenterInternal(),i=this.getResolution();void 0!==o&&void 0!==i&&(n=[e[0]-t*(e[0]-o[0])/i,e[1]-t*(e[1]-o[1])/i]);return n}},{key:"getViewportSize_",value:function(t){var e=this.viewportSize_;if(t){var n=e[0],o=e[1];return[Math.abs(n*Math.cos(t))+Math.abs(o*Math.sin(t)),Math.abs(n*Math.sin(t))+Math.abs(o*Math.cos(t))]}return e}},{key:"setViewportSize",value:function(t){this.viewportSize_=Array.isArray(t)?t.slice():[100,100],this.getAnimating()||this.resolveConstraints(0)}},{key:"getCenter",value:function(){var t=this.getCenterInternal();return t?(0,_proj.toUserCoordinate)(t,this.getProjection()):t}},{key:"getCenterInternal",value:function(){return this.get(_ViewProperty.default.CENTER)}},{key:"getConstraints",value:function(){return this.constraints_}},{key:"getConstrainResolution",value:function(){return this.get("constrainResolution")}},{key:"getHints",value:function(t){return void 0!==t?(t[0]=this.hints_[0],t[1]=this.hints_[1],t):this.hints_.slice()}},{key:"calculateExtent",value:function(t){var e=this.calculateExtentInternal(t);return(0,_proj.toUserExtent)(e,this.getProjection())}},{key:"calculateExtentInternal",value:function(t){t=t||this.getViewportSizeMinusPadding_();var e=this.getCenterInternal();(0,_asserts.assert)(e,"The view center is not defined");var n=this.getResolution();(0,_asserts.assert)(void 0!==n,"The view resolution is not defined");var o=this.getRotation();return(0,_asserts.assert)(void 0!==o,"The view rotation is not defined"),(0,_extent2.getForViewAndSize)(e,n,o,t)}},{key:"getMaxResolution",value:function(){return this.maxResolution_}},{key:"getMinResolution",value:function(){return this.minResolution_}},{key:"getMaxZoom",value:function(){return this.getZoomForResolution(this.minResolution_)}},{key:"setMaxZoom",value:function(t){this.applyOptions_(this.getUpdatedOptions_({maxZoom:t}))}},{key:"getMinZoom",value:function(){return this.getZoomForResolution(this.maxResolution_)}},{key:"setMinZoom",value:function(t){this.applyOptions_(this.getUpdatedOptions_({minZoom:t}))}},{key:"setConstrainResolution",value:function(t){this.applyOptions_(this.getUpdatedOptions_({constrainResolution:t}))}},{key:"getProjection",value:function(){return this.projection_}},{key:"getResolution",value:function(){return this.get(_ViewProperty.default.RESOLUTION)}},{key:"getResolutions",value:function(){return this.resolutions_}},{key:"getResolutionForExtent",value:function(t,e){return this.getResolutionForExtentInternal((0,_proj.fromUserExtent)(t,this.getProjection()),e)}},{key:"getResolutionForExtentInternal",value:function(t,e){e=e||this.getViewportSizeMinusPadding_();var n=(0,_extent2.getWidth)(t)/e[0],o=(0,_extent2.getHeight)(t)/e[1];return Math.max(n,o)}},{key:"getResolutionForValueFunction",value:function(t){t=t||2;var e=this.getConstrainedResolution(this.maxResolution_),n=this.minResolution_,o=Math.log(e/n)/Math.log(t);return function(n){return e/Math.pow(t,n*o)}}},{key:"getRotation",value:function(){return this.get(_ViewProperty.default.ROTATION)}},{key:"getValueForResolutionFunction",value:function(t){var e=Math.log(t||2),n=this.getConstrainedResolution(this.maxResolution_),o=this.minResolution_,i=Math.log(n/o)/e;return function(t){return Math.log(n/t)/e/i}}},{key:"getViewportSizeMinusPadding_",value:function(t){var e=this.getViewportSize_(t),n=this.padding_;return n&&(e=[e[0]-n[1]-n[3],e[1]-n[0]-n[2]]),e}},{key:"getState",value:function(){var t=this.getProjection(),e=this.getResolution(),n=this.getRotation(),o=this.getCenterInternal(),i=this.padding_;if(i){var r=this.getViewportSizeMinusPadding_();o=calculateCenterOn(o,this.getViewportSize_(),[r[0]/2+i[3],r[1]/2+i[0]],e,n)}return{center:o.slice(0),projection:void 0!==t?t:null,resolution:e,nextCenter:this.nextCenter_,nextResolution:this.nextResolution_,nextRotation:this.nextRotation_,rotation:n,zoom:this.getZoom()}}},{key:"getViewStateAndExtent",value:function(){return{viewState:this.getState(),extent:this.calculateExtent()}}},{key:"getZoom",value:function(){var t,e=this.getResolution();return void 0!==e&&(t=this.getZoomForResolution(e)),t}},{key:"getZoomForResolution",value:function(t){var e,n,o=this.minZoom_||0;if(this.resolutions_){var i=(0,_array.linearFindNearest)(this.resolutions_,t,1);o=i,e=this.resolutions_[i],n=i==this.resolutions_.length-1?2:e/this.resolutions_[i+1]}else e=this.maxResolution_,n=this.zoomFactor_;return o+Math.log(e/t)/Math.log(n)}},{key:"getResolutionForZoom",value:function(t){if(this.resolutions_){if(this.resolutions_.length<=1)return 0;var e=(0,_math.clamp)(Math.floor(t),0,this.resolutions_.length-2),n=this.resolutions_[e]/this.resolutions_[e+1];return this.resolutions_[e]/Math.pow(n,(0,_math.clamp)(t-e,0,1))}return this.maxResolution_/Math.pow(this.zoomFactor_,t-this.minZoom_)}},{key:"fit",value:function(t,e){var n;if((0,_asserts.assert)(Array.isArray(t)||"function"==typeof t.getSimplifiedGeometry,"Invalid extent or geometry provided as `geometry`"),Array.isArray(t)){(0,_asserts.assert)(!(0,_extent2.isEmpty)(t),"Cannot fit empty extent provided as `geometry`");var o=(0,_proj.fromUserExtent)(t,this.getProjection());n=(0,_Polygon.fromExtent)(o)}else if("Circle"===t.getType()){var i=(0,_proj.fromUserExtent)(t.getExtent(),this.getProjection());(n=(0,_Polygon.fromExtent)(i)).rotate(this.getRotation(),(0,_extent2.getCenter)(i))}else{var r=(0,_proj.getUserProjection)();n=r?t.clone().transform(r,this.getProjection()):t}this.fitInternal(n,e)}},{key:"rotatedExtentForGeometry",value:function(t){for(var e=this.getRotation(),n=Math.cos(e),o=Math.sin(-e),i=t.getFlatCoordinates(),r=t.getStride(),a=1/0,s=1/0,u=-1/0,l=-1/0,c=0,h=i.length;c<h;c+=r){var _=i[c]*n-i[c+1]*o,g=i[c]*o+i[c+1]*n;a=Math.min(a,_),s=Math.min(s,g),u=Math.max(u,_),l=Math.max(l,g)}return[a,s,u,l]}},{key:"fitInternal",value:function(t,e){var n=(e=e||{}).size;n||(n=this.getViewportSizeMinusPadding_());var o,i=void 0!==e.padding?e.padding:[0,0,0,0],r=void 0!==e.nearest&&e.nearest;o=void 0!==e.minResolution?e.minResolution:void 0!==e.maxZoom?this.getResolutionForZoom(e.maxZoom):0;var a=this.rotatedExtentForGeometry(t),s=this.getResolutionForExtentInternal(a,[n[0]-i[1]-i[3],n[1]-i[0]-i[2]]);s=isNaN(s)?o:Math.max(s,o),s=this.getConstrainedResolution(s,r?0:1);var u=this.getRotation(),l=Math.sin(u),c=Math.cos(u),h=(0,_extent2.getCenter)(a);h[0]+=(i[1]-i[3])/2*s,h[1]+=(i[0]-i[2])/2*s;var _=h[0]*c-h[1]*l,g=h[1]*c+h[0]*l,f=this.getConstrainedCenter([_,g],s),v=e.callback?e.callback:_functions.VOID;void 0!==e.duration?this.animateInternal({resolution:s,center:f,duration:e.duration,easing:e.easing},v):(this.targetResolution_=s,this.targetCenter_=f,this.applyTargetState_(!1,!0),animationCallback(v,!0))}},{key:"centerOn",value:function(t,e,n){this.centerOnInternal((0,_proj.fromUserCoordinate)(t,this.getProjection()),e,n)}},{key:"centerOnInternal",value:function(t,e,n){this.setCenterInternal(calculateCenterOn(t,e,n,this.getResolution(),this.getRotation()))}},{key:"calculateCenterShift",value:function(t,e,n,o){var i,r=this.padding_;if(r&&t){var a=this.getViewportSizeMinusPadding_(-n),s=calculateCenterOn(t,o,[a[0]/2+r[3],a[1]/2+r[0]],e,n);i=[t[0]-s[0],t[1]-s[1]]}return i}},{key:"isDef",value:function(){return!!this.getCenterInternal()&&void 0!==this.getResolution()}},{key:"adjustCenter",value:function(t){var e=(0,_proj.toUserCoordinate)(this.targetCenter_,this.getProjection());this.setCenter([e[0]+t[0],e[1]+t[1]])}},{key:"adjustCenterInternal",value:function(t){var e=this.targetCenter_;this.setCenterInternal([e[0]+t[0],e[1]+t[1]])}},{key:"adjustResolution",value:function(t,e){e=e&&(0,_proj.fromUserCoordinate)(e,this.getProjection()),this.adjustResolutionInternal(t,e)}},{key:"adjustResolutionInternal",value:function(t,e){var n=this.getAnimating()||this.getInteracting(),o=this.getViewportSize_(this.getRotation()),i=this.constraints_.resolution(this.targetResolution_*t,0,o,n);e&&(this.targetCenter_=this.calculateCenterZoom(i,e)),this.targetResolution_*=t,this.applyTargetState_()}},{key:"adjustZoom",value:function(t,e){this.adjustResolution(Math.pow(this.zoomFactor_,-t),e)}},{key:"adjustRotation",value:function(t,e){e&&(e=(0,_proj.fromUserCoordinate)(e,this.getProjection())),this.adjustRotationInternal(t,e)}},{key:"adjustRotationInternal",value:function(t,e){var n=this.getAnimating()||this.getInteracting(),o=this.constraints_.rotation(this.targetRotation_+t,n);e&&(this.targetCenter_=this.calculateCenterRotate(o,e)),this.targetRotation_+=t,this.applyTargetState_()}},{key:"setCenter",value:function(t){this.setCenterInternal(t?(0,_proj.fromUserCoordinate)(t,this.getProjection()):t)}},{key:"setCenterInternal",value:function(t){this.targetCenter_=t,this.applyTargetState_()}},{key:"setHint",value:function(t,e){return this.hints_[t]+=e,this.changed(),this.hints_[t]}},{key:"setResolution",value:function(t){this.targetResolution_=t,this.applyTargetState_()}},{key:"setRotation",value:function(t){this.targetRotation_=t,this.applyTargetState_()}},{key:"setZoom",value:function(t){this.setResolution(this.getResolutionForZoom(t))}},{key:"applyTargetState_",value:function(t,e){var n=this.getAnimating()||this.getInteracting()||e,o=this.constraints_.rotation(this.targetRotation_,n),i=this.getViewportSize_(o),r=this.constraints_.resolution(this.targetResolution_,0,i,n),a=this.constraints_.center(this.targetCenter_,r,i,n,this.calculateCenterShift(this.targetCenter_,r,o,i));this.get(_ViewProperty.default.ROTATION)!==o&&this.set(_ViewProperty.default.ROTATION,o),this.get(_ViewProperty.default.RESOLUTION)!==r&&(this.set(_ViewProperty.default.RESOLUTION,r),this.set("zoom",this.getZoom(),!0)),a&&this.get(_ViewProperty.default.CENTER)&&(0,_coordinate.equals)(this.get(_ViewProperty.default.CENTER),a)||this.set(_ViewProperty.default.CENTER,a),this.getAnimating()&&!t&&this.cancelAnimations(),this.cancelAnchor_=void 0}},{key:"resolveConstraints",value:function(t,e,n){t=void 0!==t?t:200;var o=e||0,i=this.constraints_.rotation(this.targetRotation_),r=this.getViewportSize_(i),a=this.constraints_.resolution(this.targetResolution_,o,r),s=this.constraints_.center(this.targetCenter_,a,r,!1,this.calculateCenterShift(this.targetCenter_,a,i,r));if(0===t&&!this.cancelAnchor_)return this.targetResolution_=a,this.targetRotation_=i,this.targetCenter_=s,void this.applyTargetState_();n=n||(0===t?this.cancelAnchor_:void 0),this.cancelAnchor_=void 0,this.getResolution()===a&&this.getRotation()===i&&this.getCenterInternal()&&(0,_coordinate.equals)(this.getCenterInternal(),s)||(this.getAnimating()&&this.cancelAnimations(),this.animateInternal({rotation:i,center:s,resolution:a,duration:t,easing:_easing.easeOut,anchor:n}))}},{key:"beginInteraction",value:function(){this.resolveConstraints(0),this.setHint(_ViewHint.default.INTERACTING,1)}},{key:"endInteraction",value:function(t,e,n){n=n&&(0,_proj.fromUserCoordinate)(n,this.getProjection()),this.endInteractionInternal(t,e,n)}},{key:"endInteractionInternal",value:function(t,e,n){this.getInteracting()&&(this.setHint(_ViewHint.default.INTERACTING,-1),this.resolveConstraints(t,e,n))}},{key:"getConstrainedCenter",value:function(t,e){var n=this.getViewportSize_(this.getRotation());return this.constraints_.center(t,e||this.getResolution(),n)}},{key:"getConstrainedZoom",value:function(t,e){var n=this.getResolutionForZoom(t);return this.getZoomForResolution(this.getConstrainedResolution(n,e))}},{key:"getConstrainedResolution",value:function(t,e){e=e||0;var n=this.getViewportSize_(this.getRotation());return this.constraints_.resolution(t,e,n)}}])}();function animationCallback(t,e){setTimeout(function(){t(e)},0)}function createCenterConstraint(t){if(void 0!==t.extent){var e=void 0===t.smoothExtentConstraint||t.smoothExtentConstraint;return(0,_centerconstraint.createExtent)(t.extent,t.constrainOnlyCenter,e)}var n=(0,_proj.createProjection)(t.projection,"EPSG:3857");if(!0!==t.multiWorld&&n.isGlobal()){var o=n.getExtent().slice();return o[0]=-1/0,o[2]=1/0,(0,_centerconstraint.createExtent)(o,!1,!1)}return _centerconstraint.none}function createResolutionConstraint(t){var e,n,o,i=void 0!==t.minZoom?t.minZoom:DEFAULT_MIN_ZOOM,r=void 0!==t.maxZoom?t.maxZoom:28,a=void 0!==t.zoomFactor?t.zoomFactor:2,s=void 0!==t.multiWorld&&t.multiWorld,u=void 0===t.smoothResolutionConstraint||t.smoothResolutionConstraint,l=void 0!==t.showFullExtent&&t.showFullExtent,c=(0,_proj.createProjection)(t.projection,"EPSG:3857"),h=c.getExtent(),_=t.constrainOnlyCenter,g=t.extent;if(s||g||!c.isGlobal()||(_=!1,g=h),void 0!==t.resolutions){var f=t.resolutions;n=f[i],o=void 0!==f[r]?f[r]:f[f.length-1],e=t.constrainResolution?(0,_resolutionconstraint.createSnapToResolutions)(f,u,!_&&g,l):(0,_resolutionconstraint.createMinMaxResolution)(n,o,u,!_&&g,l)}else{var v=(h?Math.max((0,_extent2.getWidth)(h),(0,_extent2.getHeight)(h)):360*_proj.METERS_PER_UNIT.degrees/c.getMetersPerUnit())/_common.DEFAULT_TILE_SIZE/Math.pow(2,DEFAULT_MIN_ZOOM),p=v/Math.pow(2,28-DEFAULT_MIN_ZOOM);void 0!==(n=t.maxResolution)?i=0:n=v/Math.pow(a,i),void 0===(o=t.minResolution)&&(o=void 0!==t.maxZoom?void 0!==t.maxResolution?n/Math.pow(a,r):v/Math.pow(a,r):p),r=i+Math.floor(Math.log(n/o)/Math.log(a)),o=n/Math.pow(a,r-i),e=t.constrainResolution?(0,_resolutionconstraint.createSnapToPower)(a,n,o,u,!_&&g,l):(0,_resolutionconstraint.createMinMaxResolution)(n,o,u,!_&&g,l)}return{constraint:e,maxResolution:n,minResolution:o,minZoom:i,zoomFactor:a}}function createRotationConstraint(t){if(void 0===t.enableRotation||t.enableRotation){var e=t.constrainRotation;return void 0===e||!0===e?(0,_rotationconstraint.createSnapToZero)():!1===e?_rotationconstraint.none:"number"==typeof e?(0,_rotationconstraint.createSnapToN)(e):_rotationconstraint.none}return _rotationconstraint.disable}function isNoopAnimation(t){return!(t.sourceCenter&&t.targetCenter&&!(0,_coordinate.equals)(t.sourceCenter,t.targetCenter))&&(t.sourceResolution===t.targetResolution&&t.sourceRotation===t.targetRotation)}function calculateCenterOn(t,e,n,o,i){var r=Math.cos(-i),a=Math.sin(-i),s=t[0]*r-t[1]*a,u=t[1]*r+t[0]*a;return[(s+=(e[0]/2-n[0])*o)*r-(u+=(n[1]-e[1]/2)*o)*(a=-a),u*r+s*a]}var _default=exports.default=View;

},{"./Object.js":25,"./ViewHint.js":34,"./ViewProperty.js":35,"./array.js":36,"./asserts.js":37,"./centerconstraint.js":38,"./coordinate.js":47,"./easing.js":50,"./extent.js":59,"./functions.js":62,"./geom/Polygon.js":73,"./math.js":120,"./proj.js":123,"./resolutionconstraint.js":165,"./rotationconstraint.js":166,"./tilegrid/common.js":201}],34:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _default=exports.default={ANIMATING:0,INTERACTING:1};

},{}],35:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _default=exports.default={CENTER:"center",RESOLUTION:"resolution",ROTATION:"rotation"};

},{}],36:[function(require,module,exports){
"use strict";function binarySearch(r,e,n){var t,i;n=n||ascending;for(var a=0,u=r.length,o=!1;a<u;)(i=+n(r[t=a+(u-a>>1)],e))<0?a=t+1:(u=t,o=!i);return o?a:~a}function ascending(r,e){return r>e?1:r<e?-1:0}function descending(r,e){return r<e?1:r>e?-1:0}function linearFindNearest(r,e,n){if(r[0]<=e)return 0;var t=r.length;if(e<=r[t-1])return t-1;if("function"==typeof n){for(var i=1;i<t;++i){var a=r[i];if(a===e)return i;if(a<e)return n(e,r[i-1],a)>0?i-1:i}return t-1}if(n>0){for(var u=1;u<t;++u)if(r[u]<e)return u-1;return t-1}if(n<0){for(var o=1;o<t;++o)if(r[o]<=e)return o;return t-1}for(var f=1;f<t;++f){if(r[f]==e)return f;if(r[f]<e)return r[f-1]-e<e-r[f]?f-1:f}return t-1}function reverseSubArray(r,e,n){for(;e<n;){var t=r[e];r[e]=r[n],r[n]=t,++e,--n}}function extend(r,e){for(var n=Array.isArray(e)?e:[e],t=n.length,i=0;i<t;i++)r[r.length]=n[i]}function remove(r,e){var n=r.indexOf(e),t=n>-1;return t&&r.splice(n,1),t}function equals(r,e){var n=r.length;if(n!==e.length)return!1;for(var t=0;t<n;t++)if(r[t]!==e[t])return!1;return!0}function stableSort(r,e){var n,t=r.length,i=Array(r.length);for(n=0;n<t;n++)i[n]={index:n,value:r[n]};for(i.sort(function(r,n){return e(r.value,n.value)||r.index-n.index}),n=0;n<r.length;n++)r[n]=i[n].value}function isSorted(r,e,n){var t=e||ascending;return r.every(function(e,i){if(0===i)return!0;var a=t(r[i-1],e);return!(a>0||n&&0===a)})}Object.defineProperty(exports,"__esModule",{value:!0}),exports.ascending=ascending,exports.binarySearch=binarySearch,exports.descending=descending,exports.equals=equals,exports.extend=extend,exports.isSorted=isSorted,exports.linearFindNearest=linearFindNearest,exports.remove=remove,exports.reverseSubArray=reverseSubArray,exports.stableSort=stableSort;

},{}],37:[function(require,module,exports){
"use strict";function assert(e,r){if(!e)throw new Error(r)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.assert=assert;

},{}],38:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.createExtent=createExtent,exports.none=none;var _math=require("./math.js");function createExtent(t,e,a){return function(r,n,o,h,u){if(r){if(!n&&!e)return r;var c=e?0:o[0]*n,m=e?0:o[1]*n,x=u?u[0]:0,i=u?u[1]:0,M=t[0]+c/2+x,l=t[2]-c/2+x,f=t[1]+m/2+i,s=t[3]-m/2+i;M>l&&(l=M=(l+M)/2),f>s&&(s=f=(s+f)/2);var p=(0,_math.clamp)(r[0],M,l),v=(0,_math.clamp)(r[1],f,s);if(h&&a&&n){var _=30*n;p+=-_*Math.log(1+Math.max(0,M-r[0])/_)+_*Math.log(1+Math.max(0,r[0]-l)/_),v+=-_*Math.log(1+Math.max(0,f-r[1])/_)+_*Math.log(1+Math.max(0,r[1]-s)/_)}return[p,v]}}}function none(t){return t}

},{"./math.js":120}],39:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.asArray=asArray,exports.asString=asString,exports.fromString=fromString,exports.isStringColor=isStringColor,exports.lchaToRgba=lchaToRgba,exports.normalize=normalize,exports.rgbaToLcha=rgbaToLcha,exports.toString=toString,exports.withAlpha=withAlpha;var _lchuv=_interopRequireDefault(require("color-space/lchuv.js")),_colorRgba=_interopRequireDefault(require("color-rgba")),_rgb=_interopRequireDefault(require("color-space/rgb.js")),_xyz=_interopRequireDefault(require("color-space/xyz.js")),_math=require("./math.js");function _interopRequireDefault(r){return r&&r.__esModule?r:{default:r}}function _createForOfIteratorHelper(r,e){var t="undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(!t){if(Array.isArray(r)||(t=_unsupportedIterableToArray(r))||e&&r&&"number"==typeof r.length){t&&(r=t);var a=0,o=function(){};return{s:o,n:function(){return a>=r.length?{done:!0}:{done:!1,value:r[a++]}},e:function(r){throw r},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,i=!0,u=!1;return{s:function(){t=t.call(r)},n:function(){var r=t.next();return i=r.done,r},e:function(r){u=!0,n=r},f:function(){try{i||null==t.return||t.return()}finally{if(u)throw n}}}}function _unsupportedIterableToArray(r,e){if(r){if("string"==typeof r)return _arrayLikeToArray(r,e);var t={}.toString.call(r).slice(8,-1);return"Object"===t&&r.constructor&&(t=r.constructor.name),"Map"===t||"Set"===t?Array.from(r):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?_arrayLikeToArray(r,e):void 0}}function _arrayLikeToArray(r,e){(null==e||e>r.length)&&(e=r.length);for(var t=0,a=Array(e);t<e;t++)a[t]=r[t];return a}function asString(r){return"string"==typeof r?r:toString(r)}var MAX_CACHE_SIZE=1024,cache={},cacheSize=0;function withAlpha(r){if(4===r.length)return r;var e=r.slice();return e[3]=1,e}function rgbaToLcha(r){var e=_xyz.default.lchuv(_rgb.default.xyz(r));return e[3]=r[3],e}function lchaToRgba(r){var e=_xyz.default.rgb(_lchuv.default.xyz(r));return e[3]=r[3],e}function fromString(r){if(cache.hasOwnProperty(r))return cache[r];if(cacheSize>=MAX_CACHE_SIZE){var e=0;for(var t in cache)0==(3&e++)&&(delete cache[t],--cacheSize)}var a=(0,_colorRgba.default)(r);if(4!==a.length)throw new Error('failed to parse "'+r+'" as color');var o,n=_createForOfIteratorHelper(a);try{for(n.s();!(o=n.n()).done;){var i=o.value;if(isNaN(i))throw new Error('failed to parse "'+r+'" as color')}}catch(r){n.e(r)}finally{n.f()}return normalize(a),cache[r]=a,++cacheSize,a}function asArray(r){return Array.isArray(r)?r:fromString(r)}function normalize(r){return r[0]=(0,_math.clamp)(r[0]+.5|0,0,255),r[1]=(0,_math.clamp)(r[1]+.5|0,0,255),r[2]=(0,_math.clamp)(r[2]+.5|0,0,255),r[3]=(0,_math.clamp)(r[3],0,1),r}function toString(r){var e=r[0];e!=(0|e)&&(e=e+.5|0);var t=r[1];t!=(0|t)&&(t=t+.5|0);var a=r[2];return a!=(0|a)&&(a=a+.5|0),"rgba("+e+","+t+","+a+","+(void 0===r[3]?1:Math.round(1e3*r[3])/1e3)+")"}function isStringColor(r){try{return fromString(r),!0}catch(r){return!1}}

},{"./math.js":120,"color-rgba":3,"color-space/lchuv.js":5,"color-space/rgb.js":7,"color-space/xyz.js":8}],40:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.asColorLike=asColorLike;var _ImageState=_interopRequireDefault(require("./ImageState.js")),_dom=require("./dom.js"),_IconImage=require("./style/IconImage.js"),_IconImageCache=require("./style/IconImageCache.js"),_color=require("./color.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function asColorLike(e){return e?Array.isArray(e)?(0,_color.toString)(e):"object"===_typeof(e)&&"src"in e?asCanvasPattern(e):e:null}function asCanvasPattern(e){if(!e.offset||!e.size)return _IconImageCache.shared.getPattern(e.src,"anonymous",e.color);var t=e.src+":"+e.offset,o=_IconImageCache.shared.getPattern(t,void 0,e.color);if(o)return o;var r=_IconImageCache.shared.get(e.src,"anonymous",null);if(r.getImageState()!==_ImageState.default.LOADED)return null;var a=(0,_dom.createCanvasContext2D)(e.size[0],e.size[1]);return a.drawImage(r.getImage(1),e.offset[0],e.offset[1],e.size[0],e.size[1],0,0,e.size[0],e.size[1]),(0,_IconImage.get)(a.canvas,t,void 0,_ImageState.default.LOADED,e.color,!0),_IconImageCache.shared.getPattern(t,void 0,e.color)}

},{"./ImageState.js":15,"./color.js":39,"./dom.js":49,"./style/IconImage.js":190,"./style/IconImageCache.js":191}],41:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.error=error,exports.log=log,exports.setLevel=setLevel,exports.warn=warn;var levels={info:1,warn:2,error:3,none:4},level=levels.info;function setLevel(e){level=levels[e]}function log(){var e;level>levels.info||(e=console).log.apply(e,arguments)}function warn(){var e;level>levels.warn||(e=console).warn.apply(e,arguments)}function error(){var e;level>levels.error||(e=console).error.apply(e,arguments)}

},{}],42:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _Control2=_interopRequireDefault(require("./Control.js")),_EventType=_interopRequireDefault(require("../events/EventType.js")),_css=require("../css.js"),_array=require("../array.js"),_dom=require("../dom.js"),_functions=require("../functions.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _regeneratorRuntime(){_regeneratorRuntime=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(e,t,r){e[t]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",l=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function c(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,r){return e[t]=r}}function u(e,t,r,n){var i=t&&t.prototype instanceof v?t:v,a=Object.create(i.prototype),l=new k(n||[]);return o(a,"_invoke",{value:x(e,r,l)}),a}function f(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=u;var p="suspendedStart",h="suspendedYield",d="executing",y="completed",_={};function v(){}function b(){}function g(){}var m={};c(m,a,function(){return this});var w=Object.getPrototypeOf,L=w&&w(w(N([])));L&&L!==r&&n.call(L,a)&&(m=L);var C=g.prototype=v.prototype=Object.create(m);function E(e){["next","throw","return"].forEach(function(t){c(e,t,function(e){return this._invoke(t,e)})})}function O(e,t){function r(o,i,a,l){var s=f(e[o],e,i);if("throw"!==s.type){var c=s.arg,u=c.value;return u&&"object"==_typeof(u)&&n.call(u,"__await")?t.resolve(u.__await).then(function(e){r("next",e,a,l)},function(e){r("throw",e,a,l)}):t.resolve(u).then(function(e){c.value=e,a(c)},function(e){return r("throw",e,a,l)})}l(s.arg)}var i;o(this,"_invoke",{value:function(e,n){function o(){return new t(function(t,o){r(e,n,t,o)})}return i=i?i.then(o,o):o()}})}function x(t,r,n){var o=p;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:e,done:!0}}for(n.method=i,n.arg=a;;){var l=n.delegate;if(l){var s=P(l,n);if(s){if(s===_)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===p)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var c=f(t,r,n);if("normal"===c.type){if(o=n.done?y:h,c.arg===_)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=y,n.method="throw",n.arg=c.arg)}}}function P(t,r){var n=r.method,o=t.iterator[n];if(o===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,P(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),_;var i=f(o,t.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,_;var a=i.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,_):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,_)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function j(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function N(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,i=function r(){for(;++o<t.length;)if(n.call(t,o))return r.value=t[o],r.done=!1,r;return r.value=e,r.done=!0,r};return i.next=i}}throw new TypeError(_typeof(t)+" is not iterable")}return b.prototype=g,o(C,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:b,configurable:!0}),b.displayName=c(g,s,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===b||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,g):(e.__proto__=g,c(e,s,"GeneratorFunction")),e.prototype=Object.create(C),e},t.awrap=function(e){return{__await:e}},E(O.prototype),c(O.prototype,l,function(){return this}),t.AsyncIterator=O,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new O(u(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then(function(e){return e.done?e.value:a.next()})},E(C),c(C,s,"Generator"),c(C,a,function(){return this}),c(C,"toString",function(){return"[object Generator]"}),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=N,k.prototype={constructor:k,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(j),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function o(n,o){return l.type="throw",l.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],l=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=n.call(a,"catchLoc"),c=n.call(a,"finallyLoc");if(s&&c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,_):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),_},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),j(r),_}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;j(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:N(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),_}},t}function asyncGeneratorStep(e,t,r,n,o,i,a){try{var l=e[i](a),s=l.value}catch(e){return void r(e)}l.done?t(s):Promise.resolve(s).then(n,o)}function _asyncToGenerator(e){return function(){var t=this,r=arguments;return new Promise(function(n,o){var i=e.apply(t,r);function a(e){asyncGeneratorStep(i,n,o,a,l,"next",e)}function l(e){asyncGeneratorStep(i,n,o,a,l,"throw",e)}a(void 0)})}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey(n.key),n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var Attribution=function(e){function t(e){var r;_classCallCheck(this,t),e=e||{},(r=_callSuper(this,t,[{element:document.createElement("div"),render:e.render,target:e.target}])).ulElement_=document.createElement("ul"),r.collapsed_=void 0===e.collapsed||e.collapsed,r.userCollapsed_=r.collapsed_,r.overrideCollapsible_=void 0!==e.collapsible,r.collapsible_=void 0===e.collapsible||e.collapsible,r.collapsible_||(r.collapsed_=!1);var n=void 0!==e.className?e.className:"ol-attribution",o=void 0!==e.tipLabel?e.tipLabel:"Attributions",i=void 0!==e.expandClassName?e.expandClassName:n+"-expand",a=void 0!==e.collapseLabel?e.collapseLabel:"›",l=void 0!==e.collapseClassName?e.collapseClassName:n+"-collapse";"string"==typeof a?(r.collapseLabel_=document.createElement("span"),r.collapseLabel_.textContent=a,r.collapseLabel_.className=l):r.collapseLabel_=a;var s=void 0!==e.label?e.label:"i";"string"==typeof s?(r.label_=document.createElement("span"),r.label_.textContent=s,r.label_.className=i):r.label_=s;var c=r.collapsible_&&!r.collapsed_?r.collapseLabel_:r.label_;r.toggleButton_=document.createElement("button"),r.toggleButton_.setAttribute("type","button"),r.toggleButton_.setAttribute("aria-expanded",String(!r.collapsed_)),r.toggleButton_.title=o,r.toggleButton_.appendChild(c),r.toggleButton_.addEventListener(_EventType.default.CLICK,r.handleClick_.bind(r),!1);var u=n+" "+_css.CLASS_UNSELECTABLE+" "+_css.CLASS_CONTROL+(r.collapsed_&&r.collapsible_?" "+_css.CLASS_COLLAPSED:"")+(r.collapsible_?"":" ol-uncollapsible"),f=r.element;return f.className=u,f.appendChild(r.toggleButton_),f.appendChild(r.ulElement_),r.renderedAttributions_=[],r.renderedVisible_=!0,r}return _inherits(t,_Control2["default"]),_createClass(t,[{key:"collectSourceAttributions_",value:function(e){var t=this.getMap().getAllLayers(),r=Array.from(new Set(t.flatMap(function(t){return t.getAttributions(e)})));if(!this.overrideCollapsible_){var n=!t.some(function(e){var t;return!1===(null===(t=e.getSource())||void 0===t?void 0:t.getAttributionsCollapsible())});this.setCollapsible(n)}return r}},{key:"updateElement_",value:function(){var e=_asyncToGenerator(_regeneratorRuntime().mark(function e(t){var r,n,o,i,a;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=3;break}return this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1),e.abrupt("return");case 3:return e.next=5,Promise.all(this.collectSourceAttributions_(t).map(function(e){return(0,_functions.toPromise)(function(){return e})}));case 5:if(r=e.sent,n=r.length>0,this.renderedVisible_!=n&&(this.element.style.display=n?"":"none",this.renderedVisible_=n),!(0,_array.equals)(r,this.renderedAttributions_)){e.next=10;break}return e.abrupt("return");case 10:for((0,_dom.removeChildren)(this.ulElement_),o=0,i=r.length;o<i;++o)(a=document.createElement("li")).innerHTML=r[o],this.ulElement_.appendChild(a);this.renderedAttributions_=r;case 13:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"handleClick_",value:function(e){e.preventDefault(),this.handleToggle_(),this.userCollapsed_=this.collapsed_}},{key:"handleToggle_",value:function(){this.element.classList.toggle(_css.CLASS_COLLAPSED),this.collapsed_?(0,_dom.replaceNode)(this.collapseLabel_,this.label_):(0,_dom.replaceNode)(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_,this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_))}},{key:"getCollapsible",value:function(){return this.collapsible_}},{key:"setCollapsible",value:function(e){this.collapsible_!==e&&(this.collapsible_=e,this.element.classList.toggle("ol-uncollapsible"),this.userCollapsed_&&this.handleToggle_())}},{key:"setCollapsed",value:function(e){this.userCollapsed_=e,this.collapsible_&&this.collapsed_!==e&&this.handleToggle_()}},{key:"getCollapsed",value:function(){return this.collapsed_}},{key:"render",value:function(e){this.updateElement_(e.frameState)}}])}(),_default=exports.default=Attribution;

},{"../array.js":36,"../css.js":48,"../dom.js":49,"../events/EventType.js":53,"../functions.js":62,"./Control.js":43}],43:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _Object=_interopRequireDefault(require("../Object.js")),_MapEventType=_interopRequireDefault(require("../MapEventType.js")),_functions=require("../functions.js"),_events=require("../events.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey(n.key),n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _superPropGet(e,t,r,n){var o=_get(_getPrototypeOf(1&n?e.prototype:e),t,r);return 2&n?function(e){return o.apply(r,e)}:o}function _get(){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=_superPropBase(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}}).apply(null,arguments)}function _superPropBase(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf(e)););return e}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var Control=function(e){function t(e){var r;_classCallCheck(this,t),r=_callSuper(this,t);var n=e.element;return!n||e.target||n.style.pointerEvents||(n.style.pointerEvents="auto"),r.element=n||null,r.target_=null,r.map_=null,r.listenerKeys=[],e.render&&(r.render=e.render),e.target&&r.setTarget(e.target),r}return _inherits(t,_Object["default"]),_createClass(t,[{key:"disposeInternal",value:function(){var e;null===(e=this.element)||void 0===e||e.remove(),_superPropGet(t,"disposeInternal",this,3)([])}},{key:"getMap",value:function(){return this.map_}},{key:"setMap",value:function(e){var t,r;this.map_&&(null===(t=this.element)||void 0===t||t.remove());for(var n=0,o=this.listenerKeys.length;n<o;++n)(0,_events.unlistenByKey)(this.listenerKeys[n]);(this.listenerKeys.length=0,this.map_=e,e)&&((null!==(r=this.target_)&&void 0!==r?r:e.getOverlayContainerStopEvent()).appendChild(this.element),this.render!==_functions.VOID&&this.listenerKeys.push((0,_events.listen)(e,_MapEventType.default.POSTRENDER,this.render,this)),e.render())}},{key:"render",value:function(e){}},{key:"setTarget",value:function(e){this.target_="string"==typeof e?document.getElementById(e):e}}])}(),_default=exports.default=Control;

},{"../MapEventType.js":23,"../Object.js":25,"../events.js":51,"../functions.js":62}],44:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _Control2=_interopRequireDefault(require("./Control.js")),_EventType=_interopRequireDefault(require("../events/EventType.js")),_css=require("../css.js"),_easing=require("../easing.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var Rotate=function(e){function t(e){var r;_classCallCheck(this,t),e=e||{},r=_callSuper(this,t,[{element:document.createElement("div"),render:e.render,target:e.target}]);var o=void 0!==e.className?e.className:"ol-rotate",n=void 0!==e.label?e.label:"⇧",i=void 0!==e.compassClassName?e.compassClassName:"ol-compass";r.label_=null,"string"==typeof n?(r.label_=document.createElement("span"),r.label_.className=i,r.label_.textContent=n):(r.label_=n,r.label_.classList.add(i));var a=e.tipLabel?e.tipLabel:"Reset rotation",s=document.createElement("button");s.className=o+"-reset",s.setAttribute("type","button"),s.title=a,s.appendChild(r.label_),s.addEventListener(_EventType.default.CLICK,r.handleClick_.bind(r),!1);var l=o+" "+_css.CLASS_UNSELECTABLE+" "+_css.CLASS_CONTROL,u=r.element;return u.className=l,u.appendChild(s),r.callResetNorth_=e.resetNorth?e.resetNorth:void 0,r.duration_=void 0!==e.duration?e.duration:250,r.autoHide_=void 0===e.autoHide||e.autoHide,r.rotation_=void 0,r.autoHide_&&r.element.classList.add(_css.CLASS_HIDDEN),r}return _inherits(t,_Control2["default"]),_createClass(t,[{key:"handleClick_",value:function(e){e.preventDefault(),void 0!==this.callResetNorth_?this.callResetNorth_():this.resetNorth_()}},{key:"resetNorth_",value:function(){var e=this.getMap().getView();if(e){var t=e.getRotation();void 0!==t&&(this.duration_>0&&t%(2*Math.PI)!=0?e.animate({rotation:0,duration:this.duration_,easing:_easing.easeOut}):e.setRotation(0))}}},{key:"render",value:function(e){var t=e.frameState;if(t){var r=t.viewState.rotation;if(r!=this.rotation_){var o="rotate("+r+"rad)";if(this.autoHide_){var n=this.element.classList.contains(_css.CLASS_HIDDEN);n||0!==r?n&&0!==r&&this.element.classList.remove(_css.CLASS_HIDDEN):this.element.classList.add(_css.CLASS_HIDDEN)}this.label_.style.transform=o}this.rotation_=r}}}])}(),_default=exports.default=Rotate;

},{"../css.js":48,"../easing.js":50,"../events/EventType.js":53,"./Control.js":43}],45:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _Control2=_interopRequireDefault(require("./Control.js")),_EventType=_interopRequireDefault(require("../events/EventType.js")),_css=require("../css.js"),_easing=require("../easing.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var o=0;o<t.length;o++){var r=t[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,_toPropertyKey(r.key),r)}}function _createClass(e,t,o){return t&&_defineProperties(e.prototype,t),o&&_defineProperties(e,o),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var r=o.call(e,t||"default");if("object"!=_typeof(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,o){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,o||[],_getPrototypeOf(e).constructor):t.apply(e,o))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var Zoom=function(e){function t(e){var o;_classCallCheck(this,t),e=e||{},o=_callSuper(this,t,[{element:document.createElement("div"),target:e.target}]);var r=void 0!==e.className?e.className:"ol-zoom",n=void 0!==e.delta?e.delta:1,i=void 0!==e.zoomInClassName?e.zoomInClassName:r+"-in",a=void 0!==e.zoomOutClassName?e.zoomOutClassName:r+"-out",u=void 0!==e.zoomInLabel?e.zoomInLabel:"+",l=void 0!==e.zoomOutLabel?e.zoomOutLabel:"–",s=void 0!==e.zoomInTipLabel?e.zoomInTipLabel:"Zoom in",c=void 0!==e.zoomOutTipLabel?e.zoomOutTipLabel:"Zoom out",f=document.createElement("button");f.className=i,f.setAttribute("type","button"),f.title=s,f.appendChild("string"==typeof u?document.createTextNode(u):u),f.addEventListener(_EventType.default.CLICK,o.handleClick_.bind(o,n),!1);var p=document.createElement("button");p.className=a,p.setAttribute("type","button"),p.title=c,p.appendChild("string"==typeof l?document.createTextNode(l):l),p.addEventListener(_EventType.default.CLICK,o.handleClick_.bind(o,-n),!1);var d=r+" "+_css.CLASS_UNSELECTABLE+" "+_css.CLASS_CONTROL,_=o.element;return _.className=d,_.appendChild(f),_.appendChild(p),o.duration_=void 0!==e.duration?e.duration:250,o}return _inherits(t,_Control2["default"]),_createClass(t,[{key:"handleClick_",value:function(e,t){t.preventDefault(),this.zoomByDelta_(e)}},{key:"zoomByDelta_",value:function(e){var t=this.getMap().getView();if(t){var o=t.getZoom();if(void 0!==o){var r=t.getConstrainedZoom(o+e);this.duration_>0?(t.getAnimating()&&t.cancelAnimations(),t.animate({zoom:r,duration:this.duration_,easing:_easing.easeOut})):t.setZoom(r)}}}}])}(),_default=exports.default=Zoom;

},{"../css.js":48,"../easing.js":50,"../events/EventType.js":53,"./Control.js":43}],46:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.defaults=defaults;var _Attribution=_interopRequireDefault(require("./Attribution.js")),_Collection=_interopRequireDefault(require("../Collection.js")),_Rotate=_interopRequireDefault(require("./Rotate.js")),_Zoom=_interopRequireDefault(require("./Zoom.js"));function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function defaults(t){t=t||{};var e=new _Collection.default;return(void 0===t.zoom||t.zoom)&&e.push(new _Zoom.default(t.zoomOptions)),(void 0===t.rotate||t.rotate)&&e.push(new _Rotate.default(t.rotateOptions)),(void 0===t.attribution||t.attribution)&&e.push(new _Attribution.default(t.attributionOptions)),e}

},{"../Collection.js":9,"./Attribution.js":42,"./Rotate.js":44,"./Zoom.js":45}],47:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.add=add,exports.closestOnCircle=closestOnCircle,exports.closestOnSegment=closestOnSegment,exports.createStringXY=createStringXY,exports.degreesToStringHDMS=degreesToStringHDMS,exports.distance=distance,exports.equals=equals,exports.format=format,exports.getWorldsAway=getWorldsAway,exports.rotate=rotate,exports.scale=scale,exports.squaredDistance=squaredDistance,exports.squaredDistanceToSegment=squaredDistanceToSegment,exports.toStringHDMS=toStringHDMS,exports.toStringXY=toStringXY,exports.wrapX=wrapX;var _extent=require("./extent.js"),_math=require("./math.js"),_string=require("./string.js");function add(t,e){return t[0]+=+e[0],t[1]+=+e[1],t}function closestOnCircle(t,e){var r=e.getRadius(),n=e.getCenter(),o=n[0],a=n[1],s=t[0]-o,i=t[1]-a;0===s&&0===i&&(s=1);var u=Math.sqrt(s*s+i*i);return[o+r*s/u,a+r*i/u]}function closestOnSegment(t,e){var r,n,o=t[0],a=t[1],s=e[0],i=e[1],u=s[0],c=s[1],g=i[0],d=i[1],S=g-u,l=d-c,f=0===S&&0===l?0:(S*(o-u)+l*(a-c))/(S*S+l*l||0);return f<=0?(r=u,n=c):f>=1?(r=g,n=d):(r=u+f*S,n=c+f*l),[r,n]}function createStringXY(t){return function(e){return toStringXY(e,t)}}function degreesToStringHDMS(t,e,r){var n=(0,_math.modulo)(e+180,360)-180,o=Math.abs(3600*n),a=r||0,s=Math.floor(o/3600),i=Math.floor((o-3600*s)/60),u=(0,_math.toFixed)(o-3600*s-60*i,a);u>=60&&(u=0,i+=1),i>=60&&(i=0,s+=1);var c=s+"°";return 0===i&&0===u||(c+=" "+(0,_string.padNumber)(i,2)+"′"),0!==u&&(c+=" "+(0,_string.padNumber)(u,2,a)+"″"),0!==n&&(c+=" "+t.charAt(n<0?1:0)),c}function format(t,e,r){return t?e.replace("{x}",t[0].toFixed(r)).replace("{y}",t[1].toFixed(r)):""}function equals(t,e){for(var r=!0,n=t.length-1;n>=0;--n)if(t[n]!=e[n]){r=!1;break}return r}function rotate(t,e){var r=Math.cos(e),n=Math.sin(e),o=t[0]*r-t[1]*n,a=t[1]*r+t[0]*n;return t[0]=o,t[1]=a,t}function scale(t,e){return t[0]*=e,t[1]*=e,t}function squaredDistance(t,e){var r=t[0]-e[0],n=t[1]-e[1];return r*r+n*n}function distance(t,e){return Math.sqrt(squaredDistance(t,e))}function squaredDistanceToSegment(t,e){return squaredDistance(t,closestOnSegment(t,e))}function toStringHDMS(t,e){return t?degreesToStringHDMS("NS",t[1],e)+" "+degreesToStringHDMS("EW",t[0],e):""}function toStringXY(t,e){return format(t,"{x}, {y}",e)}function wrapX(t,e){if(e.canWrapX()){var r=(0,_extent.getWidth)(e.getExtent()),n=getWorldsAway(t,e,r);n&&(t[0]-=n*r)}return t}function getWorldsAway(t,e,r){var n=e.getExtent(),o=0;return e.canWrapX()&&(t[0]<n[0]||t[0]>n[2])&&(r=r||(0,_extent.getWidth)(n),o=Math.floor((t[0]-n[0])/r)),o}

},{"./extent.js":59,"./math.js":120,"./string.js":182}],48:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getFontParameters=exports.CLASS_UNSUPPORTED=exports.CLASS_UNSELECTABLE=exports.CLASS_SELECTABLE=exports.CLASS_HIDDEN=exports.CLASS_CONTROL=exports.CLASS_COLLAPSED=void 0;var CLASS_HIDDEN=exports.CLASS_HIDDEN="ol-hidden",CLASS_SELECTABLE=exports.CLASS_SELECTABLE="ol-selectable",CLASS_UNSELECTABLE=exports.CLASS_UNSELECTABLE="ol-unselectable",CLASS_UNSUPPORTED=exports.CLASS_UNSUPPORTED="ol-unsupported",CLASS_CONTROL=exports.CLASS_CONTROL="ol-control",CLASS_COLLAPSED=exports.CLASS_COLLAPSED="ol-collapsed",fontRegEx=new RegExp(["^\\s*(?=(?:(?:[-a-z]+\\s*){0,2}(italic|oblique))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(small-caps))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(bold(?:er)?|lighter|[1-9]00 ))?)","(?:(?:normal|\\1|\\2|\\3)\\s*){0,3}((?:xx?-)?","(?:small|large)|medium|smaller|larger|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx]))","(?:\\s*\\/\\s*(normal|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx])?))","?\\s*([-,\\\"\\'\\sa-z]+?)\\s*$"].join(""),"i"),fontRegExMatchIndex=["style","variant","weight","size","lineHeight","family"],getFontParameters=exports.getFontParameters=function(e){var t=e.match(fontRegEx);if(!t)return null;for(var r={lineHeight:"normal",size:"1.2em",style:"normal",weight:"normal",variant:"normal"},o=0,S=fontRegExMatchIndex.length;o<S;++o){var s=t[o+1];void 0!==s&&(r[fontRegExMatchIndex[o]]=s)}return r.families=r.family.split(/,\s?/),r};

},{}],49:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.createCanvasContext2D=createCanvasContext2D,exports.getSharedCanvasContext2D=getSharedCanvasContext2D,exports.outerHeight=outerHeight,exports.outerWidth=outerWidth,exports.releaseCanvas=releaseCanvas,exports.removeChildren=removeChildren,exports.replaceChildren=replaceChildren,exports.replaceNode=replaceNode;var sharedCanvasContext,_has=require("./has.js");function createCanvasContext2D(e,t,r,a){var n;return n=r&&r.length?r.shift():_has.WORKER_OFFSCREEN_CANVAS?new OffscreenCanvas(e||300,t||300):document.createElement("canvas"),e&&(n.width=e),t&&(n.height=t),n.getContext("2d",a)}function getSharedCanvasContext2D(){return sharedCanvasContext||(sharedCanvasContext=createCanvasContext2D(1,1)),sharedCanvasContext}function releaseCanvas(e){var t=e.canvas;t.width=1,t.height=1,e.clearRect(0,0,1,1)}function outerWidth(e){var t=e.offsetWidth,r=getComputedStyle(e);return t+=parseInt(r.marginLeft,10)+parseInt(r.marginRight,10)}function outerHeight(e){var t=e.offsetHeight,r=getComputedStyle(e);return t+=parseInt(r.marginTop,10)+parseInt(r.marginBottom,10)}function replaceNode(e,t){var r=t.parentNode;r&&r.replaceChild(e,t)}function removeChildren(e){for(;e.lastChild;)e.lastChild.remove()}function replaceChildren(e,t){for(var r=e.childNodes,a=0;;++a){var n=r[a],o=t[a];if(!n&&!o)break;n!==o&&(n?o?e.insertBefore(o,n):(e.removeChild(n),--a):e.appendChild(o))}}

},{"./has.js":93}],50:[function(require,module,exports){
"use strict";function easeIn(n){return Math.pow(n,3)}function easeOut(n){return 1-easeIn(1-n)}function inAndOut(n){return 3*n*n-2*n*n*n}function linear(n){return n}function upAndDown(n){return n<.5?inAndOut(2*n):1-inAndOut(2*(n-.5))}Object.defineProperty(exports,"__esModule",{value:!0}),exports.easeIn=easeIn,exports.easeOut=easeOut,exports.inAndOut=inAndOut,exports.linear=linear,exports.upAndDown=upAndDown;

},{}],51:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.listen=listen,exports.listenOnce=listenOnce,exports.unlistenByKey=unlistenByKey;var _obj=require("./obj.js");function listen(e,t,n,r,i){if(i){var s=n;n=function(){e.removeEventListener(t,n),s.apply(null!=r?r:this,arguments)}}else r&&r!==e&&(n=n.bind(r));var l={target:e,type:t,listener:n};return e.addEventListener(t,n),l}function listenOnce(e,t,n,r){return listen(e,t,n,r,!0)}function unlistenByKey(e){e&&e.target&&(e.target.removeEventListener(e.type,e.listener),(0,_obj.clear)(e))}

},{"./obj.js":121}],52:[function(require,module,exports){
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var o=0;o<e.length;o++){var r=e[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,_toPropertyKey(r.key),r)}}function _createClass(t,e,o){return e&&_defineProperties(t.prototype,e),o&&_defineProperties(t,o),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var r=o.call(t,e||"default");if("object"!=_typeof(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0,exports.preventDefault=preventDefault,exports.stopPropagation=stopPropagation;var BaseEvent=function(){return _createClass(function t(e){_classCallCheck(this,t),this.propagationStopped,this.defaultPrevented,this.type=e,this.target=null},[{key:"preventDefault",value:function(){this.defaultPrevented=!0}},{key:"stopPropagation",value:function(){this.propagationStopped=!0}}])}();function stopPropagation(t){t.stopPropagation()}function preventDefault(t){t.preventDefault()}var _default=exports.default=BaseEvent;

},{}],53:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _default=exports.default={CHANGE:"change",ERROR:"error",BLUR:"blur",CLEAR:"clear",CONTEXTMENU:"contextmenu",CLICK:"click",DBLCLICK:"dblclick",DRAGENTER:"dragenter",DRAGOVER:"dragover",DROP:"drop",FOCUS:"focus",KEYDOWN:"keydown",KEYPRESS:"keypress",LOAD:"load",RESIZE:"resize",TOUCHMOVE:"touchmove",WHEEL:"wheel"};

},{}],54:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _default=exports.default={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",DOWN:"ArrowDown"};

},{}],55:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _Disposable2=_interopRequireDefault(require("../Disposable.js")),_Event=_interopRequireDefault(require("./Event.js")),_functions=require("../functions.js"),_obj=require("../obj.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey(n.key),n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var Target=function(e){function t(e){var r;return _classCallCheck(this,t),(r=_callSuper(this,t)).eventTarget_=e,r.pendingRemovals_=null,r.dispatching_=null,r.listeners_=null,r}return _inherits(t,_Disposable2["default"]),_createClass(t,[{key:"addEventListener",value:function(e,t){if(e&&t){var r=this.listeners_||(this.listeners_={}),n=r[e]||(r[e]=[]);n.includes(t)||n.push(t)}}},{key:"dispatchEvent",value:function(e){var t="string"==typeof e,r=t?e:e.type,n=this.listeners_&&this.listeners_[r];if(n){var i=t?new _Event.default(e):e;i.target||(i.target=this.eventTarget_||this);var o,s=this.dispatching_||(this.dispatching_={}),u=this.pendingRemovals_||(this.pendingRemovals_={});r in s||(s[r]=0,u[r]=0),++s[r];for(var l=0,a=n.length;l<a;++l)if(!1===(o="handleEvent"in n[l]?n[l].handleEvent(i):n[l].call(this,i))||i.propagationStopped){o=!1;break}if(0==--s[r]){var f=u[r];for(delete u[r];f--;)this.removeEventListener(r,_functions.VOID);delete s[r]}return o}}},{key:"disposeInternal",value:function(){this.listeners_&&(0,_obj.clear)(this.listeners_)}},{key:"getListeners",value:function(e){return this.listeners_&&this.listeners_[e]||void 0}},{key:"hasListener",value:function(e){return!!this.listeners_&&(e?e in this.listeners_:Object.keys(this.listeners_).length>0)}},{key:"removeEventListener",value:function(e,t){if(this.listeners_){var r=this.listeners_[e];if(r){var n=r.indexOf(t);-1!==n&&(this.pendingRemovals_&&e in this.pendingRemovals_?(r[n]=_functions.VOID,++this.pendingRemovals_[e]):(r.splice(n,1),0===r.length&&delete this.listeners_[e]))}}}}])}(),_default=exports.default=Target;

},{"../Disposable.js":12,"../functions.js":62,"../obj.js":121,"./Event.js":52}],56:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.all=all,exports.touchOnly=exports.targetNotEditable=exports.singleClick=exports.shiftKeyOnly=exports.primaryAction=exports.pointerMove=exports.platformModifierKeyOnly=exports.platformModifierKey=exports.penOnly=exports.noModifierKeys=exports.never=exports.mouseOnly=exports.mouseActionButton=exports.focusWithTabindex=exports.focus=exports.doubleClick=exports.click=exports.always=exports.altShiftKeysOnly=exports.altKeyOnly=void 0;var _MapBrowserEventType=_interopRequireDefault(require("../MapBrowserEventType.js")),_functions=require("../functions.js"),_has=require("../has.js"),_asserts=require("../asserts.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function all(e){var t=arguments;return function(e){for(var r=!0,n=0,o=t.length;n<o&&(r=r&&t[n](e));++n);return r}}var altKeyOnly=exports.altKeyOnly=function(e){var t=e.originalEvent;return t.altKey&&!(t.metaKey||t.ctrlKey)&&!t.shiftKey},altShiftKeysOnly=exports.altShiftKeysOnly=function(e){var t=e.originalEvent;return t.altKey&&!(t.metaKey||t.ctrlKey)&&t.shiftKey},focus=exports.focus=function(e){var t=e.map.getTargetElement(),r=e.map.getOwnerDocument().activeElement;return t.contains(r)},focusWithTabindex=exports.focusWithTabindex=function(e){return!e.map.getTargetElement().hasAttribute("tabindex")||focus(e)},always=exports.always=_functions.TRUE,click=exports.click=function(e){return e.type==_MapBrowserEventType.default.CLICK},mouseActionButton=exports.mouseActionButton=function(e){var t=e.originalEvent;return 0==t.button&&!(_has.WEBKIT&&_has.MAC&&t.ctrlKey)},never=exports.never=_functions.FALSE,pointerMove=exports.pointerMove=function(e){return"pointermove"==e.type},singleClick=exports.singleClick=function(e){return e.type==_MapBrowserEventType.default.SINGLECLICK},doubleClick=exports.doubleClick=function(e){return e.type==_MapBrowserEventType.default.DBLCLICK},noModifierKeys=exports.noModifierKeys=function(e){var t=e.originalEvent;return!t.altKey&&!(t.metaKey||t.ctrlKey)&&!t.shiftKey},platformModifierKeyOnly=exports.platformModifierKeyOnly=function(e){var t=e.originalEvent;return!t.altKey&&(_has.MAC?t.metaKey:t.ctrlKey)&&!t.shiftKey},platformModifierKey=exports.platformModifierKey=function(e){var t=e.originalEvent;return _has.MAC?t.metaKey:t.ctrlKey},shiftKeyOnly=exports.shiftKeyOnly=function(e){var t=e.originalEvent;return!t.altKey&&!(t.metaKey||t.ctrlKey)&&t.shiftKey},targetNotEditable=exports.targetNotEditable=function(e){var t=e.originalEvent,r=t.target.tagName;return"INPUT"!==r&&"SELECT"!==r&&"TEXTAREA"!==r&&!t.target.isContentEditable},mouseOnly=exports.mouseOnly=function(e){var t=e.originalEvent;return(0,_asserts.assert)(void 0!==t,"mapBrowserEvent must originate from a pointer event"),"mouse"==t.pointerType},touchOnly=exports.touchOnly=function(e){var t=e.originalEvent;return(0,_asserts.assert)(void 0!==t,"mapBrowserEvent must originate from a pointer event"),"touch"===t.pointerType},penOnly=exports.penOnly=function(e){var t=e.originalEvent;return(0,_asserts.assert)(void 0!==t,"mapBrowserEvent must originate from a pointer event"),"pen"===t.pointerType},primaryAction=exports.primaryAction=function(e){var t=e.originalEvent;return(0,_asserts.assert)(void 0!==t,"mapBrowserEvent must originate from a pointer event"),t.isPrimary&&0===t.button};

},{"../MapBrowserEventType.js":21,"../asserts.js":37,"../functions.js":62,"../has.js":93}],57:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.buildExpression=buildExpression,exports.newEvaluationContext=newEvaluationContext;var _expression=require("./expression.js"),_color=require("../color.js");function _typeof(r){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(r){return typeof r}:function(r){return r&&"function"==typeof Symbol&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r})(r)}function _toConsumableArray(r){return _arrayWithoutHoles(r)||_iterableToArray(r)||_unsupportedIterableToArray(r)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(r,e){if(r){if("string"==typeof r)return _arrayLikeToArray(r,e);var n={}.toString.call(r).slice(8,-1);return"Object"===n&&r.constructor&&(n=r.constructor.name),"Map"===n||"Set"===n?Array.from(r):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(r,e):void 0}}function _iterableToArray(r){if("undefined"!=typeof Symbol&&null!=r[Symbol.iterator]||null!=r["@@iterator"])return Array.from(r)}function _arrayWithoutHoles(r){if(Array.isArray(r))return _arrayLikeToArray(r)}function _arrayLikeToArray(r,e){(null==e||e>r.length)&&(e=r.length);for(var n=0,o=Array(e);n<e;n++)o[n]=r[n];return o}function newEvaluationContext(){return{variables:{},properties:{},resolution:NaN,featureId:null,geometryType:""}}function buildExpression(r,e,n){return compileExpression((0,_expression.parse)(r,e,n),n)}function compileExpression(r,e){if(r instanceof _expression.LiteralExpression){if(r.type===_expression.ColorType&&"string"==typeof r.value){var n=(0,_color.fromString)(r.value);return function(){return n}}return function(){return r.value}}var o=r.operator;switch(o){case _expression.Ops.Number:case _expression.Ops.String:case _expression.Ops.Coalesce:return compileAssertionExpression(r,e);case _expression.Ops.Get:case _expression.Ops.Var:return compileAccessorExpression(r,e);case _expression.Ops.Id:return function(r){return r.featureId};case _expression.Ops.GeometryType:return function(r){return r.geometryType};case _expression.Ops.Concat:var s=r.args.map(function(r){return compileExpression(r,e)});return function(r){var e;return(e="").concat.apply(e,_toConsumableArray(s.map(function(e){return e(r).toString()})))};case _expression.Ops.Resolution:return function(r){return r.resolution};case _expression.Ops.Any:case _expression.Ops.All:case _expression.Ops.Between:case _expression.Ops.In:case _expression.Ops.Not:return compileLogicalExpression(r,e);case _expression.Ops.Equal:case _expression.Ops.NotEqual:case _expression.Ops.LessThan:case _expression.Ops.LessThanOrEqualTo:case _expression.Ops.GreaterThan:case _expression.Ops.GreaterThanOrEqualTo:return compileComparisonExpression(r,e);case _expression.Ops.Multiply:case _expression.Ops.Divide:case _expression.Ops.Add:case _expression.Ops.Subtract:case _expression.Ops.Clamp:case _expression.Ops.Mod:case _expression.Ops.Pow:case _expression.Ops.Abs:case _expression.Ops.Floor:case _expression.Ops.Ceil:case _expression.Ops.Round:case _expression.Ops.Sin:case _expression.Ops.Cos:case _expression.Ops.Atan:case _expression.Ops.Sqrt:return compileNumericExpression(r,e);case _expression.Ops.Case:return compileCaseExpression(r,e);case _expression.Ops.Match:return compileMatchExpression(r,e);case _expression.Ops.Interpolate:return compileInterpolateExpression(r,e);case _expression.Ops.ToString:return compileConvertExpression(r,e);default:throw new Error("Unsupported operator ".concat(o))}}function compileAssertionExpression(r,e){for(var n=r.operator,o=r.args.length,s=new Array(o),t=0;t<o;++t)s[t]=compileExpression(r.args[t],e);switch(n){case _expression.Ops.Coalesce:return function(r){for(var e=0;e<o;++e){var n=s[e](r);if(null!=n)return n}throw new Error("Expected one of the values to be non-null")};case _expression.Ops.Number:case _expression.Ops.String:return function(r){for(var e=0;e<o;++e){var t=s[e](r);if(_typeof(t)===n)return t}throw new Error("Expected one of the values to be a ".concat(n))};default:throw new Error("Unsupported assertion operator ".concat(n))}}function compileAccessorExpression(r,e){var n=r.args[0].value;switch(r.operator){case _expression.Ops.Get:return function(e){for(var o=r.args,s=e.properties[n],t=1,a=o.length;t<a;++t){s=s[o[t].value]}return s};case _expression.Ops.Var:return function(r){return r.variables[n]};default:throw new Error("Unsupported accessor operator ".concat(r.operator))}}function compileComparisonExpression(r,e){var n=r.operator,o=compileExpression(r.args[0],e),s=compileExpression(r.args[1],e);switch(n){case _expression.Ops.Equal:return function(r){return o(r)===s(r)};case _expression.Ops.NotEqual:return function(r){return o(r)!==s(r)};case _expression.Ops.LessThan:return function(r){return o(r)<s(r)};case _expression.Ops.LessThanOrEqualTo:return function(r){return o(r)<=s(r)};case _expression.Ops.GreaterThan:return function(r){return o(r)>s(r)};case _expression.Ops.GreaterThanOrEqualTo:return function(r){return o(r)>=s(r)};default:throw new Error("Unsupported comparison operator ".concat(n))}}function compileLogicalExpression(r,e){for(var n=r.operator,o=r.args.length,s=new Array(o),t=0;t<o;++t)s[t]=compileExpression(r.args[t],e);switch(n){case _expression.Ops.Any:return function(r){for(var e=0;e<o;++e)if(s[e](r))return!0;return!1};case _expression.Ops.All:return function(r){for(var e=0;e<o;++e)if(!s[e](r))return!1;return!0};case _expression.Ops.Between:return function(r){var e=s[0](r),n=s[1](r),o=s[2](r);return e>=n&&e<=o};case _expression.Ops.In:return function(r){for(var e=s[0](r),n=1;n<o;++n)if(e===s[n](r))return!0;return!1};case _expression.Ops.Not:return function(r){return!s[0](r)};default:throw new Error("Unsupported logical operator ".concat(n))}}function compileNumericExpression(r,e){for(var n=r.operator,o=r.args.length,s=new Array(o),t=0;t<o;++t)s[t]=compileExpression(r.args[t],e);switch(n){case _expression.Ops.Multiply:return function(r){for(var e=1,n=0;n<o;++n)e*=s[n](r);return e};case _expression.Ops.Divide:return function(r){return s[0](r)/s[1](r)};case _expression.Ops.Add:return function(r){for(var e=0,n=0;n<o;++n)e+=s[n](r);return e};case _expression.Ops.Subtract:return function(r){return s[0](r)-s[1](r)};case _expression.Ops.Clamp:return function(r){var e=s[0](r),n=s[1](r);if(e<n)return n;var o=s[2](r);return e>o?o:e};case _expression.Ops.Mod:return function(r){return s[0](r)%s[1](r)};case _expression.Ops.Pow:return function(r){return Math.pow(s[0](r),s[1](r))};case _expression.Ops.Abs:return function(r){return Math.abs(s[0](r))};case _expression.Ops.Floor:return function(r){return Math.floor(s[0](r))};case _expression.Ops.Ceil:return function(r){return Math.ceil(s[0](r))};case _expression.Ops.Round:return function(r){return Math.round(s[0](r))};case _expression.Ops.Sin:return function(r){return Math.sin(s[0](r))};case _expression.Ops.Cos:return function(r){return Math.cos(s[0](r))};case _expression.Ops.Atan:return 2===o?function(r){return Math.atan2(s[0](r),s[1](r))}:function(r){return Math.atan(s[0](r))};case _expression.Ops.Sqrt:return function(r){return Math.sqrt(s[0](r))};default:throw new Error("Unsupported numeric operator ".concat(n))}}function compileCaseExpression(r,e){for(var n=r.args.length,o=new Array(n),s=0;s<n;++s)o[s]=compileExpression(r.args[s],e);return function(r){for(var e=0;e<n-1;e+=2){if(o[e](r))return o[e+1](r)}return o[n-1](r)}}function compileMatchExpression(r,e){for(var n=r.args.length,o=new Array(n),s=0;s<n;++s)o[s]=compileExpression(r.args[s],e);return function(r){for(var e=o[0](r),s=1;s<n;s+=2)if(e===o[s](r))return o[s+1](r);return o[n-1](r)}}function compileInterpolateExpression(r,e){for(var n=r.args.length,o=new Array(n),s=0;s<n;++s)o[s]=compileExpression(r.args[s],e);return function(r){for(var e,s,t=o[0](r),a=o[1](r),i=2;i<n;i+=2){var p=o[i](r),u=o[i+1](r),c=Array.isArray(u);if(c&&(u=(0,_color.withAlpha)(u)),p>=a)return 2===i?u:c?interpolateColor(t,a,e,s,p,u):interpolateNumber(t,a,e,s,p,u);e=p,s=u}return s}}function compileConvertExpression(r,e){for(var n=r.operator,o=r.args.length,s=new Array(o),t=0;t<o;++t)s[t]=compileExpression(r.args[t],e);switch(n){case _expression.Ops.ToString:return function(e){var n=s[0](e);return r.args[0].type===_expression.ColorType?(0,_color.toString)(n):n.toString()};default:throw new Error("Unsupported convert operator ".concat(n))}}function interpolateNumber(r,e,n,o,s,t){var a=s-n;if(0===a)return o;var i=e-n;return o+(1===r?i/a:(Math.pow(r,i)-1)/(Math.pow(r,a)-1))*(t-o)}function interpolateColor(r,e,n,o,s,t){if(0===s-n)return o;var a=(0,_color.rgbaToLcha)(o),i=(0,_color.rgbaToLcha)(t),p=i[2]-a[2];p>180?p-=360:p<-180&&(p+=360);var u=[interpolateNumber(r,e,n,a[0],s,i[0]),interpolateNumber(r,e,n,a[1],s,i[1]),a[2]+interpolateNumber(r,e,n,0,s,p),interpolateNumber(r,e,n,o[3],s,t[3])];return(0,_color.normalize)((0,_color.lchaToRgba)(u))}

},{"../color.js":39,"./expression.js":58}],58:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.StringType=exports.SizeType=exports.Ops=exports.NumberType=exports.NumberArrayType=exports.NoneType=exports.LiteralExpression=exports.ColorType=exports.CallExpression=exports.BooleanType=exports.AnyType=void 0,exports.computeGeometryType=computeGeometryType,exports.includesType=includesType,exports.isType=isType,exports.newParsingContext=newParsingContext,exports.overlapsType=overlapsType,exports.parse=parse,exports.typeName=typeName;var _parsers,_array=require("../array.js"),_color=require("../color.js"),_size=require("../size.js");function _construct(e,r,t){if(_isNativeReflectConstruct())return Reflect.construct.apply(null,arguments);var o=[null];o.push.apply(o,r);var n=new(e.bind.apply(e,o));return t&&_setPrototypeOf(n,t.prototype),n}function _setPrototypeOf(e,r){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,r){return e.__proto__=r,e})(e,r)}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArray(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _defineProperties(e,r){for(var t=0;t<r.length;t++){var o=r[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,r,t){return r&&_defineProperties(e.prototype,r),t&&_defineProperties(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _classCallCheck(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function _createForOfIteratorHelper(e,r){var t="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=_unsupportedIterableToArray(e))||r&&e&&"number"==typeof e.length){t&&(e=t);var o=0,n=function(){};return{s:n,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,i=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return s=e.done,e},e:function(e){i=!0,a=e},f:function(){try{s||null==t.return||t.return()}finally{if(i)throw a}}}}function _unsupportedIterableToArray(e,r){if(e){if("string"==typeof e)return _arrayLikeToArray(e,r);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?_arrayLikeToArray(e,r):void 0}}function _arrayLikeToArray(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,o=Array(r);t<r;t++)o[t]=e[t];return o}function _defineProperty(e,r,t){return(r=_toPropertyKey(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function _toPropertyKey(e){var r=_toPrimitive(e,"string");return"symbol"==_typeof(r)?r:r+""}function _toPrimitive(e,r){if("object"!=_typeof(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var o=t.call(e,r||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(e)}var numTypes=0,NoneType=exports.NoneType=0,BooleanType=exports.BooleanType=1<<numTypes++,NumberType=exports.NumberType=1<<numTypes++,StringType=exports.StringType=1<<numTypes++,ColorType=exports.ColorType=1<<numTypes++,NumberArrayType=exports.NumberArrayType=1<<numTypes++,SizeType=exports.SizeType=1<<numTypes++,AnyType=exports.AnyType=Math.pow(2,numTypes)-1,typeNames=_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty({},BooleanType,"boolean"),NumberType,"number"),StringType,"string"),ColorType,"color"),NumberArrayType,"number[]"),SizeType,"size"),namedTypes=Object.keys(typeNames).map(Number).sort(_array.ascending);function isSpecific(e){return e in typeNames}function typeName(e){var r,t=[],o=_createForOfIteratorHelper(namedTypes);try{for(o.s();!(r=o.n()).done;){var n=r.value;includesType(e,n)&&t.push(typeNames[n])}}catch(e){o.e(e)}finally{o.f()}return 0===t.length?"untyped":t.length<3?t.join(" or "):t.slice(0,-1).join(", ")+", or "+t[t.length-1]}function includesType(e,r){return(e&r)===r}function overlapsType(e,r){return!!(e&r)}function isType(e,r){return e===r}var LiteralExpression=exports.LiteralExpression=_createClass(function e(r,t){if(_classCallCheck(this,e),!isSpecific(r))throw new Error("literal expressions must have a specific type, got ".concat(typeName(r)));this.type=r,this.value=t}),CallExpression=exports.CallExpression=_createClass(function e(r,t){_classCallCheck(this,e),this.type=r,this.operator=t;for(var o=arguments.length,n=new Array(o>2?o-2:0),a=2;a<o;a++)n[a-2]=arguments[a];this.args=n});function newParsingContext(){return{variables:new Set,properties:new Set,featureId:!1,geometryType:!1}}function parse(e,r,t){switch(_typeof(e)){case"boolean":if(isType(r,StringType))return new LiteralExpression(StringType,e?"true":"false");if(!includesType(r,BooleanType))throw new Error("got a boolean, but expected ".concat(typeName(r)));return new LiteralExpression(BooleanType,e);case"number":if(isType(r,SizeType))return new LiteralExpression(SizeType,(0,_size.toSize)(e));if(isType(r,BooleanType))return new LiteralExpression(BooleanType,!!e);if(isType(r,StringType))return new LiteralExpression(StringType,e.toString());if(!includesType(r,NumberType))throw new Error("got a number, but expected ".concat(typeName(r)));return new LiteralExpression(NumberType,e);case"string":if(isType(r,ColorType))return new LiteralExpression(ColorType,(0,_color.fromString)(e));if(isType(r,BooleanType))return new LiteralExpression(BooleanType,!!e);if(!includesType(r,StringType))throw new Error("got a string, but expected ".concat(typeName(r)));return new LiteralExpression(StringType,e)}if(!Array.isArray(e))throw new Error("expression must be an array or a primitive value");if(0===e.length)throw new Error("empty expression");if("string"==typeof e[0])return parseCallExpression(e,r,t);var o,n=_createForOfIteratorHelper(e);try{for(n.s();!(o=n.n()).done;){if("number"!=typeof o.value)throw new Error("expected an array of numbers")}}catch(e){n.e(e)}finally{n.f()}if(isType(r,SizeType)){if(2!==e.length)throw new Error("expected an array of two values for a size, got ".concat(e.length));return new LiteralExpression(SizeType,e)}if(isType(r,ColorType)){if(3===e.length)return new LiteralExpression(ColorType,[].concat(_toConsumableArray(e),[1]));if(4===e.length)return new LiteralExpression(ColorType,e);throw new Error("expected an array of 3 or 4 values for a color, got ".concat(e.length))}if(!includesType(r,NumberArrayType))throw new Error("got an array of numbers, but expected ".concat(typeName(r)));return new LiteralExpression(NumberArrayType,e)}var Ops=exports.Ops={Get:"get",Var:"var",Concat:"concat",GeometryType:"geometry-type",Any:"any",All:"all",Not:"!",Resolution:"resolution",Zoom:"zoom",Time:"time",Equal:"==",NotEqual:"!=",GreaterThan:">",GreaterThanOrEqualTo:">=",LessThan:"<",LessThanOrEqualTo:"<=",Multiply:"*",Divide:"/",Add:"+",Subtract:"-",Clamp:"clamp",Mod:"%",Pow:"^",Abs:"abs",Floor:"floor",Ceil:"ceil",Round:"round",Sin:"sin",Cos:"cos",Atan:"atan",Sqrt:"sqrt",Match:"match",Between:"between",Interpolate:"interpolate",Coalesce:"coalesce",Case:"case",In:"in",Number:"number",String:"string",Array:"array",Color:"color",Id:"id",Band:"band",Palette:"palette",ToString:"to-string"},parsers=(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_parsers={},Ops.Get,createCallExpressionParser(hasArgsCount(1,1/0),withGetArgs)),Ops.Var,createCallExpressionParser(hasArgsCount(1,1),withVarArgs)),Ops.Id,createCallExpressionParser(usesFeatureId,withNoArgs)),Ops.Concat,createCallExpressionParser(hasArgsCount(2,1/0),withArgsOfType(StringType))),Ops.GeometryType,createCallExpressionParser(usesGeometryType,withNoArgs)),Ops.Resolution,createCallExpressionParser(withNoArgs)),Ops.Zoom,createCallExpressionParser(withNoArgs)),Ops.Time,createCallExpressionParser(withNoArgs)),Ops.Any,createCallExpressionParser(hasArgsCount(2,1/0),withArgsOfType(BooleanType))),Ops.All,createCallExpressionParser(hasArgsCount(2,1/0),withArgsOfType(BooleanType))),_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_parsers,Ops.Not,createCallExpressionParser(hasArgsCount(1,1),withArgsOfType(BooleanType))),Ops.Equal,createCallExpressionParser(hasArgsCount(2,2),withArgsOfType(AnyType))),Ops.NotEqual,createCallExpressionParser(hasArgsCount(2,2),withArgsOfType(AnyType))),Ops.GreaterThan,createCallExpressionParser(hasArgsCount(2,2),withArgsOfType(NumberType))),Ops.GreaterThanOrEqualTo,createCallExpressionParser(hasArgsCount(2,2),withArgsOfType(NumberType))),Ops.LessThan,createCallExpressionParser(hasArgsCount(2,2),withArgsOfType(NumberType))),Ops.LessThanOrEqualTo,createCallExpressionParser(hasArgsCount(2,2),withArgsOfType(NumberType))),Ops.Multiply,createCallExpressionParser(hasArgsCount(2,1/0),withArgsOfReturnType)),Ops.Coalesce,createCallExpressionParser(hasArgsCount(2,1/0),withArgsOfReturnType)),Ops.Divide,createCallExpressionParser(hasArgsCount(2,2),withArgsOfType(NumberType))),_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_parsers,Ops.Add,createCallExpressionParser(hasArgsCount(2,1/0),withArgsOfType(NumberType))),Ops.Subtract,createCallExpressionParser(hasArgsCount(2,2),withArgsOfType(NumberType))),Ops.Clamp,createCallExpressionParser(hasArgsCount(3,3),withArgsOfType(NumberType))),Ops.Mod,createCallExpressionParser(hasArgsCount(2,2),withArgsOfType(NumberType))),Ops.Pow,createCallExpressionParser(hasArgsCount(2,2),withArgsOfType(NumberType))),Ops.Abs,createCallExpressionParser(hasArgsCount(1,1),withArgsOfType(NumberType))),Ops.Floor,createCallExpressionParser(hasArgsCount(1,1),withArgsOfType(NumberType))),Ops.Ceil,createCallExpressionParser(hasArgsCount(1,1),withArgsOfType(NumberType))),Ops.Round,createCallExpressionParser(hasArgsCount(1,1),withArgsOfType(NumberType))),Ops.Sin,createCallExpressionParser(hasArgsCount(1,1),withArgsOfType(NumberType))),_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_parsers,Ops.Cos,createCallExpressionParser(hasArgsCount(1,1),withArgsOfType(NumberType))),Ops.Atan,createCallExpressionParser(hasArgsCount(1,2),withArgsOfType(NumberType))),Ops.Sqrt,createCallExpressionParser(hasArgsCount(1,1),withArgsOfType(NumberType))),Ops.Match,createCallExpressionParser(hasArgsCount(4,1/0),hasEvenArgs,withMatchArgs)),Ops.Between,createCallExpressionParser(hasArgsCount(3,3),withArgsOfType(NumberType))),Ops.Interpolate,createCallExpressionParser(hasArgsCount(6,1/0),hasEvenArgs,withInterpolateArgs)),Ops.Case,createCallExpressionParser(hasArgsCount(3,1/0),hasOddArgs,withCaseArgs)),Ops.In,createCallExpressionParser(hasArgsCount(2,2),withInArgs)),Ops.Number,createCallExpressionParser(hasArgsCount(1,1/0),withArgsOfType(AnyType))),Ops.String,createCallExpressionParser(hasArgsCount(1,1/0),withArgsOfType(AnyType))),_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_parsers,Ops.Array,createCallExpressionParser(hasArgsCount(1,1/0),withArgsOfType(NumberType))),Ops.Color,createCallExpressionParser(hasArgsCount(1,4),withArgsOfType(NumberType))),Ops.Band,createCallExpressionParser(hasArgsCount(1,3),withArgsOfType(NumberType))),Ops.Palette,createCallExpressionParser(hasArgsCount(2,2),withPaletteArgs)),Ops.ToString,createCallExpressionParser(hasArgsCount(1,1),withArgsOfType(BooleanType|NumberType|StringType|ColorType))));function withGetArgs(e,r,t){for(var o=e.length-1,n=new Array(o),a=0;a<o;++a){var s=e[a+1];switch(_typeof(s)){case"number":n[a]=new LiteralExpression(NumberType,s);break;case"string":n[a]=new LiteralExpression(StringType,s);break;default:throw new Error("expected a string key or numeric array index for a get operation, got ".concat(s))}0===a&&t.properties.add(String(s))}return n}function withVarArgs(e,r,t){var o=e[1];if("string"!=typeof o)throw new Error("expected a string argument for var operation");return t.variables.add(o),[new LiteralExpression(StringType,o)]}function usesFeatureId(e,r,t){t.featureId=!0}function usesGeometryType(e,r,t){t.geometryType=!0}function withNoArgs(e,r,t){var o=e[0];if(1!==e.length)throw new Error("expected no arguments for ".concat(o," operation"));return[]}function hasArgsCount(e,r){return function(t,o,n){var a=t[0],s=t.length-1;if(e===r){if(s!==e){var i=1===e?"":"s";throw new Error("expected ".concat(e," argument").concat(i," for ").concat(a,", got ").concat(s))}}else if(s<e||s>r){var p=r===1/0?"".concat(e," or more"):"".concat(e," to ").concat(r);throw new Error("expected ".concat(p," arguments for ").concat(a,", got ").concat(s))}}}function withArgsOfReturnType(e,r,t){for(var o=e.length-1,n=new Array(o),a=0;a<o;++a){var s=parse(e[a+1],r,t);n[a]=s}return n}function withArgsOfType(e){return function(r,t,o){for(var n=r.length-1,a=new Array(n),s=0;s<n;++s){var i=parse(r[s+1],e,o);a[s]=i}return a}}function hasOddArgs(e,r,t){var o=e[0],n=e.length-1;if(n%2==0)throw new Error("expected an odd number of arguments for ".concat(o,", got ").concat(n," instead"))}function hasEvenArgs(e,r,t){var o=e[0],n=e.length-1;if(n%2==1)throw new Error("expected an even number of arguments for operation ".concat(o,", got ").concat(n," instead"))}function withMatchArgs(e,r,t){for(var o=e.length-1,n=StringType|NumberType|BooleanType,a=parse(e[1],n,t),s=parse(e[e.length-1],r,t),i=new Array(o-2),p=0;p<o-2;p+=2){try{var y=parse(e[p+2],a.type,t);i[p]=y}catch(e){throw new Error("failed to parse argument ".concat(p+1," of match expression: ").concat(e.message))}try{var l=parse(e[p+3],s.type,t);i[p+1]=l}catch(e){throw new Error("failed to parse argument ".concat(p+2," of match expression: ").concat(e.message))}}return[a].concat(i,[s])}function withInterpolateArgs(e,r,t){var o,n=e[1];switch(n[0]){case"linear":o=1;break;case"exponential":var a=n[1];if("number"!=typeof a||a<=0)throw new Error("expected a number base for exponential interpolation"+", got ".concat(JSON.stringify(a)," instead"));o=a;break;default:throw new Error("invalid interpolation type: ".concat(JSON.stringify(n)))}var s,i=new LiteralExpression(NumberType,o);try{s=parse(e[2],NumberType,t)}catch(e){throw new Error("failed to parse argument 1 in interpolate expression: ".concat(e.message))}for(var p=new Array(e.length-3),y=0;y<p.length;y+=2){try{var l=parse(e[y+3],NumberType,t);p[y]=l}catch(e){throw new Error("failed to parse argument ".concat(y+2," for interpolate expression: ").concat(e.message))}try{var c=parse(e[y+4],r,t);p[y+1]=c}catch(e){throw new Error("failed to parse argument ".concat(y+3," for interpolate expression: ").concat(e.message))}}return[i,s].concat(p)}function withCaseArgs(e,r,t){for(var o=parse(e[e.length-1],r,t),n=new Array(e.length-1),a=0;a<n.length-1;a+=2){try{var s=parse(e[a+1],BooleanType,t);n[a]=s}catch(e){throw new Error("failed to parse argument ".concat(a," of case expression: ").concat(e.message))}try{var i=parse(e[a+2],o.type,t);n[a+1]=i}catch(e){throw new Error("failed to parse argument ".concat(a+1," of case expression: ").concat(e.message))}}return n[n.length-1]=o,n}function withInArgs(e,r,t){var o,n=e[2];if(!Array.isArray(n))throw new Error('the second argument for the "in" operator must be an array');if("string"==typeof n[0]){if("literal"!==n[0])throw new Error('for the "in" operator, a string array should be wrapped in a "literal" operator to disambiguate from expressions');if(!Array.isArray(n[1]))throw new Error('failed to parse "in" expression: the literal operator must be followed by an array');n=n[1],o=StringType}else o=NumberType;for(var a=new Array(n.length),s=0;s<a.length;s++)try{var i=parse(n[s],o,t);a[s]=i}catch(e){throw new Error("failed to parse haystack item ".concat(s,' for "in" expression: ').concat(e.message))}return[parse(e[1],o,t)].concat(a)}function withPaletteArgs(e,r,t){var o;try{o=parse(e[1],NumberType,t)}catch(e){throw new Error("failed to parse first argument in palette expression: ".concat(e.message))}var n=e[2];if(!Array.isArray(n))throw new Error("the second argument of palette must be an array");for(var a=new Array(n.length),s=0;s<a.length;s++){var i=void 0;try{i=parse(n[s],ColorType,t)}catch(e){throw new Error("failed to parse color at index ".concat(s," in palette expression: ").concat(e.message))}if(!(i instanceof LiteralExpression))throw new Error("the palette color at index ".concat(s," must be a literal value"));a[s]=i}return[o].concat(a)}function createCallExpressionParser(){for(var e=arguments.length,r=new Array(e),t=0;t<e;t++)r[t]=arguments[t];return function(e,t,o){for(var n,a=e[0],s=0;s<r.length;s++){var i=r[s](e,t,o);if(s==r.length-1){if(!i)throw new Error("expected last argument validator to return the parsed args");n=i}}return _construct(CallExpression,[t,a].concat(_toConsumableArray(n)))}}function parseCallExpression(e,r,t){var o=e[0],n=parsers[o];if(!n)throw new Error("unknown operator: ".concat(o));return n(e,r,t)}function computeGeometryType(e){if(!e)return"";var r=e.getType();switch(r){case"Point":case"LineString":case"Polygon":return r;case"MultiPoint":case"MultiLineString":case"MultiPolygon":return r.substring(5);case"Circle":return"Polygon";case"GeometryCollection":return computeGeometryType(e.getGeometries()[0]);default:return""}}

},{"../array.js":36,"../color.js":39,"../size.js":167}],59:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.applyTransform=applyTransform,exports.approximatelyEquals=approximatelyEquals,exports.boundingExtent=boundingExtent,exports.buffer=buffer,exports.clone=clone,exports.closestSquaredDistanceXY=closestSquaredDistanceXY,exports.containsCoordinate=containsCoordinate,exports.containsExtent=containsExtent,exports.containsXY=containsXY,exports.coordinateRelationship=coordinateRelationship,exports.createEmpty=createEmpty,exports.createOrUpdate=createOrUpdate,exports.createOrUpdateEmpty=createOrUpdateEmpty,exports.createOrUpdateFromCoordinate=createOrUpdateFromCoordinate,exports.createOrUpdateFromCoordinates=createOrUpdateFromCoordinates,exports.createOrUpdateFromFlatCoordinates=createOrUpdateFromFlatCoordinates,exports.createOrUpdateFromRings=createOrUpdateFromRings,exports.equals=equals,exports.extend=extend,exports.extendCoordinate=extendCoordinate,exports.extendCoordinates=extendCoordinates,exports.extendFlatCoordinates=extendFlatCoordinates,exports.extendRings=extendRings,exports.extendXY=extendXY,exports.forEachCorner=forEachCorner,exports.getArea=getArea,exports.getBottomLeft=getBottomLeft,exports.getBottomRight=getBottomRight,exports.getCenter=getCenter,exports.getCorner=getCorner,exports.getEnlargedArea=getEnlargedArea,exports.getForViewAndSize=getForViewAndSize,exports.getHeight=getHeight,exports.getIntersection=getIntersection,exports.getIntersectionArea=getIntersectionArea,exports.getMargin=getMargin,exports.getRotatedViewport=getRotatedViewport,exports.getSize=getSize,exports.getTopLeft=getTopLeft,exports.getTopRight=getTopRight,exports.getWidth=getWidth,exports.intersects=intersects,exports.intersectsSegment=intersectsSegment,exports.isEmpty=isEmpty,exports.returnOrUpdate=returnOrUpdate,exports.scaleFromCenter=scaleFromCenter,exports.wrapAndSliceX=wrapAndSliceX,exports.wrapX=wrapX;var _Relationship=_interopRequireDefault(require("./extent/Relationship.js"));function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _slicedToArray(t,e){return _arrayWithHoles(t)||_iterableToArrayLimit(t,e)||_unsupportedIterableToArray(t,e)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(t,e){if(t){if("string"==typeof t)return _arrayLikeToArray(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(t,e):void 0}}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function _iterableToArrayLimit(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,a,i,s=[],u=!0,p=!1;try{if(a=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=a.call(r)).done)&&(s.push(n.value),s.length!==e);u=!0);}catch(t){p=!0,o=t}finally{try{if(!u&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(p)throw o}}return s}}function _arrayWithHoles(t){if(Array.isArray(t))return t}function boundingExtent(t){for(var e=createEmpty(),r=0,n=t.length;r<n;++r)extendCoordinate(e,t[r]);return e}function _boundingExtentXYs(t,e,r){return createOrUpdate(Math.min.apply(null,t),Math.min.apply(null,e),Math.max.apply(null,t),Math.max.apply(null,e),r)}function buffer(t,e,r){return r?(r[0]=t[0]-e,r[1]=t[1]-e,r[2]=t[2]+e,r[3]=t[3]+e,r):[t[0]-e,t[1]-e,t[2]+e,t[3]+e]}function clone(t,e){return e?(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e):t.slice()}function closestSquaredDistanceXY(t,e,r){var n,o;return(n=e<t[0]?t[0]-e:t[2]<e?e-t[2]:0)*n+(o=r<t[1]?t[1]-r:t[3]<r?r-t[3]:0)*o}function containsCoordinate(t,e){return containsXY(t,e[0],e[1])}function containsExtent(t,e){return t[0]<=e[0]&&e[2]<=t[2]&&t[1]<=e[1]&&e[3]<=t[3]}function containsXY(t,e,r){return t[0]<=e&&e<=t[2]&&t[1]<=r&&r<=t[3]}function coordinateRelationship(t,e){var r=t[0],n=t[1],o=t[2],a=t[3],i=e[0],s=e[1],u=_Relationship.default.UNKNOWN;return i<r?u|=_Relationship.default.LEFT:i>o&&(u|=_Relationship.default.RIGHT),s<n?u|=_Relationship.default.BELOW:s>a&&(u|=_Relationship.default.ABOVE),u===_Relationship.default.UNKNOWN&&(u=_Relationship.default.INTERSECTING),u}function createEmpty(){return[1/0,1/0,-1/0,-1/0]}function createOrUpdate(t,e,r,n,o){return o?(o[0]=t,o[1]=e,o[2]=r,o[3]=n,o):[t,e,r,n]}function createOrUpdateEmpty(t){return createOrUpdate(1/0,1/0,-1/0,-1/0,t)}function createOrUpdateFromCoordinate(t,e){var r=t[0],n=t[1];return createOrUpdate(r,n,r,n,e)}function createOrUpdateFromCoordinates(t,e){return extendCoordinates(createOrUpdateEmpty(e),t)}function createOrUpdateFromFlatCoordinates(t,e,r,n,o){return extendFlatCoordinates(createOrUpdateEmpty(o),t,e,r,n)}function createOrUpdateFromRings(t,e){return extendRings(createOrUpdateEmpty(e),t)}function equals(t,e){return t[0]==e[0]&&t[2]==e[2]&&t[1]==e[1]&&t[3]==e[3]}function approximatelyEquals(t,e,r){return Math.abs(t[0]-e[0])<r&&Math.abs(t[2]-e[2])<r&&Math.abs(t[1]-e[1])<r&&Math.abs(t[3]-e[3])<r}function extend(t,e){return e[0]<t[0]&&(t[0]=e[0]),e[2]>t[2]&&(t[2]=e[2]),e[1]<t[1]&&(t[1]=e[1]),e[3]>t[3]&&(t[3]=e[3]),t}function extendCoordinate(t,e){e[0]<t[0]&&(t[0]=e[0]),e[0]>t[2]&&(t[2]=e[0]),e[1]<t[1]&&(t[1]=e[1]),e[1]>t[3]&&(t[3]=e[1])}function extendCoordinates(t,e){for(var r=0,n=e.length;r<n;++r)extendCoordinate(t,e[r]);return t}function extendFlatCoordinates(t,e,r,n,o){for(;r<n;r+=o)extendXY(t,e[r],e[r+1]);return t}function extendRings(t,e){for(var r=0,n=e.length;r<n;++r)extendCoordinates(t,e[r]);return t}function extendXY(t,e,r){t[0]=Math.min(t[0],e),t[1]=Math.min(t[1],r),t[2]=Math.max(t[2],e),t[3]=Math.max(t[3],r)}function forEachCorner(t,e){var r;return(r=e(getBottomLeft(t)))?r:(r=e(getBottomRight(t)))?r:(r=e(getTopRight(t)))?r:(r=e(getTopLeft(t)))||!1}function getArea(t){var e=0;return isEmpty(t)||(e=getWidth(t)*getHeight(t)),e}function getBottomLeft(t){return[t[0],t[1]]}function getBottomRight(t){return[t[2],t[1]]}function getCenter(t){return[(t[0]+t[2])/2,(t[1]+t[3])/2]}function getCorner(t,e){var r;if("bottom-left"===e)r=getBottomLeft(t);else if("bottom-right"===e)r=getBottomRight(t);else if("top-left"===e)r=getTopLeft(t);else{if("top-right"!==e)throw new Error("Invalid corner");r=getTopRight(t)}return r}function getEnlargedArea(t,e){var r=Math.min(t[0],e[0]),n=Math.min(t[1],e[1]);return(Math.max(t[2],e[2])-r)*(Math.max(t[3],e[3])-n)}function getForViewAndSize(t,e,r,n,o){var a=_slicedToArray(getRotatedViewport(t,e,r,n),8),i=a[0],s=a[1],u=a[2],p=a[3],c=a[4],d=a[5],l=a[6],f=a[7];return createOrUpdate(Math.min(i,u,c,l),Math.min(s,p,d,f),Math.max(i,u,c,l),Math.max(s,p,d,f),o)}function getRotatedViewport(t,e,r,n){var o=e*n[0]/2,a=e*n[1]/2,i=Math.cos(r),s=Math.sin(r),u=o*i,p=o*s,c=a*i,d=a*s,l=t[0],f=t[1];return[l-u+d,f-p-c,l-u-d,f-p+c,l+u-d,f+p+c,l+u+d,f+p-c,l-u+d,f-p-c]}function getHeight(t){return t[3]-t[1]}function getIntersectionArea(t,e){return getArea(getIntersection(t,e))}function getIntersection(t,e,r){var n=r||createEmpty();return intersects(t,e)?(t[0]>e[0]?n[0]=t[0]:n[0]=e[0],t[1]>e[1]?n[1]=t[1]:n[1]=e[1],t[2]<e[2]?n[2]=t[2]:n[2]=e[2],t[3]<e[3]?n[3]=t[3]:n[3]=e[3]):createOrUpdateEmpty(n),n}function getMargin(t){return getWidth(t)+getHeight(t)}function getSize(t){return[t[2]-t[0],t[3]-t[1]]}function getTopLeft(t){return[t[0],t[3]]}function getTopRight(t){return[t[2],t[3]]}function getWidth(t){return t[2]-t[0]}function intersects(t,e){return t[0]<=e[2]&&t[2]>=e[0]&&t[1]<=e[3]&&t[3]>=e[1]}function isEmpty(t){return t[2]<t[0]||t[3]<t[1]}function returnOrUpdate(t,e){return e?(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e):t}function scaleFromCenter(t,e){var r=(t[2]-t[0])/2*(e-1),n=(t[3]-t[1])/2*(e-1);t[0]-=r,t[2]+=r,t[1]-=n,t[3]+=n}function intersectsSegment(t,e,r){var n=!1,o=coordinateRelationship(t,e),a=coordinateRelationship(t,r);if(o===_Relationship.default.INTERSECTING||a===_Relationship.default.INTERSECTING)n=!0;else{var i,s,u=t[0],p=t[1],c=t[2],d=t[3],l=e[0],f=e[1],g=r[0],x=r[1],h=(x-f)/(g-l);a&_Relationship.default.ABOVE&&!(o&_Relationship.default.ABOVE)&&(n=(i=g-(x-d)/h)>=u&&i<=c),n||!(a&_Relationship.default.RIGHT)||o&_Relationship.default.RIGHT||(n=(s=x-(g-c)*h)>=p&&s<=d),n||!(a&_Relationship.default.BELOW)||o&_Relationship.default.BELOW||(n=(i=g-(x-p)/h)>=u&&i<=c),n||!(a&_Relationship.default.LEFT)||o&_Relationship.default.LEFT||(n=(s=x-(g-u)*h)>=p&&s<=d)}return n}function applyTransform(t,e,r,n){if(isEmpty(t))return createOrUpdateEmpty(r);var o=[];if(n>1)for(var a=t[2]-t[0],i=t[3]-t[1],s=0;s<n;++s)o.push(t[0]+a*s/n,t[1],t[2],t[1]+i*s/n,t[2]-a*s/n,t[3],t[0],t[3]-i*s/n);else o=[t[0],t[1],t[2],t[1],t[2],t[3],t[0],t[3]];e(o,o,2);for(var u=[],p=[],c=0,d=o.length;c<d;c+=2)u.push(o[c]),p.push(o[c+1]);return _boundingExtentXYs(u,p,r)}function wrapX(t,e){var r=e.getExtent(),n=getCenter(t);if(e.canWrapX()&&(n[0]<r[0]||n[0]>=r[2])){var o=getWidth(r),a=Math.floor((n[0]-r[0])/o)*o;t[0]-=a,t[2]-=a}return t}function wrapAndSliceX(t,e,r){if(e.canWrapX()){var n=e.getExtent();if(!isFinite(t[0])||!isFinite(t[2]))return[[n[0],t[1],n[2],t[3]]];wrapX(t,e);var o=getWidth(n);if(getWidth(t)>o&&!r)return[[n[0],t[1],n[2],t[3]]];if(t[0]<n[0])return[[t[0]+o,t[1],n[2],t[3]],[n[0],t[1],t[2],t[3]]];if(t[2]>n[2])return[[t[0],t[1],n[2],t[3]],[n[0],t[1],t[2]-o,t[3]]]}return[t]}

},{"./extent/Relationship.js":60}],60:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _default=exports.default={UNKNOWN:0,INTERSECTING:1,ABOVE:2,RIGHT:4,BELOW:8,LEFT:16};

},{}],61:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.loadFeaturesXhr=loadFeaturesXhr,exports.setWithCredentials=setWithCredentials,exports.xhr=xhr;var _functions=require("./functions.js"),withCredentials=!1;function loadFeaturesXhr(e,t,r,s,n,a,o){var i=new XMLHttpRequest;i.open("GET","function"==typeof e?e(r,s,n):e,!0),"arraybuffer"==t.getType()&&(i.responseType="arraybuffer"),i.withCredentials=withCredentials,i.onload=function(e){if(!i.status||i.status>=200&&i.status<300){var s=t.getType();try{var u;"text"==s||"json"==s?u=i.responseText:"xml"==s?u=i.responseXML||i.responseText:"arraybuffer"==s&&(u=i.response),u?a(t.readFeatures(u,{extent:r,featureProjection:n}),t.readProjection(u)):o()}catch(e){o()}}else o()},i.onerror=o,i.send()}function xhr(e,t){return function(r,s,n,a,o){var i=this;loadFeaturesXhr(e,t,r,s,n,function(e,t){i.addFeatures(e),void 0!==a&&a(e)},o||_functions.VOID)}}function setWithCredentials(e){withCredentials=e}

},{"./functions.js":62}],62:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.FALSE=FALSE,exports.TRUE=TRUE,exports.VOID=VOID,exports.memoizeOne=memoizeOne,exports.toPromise=toPromise;var _array=require("./array.js");function TRUE(){return!0}function FALSE(){return!1}function VOID(){}function memoizeOne(r){var e,t,o;return function(){var n=Array.prototype.slice.call(arguments);return t&&this===o&&(0,_array.equals)(n,t)||(o=this,t=n,e=r.apply(this,arguments)),e}}function toPromise(r){return function(){var e;try{e=r()}catch(r){return Promise.reject(r)}return e instanceof Promise?e:Promise.resolve(e)}()}

},{"./array.js":36}],63:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),Object.defineProperty(exports,"Circle",{enumerable:!0,get:function(){return _Circle.default}}),Object.defineProperty(exports,"Geometry",{enumerable:!0,get:function(){return _Geometry.default}}),Object.defineProperty(exports,"GeometryCollection",{enumerable:!0,get:function(){return _GeometryCollection.default}}),Object.defineProperty(exports,"LineString",{enumerable:!0,get:function(){return _LineString.default}}),Object.defineProperty(exports,"LinearRing",{enumerable:!0,get:function(){return _LinearRing.default}}),Object.defineProperty(exports,"MultiLineString",{enumerable:!0,get:function(){return _MultiLineString.default}}),Object.defineProperty(exports,"MultiPoint",{enumerable:!0,get:function(){return _MultiPoint.default}}),Object.defineProperty(exports,"MultiPolygon",{enumerable:!0,get:function(){return _MultiPolygon.default}}),Object.defineProperty(exports,"Point",{enumerable:!0,get:function(){return _Point.default}}),Object.defineProperty(exports,"Polygon",{enumerable:!0,get:function(){return _Polygon.default}}),Object.defineProperty(exports,"SimpleGeometry",{enumerable:!0,get:function(){return _SimpleGeometry.default}});var _Circle=_interopRequireDefault(require("./geom/Circle.js")),_Geometry=_interopRequireDefault(require("./geom/Geometry.js")),_GeometryCollection=_interopRequireDefault(require("./geom/GeometryCollection.js")),_LinearRing=_interopRequireDefault(require("./geom/LinearRing.js")),_LineString=_interopRequireDefault(require("./geom/LineString.js")),_MultiLineString=_interopRequireDefault(require("./geom/MultiLineString.js")),_MultiPoint=_interopRequireDefault(require("./geom/MultiPoint.js")),_MultiPolygon=_interopRequireDefault(require("./geom/MultiPolygon.js")),_Point=_interopRequireDefault(require("./geom/Point.js")),_Polygon=_interopRequireDefault(require("./geom/Polygon.js")),_SimpleGeometry=_interopRequireDefault(require("./geom/SimpleGeometry.js"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}

},{"./geom/Circle.js":64,"./geom/Geometry.js":65,"./geom/GeometryCollection.js":66,"./geom/LineString.js":67,"./geom/LinearRing.js":68,"./geom/MultiLineString.js":69,"./geom/MultiPoint.js":70,"./geom/MultiPolygon.js":71,"./geom/Point.js":72,"./geom/Polygon.js":73,"./geom/SimpleGeometry.js":74}],64:[function(require,module,exports){
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _SimpleGeometry2=_interopRequireDefault(require("./SimpleGeometry.js")),_extent=require("../extent.js"),_deflate=require("./flat/deflate.js"),_transform=require("./flat/transform.js");function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,_toPropertyKey(o.key),o)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var o=r.call(t,e||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _callSuper(t,e,r){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,r||[],_getPrototypeOf(t).constructor):e.apply(t,r))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var Circle=function(t){function e(t,r,o){var i;return _classCallCheck(this,e),i=_callSuper(this,e),void 0!==o&&void 0===r?i.setFlatCoordinates(o,t):(r=r||0,i.setCenterAndRadius(t,r,o)),i}return _inherits(e,_SimpleGeometry2["default"]),_createClass(e,[{key:"clone",value:function(){var t=new e(this.flatCoordinates.slice(),void 0,this.layout);return t.applyProperties(this),t}},{key:"closestPointXY",value:function(t,e,r,o){var i=this.flatCoordinates,n=t-i[0],s=e-i[1],a=n*n+s*s;if(a<o){if(0===a)for(var u=0;u<this.stride;++u)r[u]=i[u];else{var f=this.getRadius()/Math.sqrt(a);r[0]=i[0]+f*n,r[1]=i[1]+f*s;for(var l=2;l<this.stride;++l)r[l]=i[l]}return r.length=this.stride,a}return o}},{key:"containsXY",value:function(t,e){var r=this.flatCoordinates,o=t-r[0],i=e-r[1];return o*o+i*i<=this.getRadiusSquared_()}},{key:"getCenter",value:function(){return this.flatCoordinates.slice(0,this.stride)}},{key:"computeExtent",value:function(t){var e=this.flatCoordinates,r=e[this.stride]-e[0];return(0,_extent.createOrUpdate)(e[0]-r,e[1]-r,e[0]+r,e[1]+r,t)}},{key:"getRadius",value:function(){return Math.sqrt(this.getRadiusSquared_())}},{key:"getRadiusSquared_",value:function(){var t=this.flatCoordinates[this.stride]-this.flatCoordinates[0],e=this.flatCoordinates[this.stride+1]-this.flatCoordinates[1];return t*t+e*e}},{key:"getType",value:function(){return"Circle"}},{key:"intersectsExtent",value:function(t){var e=this.getExtent();if((0,_extent.intersects)(t,e)){var r=this.getCenter();return t[0]<=r[0]&&t[2]>=r[0]||(t[1]<=r[1]&&t[3]>=r[1]||(0,_extent.forEachCorner)(t,this.intersectsCoordinate.bind(this)))}return!1}},{key:"setCenter",value:function(t){var e=this.stride,r=this.flatCoordinates[e]-this.flatCoordinates[0],o=t.slice();o[e]=o[0]+r;for(var i=1;i<e;++i)o[e+i]=t[i];this.setFlatCoordinates(this.layout,o),this.changed()}},{key:"setCenterAndRadius",value:function(t,e,r){this.setLayout(r,t,0),this.flatCoordinates||(this.flatCoordinates=[]);var o=this.flatCoordinates,i=(0,_deflate.deflateCoordinate)(o,0,t,this.stride);o[i++]=o[0]+e;for(var n=1,s=this.stride;n<s;++n)o[i++]=o[n];o.length=i,this.changed()}},{key:"getCoordinates",value:function(){return null}},{key:"setCoordinates",value:function(t,e){}},{key:"setRadius",value:function(t){this.flatCoordinates[this.stride]=this.flatCoordinates[0]+t,this.changed()}},{key:"rotate",value:function(t,e){var r=this.getCenter(),o=this.getStride();this.setCenter((0,_transform.rotate)(r,0,r.length,o,t,e,r)),this.changed()}}])}();Circle.prototype.transform;var _default=exports.default=Circle;

},{"../extent.js":59,"./SimpleGeometry.js":74,"./flat/deflate.js":79,"./flat/transform.js":92}],65:[function(require,module,exports){
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _Object=_interopRequireDefault(require("../Object.js")),_util=require("../util.js"),_transform=require("../transform.js"),_extent2=require("../extent.js"),_proj=require("../proj.js"),_functions=require("../functions.js"),_transform2=require("./flat/transform.js");function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,_toPropertyKey(n.key),n)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _callSuper(t,e,r){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,r||[],_getPrototypeOf(t).constructor):e.apply(t,r))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var tmpTransform=(0,_transform.create)(),Geometry=function(t){function e(){var t;return _classCallCheck(this,e),(t=_callSuper(this,e)).extent_=(0,_extent2.createEmpty)(),t.extentRevision_=-1,t.simplifiedGeometryMaxMinSquaredTolerance=0,t.simplifiedGeometryRevision=0,t.simplifyTransformedInternal=(0,_functions.memoizeOne)(function(e,r,n){if(!n)return t.getSimplifiedGeometry(r);var o=t.clone();return o.applyTransform(n),o.getSimplifiedGeometry(r)}),t}return _inherits(e,_Object["default"]),_createClass(e,[{key:"simplifyTransformed",value:function(t,e){return this.simplifyTransformedInternal(this.getRevision(),t,e)}},{key:"clone",value:function(){return(0,_util.abstract)()}},{key:"closestPointXY",value:function(t,e,r,n){return(0,_util.abstract)()}},{key:"containsXY",value:function(t,e){var r=this.getClosestPoint([t,e]);return r[0]===t&&r[1]===e}},{key:"getClosestPoint",value:function(t,e){return e=e||[NaN,NaN],this.closestPointXY(t[0],t[1],e,1/0),e}},{key:"intersectsCoordinate",value:function(t){return this.containsXY(t[0],t[1])}},{key:"computeExtent",value:function(t){return(0,_util.abstract)()}},{key:"getExtent",value:function(t){if(this.extentRevision_!=this.getRevision()){var e=this.computeExtent(this.extent_);(isNaN(e[0])||isNaN(e[1]))&&(0,_extent2.createOrUpdateEmpty)(e),this.extentRevision_=this.getRevision()}return(0,_extent2.returnOrUpdate)(this.extent_,t)}},{key:"rotate",value:function(t,e){(0,_util.abstract)()}},{key:"scale",value:function(t,e,r){(0,_util.abstract)()}},{key:"simplify",value:function(t){return this.getSimplifiedGeometry(t*t)}},{key:"getSimplifiedGeometry",value:function(t){return(0,_util.abstract)()}},{key:"getType",value:function(){return(0,_util.abstract)()}},{key:"applyTransform",value:function(t){(0,_util.abstract)()}},{key:"intersectsExtent",value:function(t){return(0,_util.abstract)()}},{key:"translate",value:function(t,e){(0,_util.abstract)()}},{key:"transform",value:function(t,e){var r=(0,_proj.get)(t),n="tile-pixels"==r.getUnits()?function(t,n,o){var i=r.getExtent(),u=r.getWorldExtent(),s=(0,_extent2.getHeight)(u)/(0,_extent2.getHeight)(i);return(0,_transform.compose)(tmpTransform,u[0],u[3],s,-s,0,0,0),(0,_transform2.transform2D)(t,0,t.length,o,tmpTransform,n),(0,_proj.getTransform)(r,e)(t,n,o)}:(0,_proj.getTransform)(r,e);return this.applyTransform(n),this}}])}(),_default=exports.default=Geometry;

},{"../Object.js":25,"../extent.js":59,"../functions.js":62,"../proj.js":123,"../transform.js":203,"../util.js":205,"./flat/transform.js":92}],66:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _EventType=_interopRequireDefault(require("../events/EventType.js")),_Geometry2=_interopRequireDefault(require("./Geometry.js")),_extent=require("../extent.js"),_events=require("../events.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey(n.key),n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _superPropGet(e,t,r,n){var o=_get(_getPrototypeOf(1&n?e.prototype:e),t,r);return 2&n?function(e){return o.apply(r,e)}:o}function _get(){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=_superPropBase(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}}).apply(null,arguments)}function _superPropBase(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf(e)););return e}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var GeometryCollection=function(e){function t(e){var r;return _classCallCheck(this,t),(r=_callSuper(this,t)).geometries_=e,r.changeEventsKeys_=[],r.listenGeometriesChange_(),r}return _inherits(t,_Geometry2["default"]),_createClass(t,[{key:"unlistenGeometriesChange_",value:function(){this.changeEventsKeys_.forEach(_events.unlistenByKey),this.changeEventsKeys_.length=0}},{key:"listenGeometriesChange_",value:function(){for(var e=this.geometries_,t=0,r=e.length;t<r;++t)this.changeEventsKeys_.push((0,_events.listen)(e[t],_EventType.default.CHANGE,this.changed,this))}},{key:"clone",value:function(){var e=new t(cloneGeometries(this.geometries_));return e.applyProperties(this),e}},{key:"closestPointXY",value:function(e,t,r,n){if(n<(0,_extent.closestSquaredDistanceXY)(this.getExtent(),e,t))return n;for(var o=this.geometries_,i=0,s=o.length;i<s;++i)n=o[i].closestPointXY(e,t,r,n);return n}},{key:"containsXY",value:function(e,t){for(var r=this.geometries_,n=0,o=r.length;n<o;++n)if(r[n].containsXY(e,t))return!0;return!1}},{key:"computeExtent",value:function(e){(0,_extent.createOrUpdateEmpty)(e);for(var t=this.geometries_,r=0,n=t.length;r<n;++r)(0,_extent.extend)(e,t[r].getExtent());return e}},{key:"getGeometries",value:function(){return cloneGeometries(this.geometries_)}},{key:"getGeometriesArray",value:function(){return this.geometries_}},{key:"getGeometriesArrayRecursive",value:function(){for(var e=[],t=this.geometries_,r=0,n=t.length;r<n;++r)t[r].getType()===this.getType()?e=e.concat(t[r].getGeometriesArrayRecursive()):e.push(t[r]);return e}},{key:"getSimplifiedGeometry",value:function(e){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),e<0||0!==this.simplifiedGeometryMaxMinSquaredTolerance&&e<this.simplifiedGeometryMaxMinSquaredTolerance)return this;for(var r=[],n=this.geometries_,o=!1,i=0,s=n.length;i<s;++i){var u=n[i],a=u.getSimplifiedGeometry(e);r.push(a),a!==u&&(o=!0)}return o?new t(r):(this.simplifiedGeometryMaxMinSquaredTolerance=e,this)}},{key:"getType",value:function(){return"GeometryCollection"}},{key:"intersectsExtent",value:function(e){for(var t=this.geometries_,r=0,n=t.length;r<n;++r)if(t[r].intersectsExtent(e))return!0;return!1}},{key:"isEmpty",value:function(){return 0===this.geometries_.length}},{key:"rotate",value:function(e,t){for(var r=this.geometries_,n=0,o=r.length;n<o;++n)r[n].rotate(e,t);this.changed()}},{key:"scale",value:function(e,t,r){r||(r=(0,_extent.getCenter)(this.getExtent()));for(var n=this.geometries_,o=0,i=n.length;o<i;++o)n[o].scale(e,t,r);this.changed()}},{key:"setGeometries",value:function(e){this.setGeometriesArray(cloneGeometries(e))}},{key:"setGeometriesArray",value:function(e){this.unlistenGeometriesChange_(),this.geometries_=e,this.listenGeometriesChange_(),this.changed()}},{key:"applyTransform",value:function(e){for(var t=this.geometries_,r=0,n=t.length;r<n;++r)t[r].applyTransform(e);this.changed()}},{key:"translate",value:function(e,t){for(var r=this.geometries_,n=0,o=r.length;n<o;++n)r[n].translate(e,t);this.changed()}},{key:"disposeInternal",value:function(){this.unlistenGeometriesChange_(),_superPropGet(t,"disposeInternal",this,3)([])}}])}();function cloneGeometries(e){return e.map(function(e){return e.clone()})}var _default=exports.default=GeometryCollection;

},{"../events.js":51,"../events/EventType.js":53,"../extent.js":59,"./Geometry.js":65}],67:[function(require,module,exports){
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _SimpleGeometry2=_interopRequireDefault(require("./SimpleGeometry.js")),_closest=require("./flat/closest.js"),_extent=require("../extent.js"),_deflate=require("./flat/deflate.js"),_simplify=require("./flat/simplify.js"),_array=require("../array.js"),_segments=require("./flat/segments.js"),_inflate=require("./flat/inflate.js"),_interpolate=require("./flat/interpolate.js"),_intersectsextent=require("./flat/intersectsextent.js"),_length=require("./flat/length.js");function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,_toPropertyKey(r.key),r)}}function _createClass(t,e,i){return e&&_defineProperties(t.prototype,e),i&&_defineProperties(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=_typeof(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _callSuper(t,e,i){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,i||[],_getPrototypeOf(t).constructor):e.apply(t,i))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var LineString=function(t){function e(t,i){var r;return _classCallCheck(this,e),(r=_callSuper(this,e)).flatMidpoint_=null,r.flatMidpointRevision_=-1,r.maxDelta_=-1,r.maxDeltaRevision_=-1,void 0===i||Array.isArray(t[0])?r.setCoordinates(t,i):r.setFlatCoordinates(i,t),r}return _inherits(e,_SimpleGeometry2["default"]),_createClass(e,[{key:"appendCoordinate",value:function(t){(0,_array.extend)(this.flatCoordinates,t),this.changed()}},{key:"clone",value:function(){var t=new e(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t}},{key:"closestPointXY",value:function(t,e,i,r){return r<(0,_extent.closestSquaredDistanceXY)(this.getExtent(),t,e)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt((0,_closest.maxSquaredDelta)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),(0,_closest.assignClosestPoint)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!1,t,e,i,r))}},{key:"forEachSegment",value:function(t){return(0,_segments.forEach)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)}},{key:"getCoordinateAtM",value:function(t,e){return"XYM"!=this.layout&&"XYZM"!=this.layout?null:(e=void 0!==e&&e,(0,_interpolate.lineStringCoordinateAtM)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e))}},{key:"getCoordinates",value:function(){return(0,_inflate.inflateCoordinates)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}},{key:"getCoordinateAt",value:function(t,e){return(0,_interpolate.interpolatePoint)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e,this.stride)}},{key:"getLength",value:function(){return(0,_length.lineStringLength)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}},{key:"getFlatMidpoint",value:function(){var t;this.flatMidpointRevision_!=this.getRevision()&&(this.flatMidpoint_=this.getCoordinateAt(.5,null!==(t=this.flatMidpoint_)&&void 0!==t?t:void 0),this.flatMidpointRevision_=this.getRevision());return this.flatMidpoint_}},{key:"getSimplifiedGeometryInternal",value:function(t){var i=[];return i.length=(0,_simplify.douglasPeucker)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,i,0),new e(i,"XY")}},{key:"getType",value:function(){return"LineString"}},{key:"intersectsExtent",value:function(t){return(0,_intersectsextent.intersectsLineString)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)}},{key:"setCoordinates",value:function(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=(0,_deflate.deflateCoordinates)(this.flatCoordinates,0,t,this.stride),this.changed()}}])}(),_default=exports.default=LineString;

},{"../array.js":36,"../extent.js":59,"./SimpleGeometry.js":74,"./flat/closest.js":77,"./flat/deflate.js":79,"./flat/inflate.js":80,"./flat/interpolate.js":82,"./flat/intersectsextent.js":83,"./flat/length.js":84,"./flat/segments.js":88,"./flat/simplify.js":89}],68:[function(require,module,exports){
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _SimpleGeometry2=_interopRequireDefault(require("./SimpleGeometry.js")),_closest=require("./flat/closest.js"),_extent=require("../extent.js"),_deflate=require("./flat/deflate.js"),_simplify=require("./flat/simplify.js"),_inflate=require("./flat/inflate.js"),_area=require("./flat/area.js");function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,_toPropertyKey(o.key),o)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var o=r.call(t,e||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _callSuper(t,e,r){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,r||[],_getPrototypeOf(t).constructor):e.apply(t,r))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var LinearRing=function(t){function e(t,r){var o;return _classCallCheck(this,e),(o=_callSuper(this,e)).maxDelta_=-1,o.maxDeltaRevision_=-1,void 0===r||Array.isArray(t[0])?o.setCoordinates(t,r):o.setFlatCoordinates(r,t),o}return _inherits(e,_SimpleGeometry2["default"]),_createClass(e,[{key:"clone",value:function(){return new e(this.flatCoordinates.slice(),this.layout)}},{key:"closestPointXY",value:function(t,e,r,o){return o<(0,_extent.closestSquaredDistanceXY)(this.getExtent(),t,e)?o:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt((0,_closest.maxSquaredDelta)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),(0,_closest.assignClosestPoint)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,t,e,r,o))}},{key:"getArea",value:function(){return(0,_area.linearRing)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}},{key:"getCoordinates",value:function(){return(0,_inflate.inflateCoordinates)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}},{key:"getSimplifiedGeometryInternal",value:function(t){var r=[];return r.length=(0,_simplify.douglasPeucker)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,r,0),new e(r,"XY")}},{key:"getType",value:function(){return"LinearRing"}},{key:"intersectsExtent",value:function(t){return!1}},{key:"setCoordinates",value:function(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=(0,_deflate.deflateCoordinates)(this.flatCoordinates,0,t,this.stride),this.changed()}}])}(),_default=exports.default=LinearRing;

},{"../extent.js":59,"./SimpleGeometry.js":74,"./flat/area.js":75,"./flat/closest.js":77,"./flat/deflate.js":79,"./flat/inflate.js":80,"./flat/simplify.js":89}],69:[function(require,module,exports){
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _LineString=_interopRequireDefault(require("./LineString.js")),_SimpleGeometry2=_interopRequireDefault(require("./SimpleGeometry.js")),_closest=require("./flat/closest.js"),_extent=require("../extent.js"),_deflate=require("./flat/deflate.js"),_simplify=require("./flat/simplify.js"),_array=require("../array.js"),_inflate=require("./flat/inflate.js"),_interpolate=require("./flat/interpolate.js"),_intersectsextent=require("./flat/intersectsextent.js");function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,_toPropertyKey(i.key),i)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!=_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _callSuper(t,e,r){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,r||[],_getPrototypeOf(t).constructor):e.apply(t,r))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var MultiLineString=function(t){function e(t,r,i){var n;if(_classCallCheck(this,e),(n=_callSuper(this,e)).ends_=[],n.maxDelta_=-1,n.maxDeltaRevision_=-1,Array.isArray(t[0]))n.setCoordinates(t,r);else if(void 0!==r&&i)n.setFlatCoordinates(r,t),n.ends_=i;else{for(var o=t,s=[],a=[],l=0,u=o.length;l<u;++l){var f=o[l];(0,_array.extend)(s,f.getFlatCoordinates()),a.push(s.length)}var c=0===o.length?n.getLayout():o[0].getLayout();n.setFlatCoordinates(c,s),n.ends_=a}return n}return _inherits(e,_SimpleGeometry2["default"]),_createClass(e,[{key:"appendLineString",value:function(t){(0,_array.extend)(this.flatCoordinates,t.getFlatCoordinates().slice()),this.ends_.push(this.flatCoordinates.length),this.changed()}},{key:"clone",value:function(){var t=new e(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return t.applyProperties(this),t}},{key:"closestPointXY",value:function(t,e,r,i){return i<(0,_extent.closestSquaredDistanceXY)(this.getExtent(),t,e)?i:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt((0,_closest.arrayMaxSquaredDelta)(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),(0,_closest.assignClosestArrayPoint)(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!1,t,e,r,i))}},{key:"getCoordinateAtM",value:function(t,e,r){return"XYM"!=this.layout&&"XYZM"!=this.layout||0===this.flatCoordinates.length?null:(e=void 0!==e&&e,r=void 0!==r&&r,(0,_interpolate.lineStringsCoordinateAtM)(this.flatCoordinates,0,this.ends_,this.stride,t,e,r))}},{key:"getCoordinates",value:function(){return(0,_inflate.inflateCoordinatesArray)(this.flatCoordinates,0,this.ends_,this.stride)}},{key:"getEnds",value:function(){return this.ends_}},{key:"getLineString",value:function(t){return t<0||this.ends_.length<=t?null:new _LineString.default(this.flatCoordinates.slice(0===t?0:this.ends_[t-1],this.ends_[t]),this.layout)}},{key:"getLineStrings",value:function(){for(var t=this.flatCoordinates,e=this.ends_,r=this.layout,i=[],n=0,o=0,s=e.length;o<s;++o){var a=e[o],l=new _LineString.default(t.slice(n,a),r);i.push(l),n=a}return i}},{key:"getFlatMidpoints",value:function(){for(var t=[],e=this.flatCoordinates,r=0,i=this.ends_,n=this.stride,o=0,s=i.length;o<s;++o){var a=i[o],l=(0,_interpolate.interpolatePoint)(e,r,a,n,.5);(0,_array.extend)(t,l),r=a}return t}},{key:"getSimplifiedGeometryInternal",value:function(t){var r=[],i=[];return r.length=(0,_simplify.douglasPeuckerArray)(this.flatCoordinates,0,this.ends_,this.stride,t,r,0,i),new e(r,"XY",i)}},{key:"getType",value:function(){return"MultiLineString"}},{key:"intersectsExtent",value:function(t){return(0,_intersectsextent.intersectsLineStringArray)(this.flatCoordinates,0,this.ends_,this.stride,t)}},{key:"setCoordinates",value:function(t,e){this.setLayout(e,t,2),this.flatCoordinates||(this.flatCoordinates=[]);var r=(0,_deflate.deflateCoordinatesArray)(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=0===r.length?0:r[r.length-1],this.changed()}}])}(),_default=exports.default=MultiLineString;

},{"../array.js":36,"../extent.js":59,"./LineString.js":67,"./SimpleGeometry.js":74,"./flat/closest.js":77,"./flat/deflate.js":79,"./flat/inflate.js":80,"./flat/interpolate.js":82,"./flat/intersectsextent.js":83,"./flat/simplify.js":89}],70:[function(require,module,exports){
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _Point=_interopRequireDefault(require("./Point.js")),_SimpleGeometry2=_interopRequireDefault(require("./SimpleGeometry.js")),_extent=require("../extent.js"),_deflate=require("./flat/deflate.js"),_array=require("../array.js"),_inflate=require("./flat/inflate.js"),_math=require("../math.js");function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,_toPropertyKey(o.key),o)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var o=r.call(t,e||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _callSuper(t,e,r){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,r||[],_getPrototypeOf(t).constructor):e.apply(t,r))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var MultiPoint=function(t){function e(t,r){var o;return _classCallCheck(this,e),o=_callSuper(this,e),r&&!Array.isArray(t[0])?o.setFlatCoordinates(r,t):o.setCoordinates(t,r),o}return _inherits(e,_SimpleGeometry2["default"]),_createClass(e,[{key:"appendPoint",value:function(t){(0,_array.extend)(this.flatCoordinates,t.getFlatCoordinates()),this.changed()}},{key:"clone",value:function(){var t=new e(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t}},{key:"closestPointXY",value:function(t,e,r,o){if(o<(0,_extent.closestSquaredDistanceXY)(this.getExtent(),t,e))return o;for(var n=this.flatCoordinates,i=this.stride,a=0,s=n.length;a<s;a+=i){var u=(0,_math.squaredDistance)(t,e,n[a],n[a+1]);if(u<o){o=u;for(var l=0;l<i;++l)r[l]=n[a+l];r.length=i}}return o}},{key:"getCoordinates",value:function(){return(0,_inflate.inflateCoordinates)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}},{key:"getPoint",value:function(t){var e=this.flatCoordinates.length/this.stride;return t<0||e<=t?null:new _Point.default(this.flatCoordinates.slice(t*this.stride,(t+1)*this.stride),this.layout)}},{key:"getPoints",value:function(){for(var t=this.flatCoordinates,e=this.layout,r=this.stride,o=[],n=0,i=t.length;n<i;n+=r){var a=new _Point.default(t.slice(n,n+r),e);o.push(a)}return o}},{key:"getType",value:function(){return"MultiPoint"}},{key:"intersectsExtent",value:function(t){for(var e=this.flatCoordinates,r=this.stride,o=0,n=e.length;o<n;o+=r){var i=e[o],a=e[o+1];if((0,_extent.containsXY)(t,i,a))return!0}return!1}},{key:"setCoordinates",value:function(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=(0,_deflate.deflateCoordinates)(this.flatCoordinates,0,t,this.stride),this.changed()}}])}(),_default=exports.default=MultiPoint;

},{"../array.js":36,"../extent.js":59,"../math.js":120,"./Point.js":72,"./SimpleGeometry.js":74,"./flat/deflate.js":79,"./flat/inflate.js":80}],71:[function(require,module,exports){
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _MultiPoint=_interopRequireDefault(require("./MultiPoint.js")),_Polygon=_interopRequireDefault(require("./Polygon.js")),_SimpleGeometry2=_interopRequireDefault(require("./SimpleGeometry.js")),_closest=require("./flat/closest.js"),_extent=require("../extent.js"),_deflate=require("./flat/deflate.js"),_array=require("../array.js"),_interiorpoint=require("./flat/interiorpoint.js"),_inflate=require("./flat/inflate.js"),_intersectsextent=require("./flat/intersectsextent.js"),_orient=require("./flat/orient.js"),_area=require("./flat/area.js"),_center=require("./flat/center.js"),_contains=require("./flat/contains.js"),_simplify=require("./flat/simplify.js");function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,_toPropertyKey(r.key),r)}}function _createClass(t,e,i){return e&&_defineProperties(t.prototype,e),i&&_defineProperties(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=_typeof(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _callSuper(t,e,i){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,i||[],_getPrototypeOf(t).constructor):e.apply(t,i))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var MultiPolygon=function(t){function e(t,i,r){var n;if(_classCallCheck(this,e),(n=_callSuper(this,e)).endss_=[],n.flatInteriorPointsRevision_=-1,n.flatInteriorPoints_=null,n.maxDelta_=-1,n.maxDeltaRevision_=-1,n.orientedRevision_=-1,n.orientedFlatCoordinates_=null,!r&&!Array.isArray(t[0])){for(var s=t,o=[],a=[],l=0,u=s.length;l<u;++l){for(var f=s[l],d=o.length,h=f.getEnds(),c=0,_=h.length;c<_;++c)h[c]+=d;(0,_array.extend)(o,f.getFlatCoordinates()),a.push(h)}i=0===s.length?n.getLayout():s[0].getLayout(),t=o,r=a}return void 0!==i&&r?(n.setFlatCoordinates(i,t),n.endss_=r):n.setCoordinates(t,i),n}return _inherits(e,_SimpleGeometry2["default"]),_createClass(e,[{key:"appendPolygon",value:function(t){var e;if(this.flatCoordinates){var i=this.flatCoordinates.length;(0,_array.extend)(this.flatCoordinates,t.getFlatCoordinates());for(var r=0,n=(e=t.getEnds().slice()).length;r<n;++r)e[r]+=i}else this.flatCoordinates=t.getFlatCoordinates().slice(),e=t.getEnds().slice(),this.endss_.push();this.endss_.push(e),this.changed()}},{key:"clone",value:function(){for(var t=this.endss_.length,i=new Array(t),r=0;r<t;++r)i[r]=this.endss_[r].slice();var n=new e(this.flatCoordinates.slice(),this.layout,i);return n.applyProperties(this),n}},{key:"closestPointXY",value:function(t,e,i,r){return r<(0,_extent.closestSquaredDistanceXY)(this.getExtent(),t,e)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt((0,_closest.multiArrayMaxSquaredDelta)(this.flatCoordinates,0,this.endss_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),(0,_closest.assignClosestMultiArrayPoint)(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,this.maxDelta_,!0,t,e,i,r))}},{key:"containsXY",value:function(t,e){return(0,_contains.linearRingssContainsXY)(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t,e)}},{key:"getArea",value:function(){return(0,_area.linearRingss)(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride)}},{key:"getCoordinates",value:function(t){var e;return void 0!==t?(e=this.getOrientedFlatCoordinates().slice(),(0,_orient.orientLinearRingsArray)(e,0,this.endss_,this.stride,t)):e=this.flatCoordinates,(0,_inflate.inflateMultiCoordinatesArray)(e,0,this.endss_,this.stride)}},{key:"getEndss",value:function(){return this.endss_}},{key:"getFlatInteriorPoints",value:function(){if(this.flatInteriorPointsRevision_!=this.getRevision()){var t=(0,_center.linearRingss)(this.flatCoordinates,0,this.endss_,this.stride);this.flatInteriorPoints_=(0,_interiorpoint.getInteriorPointsOfMultiArray)(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t),this.flatInteriorPointsRevision_=this.getRevision()}return this.flatInteriorPoints_}},{key:"getInteriorPoints",value:function(){return new _MultiPoint.default(this.getFlatInteriorPoints().slice(),"XYM")}},{key:"getOrientedFlatCoordinates",value:function(){if(this.orientedRevision_!=this.getRevision()){var t=this.flatCoordinates;(0,_orient.linearRingssAreOriented)(t,0,this.endss_,this.stride)?this.orientedFlatCoordinates_=t:(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=(0,_orient.orientLinearRingsArray)(this.orientedFlatCoordinates_,0,this.endss_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}},{key:"getSimplifiedGeometryInternal",value:function(t){var i=[],r=[];return i.length=(0,_simplify.quantizeMultiArray)(this.flatCoordinates,0,this.endss_,this.stride,Math.sqrt(t),i,0,r),new e(i,"XY",r)}},{key:"getPolygon",value:function(t){if(t<0||this.endss_.length<=t)return null;var e;if(0===t)e=0;else{var i=this.endss_[t-1];e=i[i.length-1]}var r=this.endss_[t].slice(),n=r[r.length-1];if(0!==e)for(var s=0,o=r.length;s<o;++s)r[s]-=e;return new _Polygon.default(this.flatCoordinates.slice(e,n),this.layout,r)}},{key:"getPolygons",value:function(){for(var t=this.layout,e=this.flatCoordinates,i=this.endss_,r=[],n=0,s=0,o=i.length;s<o;++s){var a=i[s].slice(),l=a[a.length-1];if(0!==n)for(var u=0,f=a.length;u<f;++u)a[u]-=n;var d=new _Polygon.default(e.slice(n,l),t,a);r.push(d),n=l}return r}},{key:"getType",value:function(){return"MultiPolygon"}},{key:"intersectsExtent",value:function(t){return(0,_intersectsextent.intersectsLinearRingMultiArray)(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t)}},{key:"setCoordinates",value:function(t,e){this.setLayout(e,t,3),this.flatCoordinates||(this.flatCoordinates=[]);var i=(0,_deflate.deflateMultiCoordinatesArray)(this.flatCoordinates,0,t,this.stride,this.endss_);if(0===i.length)this.flatCoordinates.length=0;else{var r=i[i.length-1];this.flatCoordinates.length=0===r.length?0:r[r.length-1]}this.changed()}}])}(),_default=exports.default=MultiPolygon;

},{"../array.js":36,"../extent.js":59,"./MultiPoint.js":70,"./Polygon.js":73,"./SimpleGeometry.js":74,"./flat/area.js":75,"./flat/center.js":76,"./flat/closest.js":77,"./flat/contains.js":78,"./flat/deflate.js":79,"./flat/inflate.js":80,"./flat/interiorpoint.js":81,"./flat/intersectsextent.js":83,"./flat/orient.js":86,"./flat/simplify.js":89}],72:[function(require,module,exports){
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _SimpleGeometry2=_interopRequireDefault(require("./SimpleGeometry.js")),_extent=require("../extent.js"),_deflate=require("./flat/deflate.js"),_math=require("../math.js");function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,_toPropertyKey(o.key),o)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var o=r.call(t,e||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _callSuper(t,e,r){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,r||[],_getPrototypeOf(t).constructor):e.apply(t,r))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var Point=function(t){function e(t,r){var o;return _classCallCheck(this,e),(o=_callSuper(this,e)).setCoordinates(t,r),o}return _inherits(e,_SimpleGeometry2["default"]),_createClass(e,[{key:"clone",value:function(){var t=new e(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t}},{key:"closestPointXY",value:function(t,e,r,o){var n=this.flatCoordinates,i=(0,_math.squaredDistance)(t,e,n[0],n[1]);if(i<o){for(var u=this.stride,a=0;a<u;++a)r[a]=n[a];return r.length=u,i}return o}},{key:"getCoordinates",value:function(){return this.flatCoordinates.slice()}},{key:"computeExtent",value:function(t){return(0,_extent.createOrUpdateFromCoordinate)(this.flatCoordinates,t)}},{key:"getType",value:function(){return"Point"}},{key:"intersectsExtent",value:function(t){return(0,_extent.containsXY)(t,this.flatCoordinates[0],this.flatCoordinates[1])}},{key:"setCoordinates",value:function(t,e){this.setLayout(e,t,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=(0,_deflate.deflateCoordinate)(this.flatCoordinates,0,t,this.stride),this.changed()}}])}(),_default=exports.default=Point;

},{"../extent.js":59,"../math.js":120,"./SimpleGeometry.js":74,"./flat/deflate.js":79}],73:[function(require,module,exports){
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.circular=circular,exports.default=void 0,exports.fromCircle=fromCircle,exports.fromExtent=fromExtent,exports.makeRegular=makeRegular;var _LinearRing=_interopRequireDefault(require("./LinearRing.js")),_Point=_interopRequireDefault(require("./Point.js")),_SimpleGeometry2=_interopRequireDefault(require("./SimpleGeometry.js")),_closest=require("./flat/closest.js"),_extent=require("../extent.js"),_deflate=require("./flat/deflate.js"),_array=require("../array.js"),_interiorpoint=require("./flat/interiorpoint.js"),_inflate=require("./flat/inflate.js"),_intersectsextent=require("./flat/intersectsextent.js"),_orient=require("./flat/orient.js"),_area=require("./flat/area.js"),_contains=require("./flat/contains.js"),_math=require("../math.js"),_simplify=require("./flat/simplify.js"),_sphere=require("../sphere.js");function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,_toPropertyKey(i.key),i)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!=_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _callSuper(t,e,r){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,r||[],_getPrototypeOf(t).constructor):e.apply(t,r))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var Polygon=function(t){function e(t,r,i){var n;return _classCallCheck(this,e),(n=_callSuper(this,e)).ends_=[],n.flatInteriorPointRevision_=-1,n.flatInteriorPoint_=null,n.maxDelta_=-1,n.maxDeltaRevision_=-1,n.orientedRevision_=-1,n.orientedFlatCoordinates_=null,void 0!==r&&i?(n.setFlatCoordinates(r,t),n.ends_=i):n.setCoordinates(t,r),n}return _inherits(e,_SimpleGeometry2["default"]),_createClass(e,[{key:"appendLinearRing",value:function(t){this.flatCoordinates?(0,_array.extend)(this.flatCoordinates,t.getFlatCoordinates()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()}},{key:"clone",value:function(){var t=new e(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return t.applyProperties(this),t}},{key:"closestPointXY",value:function(t,e,r,i){return i<(0,_extent.closestSquaredDistanceXY)(this.getExtent(),t,e)?i:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt((0,_closest.arrayMaxSquaredDelta)(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),(0,_closest.assignClosestArrayPoint)(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,t,e,r,i))}},{key:"containsXY",value:function(t,e){return(0,_contains.linearRingsContainsXY)(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,e)}},{key:"getArea",value:function(){return(0,_area.linearRings)(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)}},{key:"getCoordinates",value:function(t){var e;return void 0!==t?(e=this.getOrientedFlatCoordinates().slice(),(0,_orient.orientLinearRings)(e,0,this.ends_,this.stride,t)):e=this.flatCoordinates,(0,_inflate.inflateCoordinatesArray)(e,0,this.ends_,this.stride)}},{key:"getEnds",value:function(){return this.ends_}},{key:"getFlatInteriorPoint",value:function(){if(this.flatInteriorPointRevision_!=this.getRevision()){var t=(0,_extent.getCenter)(this.getExtent());this.flatInteriorPoint_=(0,_interiorpoint.getInteriorPointOfArray)(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,0),this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_}},{key:"getInteriorPoint",value:function(){return new _Point.default(this.getFlatInteriorPoint(),"XYM")}},{key:"getLinearRingCount",value:function(){return this.ends_.length}},{key:"getLinearRing",value:function(t){return t<0||this.ends_.length<=t?null:new _LinearRing.default(this.flatCoordinates.slice(0===t?0:this.ends_[t-1],this.ends_[t]),this.layout)}},{key:"getLinearRings",value:function(){for(var t=this.layout,e=this.flatCoordinates,r=this.ends_,i=[],n=0,o=0,s=r.length;o<s;++o){var a=r[o],l=new _LinearRing.default(e.slice(n,a),t);i.push(l),n=a}return i}},{key:"getOrientedFlatCoordinates",value:function(){if(this.orientedRevision_!=this.getRevision()){var t=this.flatCoordinates;(0,_orient.linearRingsAreOriented)(t,0,this.ends_,this.stride)?this.orientedFlatCoordinates_=t:(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=(0,_orient.orientLinearRings)(this.orientedFlatCoordinates_,0,this.ends_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}},{key:"getSimplifiedGeometryInternal",value:function(t){var r=[],i=[];return r.length=(0,_simplify.quantizeArray)(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(t),r,0,i),new e(r,"XY",i)}},{key:"getType",value:function(){return"Polygon"}},{key:"intersectsExtent",value:function(t){return(0,_intersectsextent.intersectsLinearRingArray)(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t)}},{key:"setCoordinates",value:function(t,e){this.setLayout(e,t,2),this.flatCoordinates||(this.flatCoordinates=[]);var r=(0,_deflate.deflateCoordinatesArray)(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=0===r.length?0:r[r.length-1],this.changed()}}])}(),_default=exports.default=Polygon;function circular(t,e,r,i){r=r||32;for(var n=[],o=0;o<r;++o)(0,_array.extend)(n,(0,_sphere.offset)(t,e,2*Math.PI*o/r,i));return n.push(n[0],n[1]),new Polygon(n,"XY",[n.length])}function fromExtent(t){if((0,_extent.isEmpty)(t))throw new Error("Cannot create polygon from empty extent");var e=t[0],r=t[1],i=t[2],n=t[3],o=[e,r,e,n,i,n,i,r,e,r];return new Polygon(o,"XY",[o.length])}function fromCircle(t,e,r){e=e||32;for(var i=t.getStride(),n=t.getLayout(),o=t.getCenter(),s=i*(e+1),a=new Array(s),l=0;l<s;l+=i){a[l]=0,a[l+1]=0;for(var u=2;u<i;u++)a[l+u]=o[u]}var f=[a.length],c=new Polygon(a,n,f);return makeRegular(c,o,t.getRadius(),r),c}function makeRegular(t,e,r,i){for(var n=t.getFlatCoordinates(),o=t.getStride(),s=n.length/o-1,a=i||0,l=0;l<=s;++l){var u=l*o,f=a+2*(0,_math.modulo)(l,s)*Math.PI/s;n[u]=e[0]+r*Math.cos(f),n[u+1]=e[1]+r*Math.sin(f)}t.changed()}

},{"../array.js":36,"../extent.js":59,"../math.js":120,"../sphere.js":181,"./LinearRing.js":68,"./Point.js":72,"./SimpleGeometry.js":74,"./flat/area.js":75,"./flat/closest.js":77,"./flat/contains.js":78,"./flat/deflate.js":79,"./flat/inflate.js":80,"./flat/interiorpoint.js":81,"./flat/intersectsextent.js":83,"./flat/orient.js":86,"./flat/simplify.js":89}],74:[function(require,module,exports){
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0,exports.getLayoutForStride=getLayoutForStride,exports.getStrideForLayout=getStrideForLayout,exports.transformGeom2D=transformGeom2D;var _Geometry2=_interopRequireDefault(require("./Geometry.js")),_util=require("../util.js"),_extent=require("../extent.js"),_transform=require("./flat/transform.js");function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,_toPropertyKey(o.key),o)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var o=r.call(t,e||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _callSuper(t,e,r){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,r||[],_getPrototypeOf(t).constructor):e.apply(t,r))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var SimpleGeometry=function(t){function e(){var t;return _classCallCheck(this,e),(t=_callSuper(this,e)).layout="XY",t.stride=2,t.flatCoordinates,t}return _inherits(e,_Geometry2["default"]),_createClass(e,[{key:"computeExtent",value:function(t){return(0,_extent.createOrUpdateFromFlatCoordinates)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)}},{key:"getCoordinates",value:function(){return(0,_util.abstract)()}},{key:"getFirstCoordinate",value:function(){return this.flatCoordinates.slice(0,this.stride)}},{key:"getFlatCoordinates",value:function(){return this.flatCoordinates}},{key:"getLastCoordinate",value:function(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)}},{key:"getLayout",value:function(){return this.layout}},{key:"getSimplifiedGeometry",value:function(t){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),t<0||0!==this.simplifiedGeometryMaxMinSquaredTolerance&&t<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;var e=this.getSimplifiedGeometryInternal(t);return e.getFlatCoordinates().length<this.flatCoordinates.length?e:(this.simplifiedGeometryMaxMinSquaredTolerance=t,this)}},{key:"getSimplifiedGeometryInternal",value:function(t){return this}},{key:"getStride",value:function(){return this.stride}},{key:"setFlatCoordinates",value:function(t,e){this.stride=getStrideForLayout(t),this.layout=t,this.flatCoordinates=e}},{key:"setCoordinates",value:function(t,e){(0,_util.abstract)()}},{key:"setLayout",value:function(t,e,r){var o;if(t)o=getStrideForLayout(t);else{for(var i=0;i<r;++i){if(0===e.length)return this.layout="XY",void(this.stride=2);e=e[0]}t=getLayoutForStride(o=e.length)}this.layout=t,this.stride=o}},{key:"applyTransform",value:function(t){this.flatCoordinates&&(t(this.flatCoordinates,this.flatCoordinates,this.stride),this.changed())}},{key:"rotate",value:function(t,e){var r=this.getFlatCoordinates();if(r){var o=this.getStride();(0,_transform.rotate)(r,0,r.length,o,t,e,r),this.changed()}}},{key:"scale",value:function(t,e,r){void 0===e&&(e=t),r||(r=(0,_extent.getCenter)(this.getExtent()));var o=this.getFlatCoordinates();if(o){var i=this.getStride();(0,_transform.scale)(o,0,o.length,i,t,e,r,o),this.changed()}}},{key:"translate",value:function(t,e){var r=this.getFlatCoordinates();if(r){var o=this.getStride();(0,_transform.translate)(r,0,r.length,o,t,e,r),this.changed()}}}])}();function getLayoutForStride(t){var e;return 2==t?e="XY":3==t?e="XYZ":4==t&&(e="XYZM"),e}function getStrideForLayout(t){var e;return"XY"==t?e=2:"XYZ"==t||"XYM"==t?e=3:"XYZM"==t&&(e=4),e}function transformGeom2D(t,e,r){var o=t.getFlatCoordinates();if(!o)return null;var i=t.getStride();return(0,_transform.transform2D)(o,0,o.length,i,e,r)}var _default=exports.default=SimpleGeometry;

},{"../extent.js":59,"../util.js":205,"./Geometry.js":65,"./flat/transform.js":92}],75:[function(require,module,exports){
"use strict";function linearRing(n,r,e,i){for(var a=0,s=n[e-i],t=n[e-i+1],l=0,g=0;r<e;r+=i){var o=n[r]-s,R=n[r+1]-t;a+=g*o-l*R,l=o,g=R}return a/2}function linearRings(n,r,e,i){for(var a=0,s=0,t=e.length;s<t;++s){var l=e[s];a+=linearRing(n,r,l,i),r=l}return a}function linearRingss(n,r,e,i){for(var a=0,s=0,t=e.length;s<t;++s){var l=e[s];a+=linearRings(n,r,l,i),r=l[l.length-1]}return a}Object.defineProperty(exports,"__esModule",{value:!0}),exports.linearRing=linearRing,exports.linearRings=linearRings,exports.linearRingss=linearRingss;

},{}],76:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.linearRingss=linearRingss;var _extent=require("../../extent.js");function linearRingss(e,t,r,n){for(var s=[],a=(0,_extent.createEmpty)(),i=0,o=r.length;i<o;++i){var l=r[i];a=(0,_extent.createOrUpdateFromFlatCoordinates)(e,t,l[0],n),s.push((a[0]+a[2])/2,(a[1]+a[3])/2),t=l[l.length-1]}return s}

},{"../../extent.js":59}],77:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.arrayMaxSquaredDelta=arrayMaxSquaredDelta,exports.assignClosestArrayPoint=assignClosestArrayPoint,exports.assignClosestMultiArrayPoint=assignClosestMultiArrayPoint,exports.assignClosestPoint=assignClosestPoint,exports.maxSquaredDelta=maxSquaredDelta,exports.multiArrayMaxSquaredDelta=multiArrayMaxSquaredDelta;var _math=require("../../math.js");function assignClosest(a,r,t,e,s,n,i){var o,l=a[r],u=a[r+1],f=a[t]-l,g=a[t+1]-u;if(0===f&&0===g)o=r;else{var h=((s-l)*f+(n-u)*g)/(f*f+g*g);if(h>1)o=t;else{if(h>0){for(var v=0;v<e;++v)i[v]=(0,_math.lerp)(a[r+v],a[t+v],h);return void(i.length=e)}o=r}}for(var x=0;x<e;++x)i[x]=a[o+x];i.length=e}function maxSquaredDelta(a,r,t,e,s){var n=a[r],i=a[r+1];for(r+=e;r<t;r+=e){var o=a[r],l=a[r+1],u=(0,_math.squaredDistance)(n,i,o,l);u>s&&(s=u),n=o,i=l}return s}function arrayMaxSquaredDelta(a,r,t,e,s){for(var n=0,i=t.length;n<i;++n){var o=t[n];s=maxSquaredDelta(a,r,o,e,s),r=o}return s}function multiArrayMaxSquaredDelta(a,r,t,e,s){for(var n=0,i=t.length;n<i;++n){var o=t[n];s=arrayMaxSquaredDelta(a,r,o,e,s),r=o[o.length-1]}return s}function assignClosestPoint(a,r,t,e,s,n,i,o,l,u,f){if(r==t)return u;var g,h;if(0===s){if((h=(0,_math.squaredDistance)(i,o,a[r],a[r+1]))<u){for(g=0;g<e;++g)l[g]=a[r+g];return l.length=e,h}return u}f=f||[NaN,NaN];for(var v=r+e;v<t;)if(assignClosest(a,v-e,v,e,i,o,f),(h=(0,_math.squaredDistance)(i,o,f[0],f[1]))<u){for(u=h,g=0;g<e;++g)l[g]=f[g];l.length=e,v+=e}else v+=e*Math.max((Math.sqrt(h)-Math.sqrt(u))/s|0,1);if(n&&(assignClosest(a,t-e,r,e,i,o,f),(h=(0,_math.squaredDistance)(i,o,f[0],f[1]))<u)){for(u=h,g=0;g<e;++g)l[g]=f[g];l.length=e}return u}function assignClosestArrayPoint(a,r,t,e,s,n,i,o,l,u,f){f=f||[NaN,NaN];for(var g=0,h=t.length;g<h;++g){var v=t[g];u=assignClosestPoint(a,r,v,e,s,n,i,o,l,u,f),r=v}return u}function assignClosestMultiArrayPoint(a,r,t,e,s,n,i,o,l,u,f){f=f||[NaN,NaN];for(var g=0,h=t.length;g<h;++g){var v=t[g];u=assignClosestArrayPoint(a,r,v,e,s,n,i,o,l,u,f),r=v[v.length-1]}return u}

},{"../../math.js":120}],78:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.linearRingContainsExtent=linearRingContainsExtent,exports.linearRingContainsXY=linearRingContainsXY,exports.linearRingsContainsXY=linearRingsContainsXY,exports.linearRingssContainsXY=linearRingssContainsXY;var _extent=require("../../extent.js");function linearRingContainsExtent(n,i,r,t,e){return!(0,_extent.forEachCorner)(e,function(e){return!linearRingContainsXY(n,i,r,t,e[0],e[1])})}function linearRingContainsXY(n,i,r,t,e,a){for(var s=0,o=n[r-t],l=n[r-t+1];i<r;i+=t){var g=n[i],u=n[i+1];l<=a?u>a&&(g-o)*(a-l)-(e-o)*(u-l)>0&&s++:u<=a&&(g-o)*(a-l)-(e-o)*(u-l)<0&&s--,o=g,l=u}return 0!==s}function linearRingsContainsXY(n,i,r,t,e,a){if(0===r.length)return!1;if(!linearRingContainsXY(n,i,r[0],t,e,a))return!1;for(var s=1,o=r.length;s<o;++s)if(linearRingContainsXY(n,r[s-1],r[s],t,e,a))return!1;return!0}function linearRingssContainsXY(n,i,r,t,e,a){if(0===r.length)return!1;for(var s=0,o=r.length;s<o;++s){var l=r[s];if(linearRingsContainsXY(n,i,l,t,e,a))return!0;i=l[l.length-1]}return!1}

},{"../../extent.js":59}],79:[function(require,module,exports){
"use strict";function deflateCoordinate(e,r,t,o){for(var a=0,n=t.length;a<n;++a)e[r++]=t[a];return r}function deflateCoordinates(e,r,t,o){for(var a=0,n=t.length;a<n;++a)for(var d=t[a],l=0;l<o;++l)e[r++]=d[l];return r}function deflateCoordinatesArray(e,r,t,o,a){a=a||[];for(var n=0,d=0,l=t.length;d<l;++d){var f=deflateCoordinates(e,r,t[d],o);a[n++]=f,r=f}return a.length=n,a}function deflateMultiCoordinatesArray(e,r,t,o,a){a=a||[];for(var n=0,d=0,l=t.length;d<l;++d){var f=deflateCoordinatesArray(e,r,t[d],o,a[n]);0===f.length&&(f[0]=r),a[n++]=f,r=f[f.length-1]}return a.length=n,a}Object.defineProperty(exports,"__esModule",{value:!0}),exports.deflateCoordinate=deflateCoordinate,exports.deflateCoordinates=deflateCoordinates,exports.deflateCoordinatesArray=deflateCoordinatesArray,exports.deflateMultiCoordinatesArray=deflateMultiCoordinatesArray;

},{}],80:[function(require,module,exports){
"use strict";function inflateCoordinates(r,t,e,n,o){o=void 0!==o?o:[];for(var a=0,i=t;i<e;i+=n)o[a++]=r.slice(i,i+n);return o.length=a,o}function inflateCoordinatesArray(r,t,e,n,o){o=void 0!==o?o:[];for(var a=0,i=0,l=e.length;i<l;++i){var s=e[i];o[a++]=inflateCoordinates(r,t,s,n,o[a]),t=s}return o.length=a,o}function inflateMultiCoordinatesArray(r,t,e,n,o){o=void 0!==o?o:[];for(var a=0,i=0,l=e.length;i<l;++i){var s=e[i];o[a++]=1===s.length&&s[0]===t?[]:inflateCoordinatesArray(r,t,s,n,o[a]),t=s[s.length-1]}return o.length=a,o}Object.defineProperty(exports,"__esModule",{value:!0}),exports.inflateCoordinates=inflateCoordinates,exports.inflateCoordinatesArray=inflateCoordinatesArray,exports.inflateMultiCoordinatesArray=inflateMultiCoordinatesArray;

},{}],81:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getInteriorPointOfArray=getInteriorPointOfArray,exports.getInteriorPointsOfMultiArray=getInteriorPointsOfMultiArray;var _array=require("../../array.js"),_contains=require("./contains.js");function getInteriorPointOfArray(r,t,e,n,a,i,o){for(var s,f,u,g,y,l,c,v=a[i+1],O=[],P=0,h=e.length;P<h;++P){var A=e[P];for(g=r[A-n],l=r[A-n+1],s=t;s<A;s+=n)y=r[s],c=r[s+1],(v<=l&&c<=v||l<=v&&v<=c)&&(u=(v-l)/(c-l)*(y-g)+g,O.push(u)),g=y,l=c}var I=NaN,p=-1/0;for(O.sort(_array.ascending),g=O[0],s=1,f=O.length;s<f;++s){y=O[s];var _=Math.abs(y-g);_>p&&(u=(g+y)/2,(0,_contains.linearRingsContainsXY)(r,t,e,n,u,v)&&(I=u,p=_)),g=y}return isNaN(I)&&(I=a[i]),o?(o.push(I,v,p),o):[I,v,p]}function getInteriorPointsOfMultiArray(r,t,e,n,a){for(var i=[],o=0,s=e.length;o<s;++o){var f=e[o];i=getInteriorPointOfArray(r,t,f,n,a,2*o,i),t=f[f.length-1]}return i}

},{"../../array.js":36,"./contains.js":78}],82:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.interpolatePoint=interpolatePoint,exports.lineStringCoordinateAtM=lineStringCoordinateAtM,exports.lineStringsCoordinateAtM=lineStringsCoordinateAtM;var _array=require("../../array.js"),_math=require("../../math.js");function interpolatePoint(r,e,t,n,i,a,l){var o,u,s=(t-e)/n;if(1===s)o=e;else if(2===s)o=e,u=i;else if(0!==s){for(var f=r[e],v=r[e+1],h=0,p=[0],c=e+n;c<t;c+=n){var d=r[c],g=r[c+1];h+=Math.sqrt((d-f)*(d-f)+(g-v)*(g-v)),p.push(h),f=d,v=g}var M=i*h,A=(0,_array.binarySearch)(p,M);A<0?(u=(M-p[-A-2])/(p[-A-1]-p[-A-2]),o=e+(-A-2)*n):o=e+A*n}l=l>1?l:2,a=a||new Array(l);for(var S=0;S<l;++S)a[S]=void 0===o?NaN:void 0===u?r[o+S]:(0,_math.lerp)(r[o+S],r[o+n+S],u);return a}function lineStringCoordinateAtM(r,e,t,n,i,a){if(t==e)return null;var l;if(i<r[e+n-1])return a?((l=r.slice(e,e+n))[n-1]=i,l):null;if(r[t-1]<i)return a?((l=r.slice(t-n,t))[n-1]=i,l):null;if(i==r[e+n-1])return r.slice(e,e+n);for(var o=e/n,u=t/n;o<u;){var s=o+u>>1;i<r[(s+1)*n-1]?u=s:o=s+1}var f=r[o*n-1];if(i==f)return r.slice((o-1)*n,(o-1)*n+n);var v=(i-f)/(r[(o+1)*n-1]-f);l=[];for(var h=0;h<n-1;++h)l.push((0,_math.lerp)(r[(o-1)*n+h],r[o*n+h],v));return l.push(i),l}function lineStringsCoordinateAtM(r,e,t,n,i,a,l){if(l)return lineStringCoordinateAtM(r,e,t[t.length-1],n,i,a);var o;if(i<r[n-1])return a?((o=r.slice(0,n))[n-1]=i,o):null;if(r[r.length-1]<i)return a?((o=r.slice(r.length-n))[n-1]=i,o):null;for(var u=0,s=t.length;u<s;++u){var f=t[u];if(e!=f){if(i<r[e+n-1])return null;if(i<=r[f-1])return lineStringCoordinateAtM(r,e,f,n,i,!1);e=f}}return null}

},{"../../array.js":36,"../../math.js":120}],83:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.intersectsLineString=intersectsLineString,exports.intersectsLineStringArray=intersectsLineStringArray,exports.intersectsLinearRing=intersectsLinearRing,exports.intersectsLinearRingArray=intersectsLinearRingArray,exports.intersectsLinearRingMultiArray=intersectsLinearRingMultiArray;var _extent=require("../../extent.js"),_segments=require("./segments.js"),_contains=require("./contains.js");function intersectsLineString(n,e,t,r,i){var s=(0,_extent.extendFlatCoordinates)((0,_extent.createEmpty)(),n,e,t,r);return!!(0,_extent.intersects)(i,s)&&(!!(0,_extent.containsExtent)(i,s)||(s[0]>=i[0]&&s[2]<=i[2]||(s[1]>=i[1]&&s[3]<=i[3]||(0,_segments.forEach)(n,e,t,r,function(n,e){return(0,_extent.intersectsSegment)(i,n,e)}))))}function intersectsLineStringArray(n,e,t,r,i){for(var s=0,a=t.length;s<a;++s){if(intersectsLineString(n,e,t[s],r,i))return!0;e=t[s]}return!1}function intersectsLinearRing(n,e,t,r,i){return!!intersectsLineString(n,e,t,r,i)||(!!(0,_contains.linearRingContainsXY)(n,e,t,r,i[0],i[1])||(!!(0,_contains.linearRingContainsXY)(n,e,t,r,i[0],i[3])||(!!(0,_contains.linearRingContainsXY)(n,e,t,r,i[2],i[1])||!!(0,_contains.linearRingContainsXY)(n,e,t,r,i[2],i[3]))))}function intersectsLinearRingArray(n,e,t,r,i){if(!intersectsLinearRing(n,e,t[0],r,i))return!1;if(1===t.length)return!0;for(var s=1,a=t.length;s<a;++s)if((0,_contains.linearRingContainsExtent)(n,t[s-1],t[s],r,i)&&!intersectsLineString(n,t[s-1],t[s],r,i))return!1;return!0}function intersectsLinearRingMultiArray(n,e,t,r,i){for(var s=0,a=t.length;s<a;++s){var c=t[s];if(intersectsLinearRingArray(n,e,c,r,i))return!0;e=c[c.length-1]}return!1}

},{"../../extent.js":59,"./contains.js":78,"./segments.js":88}],84:[function(require,module,exports){
"use strict";function lineStringLength(n,e,t,r){for(var i=n[e],g=n[e+1],a=0,h=e+r;h<t;h+=r){var l=n[h],o=n[h+1];a+=Math.sqrt((l-i)*(l-i)+(o-g)*(o-g)),i=l,g=o}return a}function linearRingLength(n,e,t,r){var i=lineStringLength(n,e,t,r),g=n[t-r]-n[e],a=n[t-r+1]-n[e+1];return i+=Math.sqrt(g*g+a*a)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.lineStringLength=lineStringLength,exports.linearRingLength=linearRingLength;

},{}],85:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.lineChunk=lineChunk;var _math=require("../../math.js");function _slicedToArray(r,e){return _arrayWithHoles(r)||_iterableToArrayLimit(r,e)||_unsupportedIterableToArray(r,e)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(r,e){if(r){if("string"==typeof r)return _arrayLikeToArray(r,e);var t={}.toString.call(r).slice(8,-1);return"Object"===t&&r.constructor&&(t=r.constructor.name),"Map"===t||"Set"===t?Array.from(r):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?_arrayLikeToArray(r,e):void 0}}function _arrayLikeToArray(r,e){(null==e||e>r.length)&&(e=r.length);for(var t=0,a=Array(e);t<e;t++)a[t]=r[t];return a}function _iterableToArrayLimit(r,e){var t=null==r?null:"undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null!=t){var a,n,l,o,i=[],u=!0,s=!1;try{if(l=(t=t.call(r)).next,0===e){if(Object(t)!==t)return;u=!1}else for(;!(u=(a=l.call(t)).done)&&(i.push(a.value),i.length!==e);u=!0);}catch(r){s=!0,n=r}finally{try{if(!u&&null!=t.return&&(o=t.return(),Object(o)!==o))return}finally{if(s)throw n}}return i}}function _arrayWithHoles(r){if(Array.isArray(r))return r}function lineChunk(r,e,t,a,n){for(var l=[],o=t,i=0,u=e.slice(t,2);i<r&&o+n<a;){var s=_slicedToArray(u.slice(-2),2),y=s[0],c=s[1],f=e[o+n],h=e[o+n+1],p=Math.sqrt((f-y)*(f-y)+(h-c)*(h-c));if((i+=p)>=r){var _=(r-i+p)/p,m=(0,_math.lerp)(y,f,_),b=(0,_math.lerp)(c,h,_);u.push(m,b),l.push(u),u=[m,b],i==r&&(o+=n),i=0}else if(i<r)u.push(e[o+n],e[o+n+1]),o+=n;else{var d=p-i,A=(0,_math.lerp)(y,f,d/p),v=(0,_math.lerp)(c,h,d/p);u.push(A,v),l.push(u),u=[A,v],i=0,o+=n}}return i>0&&l.push(u),l}

},{"../../math.js":120}],86:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.inflateEnds=inflateEnds,exports.linearRingIsClockwise=linearRingIsClockwise,exports.linearRingsAreOriented=linearRingsAreOriented,exports.linearRingssAreOriented=linearRingssAreOriented,exports.orientLinearRings=orientLinearRings,exports.orientLinearRingsArray=orientLinearRingsArray;var _reverse=require("./reverse.js");function linearRingIsClockwise(e,r,n,i){for(var t=0,s=e[n-i],o=e[n-i+1];r<n;r+=i){var a=e[r],l=e[r+1];t+=(a-s)*(l+o),s=a,o=l}return 0===t?void 0:t>0}function linearRingsAreOriented(e,r,n,i,t){t=void 0!==t&&t;for(var s=0,o=n.length;s<o;++s){var a=n[s],l=linearRingIsClockwise(e,r,a,i);if(0===s){if(t&&l||!t&&!l)return!1}else if(t&&!l||!t&&l)return!1;r=a}return!0}function linearRingssAreOriented(e,r,n,i,t){for(var s=0,o=n.length;s<o;++s){var a=n[s];if(!linearRingsAreOriented(e,r,a,i,t))return!1;a.length&&(r=a[a.length-1])}return!0}function orientLinearRings(e,r,n,i,t){t=void 0!==t&&t;for(var s=0,o=n.length;s<o;++s){var a=n[s],l=linearRingIsClockwise(e,r,a,i);(0===s?t&&l||!t&&!l:t&&!l||!t&&l)&&(0,_reverse.coordinates)(e,r,a,i),r=a}return r}function orientLinearRingsArray(e,r,n,i,t){for(var s=0,o=n.length;s<o;++s)r=orientLinearRings(e,r,n[s],i,t);return r}function inflateEnds(e,r){for(var n,i=[],t=0,s=0,o=0,a=r.length;o<a;++o){var l=r[o],g=linearRingIsClockwise(e,t,l,2);if(void 0===n&&(n=g),g===n)i.push(r.slice(s,o+1));else{if(0===i.length)continue;i[i.length-1].push(r[s])}s=o+1,t=l}return i}

},{"./reverse.js":87}],87:[function(require,module,exports){
"use strict";function coordinates(e,o,r,t){for(;o<r-t;){for(var s=0;s<t;++s){var a=e[o+s];e[o+s]=e[r-t+s],e[r-t+s]=a}o+=t,r-=t}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.coordinates=coordinates;

},{}],88:[function(require,module,exports){
"use strict";function forEach(e,r,o,t,c){var f;for(r+=t;r<o;r+=t)if(f=c(e.slice(r-t,r),e.slice(r,r+t)))return f;return!1}Object.defineProperty(exports,"__esModule",{value:!0}),exports.forEach=forEach;

},{}],89:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.douglasPeucker=douglasPeucker,exports.douglasPeuckerArray=douglasPeuckerArray,exports.douglasPeuckerMultiArray=douglasPeuckerMultiArray,exports.quantize=quantize,exports.quantizeArray=quantizeArray,exports.quantizeMultiArray=quantizeMultiArray,exports.radialDistance=radialDistance,exports.simplifyLineString=simplifyLineString,exports.snap=snap;var _math=require("../../math.js");function simplifyLineString(r,e,a,t,u,n,i){return i=void 0!==i?i:[],n||(a=radialDistance(r,e,a,t,u,i,0),r=i,e=0,t=2),i.length=douglasPeucker(r,e,a,t,u,i,0),i}function douglasPeucker(r,e,a,t,u,n,i){var s=(a-e)/t;if(s<3){for(;e<a;e+=t)n[i++]=r[e],n[i++]=r[e+1];return i}var o=new Array(s);o[0]=1,o[s-1]=1;for(var l=[e,a-t],p=0;l.length>0;){for(var c=l.pop(),f=l.pop(),g=0,d=r[f],v=r[f+1],h=r[c],y=r[c+1],A=f+t;A<c;A+=t){var q=r[A],P=r[A+1],k=(0,_math.squaredSegmentDistance)(q,P,d,v,h,y);k>g&&(p=A,g=k)}g>u&&(o[(p-e)/t]=1,f+t<p&&l.push(f,p),p+t<c&&l.push(p,c))}for(var z=0;z<s;++z)o[z]&&(n[i++]=r[e+z*t],n[i++]=r[e+z*t+1]);return i}function douglasPeuckerArray(r,e,a,t,u,n,i,s){for(var o=0,l=a.length;o<l;++o){var p=a[o];i=douglasPeucker(r,e,p,t,u,n,i),s.push(i),e=p}return i}function douglasPeuckerMultiArray(r,e,a,t,u,n,i,s){for(var o=0,l=a.length;o<l;++o){var p=a[o],c=[];i=douglasPeuckerArray(r,e,p,t,u,n,i,c),s.push(c),e=p[p.length-1]}return i}function radialDistance(r,e,a,t,u,n,i){if(a<=e+t){for(;e<a;e+=t)n[i++]=r[e],n[i++]=r[e+1];return i}var s=r[e],o=r[e+1];n[i++]=s,n[i++]=o;var l=s,p=o;for(e+=t;e<a;e+=t)l=r[e],p=r[e+1],(0,_math.squaredDistance)(s,o,l,p)>u&&(n[i++]=l,n[i++]=p,s=l,o=p);return l==s&&p==o||(n[i++]=l,n[i++]=p),i}function snap(r,e){return e*Math.round(r/e)}function quantize(r,e,a,t,u,n,i){if(e==a)return i;var s,o,l=snap(r[e],u),p=snap(r[e+1],u);e+=t,n[i++]=l,n[i++]=p;do{if(s=snap(r[e],u),o=snap(r[e+1],u),(e+=t)==a)return n[i++]=s,n[i++]=o,i}while(s==l&&o==p);for(;e<a;){var c=snap(r[e],u),f=snap(r[e+1],u);if(e+=t,c!=s||f!=o){var g=s-l,d=o-p,v=c-l,h=f-p;g*h==d*v&&(g<0&&v<g||g==v||g>0&&v>g)&&(d<0&&h<d||d==h||d>0&&h>d)?(s=c,o=f):(n[i++]=s,n[i++]=o,l=s,p=o,s=c,o=f)}}return n[i++]=s,n[i++]=o,i}function quantizeArray(r,e,a,t,u,n,i,s){for(var o=0,l=a.length;o<l;++o){var p=a[o];i=quantize(r,e,p,t,u,n,i),s.push(i),e=p}return i}function quantizeMultiArray(r,e,a,t,u,n,i,s){for(var o=0,l=a.length;o<l;++o){var p=a[o],c=[];i=quantizeArray(r,e,p,t,u,n,i,c),s.push(c),e=p[p.length-1]}return i}

},{"../../math.js":120}],90:[function(require,module,exports){
"use strict";function matchingChunk(t,e,r,n,a){var o,h,i,u,c,s,v,d,f,g=r,k=r,m=0,p=0,C=r;for(o=r;o<n;o+=a){var M=e[o],l=e[o+1];void 0!==u&&(d=M-u,f=l-c,i=Math.sqrt(d*d+f*f),void 0!==s&&(p+=h,Math.acos((s*d+v*f)/(h*i))>t&&(p>m&&(m=p,g=C,k=o),p=0,C=o-a)),h=i,s=d,v=f),u=M,c=l}return(p+=i)>m?[C,o]:[g,k]}Object.defineProperty(exports,"__esModule",{value:!0}),exports.matchingChunk=matchingChunk;

},{}],91:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.drawTextOnPath=drawTextOnPath;var _math=require("../../math.js"),_transform=require("./transform.js");function drawTextOnPath(r,a,t,e,n,h,s,i,v,f,o,l){var u=r[a],m=r[a+1],p=0,_=0,d=0,M=0;function b(){p=u,_=m,u=r[a+=e],m=r[a+1],M+=d,d=Math.sqrt((u-p)*(u-p)+(m-_)*(m-_))}do{b()}while(a<t-e&&M+d<h);for(var c=0===d?0:(h-M)/d,x=(0,_math.lerp)(p,u,c),P=(0,_math.lerp)(_,m,c),g=a-e,w=M,O=h+i*v(f,n,o);a<t-e&&M+d<O;)b();c=0===d?0:(O-M)/d;var j,q=(0,_math.lerp)(p,u,c),T=(0,_math.lerp)(_,m,c);if(l){var k=[x,P,q,T];(0,_transform.rotate)(k,0,4,2,l,k,k),j=k[0]>k[2]}else j=x>q;var y,I=Math.PI,z=[],A=g+e===a;if(d=0,M=w,u=r[a=g],m=r[a+1],A){b(),y=Math.atan2(m-_,u-p),j&&(y+=y>0?-I:I);var B=(q+x)/2,C=(T+P)/2;return z[0]=[B,C,(O-h)/2,y,n],z}for(var D=0,E=(n=n.replace(/\n/g," ")).length;D<E;){b();var F=Math.atan2(m-_,u-p);if(j&&(F+=F>0?-I:I),void 0!==y){var G=F-y;if(G+=G>I?-2*I:G<-I?2*I:0,Math.abs(G)>s)return null}y=F;for(var H=D,J=0;D<E;++D){var K=i*v(f,n[j?E-D-1:D],o);if(a+e<t&&M+d<h+J+K/2)break;J+=K}if(D!==H){var L=j?n.substring(E-H,E-D):n.substring(H,D);c=0===d?0:(h+J/2-M)/d;var N=(0,_math.lerp)(p,u,c),Q=(0,_math.lerp)(_,m,c);z.push([N,Q,J/2,F,L]),h+=J}}return z}

},{"../../math.js":120,"./transform.js":92}],92:[function(require,module,exports){
"use strict";function transform2D(r,t,e,a,n,o){o=o||[];for(var s=0,l=t;l<e;l+=a){var f=r[l],u=r[l+1];o[s++]=n[0]*f+n[2]*u+n[4],o[s++]=n[1]*f+n[3]*u+n[5]}return o&&o.length!=s&&(o.length=s),o}function rotate(r,t,e,a,n,o,s){s=s||[];for(var l=Math.cos(n),f=Math.sin(n),u=o[0],v=o[1],c=0,h=t;h<e;h+=a){var g=r[h]-u,i=r[h+1]-v;s[c++]=u+g*l-i*f,s[c++]=v+g*f+i*l;for(var p=h+2;p<h+a;++p)s[c++]=r[p]}return s&&s.length!=c&&(s.length=c),s}function scale(r,t,e,a,n,o,s,l){l=l||[];for(var f=s[0],u=s[1],v=0,c=t;c<e;c+=a){var h=r[c]-f,g=r[c+1]-u;l[v++]=f+n*h,l[v++]=u+o*g;for(var i=c+2;i<c+a;++i)l[v++]=r[i]}return l&&l.length!=v&&(l.length=v),l}function translate(r,t,e,a,n,o,s){s=s||[];for(var l=0,f=t;f<e;f+=a){s[l++]=r[f]+n,s[l++]=r[f+1]+o;for(var u=f+2;u<f+a;++u)s[l++]=r[u]}return s&&s.length!=l&&(s.length=l),s}Object.defineProperty(exports,"__esModule",{value:!0}),exports.rotate=rotate,exports.scale=scale,exports.transform2D=transform2D,exports.translate=translate;

},{}],93:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.WORKER_OFFSCREEN_CANVAS=exports.WEBKIT=exports.SAFARI_BUG_237906=exports.SAFARI=exports.PASSIVE_EVENT_LISTENERS=exports.MAC=exports.IMAGE_DECODE=exports.FIREFOX=exports.DEVICE_PIXEL_RATIO=exports.CREATE_IMAGE_BITMAP=void 0;var ua="undefined"!=typeof navigator&&void 0!==navigator.userAgent?navigator.userAgent.toLowerCase():"",FIREFOX=exports.FIREFOX=ua.includes("firefox"),SAFARI=exports.SAFARI=ua.includes("safari")&&!ua.includes("chrom"),SAFARI_BUG_237906=exports.SAFARI_BUG_237906=SAFARI&&(ua.includes("version/15.4")||/cpu (os|iphone os) 15_4 like mac os x/.test(ua)),WEBKIT=exports.WEBKIT=ua.includes("webkit")&&!ua.includes("edge"),MAC=exports.MAC=ua.includes("macintosh"),DEVICE_PIXEL_RATIO=exports.DEVICE_PIXEL_RATIO="undefined"!=typeof devicePixelRatio?devicePixelRatio:1,WORKER_OFFSCREEN_CANVAS=exports.WORKER_OFFSCREEN_CANVAS="undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof OffscreenCanvas&&self instanceof WorkerGlobalScope,IMAGE_DECODE=exports.IMAGE_DECODE="undefined"!=typeof Image&&Image.prototype.decode,CREATE_IMAGE_BITMAP=exports.CREATE_IMAGE_BITMAP="function"==typeof createImageBitmap,PASSIVE_EVENT_LISTENERS=exports.PASSIVE_EVENT_LISTENERS=function(){var e=!1;try{var o=Object.defineProperty({},"passive",{get:function(){e=!0}});window.addEventListener("_",null,o),window.removeEventListener("_",null,o)}catch(e){}return e}();

},{}],94:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _Interaction2=_interopRequireWildcard(require("./Interaction.js")),_MapBrowserEventType=_interopRequireDefault(require("../MapBrowserEventType.js"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _getRequireWildcardCache(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(_getRequireWildcardCache=function(e){return e?r:t})(e)}function _interopRequireWildcard(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=_typeof(e)&&"function"!=typeof e)return{default:e};var r=_getRequireWildcardCache(t);if(r&&r.has(e))return r.get(e);var o={__proto__:null},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&{}.hasOwnProperty.call(e,i)){var u=n?Object.getOwnPropertyDescriptor(e,i):null;u&&(u.get||u.set)?Object.defineProperty(o,i,u):o[i]=e[i]}return o.default=e,r&&r.set(e,o),o}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var DoubleClickZoom=function(e){function t(e){var r;return _classCallCheck(this,t),e=e||{},(r=_callSuper(this,t)).delta_=e.delta?e.delta:1,r.duration_=void 0!==e.duration?e.duration:250,r}return _inherits(t,_Interaction2["default"]),_createClass(t,[{key:"handleEvent",value:function(e){var t=!1;if(e.type==_MapBrowserEventType.default.DBLCLICK){var r=e.originalEvent,o=e.map,n=e.coordinate,i=r.shiftKey?-this.delta_:this.delta_,u=o.getView();(0,_Interaction2.zoomByDelta)(u,i,n,this.duration_),r.preventDefault(),t=!0}return!t}}])}(),_default=exports.default=DoubleClickZoom;

},{"../MapBrowserEventType.js":21,"./Interaction.js":99}],95:[function(require,module,exports){
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=exports.DragBoxEvent=void 0;var _Event2=_interopRequireDefault(require("../events/Event.js")),_Pointer=_interopRequireDefault(require("./Pointer.js")),_Box=_interopRequireDefault(require("../render/Box.js")),_condition=require("../events/condition.js");function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _superPropGet(t,e,o,n){var r=_get(_getPrototypeOf(1&n?t.prototype:t),e,o);return 2&n?function(t){return r.apply(o,t)}:r}function _get(){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,o){var n=_superPropBase(t,e);if(n){var r=Object.getOwnPropertyDescriptor(n,e);return r.get?r.get.call(arguments.length<3?t:o):r.value}}).apply(null,arguments)}function _superPropBase(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=_getPrototypeOf(t)););return t}function _defineProperties(t,e){for(var o=0;o<e.length;o++){var n=e[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,_toPropertyKey(n.key),n)}}function _createClass(t,e,o){return e&&_defineProperties(t.prototype,e),o&&_defineProperties(t,o),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _callSuper(t,e,o){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,o||[],_getPrototypeOf(t).constructor):e.apply(t,o))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var DragBoxEventType={BOXSTART:"boxstart",BOXDRAG:"boxdrag",BOXEND:"boxend",BOXCANCEL:"boxcancel"},DragBoxEvent=exports.DragBoxEvent=function(t){function e(t,o,n){var r;return _classCallCheck(this,e),(r=_callSuper(this,e,[t])).coordinate=o,r.mapBrowserEvent=n,r}return _inherits(e,_Event2["default"]),_createClass(e)}(),DragBox=function(t){function e(t){var o;return _classCallCheck(this,e),(o=_callSuper(this,e)).on,o.once,o.un,t=t||{},o.box_=new _Box.default(t.className||"ol-dragbox"),o.minArea_=void 0!==t.minArea?t.minArea:64,t.onBoxEnd&&(o.onBoxEnd=t.onBoxEnd),o.startPixel_=null,o.condition_=t.condition?t.condition:_condition.mouseActionButton,o.boxEndCondition_=t.boxEndCondition?t.boxEndCondition:o.defaultBoxEndCondition,o}return _inherits(e,_Pointer["default"]),_createClass(e,[{key:"defaultBoxEndCondition",value:function(t,e,o){var n=o[0]-e[0],r=o[1]-e[1];return n*n+r*r>=this.minArea_}},{key:"getGeometry",value:function(){return this.box_.getGeometry()}},{key:"handleDragEvent",value:function(t){this.startPixel_&&(this.box_.setPixels(this.startPixel_,t.pixel),this.dispatchEvent(new DragBoxEvent(DragBoxEventType.BOXDRAG,t.coordinate,t)))}},{key:"handleUpEvent",value:function(t){if(!this.startPixel_)return!1;this.box_.setMap(null);var e=this.boxEndCondition_(t,this.startPixel_,t.pixel);return e&&this.onBoxEnd(t),this.dispatchEvent(new DragBoxEvent(e?DragBoxEventType.BOXEND:DragBoxEventType.BOXCANCEL,t.coordinate,t)),!1}},{key:"handleDownEvent",value:function(t){return!!this.condition_(t)&&(this.startPixel_=t.pixel,this.box_.setMap(t.map),this.box_.setPixels(this.startPixel_,this.startPixel_),this.dispatchEvent(new DragBoxEvent(DragBoxEventType.BOXSTART,t.coordinate,t)),!0)}},{key:"onBoxEnd",value:function(t){}},{key:"setActive",value:function(t){t||(this.box_.setMap(null),this.startPixel_&&(this.dispatchEvent(new DragBoxEvent(DragBoxEventType.BOXCANCEL,this.startPixel_,null)),this.startPixel_=null)),_superPropGet(e,"setActive",this,3)([t])}}])}(),_default=exports.default=DragBox;

},{"../events/Event.js":52,"../events/condition.js":56,"../render/Box.js":131,"./Pointer.js":105}],96:[function(require,module,exports){
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _Pointer=_interopRequireWildcard(require("./Pointer.js")),_functions=require("../functions.js"),_condition=require("../events/condition.js"),_easing=require("../easing.js"),_coordinate=require("../coordinate.js");function _getRequireWildcardCache(t){if("function"!=typeof WeakMap)return null;var e=new WeakMap,n=new WeakMap;return(_getRequireWildcardCache=function(t){return t?n:e})(t)}function _interopRequireWildcard(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!=_typeof(t)&&"function"!=typeof t)return{default:t};var n=_getRequireWildcardCache(e);if(n&&n.has(t))return n.get(t);var i={__proto__:null},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in t)if("default"!==o&&{}.hasOwnProperty.call(t,o)){var a=r?Object.getOwnPropertyDescriptor(t,o):null;a&&(a.get||a.set)?Object.defineProperty(i,o,a):i[o]=t[o]}return i.default=t,n&&n.set(t,i),i}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,_toPropertyKey(i.key),i)}}function _createClass(t,e,n){return e&&_defineProperties(t.prototype,e),n&&_defineProperties(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _callSuper(t,e,n){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,n||[],_getPrototypeOf(t).constructor):e.apply(t,n))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var DragPan=function(t){function e(t){var n;_classCallCheck(this,e),t=t||{},(n=_callSuper(this,e,[{stopDown:_functions.FALSE}])).kinetic_=t.kinetic,n.lastCentroid=null,n.lastPointersCount_,n.panning_=!1;var i=t.condition?t.condition:(0,_condition.all)(_condition.noModifierKeys,_condition.primaryAction);return n.condition_=t.onFocusOnly?(0,_condition.all)(_condition.focusWithTabindex,i):i,n.noKinetic_=!1,n}return _inherits(e,_Pointer["default"]),_createClass(e,[{key:"handleDragEvent",value:function(t){var e=t.map;this.panning_||(this.panning_=!0,e.getView().beginInteraction());var n=this.targetPointers,i=e.getEventPixel((0,_Pointer.centroid)(n));if(n.length==this.lastPointersCount_){if(this.kinetic_&&this.kinetic_.update(i[0],i[1]),this.lastCentroid){var r=[this.lastCentroid[0]-i[0],i[1]-this.lastCentroid[1]],o=t.map.getView();(0,_coordinate.scale)(r,o.getResolution()),(0,_coordinate.rotate)(r,o.getRotation()),o.adjustCenterInternal(r)}}else this.kinetic_&&this.kinetic_.begin();this.lastCentroid=i,this.lastPointersCount_=n.length,t.originalEvent.preventDefault()}},{key:"handleUpEvent",value:function(t){var e=t.map,n=e.getView();if(0===this.targetPointers.length){if(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()){var i=this.kinetic_.getDistance(),r=this.kinetic_.getAngle(),o=n.getCenterInternal(),a=e.getPixelFromCoordinateInternal(o),c=e.getCoordinateFromPixelInternal([a[0]-i*Math.cos(r),a[1]-i*Math.sin(r)]);n.animateInternal({center:n.getConstrainedCenter(c),duration:500,easing:_easing.easeOut})}return this.panning_&&(this.panning_=!1,n.endInteraction()),!1}return this.kinetic_&&this.kinetic_.begin(),this.lastCentroid=null,!0}},{key:"handleDownEvent",value:function(t){if(this.targetPointers.length>0&&this.condition_(t)){var e=t.map.getView();return this.lastCentroid=null,e.getAnimating()&&e.cancelAnimations(),this.kinetic_&&this.kinetic_.begin(),this.noKinetic_=this.targetPointers.length>1,!0}return!1}}])}(),_default=exports.default=DragPan;

},{"../coordinate.js":47,"../easing.js":50,"../events/condition.js":56,"../functions.js":62,"./Pointer.js":105}],97:[function(require,module,exports){
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _Pointer=_interopRequireDefault(require("./Pointer.js")),_functions=require("../functions.js"),_condition=require("../events/condition.js"),_rotationconstraint=require("../rotationconstraint.js");function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var o=0;o<e.length;o++){var n=e[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,_toPropertyKey(n.key),n)}}function _createClass(t,e,o){return e&&_defineProperties(t.prototype,e),o&&_defineProperties(t,o),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _callSuper(t,e,o){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,o||[],_getPrototypeOf(t).constructor):e.apply(t,o))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var DragRotate=function(t){function e(t){var o;return _classCallCheck(this,e),t=t||{},(o=_callSuper(this,e,[{stopDown:_functions.FALSE}])).condition_=t.condition?t.condition:_condition.altShiftKeysOnly,o.lastAngle_=void 0,o.duration_=void 0!==t.duration?t.duration:250,o}return _inherits(e,_Pointer["default"]),_createClass(e,[{key:"handleDragEvent",value:function(t){if((0,_condition.mouseOnly)(t)){var e=t.map,o=e.getView();if(o.getConstraints().rotation!==_rotationconstraint.disable){var n=e.getSize(),r=t.pixel,i=Math.atan2(n[1]/2-r[1],r[0]-n[0]/2);if(void 0!==this.lastAngle_){var u=i-this.lastAngle_;o.adjustRotationInternal(-u)}this.lastAngle_=i}}}},{key:"handleUpEvent",value:function(t){return!(0,_condition.mouseOnly)(t)||(t.map.getView().endInteraction(this.duration_),!1)}},{key:"handleDownEvent",value:function(t){return!!(0,_condition.mouseOnly)(t)&&(!(!(0,_condition.mouseActionButton)(t)||!this.condition_(t))&&(t.map.getView().beginInteraction(),this.lastAngle_=void 0,!0))}}])}(),_default=exports.default=DragRotate;

},{"../events/condition.js":56,"../functions.js":62,"../rotationconstraint.js":166,"./Pointer.js":105}],98:[function(require,module,exports){
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _DragBox2=_interopRequireDefault(require("./DragBox.js")),_easing=require("../easing.js"),_condition=require("../events/condition.js");function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var o=0;o<e.length;o++){var r=e[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,_toPropertyKey(r.key),r)}}function _createClass(t,e,o){return e&&_defineProperties(t.prototype,e),o&&_defineProperties(t,o),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var r=o.call(t,e||"default");if("object"!=_typeof(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _callSuper(t,e,o){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,o||[],_getPrototypeOf(t).constructor):e.apply(t,o))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var DragZoom=function(t){function e(t){var o;return _classCallCheck(this,e),(o=_callSuper(this,e,[{condition:(t=t||{}).condition?t.condition:_condition.shiftKeyOnly,className:t.className||"ol-dragzoom",minArea:t.minArea}])).duration_=void 0!==t.duration?t.duration:200,o.out_=void 0!==t.out&&t.out,o}return _inherits(e,_DragBox2["default"]),_createClass(e,[{key:"onBoxEnd",value:function(t){var e=this.getMap().getView(),o=this.getGeometry();if(this.out_){var r=e.rotatedExtentForGeometry(o),n=e.getResolutionForExtentInternal(r),i=e.getResolution()/n;(o=o.clone()).scale(i*i)}e.fitInternal(o,{duration:this.duration_,easing:_easing.easeOut})}}])}(),_default=exports.default=DragZoom;

},{"../easing.js":50,"../events/condition.js":56,"./DragBox.js":95}],99:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0,exports.pan=pan,exports.zoomByDelta=zoomByDelta;var _Object=_interopRequireDefault(require("../Object.js")),_Property=_interopRequireDefault(require("./Property.js")),_easing=require("../easing.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var Interaction=function(e){function t(e){var r;return _classCallCheck(this,t),(r=_callSuper(this,t)).on,r.once,r.un,e&&e.handleEvent&&(r.handleEvent=e.handleEvent),r.map_=null,r.setActive(!0),r}return _inherits(t,_Object["default"]),_createClass(t,[{key:"getActive",value:function(){return this.get(_Property.default.ACTIVE)}},{key:"getMap",value:function(){return this.map_}},{key:"handleEvent",value:function(e){return!0}},{key:"setActive",value:function(e){this.set(_Property.default.ACTIVE,e)}},{key:"setMap",value:function(e){this.map_=e}}])}();function pan(e,t,r){var o=e.getCenterInternal();if(o){var n=[o[0]+t[0],o[1]+t[1]];e.animateInternal({duration:void 0!==r?r:250,easing:_easing.linear,center:e.getConstrainedCenter(n)})}}function zoomByDelta(e,t,r,o){var n=e.getZoom();if(void 0!==n){var i=e.getConstrainedZoom(n+t),u=e.getResolutionForZoom(i);e.getAnimating()&&e.cancelAnimations(),e.animate({resolution:u,anchor:r,duration:void 0!==o?o:250,easing:_easing.easeOut})}}var _default=exports.default=Interaction;

},{"../Object.js":25,"../easing.js":50,"./Property.js":106}],100:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _EventType=_interopRequireDefault(require("../events/EventType.js")),_Interaction2=_interopRequireWildcard(require("./Interaction.js")),_Key=_interopRequireDefault(require("../events/Key.js")),_condition=require("../events/condition.js"),_coordinate=require("../coordinate.js");function _getRequireWildcardCache(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(_getRequireWildcardCache=function(e){return e?r:t})(e)}function _interopRequireWildcard(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=_typeof(e)&&"function"!=typeof e)return{default:e};var r=_getRequireWildcardCache(t);if(r&&r.has(e))return r.get(e);var o={__proto__:null},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&{}.hasOwnProperty.call(e,i)){var u=n?Object.getOwnPropertyDescriptor(e,i):null;u&&(u.get||u.set)?Object.defineProperty(o,i,u):o[i]=e[i]}return o.default=e,r&&r.set(e,o),o}function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var KeyboardPan=function(e){function t(e){var r;return _classCallCheck(this,t),e=e||{},(r=_callSuper(this,t)).defaultCondition_=function(e){return(0,_condition.noModifierKeys)(e)&&(0,_condition.targetNotEditable)(e)},r.condition_=void 0!==e.condition?e.condition:r.defaultCondition_,r.duration_=void 0!==e.duration?e.duration:100,r.pixelDelta_=void 0!==e.pixelDelta?e.pixelDelta:128,r}return _inherits(t,_Interaction2["default"]),_createClass(t,[{key:"handleEvent",value:function(e){var t=!1;if(e.type==_EventType.default.KEYDOWN){var r=e.originalEvent,o=r.key;if(this.condition_(e)&&(o==_Key.default.DOWN||o==_Key.default.LEFT||o==_Key.default.RIGHT||o==_Key.default.UP)){var n=e.map.getView(),i=n.getResolution()*this.pixelDelta_,u=0,a=0;o==_Key.default.DOWN?a=-i:o==_Key.default.LEFT?u=-i:o==_Key.default.RIGHT?u=i:a=i;var f=[u,a];(0,_coordinate.rotate)(f,n.getRotation()),(0,_Interaction2.pan)(n,f,this.duration_),r.preventDefault(),t=!0}}return!t}}])}(),_default=exports.default=KeyboardPan;

},{"../coordinate.js":47,"../events/EventType.js":53,"../events/Key.js":54,"../events/condition.js":56,"./Interaction.js":99}],101:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _EventType=_interopRequireDefault(require("../events/EventType.js")),_Interaction2=_interopRequireWildcard(require("./Interaction.js")),_condition=require("../events/condition.js");function _getRequireWildcardCache(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(_getRequireWildcardCache=function(e){return e?r:t})(e)}function _interopRequireWildcard(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=_typeof(e)&&"function"!=typeof e)return{default:e};var r=_getRequireWildcardCache(t);if(r&&r.has(e))return r.get(e);var o={__proto__:null},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&{}.hasOwnProperty.call(e,i)){var u=n?Object.getOwnPropertyDescriptor(e,i):null;u&&(u.get||u.set)?Object.defineProperty(o,i,u):o[i]=e[i]}return o.default=e,r&&r.set(e,o),o}function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var KeyboardZoom=function(e){function t(e){var r;return _classCallCheck(this,t),e=e||{},(r=_callSuper(this,t)).condition_=e.condition?e.condition:function(e){return!(0,_condition.platformModifierKey)(e)&&(0,_condition.targetNotEditable)(e)},r.delta_=e.delta?e.delta:1,r.duration_=void 0!==e.duration?e.duration:100,r}return _inherits(t,_Interaction2["default"]),_createClass(t,[{key:"handleEvent",value:function(e){var t=!1;if(e.type==_EventType.default.KEYDOWN||e.type==_EventType.default.KEYPRESS){var r=e.originalEvent,o=r.key;if(this.condition_(e)&&("+"===o||"-"===o)){var n=e.map,i="+"===o?this.delta_:-this.delta_,u=n.getView();(0,_Interaction2.zoomByDelta)(u,i,void 0,this.duration_),r.preventDefault(),t=!0}}return!t}}])}(),_default=exports.default=KeyboardZoom;

},{"../events/EventType.js":53,"../events/condition.js":56,"./Interaction.js":99}],102:[function(require,module,exports){
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _EventType=_interopRequireDefault(require("../events/EventType.js")),_Interaction2=_interopRequireWildcard(require("./Interaction.js")),_has=require("../has.js"),_condition=require("../events/condition.js"),_math=require("../math.js");function _getRequireWildcardCache(t){if("function"!=typeof WeakMap)return null;var e=new WeakMap,o=new WeakMap;return(_getRequireWildcardCache=function(t){return t?o:e})(t)}function _interopRequireWildcard(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!=_typeof(t)&&"function"!=typeof t)return{default:t};var o=_getRequireWildcardCache(e);if(o&&o.has(t))return o.get(t);var r={__proto__:null},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var n in t)if("default"!==n&&{}.hasOwnProperty.call(t,n)){var a=i?Object.getOwnPropertyDescriptor(t,n):null;a&&(a.get||a.set)?Object.defineProperty(r,n,a):r[n]=t[n]}return r.default=t,o&&o.set(t,r),r}function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var o=0;o<e.length;o++){var r=e[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,_toPropertyKey(r.key),r)}}function _createClass(t,e,o){return e&&_defineProperties(t.prototype,e),o&&_defineProperties(t,o),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var r=o.call(t,e||"default");if("object"!=_typeof(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _callSuper(t,e,o){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,o||[],_getPrototypeOf(t).constructor):e.apply(t,o))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var MouseWheelZoom=function(t){function e(t){var o;_classCallCheck(this,e),(o=_callSuper(this,e,[t=t||{}])).totalDelta_=0,o.lastDelta_=0,o.maxDelta_=void 0!==t.maxDelta?t.maxDelta:1,o.duration_=void 0!==t.duration?t.duration:250,o.timeout_=void 0!==t.timeout?t.timeout:80,o.useAnchor_=void 0===t.useAnchor||t.useAnchor,o.constrainResolution_=void 0!==t.constrainResolution&&t.constrainResolution;var r=t.condition?t.condition:_condition.always;return o.condition_=t.onFocusOnly?(0,_condition.all)(_condition.focusWithTabindex,r):r,o.lastAnchor_=null,o.startTime_=void 0,o.timeoutId_,o.mode_=void 0,o.trackpadEventGap_=400,o.trackpadTimeoutId_,o.deltaPerZoom_=300,o}return _inherits(e,_Interaction2["default"]),_createClass(e,[{key:"endInteraction_",value:function(){this.trackpadTimeoutId_=void 0;var t=this.getMap();t&&t.getView().endInteraction(void 0,this.lastDelta_?this.lastDelta_>0?1:-1:0,this.lastAnchor_)}},{key:"handleEvent",value:function(t){if(!this.condition_(t))return!0;if(t.type!==_EventType.default.WHEEL)return!0;var e,o=t.map,r=t.originalEvent;if(r.preventDefault(),this.useAnchor_&&(this.lastAnchor_=t.coordinate),t.type==_EventType.default.WHEEL&&(e=r.deltaY,_has.FIREFOX&&r.deltaMode===WheelEvent.DOM_DELTA_PIXEL&&(e/=_has.DEVICE_PIXEL_RATIO),r.deltaMode===WheelEvent.DOM_DELTA_LINE&&(e*=40)),0===e)return!1;this.lastDelta_=e;var i=Date.now();void 0===this.startTime_&&(this.startTime_=i),(!this.mode_||i-this.startTime_>this.trackpadEventGap_)&&(this.mode_=Math.abs(e)<4?"trackpad":"wheel");var n=o.getView();if("trackpad"===this.mode_&&!n.getConstrainResolution()&&!this.constrainResolution_)return this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):(n.getAnimating()&&n.cancelAnimations(),n.beginInteraction()),this.trackpadTimeoutId_=setTimeout(this.endInteraction_.bind(this),this.timeout_),n.adjustZoom(-e/this.deltaPerZoom_,this.lastAnchor_),this.startTime_=i,!1;this.totalDelta_+=e;var a=Math.max(this.timeout_-(i-this.startTime_),0);return clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,o),a),!1}},{key:"handleWheelZoom_",value:function(t){var e=t.getView();e.getAnimating()&&e.cancelAnimations();var o=-(0,_math.clamp)(this.totalDelta_,-this.maxDelta_*this.deltaPerZoom_,this.maxDelta_*this.deltaPerZoom_)/this.deltaPerZoom_;(e.getConstrainResolution()||this.constrainResolution_)&&(o=o?o>0?1:-1:0),(0,_Interaction2.zoomByDelta)(e,o,this.lastAnchor_,this.duration_),this.mode_=void 0,this.totalDelta_=0,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0}},{key:"setMouseAnchor",value:function(t){this.useAnchor_=t,t||(this.lastAnchor_=null)}}])}(),_default=exports.default=MouseWheelZoom;

},{"../events/EventType.js":53,"../events/condition.js":56,"../has.js":93,"../math.js":120,"./Interaction.js":99}],103:[function(require,module,exports){
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _Pointer=_interopRequireWildcard(require("./Pointer.js")),_functions=require("../functions.js"),_rotationconstraint=require("../rotationconstraint.js");function _getRequireWildcardCache(t){if("function"!=typeof WeakMap)return null;var e=new WeakMap,r=new WeakMap;return(_getRequireWildcardCache=function(t){return t?r:e})(t)}function _interopRequireWildcard(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!=_typeof(t)&&"function"!=typeof t)return{default:t};var r=_getRequireWildcardCache(e);if(r&&r.has(t))return r.get(t);var n={__proto__:null},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in t)if("default"!==i&&{}.hasOwnProperty.call(t,i)){var a=o?Object.getOwnPropertyDescriptor(t,i):null;a&&(a.get||a.set)?Object.defineProperty(n,i,a):n[i]=t[i]}return n.default=t,r&&r.set(t,n),n}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,_toPropertyKey(n.key),n)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _callSuper(t,e,r){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,r||[],_getPrototypeOf(t).constructor):e.apply(t,r))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var PinchRotate=function(t){function e(t){var r;_classCallCheck(this,e);var n=t=t||{};return n.stopDown||(n.stopDown=_functions.FALSE),(r=_callSuper(this,e,[n])).anchor_=null,r.lastAngle_=void 0,r.rotating_=!1,r.rotationDelta_=0,r.threshold_=void 0!==t.threshold?t.threshold:.3,r.duration_=void 0!==t.duration?t.duration:250,r}return _inherits(e,_Pointer["default"]),_createClass(e,[{key:"handleDragEvent",value:function(t){var e=0,r=this.targetPointers[0],n=this.targetPointers[1],o=Math.atan2(n.clientY-r.clientY,n.clientX-r.clientX);if(void 0!==this.lastAngle_){var i=o-this.lastAngle_;this.rotationDelta_+=i,!this.rotating_&&Math.abs(this.rotationDelta_)>this.threshold_&&(this.rotating_=!0),e=i}this.lastAngle_=o;var a=t.map,u=a.getView();u.getConstraints().rotation!==_rotationconstraint.disable&&(this.anchor_=a.getCoordinateFromPixelInternal(a.getEventPixel((0,_Pointer.centroid)(this.targetPointers))),this.rotating_&&(a.render(),u.adjustRotationInternal(e,this.anchor_)))}},{key:"handleUpEvent",value:function(t){return!(this.targetPointers.length<2)||(t.map.getView().endInteraction(this.duration_),!1)}},{key:"handleDownEvent",value:function(t){if(this.targetPointers.length>=2){var e=t.map;return this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.handlingDownUpSequence||e.getView().beginInteraction(),!0}return!1}}])}(),_default=exports.default=PinchRotate;

},{"../functions.js":62,"../rotationconstraint.js":166,"./Pointer.js":105}],104:[function(require,module,exports){
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _Pointer=_interopRequireWildcard(require("./Pointer.js")),_functions=require("../functions.js");function _getRequireWildcardCache(t){if("function"!=typeof WeakMap)return null;var e=new WeakMap,r=new WeakMap;return(_getRequireWildcardCache=function(t){return t?r:e})(t)}function _interopRequireWildcard(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!=_typeof(t)&&"function"!=typeof t)return{default:t};var r=_getRequireWildcardCache(e);if(r&&r.has(t))return r.get(t);var n={__proto__:null},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in t)if("default"!==i&&{}.hasOwnProperty.call(t,i)){var a=o?Object.getOwnPropertyDescriptor(t,i):null;a&&(a.get||a.set)?Object.defineProperty(n,i,a):n[i]=t[i]}return n.default=t,r&&r.set(t,n),n}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,_toPropertyKey(n.key),n)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _callSuper(t,e,r){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,r||[],_getPrototypeOf(t).constructor):e.apply(t,r))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var PinchZoom=function(t){function e(t){var r;_classCallCheck(this,e);var n=t=t||{};return n.stopDown||(n.stopDown=_functions.FALSE),(r=_callSuper(this,e,[n])).anchor_=null,r.duration_=void 0!==t.duration?t.duration:400,r.lastDistance_=void 0,r.lastScaleDelta_=1,r}return _inherits(e,_Pointer["default"]),_createClass(e,[{key:"handleDragEvent",value:function(t){var e=1,r=this.targetPointers[0],n=this.targetPointers[1],o=r.clientX-n.clientX,i=r.clientY-n.clientY,a=Math.sqrt(o*o+i*i);void 0!==this.lastDistance_&&(e=this.lastDistance_/a),this.lastDistance_=a;var u=t.map,c=u.getView();1!=e&&(this.lastScaleDelta_=e),this.anchor_=u.getCoordinateFromPixelInternal(u.getEventPixel((0,_Pointer.centroid)(this.targetPointers))),u.render(),c.adjustResolutionInternal(e,this.anchor_)}},{key:"handleUpEvent",value:function(t){if(this.targetPointers.length<2){var e=t.map.getView(),r=this.lastScaleDelta_>1?1:-1;return e.endInteraction(this.duration_,r),!1}return!0}},{key:"handleDownEvent",value:function(t){if(this.targetPointers.length>=2){var e=t.map;return this.anchor_=null,this.lastDistance_=void 0,this.lastScaleDelta_=1,this.handlingDownUpSequence||e.getView().beginInteraction(),!0}return!1}}])}(),_default=exports.default=PinchZoom;

},{"../functions.js":62,"./Pointer.js":105}],105:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.centroid=centroid,exports.default=void 0;var _Interaction2=_interopRequireDefault(require("./Interaction.js")),_MapBrowserEventType=_interopRequireDefault(require("../MapBrowserEventType.js"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,_toPropertyKey(r.key),r)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=_typeof(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,n){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,n||[],_getPrototypeOf(e).constructor):t.apply(e,n))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var PointerInteraction=function(e){function t(e){var n;return _classCallCheck(this,t),n=_callSuper(this,t,[e=e||{}]),e.handleDownEvent&&(n.handleDownEvent=e.handleDownEvent),e.handleDragEvent&&(n.handleDragEvent=e.handleDragEvent),e.handleMoveEvent&&(n.handleMoveEvent=e.handleMoveEvent),e.handleUpEvent&&(n.handleUpEvent=e.handleUpEvent),e.stopDown&&(n.stopDown=e.stopDown),n.handlingDownUpSequence=!1,n.targetPointers=[],n}return _inherits(t,_Interaction2["default"]),_createClass(t,[{key:"getPointerCount",value:function(){return this.targetPointers.length}},{key:"handleDownEvent",value:function(e){return!1}},{key:"handleDragEvent",value:function(e){}},{key:"handleEvent",value:function(e){if(!e.originalEvent)return!0;var t=!1;if(this.updateTrackedPointers_(e),this.handlingDownUpSequence){if(e.type==_MapBrowserEventType.default.POINTERDRAG)this.handleDragEvent(e),e.originalEvent.preventDefault();else if(e.type==_MapBrowserEventType.default.POINTERUP){var n=this.handleUpEvent(e);this.handlingDownUpSequence=n&&this.targetPointers.length>0}}else if(e.type==_MapBrowserEventType.default.POINTERDOWN){var r=this.handleDownEvent(e);this.handlingDownUpSequence=r,t=this.stopDown(r)}else e.type==_MapBrowserEventType.default.POINTERMOVE&&this.handleMoveEvent(e);return!t}},{key:"handleMoveEvent",value:function(e){}},{key:"handleUpEvent",value:function(e){return!1}},{key:"stopDown",value:function(e){return e}},{key:"updateTrackedPointers_",value:function(e){e.activePointers&&(this.targetPointers=e.activePointers)}}])}();function centroid(e){for(var t=e.length,n=0,r=0,o=0;o<t;o++)n+=e[o].clientX,r+=e[o].clientY;return{clientX:n/t,clientY:r/t}}var _default=exports.default=PointerInteraction;

},{"../MapBrowserEventType.js":21,"./Interaction.js":99}],106:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _default=exports.default={ACTIVE:"active"};

},{}],107:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.defaults=defaults;var _Collection=_interopRequireDefault(require("../Collection.js")),_DoubleClickZoom=_interopRequireDefault(require("./DoubleClickZoom.js")),_DragPan=_interopRequireDefault(require("./DragPan.js")),_DragRotate=_interopRequireDefault(require("./DragRotate.js")),_DragZoom=_interopRequireDefault(require("./DragZoom.js")),_KeyboardPan=_interopRequireDefault(require("./KeyboardPan.js")),_KeyboardZoom=_interopRequireDefault(require("./KeyboardZoom.js")),_Kinetic=_interopRequireDefault(require("../Kinetic.js")),_MouseWheelZoom=_interopRequireDefault(require("./MouseWheelZoom.js")),_PinchRotate=_interopRequireDefault(require("./PinchRotate.js")),_PinchZoom=_interopRequireDefault(require("./PinchZoom.js"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function defaults(e){e=e||{};var o=new _Collection.default,t=new _Kinetic.default(-.005,.05,100);return(void 0===e.altShiftDragRotate||e.altShiftDragRotate)&&o.push(new _DragRotate.default),(void 0===e.doubleClickZoom||e.doubleClickZoom)&&o.push(new _DoubleClickZoom.default({delta:e.zoomDelta,duration:e.zoomDuration})),(void 0===e.dragPan||e.dragPan)&&o.push(new _DragPan.default({onFocusOnly:e.onFocusOnly,kinetic:t})),(void 0===e.pinchRotate||e.pinchRotate)&&o.push(new _PinchRotate.default),(void 0===e.pinchZoom||e.pinchZoom)&&o.push(new _PinchZoom.default({duration:e.zoomDuration})),(void 0===e.keyboard||e.keyboard)&&(o.push(new _KeyboardPan.default),o.push(new _KeyboardZoom.default({delta:e.zoomDelta,duration:e.zoomDuration}))),(void 0===e.mouseWheelZoom||e.mouseWheelZoom)&&o.push(new _MouseWheelZoom.default({onFocusOnly:e.onFocusOnly,duration:e.zoomDuration})),(void 0===e.shiftDragZoom||e.shiftDragZoom)&&o.push(new _DragZoom.default({duration:e.zoomDuration})),o}

},{"../Collection.js":9,"../Kinetic.js":17,"./DoubleClickZoom.js":94,"./DragPan.js":96,"./DragRotate.js":97,"./DragZoom.js":98,"./KeyboardPan.js":100,"./KeyboardZoom.js":101,"./MouseWheelZoom.js":102,"./PinchRotate.js":103,"./PinchZoom.js":104}],108:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _Object=_interopRequireDefault(require("../Object.js")),_Property=_interopRequireDefault(require("./Property.js")),_util=require("../util.js"),_asserts=require("../asserts.js"),_math=require("../math.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _superPropGet(e,t,r,o){var n=_get(_getPrototypeOf(1&o?e.prototype:e),t,r);return 2&o?function(e){return n.apply(r,e)}:n}function _get(){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var o=_superPropBase(e,t);if(o){var n=Object.getOwnPropertyDescriptor(o,t);return n.get?n.get.call(arguments.length<3?e:r):n.value}}).apply(null,arguments)}function _superPropBase(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf(e)););return e}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var BaseLayer=function(e){function t(e){var r;_classCallCheck(this,t),(r=_callSuper(this,t)).on,r.once,r.un,r.background_=e.background;var o=Object.assign({},e);return"object"===_typeof(e.properties)&&(delete o.properties,Object.assign(o,e.properties)),o[_Property.default.OPACITY]=void 0!==e.opacity?e.opacity:1,(0,_asserts.assert)("number"==typeof o[_Property.default.OPACITY],"Layer opacity must be a number"),o[_Property.default.VISIBLE]=void 0===e.visible||e.visible,o[_Property.default.Z_INDEX]=e.zIndex,o[_Property.default.MAX_RESOLUTION]=void 0!==e.maxResolution?e.maxResolution:1/0,o[_Property.default.MIN_RESOLUTION]=void 0!==e.minResolution?e.minResolution:0,o[_Property.default.MIN_ZOOM]=void 0!==e.minZoom?e.minZoom:-1/0,o[_Property.default.MAX_ZOOM]=void 0!==e.maxZoom?e.maxZoom:1/0,r.className_=void 0!==o.className?o.className:"ol-layer",delete o.className,r.setProperties(o),r.state_=null,r}return _inherits(t,_Object["default"]),_createClass(t,[{key:"getBackground",value:function(){return this.background_}},{key:"getClassName",value:function(){return this.className_}},{key:"getLayerState",value:function(e){var t=this.state_||{layer:this,managed:void 0===e||e},r=this.getZIndex();return t.opacity=(0,_math.clamp)(Math.round(100*this.getOpacity())/100,0,1),t.visible=this.getVisible(),t.extent=this.getExtent(),t.zIndex=void 0!==r||t.managed?r:1/0,t.maxResolution=this.getMaxResolution(),t.minResolution=Math.max(this.getMinResolution(),0),t.minZoom=this.getMinZoom(),t.maxZoom=this.getMaxZoom(),this.state_=t,t}},{key:"getLayersArray",value:function(e){return(0,_util.abstract)()}},{key:"getLayerStatesArray",value:function(e){return(0,_util.abstract)()}},{key:"getExtent",value:function(){return this.get(_Property.default.EXTENT)}},{key:"getMaxResolution",value:function(){return this.get(_Property.default.MAX_RESOLUTION)}},{key:"getMinResolution",value:function(){return this.get(_Property.default.MIN_RESOLUTION)}},{key:"getMinZoom",value:function(){return this.get(_Property.default.MIN_ZOOM)}},{key:"getMaxZoom",value:function(){return this.get(_Property.default.MAX_ZOOM)}},{key:"getOpacity",value:function(){return this.get(_Property.default.OPACITY)}},{key:"getSourceState",value:function(){return(0,_util.abstract)()}},{key:"getVisible",value:function(){return this.get(_Property.default.VISIBLE)}},{key:"getZIndex",value:function(){return this.get(_Property.default.Z_INDEX)}},{key:"setBackground",value:function(e){this.background_=e,this.changed()}},{key:"setExtent",value:function(e){this.set(_Property.default.EXTENT,e)}},{key:"setMaxResolution",value:function(e){this.set(_Property.default.MAX_RESOLUTION,e)}},{key:"setMinResolution",value:function(e){this.set(_Property.default.MIN_RESOLUTION,e)}},{key:"setMaxZoom",value:function(e){this.set(_Property.default.MAX_ZOOM,e)}},{key:"setMinZoom",value:function(e){this.set(_Property.default.MIN_ZOOM,e)}},{key:"setOpacity",value:function(e){(0,_asserts.assert)("number"==typeof e,"Layer opacity must be a number"),this.set(_Property.default.OPACITY,e)}},{key:"setVisible",value:function(e){this.set(_Property.default.VISIBLE,e)}},{key:"setZIndex",value:function(e){this.set(_Property.default.Z_INDEX,e)}},{key:"disposeInternal",value:function(){this.state_&&(this.state_.layer=null,this.state_=null),_superPropGet(t,"disposeInternal",this,3)([])}}])}(),_default=exports.default=BaseLayer;

},{"../Object.js":25,"../asserts.js":37,"../math.js":120,"../util.js":205,"./Property.js":115}],109:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _Layer2=_interopRequireDefault(require("./Layer.js"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var BaseImageLayer=function(e){function t(e){return _classCallCheck(this,t),_callSuper(this,t,[e=e||{}])}return _inherits(t,_Layer2["default"]),_createClass(t)}(),_default=exports.default=BaseImageLayer;

},{"./Layer.js":114}],110:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _Layer2=_interopRequireDefault(require("./Layer.js")),_TileProperty=_interopRequireDefault(require("./TileProperty.js"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _superPropGet(e,t,r,o){var n=_get(_getPrototypeOf(1&o?e.prototype:e),t,r);return 2&o?function(e){return n.apply(r,e)}:n}function _get(){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var o=_superPropBase(e,t);if(o){var n=Object.getOwnPropertyDescriptor(o,t);return n.get?n.get.call(arguments.length<3?e:r):n.value}}).apply(null,arguments)}function _superPropBase(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf(e)););return e}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var BaseTileLayer=function(e){function t(e){var r;_classCallCheck(this,t),e=e||{};var o=Object.assign({},e),n=e.cacheSize;return delete e.cacheSize,delete o.preload,delete o.useInterimTilesOnError,(r=_callSuper(this,t,[o])).on,r.once,r.un,r.cacheSize_=n,r.setPreload(void 0!==e.preload?e.preload:0),r.setUseInterimTilesOnError(void 0===e.useInterimTilesOnError||e.useInterimTilesOnError),r}return _inherits(t,_Layer2["default"]),_createClass(t,[{key:"getCacheSize",value:function(){return this.cacheSize_}},{key:"getPreload",value:function(){return this.get(_TileProperty.default.PRELOAD)}},{key:"setPreload",value:function(e){this.set(_TileProperty.default.PRELOAD,e)}},{key:"getUseInterimTilesOnError",value:function(){return this.get(_TileProperty.default.USE_INTERIM_TILES_ON_ERROR)}},{key:"setUseInterimTilesOnError",value:function(e){this.set(_TileProperty.default.USE_INTERIM_TILES_ON_ERROR,e)}},{key:"getData",value:function(e){return _superPropGet(t,"getData",this,3)([e])}}])}(),_default=exports.default=BaseTileLayer;

},{"./Layer.js":114,"./TileProperty.js":117}],111:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _Layer2=_interopRequireDefault(require("./Layer.js")),_rbush=_interopRequireDefault(require("rbush")),_Style=_interopRequireWildcard(require("../style/Style.js")),_style=require("../render/canvas/style.js");function _getRequireWildcardCache(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(_getRequireWildcardCache=function(e){return e?r:t})(e)}function _interopRequireWildcard(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=_typeof(e)&&"function"!=typeof e)return{default:e};var r=_getRequireWildcardCache(t);if(r&&r.has(e))return r.get(e);var n={__proto__:null},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&{}.hasOwnProperty.call(e,i)){var u=o?Object.getOwnPropertyDescriptor(e,i):null;u&&(u.get||u.set)?Object.defineProperty(n,i,u):n[i]=e[i]}return n.default=e,r&&r.set(e,n),n}function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey(n.key),n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _superPropGet(e,t,r,n){var o=_get(_getPrototypeOf(1&n?e.prototype:e),t,r);return 2&n?function(e){return o.apply(r,e)}:o}function _get(){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=_superPropBase(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}}).apply(null,arguments)}function _superPropBase(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf(e)););return e}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var Property={RENDER_ORDER:"renderOrder"},BaseVectorLayer=function(e){function t(e){var r;_classCallCheck(this,t),e=e||{};var n=Object.assign({},e);return delete n.style,delete n.renderBuffer,delete n.updateWhileAnimating,delete n.updateWhileInteracting,(r=_callSuper(this,t,[n])).declutter_=e.declutter?String(e.declutter):void 0,r.renderBuffer_=void 0!==e.renderBuffer?e.renderBuffer:100,r.style_=null,r.styleFunction_=void 0,r.setStyle(e.style),r.updateWhileAnimating_=void 0!==e.updateWhileAnimating&&e.updateWhileAnimating,r.updateWhileInteracting_=void 0!==e.updateWhileInteracting&&e.updateWhileInteracting,r}return _inherits(t,_Layer2["default"]),_createClass(t,[{key:"getDeclutter",value:function(){return this.declutter_}},{key:"getFeatures",value:function(e){return _superPropGet(t,"getFeatures",this,3)([e])}},{key:"getRenderBuffer",value:function(){return this.renderBuffer_}},{key:"getRenderOrder",value:function(){return this.get(Property.RENDER_ORDER)}},{key:"getStyle",value:function(){return this.style_}},{key:"getStyleFunction",value:function(){return this.styleFunction_}},{key:"getUpdateWhileAnimating",value:function(){return this.updateWhileAnimating_}},{key:"getUpdateWhileInteracting",value:function(){return this.updateWhileInteracting_}},{key:"renderDeclutter",value:function(e,t){var r=this.getDeclutter();r in e.declutter==!1&&(e.declutter[r]=new _rbush.default(9)),this.getRenderer().renderDeclutter(e,t)}},{key:"setRenderOrder",value:function(e){this.set(Property.RENDER_ORDER,e)}},{key:"setStyle",value:function(e){this.style_=void 0===e?_Style.createDefaultStyle:e;var t=toStyleLike(e);this.styleFunction_=null===e?void 0:(0,_Style.toFunction)(t),this.changed()}}])}();function toStyleLike(e){if(void 0===e)return _Style.createDefaultStyle;if(!e)return null;if("function"==typeof e)return e;if(e instanceof _Style.default)return e;if(!Array.isArray(e))return(0,_style.flatStylesToStyleFunction)([e]);if(0===e.length)return[];var t=e.length,r=e[0];if(r instanceof _Style.default){for(var n=new Array(t),o=0;o<t;++o){var i=e[o];if(!(i instanceof _Style.default))throw new Error("Expected a list of style instances");n[o]=i}return n}if("style"in r){for(var u=new Array(t),l=0;l<t;++l){var a=e[l];if(!("style"in a))throw new Error("Expected a list of rules with a style property");u[l]=a}return(0,_style.rulesToStyleFunction)(u)}var f=e;return(0,_style.flatStylesToStyleFunction)(f)}var _default=exports.default=BaseVectorLayer;

},{"../render/canvas/style.js":149,"../style/Style.js":195,"./Layer.js":114,"rbush":207}],112:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=exports.GroupEvent=void 0;var _Base=_interopRequireDefault(require("./Base.js")),_Collection=_interopRequireDefault(require("../Collection.js")),_CollectionEventType=_interopRequireDefault(require("../CollectionEventType.js")),_Event2=_interopRequireDefault(require("../events/Event.js")),_EventType=_interopRequireDefault(require("../events/EventType.js")),_ObjectEventType=_interopRequireDefault(require("../ObjectEventType.js")),_asserts=require("../asserts.js"),_obj=require("../obj.js"),_extent=require("../extent.js"),_util=require("../util.js"),_events=require("../events.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey(n.key),n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var GroupEvent=exports.GroupEvent=function(e){function t(e,r){var n;return _classCallCheck(this,t),(n=_callSuper(this,t,[e])).layer=r,n}return _inherits(t,_Event2["default"]),_createClass(t)}(),Property={LAYERS:"layers"},LayerGroup=function(e){function t(e){var r;_classCallCheck(this,t),e=e||{};var n=Object.assign({},e);delete n.layers;var o=e.layers;return(r=_callSuper(this,t,[n])).on,r.once,r.un,r.layersListenerKeys_=[],r.listenerKeys_={},r.addChangeListener(Property.LAYERS,r.handleLayersChanged_),o?Array.isArray(o)?o=new _Collection.default(o.slice(),{unique:!0}):(0,_asserts.assert)("function"==typeof o.getArray,"Expected `layers` to be an array or a `Collection`"):o=new _Collection.default(void 0,{unique:!0}),r.setLayers(o),r}return _inherits(t,_Base["default"]),_createClass(t,[{key:"handleLayerChange_",value:function(){this.changed()}},{key:"handleLayersChanged_",value:function(){this.layersListenerKeys_.forEach(_events.unlistenByKey),this.layersListenerKeys_.length=0;var e=this.getLayers();for(var t in this.layersListenerKeys_.push((0,_events.listen)(e,_CollectionEventType.default.ADD,this.handleLayersAdd_,this),(0,_events.listen)(e,_CollectionEventType.default.REMOVE,this.handleLayersRemove_,this)),this.listenerKeys_)this.listenerKeys_[t].forEach(_events.unlistenByKey);(0,_obj.clear)(this.listenerKeys_);for(var r=e.getArray(),n=0,o=r.length;n<o;n++){var i=r[n];this.registerLayerListeners_(i),this.dispatchEvent(new GroupEvent("addlayer",i))}this.changed()}},{key:"registerLayerListeners_",value:function(e){var r=[(0,_events.listen)(e,_ObjectEventType.default.PROPERTYCHANGE,this.handleLayerChange_,this),(0,_events.listen)(e,_EventType.default.CHANGE,this.handleLayerChange_,this)];e instanceof t&&r.push((0,_events.listen)(e,"addlayer",this.handleLayerGroupAdd_,this),(0,_events.listen)(e,"removelayer",this.handleLayerGroupRemove_,this)),this.listenerKeys_[(0,_util.getUid)(e)]=r}},{key:"handleLayerGroupAdd_",value:function(e){this.dispatchEvent(new GroupEvent("addlayer",e.layer))}},{key:"handleLayerGroupRemove_",value:function(e){this.dispatchEvent(new GroupEvent("removelayer",e.layer))}},{key:"handleLayersAdd_",value:function(e){var t=e.element;this.registerLayerListeners_(t),this.dispatchEvent(new GroupEvent("addlayer",t)),this.changed()}},{key:"handleLayersRemove_",value:function(e){var t=e.element,r=(0,_util.getUid)(t);this.listenerKeys_[r].forEach(_events.unlistenByKey),delete this.listenerKeys_[r],this.dispatchEvent(new GroupEvent("removelayer",t)),this.changed()}},{key:"getLayers",value:function(){return this.get(Property.LAYERS)}},{key:"setLayers",value:function(e){var t=this.getLayers();if(t)for(var r=t.getArray(),n=0,o=r.length;n<o;++n)this.dispatchEvent(new GroupEvent("removelayer",r[n]));this.set(Property.LAYERS,e)}},{key:"getLayersArray",value:function(e){return e=void 0!==e?e:[],this.getLayers().forEach(function(t){t.getLayersArray(e)}),e}},{key:"getLayerStatesArray",value:function(e){var t=void 0!==e?e:[],r=t.length;this.getLayers().forEach(function(e){e.getLayerStatesArray(t)});var n=this.getLayerState(),o=n.zIndex;e||void 0!==n.zIndex||(o=0);for(var i=r,s=t.length;i<s;i++){var a=t[i];a.opacity*=n.opacity,a.visible=a.visible&&n.visible,a.maxResolution=Math.min(a.maxResolution,n.maxResolution),a.minResolution=Math.max(a.minResolution,n.minResolution),a.minZoom=Math.max(a.minZoom,n.minZoom),a.maxZoom=Math.min(a.maxZoom,n.maxZoom),void 0!==n.extent&&(void 0!==a.extent?a.extent=(0,_extent.getIntersection)(a.extent,n.extent):a.extent=n.extent),void 0===a.zIndex&&(a.zIndex=o)}return t}},{key:"getSourceState",value:function(){return"ready"}}])}(),_default=exports.default=LayerGroup;

},{"../Collection.js":9,"../CollectionEventType.js":10,"../ObjectEventType.js":26,"../asserts.js":37,"../events.js":51,"../events/Event.js":52,"../events/EventType.js":53,"../extent.js":59,"../obj.js":121,"../util.js":205,"./Base.js":108}],113:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _BaseImage=_interopRequireDefault(require("./BaseImage.js")),_ImageLayer=_interopRequireDefault(require("../renderer/canvas/ImageLayer.js"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _superPropGet(e,t,r,o){var n=_get(_getPrototypeOf(1&o?e.prototype:e),t,r);return 2&o?function(e){return n.apply(r,e)}:n}function _get(){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var o=_superPropBase(e,t);if(o){var n=Object.getOwnPropertyDescriptor(o,t);return n.get?n.get.call(arguments.length<3?e:r):n.value}}).apply(null,arguments)}function _superPropBase(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf(e)););return e}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var ImageLayer=function(e){function t(e){return _classCallCheck(this,t),_callSuper(this,t,[e])}return _inherits(t,_BaseImage["default"]),_createClass(t,[{key:"createRenderer",value:function(){return new _ImageLayer.default(this)}},{key:"getData",value:function(e){return _superPropGet(t,"getData",this,3)([e])}}])}(),_default=exports.default=ImageLayer;

},{"../renderer/canvas/ImageLayer.js":153,"./BaseImage.js":109}],114:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0,exports.inView=inView;var _Base=_interopRequireDefault(require("./Base.js")),_EventType=_interopRequireDefault(require("../events/EventType.js")),_Property=_interopRequireDefault(require("./Property.js")),_EventType2=_interopRequireDefault(require("../render/EventType.js")),_View=_interopRequireDefault(require("../View.js")),_asserts=require("../asserts.js"),_extent=require("../extent.js"),_events=require("../events.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _readOnlyError(e){throw new TypeError('"'+e+'" is read-only')}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey(n.key),n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _superPropGet(e,t,r,n){var o=_get(_getPrototypeOf(1&n?e.prototype:e),t,r);return 2&n?function(e){return o.apply(r,e)}:o}function _get(){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=_superPropBase(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}}).apply(null,arguments)}function _superPropBase(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf(e)););return e}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var Layer=function(e){function t(e){var r;_classCallCheck(this,t);var n=Object.assign({},e);delete n.source,(r=_callSuper(this,t,[n])).on,r.once,r.un,r.mapPrecomposeKey_=null,r.mapRenderKey_=null,r.sourceChangeKey_=null,r.renderer_=null,r.sourceReady_=!1,r.rendered=!1,e.render&&(r.render=e.render),e.map&&r.setMap(e.map),r.addChangeListener(_Property.default.SOURCE,r.handleSourcePropertyChange_);var o=e.source?e.source:null;return r.setSource(o),r}return _inherits(t,_Base["default"]),_createClass(t,[{key:"getLayersArray",value:function(e){return(e=e||[]).push(this),e}},{key:"getLayerStatesArray",value:function(e){return(e=e||[]).push(this.getLayerState()),e}},{key:"getSource",value:function(){return this.get(_Property.default.SOURCE)||null}},{key:"getRenderSource",value:function(){return this.getSource()}},{key:"getSourceState",value:function(){var e=this.getSource();return e?e.getState():"undefined"}},{key:"handleSourceChange_",value:function(){this.changed(),this.sourceReady_||"ready"!==this.getSource().getState()||(this.sourceReady_=!0,this.dispatchEvent("sourceready"))}},{key:"handleSourcePropertyChange_",value:function(){var e=this;this.sourceChangeKey_&&((0,_events.unlistenByKey)(this.sourceChangeKey_),this.sourceChangeKey_=null),this.sourceReady_=!1;var t=this.getSource();t&&(this.sourceChangeKey_=(0,_events.listen)(t,_EventType.default.CHANGE,this.handleSourceChange_,this),"ready"===t.getState()&&(this.sourceReady_=!0,setTimeout(function(){e.dispatchEvent("sourceready")},0))),this.changed()}},{key:"getFeatures",value:function(e){return this.renderer_?this.renderer_.getFeatures(e):Promise.resolve([])}},{key:"getData",value:function(e){return this.renderer_&&this.rendered?this.renderer_.getData(e):null}},{key:"isVisible",value:function(e){var t,r,n=this,o=this.getMapInternal();!e&&o&&(e=o.getView()),!(t=e instanceof _View.default?{viewState:e.getState(),extent:e.calculateExtent()}:e).layerStatesArray&&o&&(t.layerStatesArray=o.getLayerGroup().getLayerStatesArray()),r=t.layerStatesArray?t.layerStatesArray.find(function(e){return e.layer===n}):this.getLayerState();var i=this.getExtent();return inView(r,t.viewState)&&(!i||(0,_extent.intersects)(i,t.extent))}},{key:"getAttributions",value:function(e){var t;if(!this.isVisible(e))return[];var r=null===(t=this.getSource())||void 0===t?void 0:t.getAttributions();if(!r)return[];var n=r(e instanceof _View.default?e.getViewStateAndExtent():e);return Array.isArray(n)||(n=[n]),n}},{key:"render",value:function(e,t){var r=this.getRenderer();return r.prepareFrame(e)?(this.rendered=!0,r.renderFrame(e,t)):null}},{key:"unrender",value:function(){this.rendered=!1}},{key:"getDeclutter",value:function(){}},{key:"renderDeclutter",value:function(e,t){}},{key:"renderDeferred",value:function(e){var t=this.getRenderer();t&&t.renderDeferred(e)}},{key:"setMapInternal",value:function(e){e||this.unrender(),this.set(_Property.default.MAP,e)}},{key:"getMapInternal",value:function(){return this.get(_Property.default.MAP)}},{key:"setMap",value:function(e){var t=this;this.mapPrecomposeKey_&&((0,_events.unlistenByKey)(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),e||this.changed(),this.mapRenderKey_&&((0,_events.unlistenByKey)(this.mapRenderKey_),this.mapRenderKey_=null),e&&(this.mapPrecomposeKey_=(0,_events.listen)(e,_EventType2.default.PRECOMPOSE,function(e){var r=e.frameState.layerStatesArray,n=t.getLayerState(!1);(0,_asserts.assert)(!r.some(function(e){return e.layer===n.layer}),"A layer can only be added to the map once. Use either `layer.setMap()` or `map.addLayer()`, not both."),r.push(n)}),this.mapRenderKey_=(0,_events.listen)(this,_EventType.default.CHANGE,e.render,e),this.changed())}},{key:"setSource",value:function(e){this.set(_Property.default.SOURCE,e)}},{key:"getRenderer",value:function(){return this.renderer_||(this.renderer_=this.createRenderer()),this.renderer_}},{key:"hasRenderer",value:function(){return!!this.renderer_}},{key:"createRenderer",value:function(){return null}},{key:"disposeInternal",value:function(){this.renderer_&&(this.renderer_.dispose(),delete this.renderer_),this.setSource(null),_superPropGet(t,"disposeInternal",this,3)([])}}])}();function inView(e,t){if(!e.visible)return!1;var r=t.resolution;if(r<e.minResolution||r>=e.maxResolution)return!1;var n=t.zoom;return n>e.minZoom&&n<=e.maxZoom}var _default=exports.default=Layer;

},{"../View.js":33,"../asserts.js":37,"../events.js":51,"../events/EventType.js":53,"../extent.js":59,"../render/EventType.js":133,"./Base.js":108,"./Property.js":115}],115:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _default=exports.default={OPACITY:"opacity",VISIBLE:"visible",EXTENT:"extent",Z_INDEX:"zIndex",MAX_RESOLUTION:"maxResolution",MIN_RESOLUTION:"minResolution",MAX_ZOOM:"maxZoom",MIN_ZOOM:"minZoom",SOURCE:"source",MAP:"map"};

},{}],116:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _BaseTile=_interopRequireDefault(require("./BaseTile.js")),_TileLayer=_interopRequireDefault(require("../renderer/canvas/TileLayer.js"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var TileLayer=function(e){function t(e){return _classCallCheck(this,t),_callSuper(this,t,[e])}return _inherits(t,_BaseTile["default"]),_createClass(t,[{key:"createRenderer",value:function(){return new _TileLayer.default(this,{cacheSize:this.getCacheSize()})}}])}(),_default=exports.default=TileLayer;

},{"../renderer/canvas/TileLayer.js":155,"./BaseTile.js":110}],117:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _default=exports.default={PRELOAD:"preload",USE_INTERIM_TILES_ON_ERROR:"useInterimTilesOnError"};

},{}],118:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _BaseVector=_interopRequireDefault(require("./BaseVector.js")),_VectorLayer=_interopRequireDefault(require("../renderer/canvas/VectorLayer.js"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var VectorLayer=function(e){function t(e){return _classCallCheck(this,t),_callSuper(this,t,[e])}return _inherits(t,_BaseVector["default"]),_createClass(t,[{key:"createRenderer",value:function(){return new _VectorLayer.default(this)}}])}(),_default=exports.default=VectorLayer;

},{"../renderer/canvas/VectorLayer.js":156,"./BaseVector.js":111}],119:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.all=all,exports.bbox=bbox,exports.tile=tile;var _proj=require("./proj.js");function all(e,r){return[[-1/0,-1/0,1/0,1/0]]}function bbox(e,r){return[e]}function tile(e){return function(r,t,o){var n=e.getZForResolution((0,_proj.fromUserResolution)(t,o)),i=e.getTileRangeForExtentAndZ((0,_proj.fromUserExtent)(r,o),n),l=[],u=[n,0,0];for(u[1]=i.minX;u[1]<=i.maxX;++u[1])for(u[2]=i.minY;u[2]<=i.maxY;++u[2])l.push((0,_proj.toUserExtent)(e.getTileCoordExtent(u),o));return l}}

},{"./proj.js":123}],120:[function(require,module,exports){
"use strict";function clamp(r,e,t){return Math.min(Math.max(r,e),t)}function squaredSegmentDistance(r,e,t,o,n,a){var s=n-t,u=a-o;if(0!==s||0!==u){var i=((r-t)*s+(e-o)*u)/(s*s+u*u);i>1?(t=n,o=a):i>0&&(t+=s*i,o+=u*i)}return squaredDistance(r,e,t,o)}function squaredDistance(r,e,t,o){var n=t-r,a=o-e;return n*n+a*a}function solveLinearSystem(r){for(var e=r.length,t=0;t<e;t++){for(var o=t,n=Math.abs(r[t][t]),a=t+1;a<e;a++){var s=Math.abs(r[a][t]);s>n&&(n=s,o=a)}if(0===n)return null;var u=r[o];r[o]=r[t],r[t]=u;for(var i=t+1;i<e;i++)for(var c=-r[i][t]/r[t][t],d=t;d<e+1;d++)t==d?r[i][d]=0:r[i][d]+=c*r[t][d]}for(var f=new Array(e),l=e-1;l>=0;l--){f[l]=r[l][e]/r[l][l];for(var p=l-1;p>=0;p--)r[p][e]-=r[p][l]*f[l]}return f}function toDegrees(r){return 180*r/Math.PI}function toRadians(r){return r*Math.PI/180}function modulo(r,e){var t=r%e;return t*e<0?t+e:t}function lerp(r,e,t){return r+t*(e-r)}function toFixed(r,e){var t=Math.pow(10,e);return Math.round(r*t)/t}function round(r,e){return Math.round(toFixed(r,e))}function floor(r,e){return Math.floor(toFixed(r,e))}function ceil(r,e){return Math.ceil(toFixed(r,e))}Object.defineProperty(exports,"__esModule",{value:!0}),exports.ceil=ceil,exports.clamp=clamp,exports.floor=floor,exports.lerp=lerp,exports.modulo=modulo,exports.round=round,exports.solveLinearSystem=solveLinearSystem,exports.squaredDistance=squaredDistance,exports.squaredSegmentDistance=squaredSegmentDistance,exports.toDegrees=toDegrees,exports.toFixed=toFixed,exports.toRadians=toRadians;

},{}],121:[function(require,module,exports){
"use strict";function clear(e){for(var r in e)delete e[r]}function isEmpty(e){var r;for(r in e)return!1;return!r}Object.defineProperty(exports,"__esModule",{value:!0}),exports.clear=clear,exports.isEmpty=isEmpty;

},{}],122:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _default=exports.default={POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"};

},{}],123:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),Object.defineProperty(exports,"METERS_PER_UNIT",{enumerable:!0,get:function(){return _Units.METERS_PER_UNIT}}),Object.defineProperty(exports,"Projection",{enumerable:!0,get:function(){return _Projection.default}}),exports.addCommon=addCommon,exports.addCoordinateTransforms=addCoordinateTransforms,exports.addEquivalentProjections=addEquivalentProjections,exports.addEquivalentTransforms=addEquivalentTransforms,exports.addProjection=addProjection,exports.addProjections=addProjections,exports.clearAllProjections=clearAllProjections,exports.clearUserProjection=clearUserProjection,exports.cloneTransform=cloneTransform,exports.createProjection=createProjection,exports.createSafeCoordinateTransform=createSafeCoordinateTransform,exports.createTransformFromCoordinateTransform=createTransformFromCoordinateTransform,exports.disableCoordinateWarning=disableCoordinateWarning,exports.equivalent=equivalent,exports.fromLonLat=fromLonLat,exports.fromUserCoordinate=fromUserCoordinate,exports.fromUserExtent=fromUserExtent,exports.fromUserResolution=fromUserResolution,exports.get=get,exports.getPointResolution=getPointResolution,exports.getTransform=getTransform,exports.getTransformFromProjections=getTransformFromProjections,exports.getUserProjection=getUserProjection,exports.identityTransform=identityTransform,exports.setUserProjection=setUserProjection,exports.toLonLat=toLonLat,exports.toUserCoordinate=toUserCoordinate,exports.toUserExtent=toUserExtent,exports.toUserResolution=toUserResolution,exports.transform=transform,exports.transformExtent=transformExtent,exports.transformWithProjections=transformWithProjections,exports.useGeographic=useGeographic;var _Projection=_interopRequireDefault(require("./proj/Projection.js")),_epsg=require("./proj/epsg3857.js"),_epsg2=require("./proj/epsg4326.js"),_Units=require("./proj/Units.js"),_projections=require("./proj/projections.js"),_transforms=require("./proj/transforms.js"),_extent=require("./extent.js"),_math=require("./math.js"),_coordinate=require("./coordinate.js"),_sphere=require("./sphere.js"),_console=require("./console.js");function _interopRequireDefault(r){return r&&r.__esModule?r:{default:r}}var showCoordinateWarning=!0;function disableCoordinateWarning(r){showCoordinateWarning=!(void 0===r||r)}function cloneTransform(r,e){if(void 0!==e){for(var o=0,t=r.length;o<t;++o)e[o]=r[o];e=e}else e=r.slice();return e}function identityTransform(r,e){if(void 0!==e&&r!==e){for(var o=0,t=r.length;o<t;++o)e[o]=r[o];r=e}return r}function addProjection(r){(0,_projections.add)(r.getCode(),r),(0,_transforms.add)(r,r,cloneTransform)}function addProjections(r){r.forEach(addProjection)}function get(r){return"string"==typeof r?(0,_projections.get)(r):r||null}function getPointResolution(r,e,o,t){var n,s=(r=get(r)).getPointResolutionFunc();if(s){if(n=s(e,o),t&&t!==r.getUnits()){var i=r.getMetersPerUnit();i&&(n=n*i/_Units.METERS_PER_UNIT[t])}}else{var a=r.getUnits();if("degrees"==a&&!t||"degrees"==t)n=e;else{var c=getTransformFromProjections(r,get("EPSG:4326"));if(c===identityTransform&&"degrees"!==a)n=e*r.getMetersPerUnit();else{var f=[o[0]-e/2,o[1],o[0]+e/2,o[1],o[0],o[1]-e/2,o[0],o[1]+e/2];f=c(f,f,2),n=((0,_sphere.getDistance)(f.slice(0,2),f.slice(2,4))+(0,_sphere.getDistance)(f.slice(4,6),f.slice(6,8)))/2}var u=t?_Units.METERS_PER_UNIT[t]:r.getMetersPerUnit();void 0!==u&&(n/=u)}}return n}function addEquivalentProjections(r){addProjections(r),r.forEach(function(e){r.forEach(function(r){e!==r&&(0,_transforms.add)(e,r,cloneTransform)})})}function addEquivalentTransforms(r,e,o,t){r.forEach(function(r){e.forEach(function(e){(0,_transforms.add)(r,e,o),(0,_transforms.add)(e,r,t)})})}function clearAllProjections(){(0,_projections.clear)(),(0,_transforms.clear)()}function createProjection(r,e){return r?"string"==typeof r?get(r):r:get(e)}function createTransformFromCoordinateTransform(r){return function(e,o,t){var n=e.length;t=void 0!==t?t:2,o=void 0!==o?o:new Array(n);for(var s=0;s<n;s+=t)for(var i=r(e.slice(s,s+t)),a=i.length,c=0,f=t;c<f;++c)o[s+c]=c>=a?e[s+c]:i[c];return o}}function addCoordinateTransforms(r,e,o,t){var n=get(r),s=get(e);(0,_transforms.add)(n,s,createTransformFromCoordinateTransform(o)),(0,_transforms.add)(s,n,createTransformFromCoordinateTransform(t))}function fromLonLat(r,e){return disableCoordinateWarning(),transform(r,"EPSG:4326",void 0!==e?e:"EPSG:3857")}function toLonLat(r,e){var o=transform(r,void 0!==e?e:"EPSG:3857","EPSG:4326"),t=o[0];return(t<-180||t>180)&&(o[0]=(0,_math.modulo)(t+180,360)-180),o}function equivalent(r,e){if(r===e)return!0;var o=r.getUnits()===e.getUnits();return r.getCode()===e.getCode()?o:getTransformFromProjections(r,e)===cloneTransform&&o}function getTransformFromProjections(r,e){var o=r.getCode(),t=e.getCode(),n=(0,_transforms.get)(o,t);return n||(n=identityTransform),n}function getTransform(r,e){return getTransformFromProjections(get(r),get(e))}function transform(r,e,o){return getTransform(e,o)(r,void 0,r.length)}function transformExtent(r,e,o,t){var n=getTransform(e,o);return(0,_extent.applyTransform)(r,n,void 0,t)}function transformWithProjections(r,e,o){return getTransformFromProjections(e,o)(r)}var userProjection=null;function setUserProjection(r){userProjection=get(r)}function clearUserProjection(){userProjection=null}function getUserProjection(){return userProjection}function useGeographic(){setUserProjection("EPSG:4326")}function toUserCoordinate(r,e){return userProjection?transform(r,e,userProjection):r}function fromUserCoordinate(r,e){return userProjection?transform(r,userProjection,e):(showCoordinateWarning&&!(0,_coordinate.equals)(r,[0,0])&&r[0]>=-180&&r[0]<=180&&r[1]>=-90&&r[1]<=90&&(showCoordinateWarning=!1,(0,_console.warn)("Call useGeographic() from ol/proj once to work with [longitude, latitude] coordinates.")),r)}function toUserExtent(r,e){return userProjection?transformExtent(r,e,userProjection):r}function fromUserExtent(r,e){return userProjection?transformExtent(r,userProjection,e):r}function toUserResolution(r,e){if(!userProjection)return r;var o=get(e).getMetersPerUnit(),t=userProjection.getMetersPerUnit();return o&&t?r*o/t:r}function fromUserResolution(r,e){if(!userProjection)return r;var o=get(e).getMetersPerUnit(),t=userProjection.getMetersPerUnit();return o&&t?r*t/o:r}function createSafeCoordinateTransform(r,e,o){return function(t){var n,s;if(r.canWrapX()){var i=r.getExtent(),a=(0,_extent.getWidth)(i);t=t.slice(0),(s=(0,_coordinate.getWorldsAway)(t,r,a))&&(t[0]=t[0]-s*a),t[0]=(0,_math.clamp)(t[0],i[0],i[2]),t[1]=(0,_math.clamp)(t[1],i[1],i[3]),n=o(t)}else n=o(t);return s&&e.canWrapX()&&(n[0]+=s*(0,_extent.getWidth)(e.getExtent())),n}}function addCommon(){addEquivalentProjections(_epsg.PROJECTIONS),addEquivalentProjections(_epsg2.PROJECTIONS),addEquivalentTransforms(_epsg2.PROJECTIONS,_epsg.PROJECTIONS,_epsg.fromEPSG4326,_epsg.toEPSG4326)}addCommon();

},{"./console.js":41,"./coordinate.js":47,"./extent.js":59,"./math.js":120,"./proj/Projection.js":124,"./proj/Units.js":125,"./proj/epsg3857.js":126,"./proj/epsg4326.js":127,"./proj/projections.js":129,"./proj/transforms.js":130,"./sphere.js":181}],124:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _Units=require("./Units.js");function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,_toPropertyKey(i.key),i)}}function _createClass(t,e,n){return e&&_defineProperties(t.prototype,e),n&&_defineProperties(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var Projection=function(){return _createClass(function t(e){_classCallCheck(this,t),this.code_=e.code,this.units_=e.units,this.extent_=void 0!==e.extent?e.extent:null,this.worldExtent_=void 0!==e.worldExtent?e.worldExtent:null,this.axisOrientation_=void 0!==e.axisOrientation?e.axisOrientation:"enu",this.global_=void 0!==e.global&&e.global,this.canWrapX_=!(!this.global_||!this.extent_),this.getPointResolutionFunc_=e.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=e.metersPerUnit},[{key:"canWrapX",value:function(){return this.canWrapX_}},{key:"getCode",value:function(){return this.code_}},{key:"getExtent",value:function(){return this.extent_}},{key:"getUnits",value:function(){return this.units_}},{key:"getMetersPerUnit",value:function(){return this.metersPerUnit_||_Units.METERS_PER_UNIT[this.units_]}},{key:"getWorldExtent",value:function(){return this.worldExtent_}},{key:"getAxisOrientation",value:function(){return this.axisOrientation_}},{key:"isGlobal",value:function(){return this.global_}},{key:"setGlobal",value:function(t){this.global_=t,this.canWrapX_=!(!t||!this.extent_)}},{key:"getDefaultTileGrid",value:function(){return this.defaultTileGrid_}},{key:"setDefaultTileGrid",value:function(t){this.defaultTileGrid_=t}},{key:"setExtent",value:function(t){this.extent_=t,this.canWrapX_=!(!this.global_||!t)}},{key:"setWorldExtent",value:function(t){this.worldExtent_=t}},{key:"setGetPointResolution",value:function(t){this.getPointResolutionFunc_=t}},{key:"getPointResolutionFunc",value:function(){return this.getPointResolutionFunc_}}])}(),_default=exports.default=Projection;

},{"./Units.js":125}],125:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.METERS_PER_UNIT=void 0,exports.fromCode=fromCode;var unitByCode={9001:"m",9002:"ft",9003:"us-ft",9101:"radians",9102:"degrees"};function fromCode(e){return unitByCode[e]}var METERS_PER_UNIT=exports.METERS_PER_UNIT={radians:6370997/(2*Math.PI),degrees:2*Math.PI*6370997/360,ft:.3048,m:1,"us-ft":1200/3937};

},{}],126:[function(require,module,exports){
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.WORLD_EXTENT=exports.RADIUS=exports.PROJECTIONS=exports.MAX_SAFE_Y=exports.HALF_SIZE=exports.EXTENT=void 0,exports.fromEPSG4326=fromEPSG4326,exports.toEPSG4326=toEPSG4326;var _Projection2=_interopRequireDefault(require("./Projection.js"));function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,_toPropertyKey(o.key),o)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var o=r.call(t,e||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _callSuper(t,e,r){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,r||[],_getPrototypeOf(t).constructor):e.apply(t,r))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var RADIUS=exports.RADIUS=6378137,HALF_SIZE=exports.HALF_SIZE=Math.PI*RADIUS,EXTENT=exports.EXTENT=[-HALF_SIZE,-HALF_SIZE,HALF_SIZE,HALF_SIZE],WORLD_EXTENT=exports.WORLD_EXTENT=[-180,-85,180,85],MAX_SAFE_Y=exports.MAX_SAFE_Y=RADIUS*Math.log(Math.tan(Math.PI/2)),EPSG3857Projection=function(t){function e(t){return _classCallCheck(this,e),_callSuper(this,e,[{code:t,units:"m",extent:EXTENT,global:!0,worldExtent:WORLD_EXTENT,getPointResolution:function(t,e){return t/Math.cosh(e[1]/RADIUS)}}])}return _inherits(e,_Projection2["default"]),_createClass(e)}(),PROJECTIONS=exports.PROJECTIONS=[new EPSG3857Projection("EPSG:3857"),new EPSG3857Projection("EPSG:102100"),new EPSG3857Projection("EPSG:102113"),new EPSG3857Projection("EPSG:900913"),new EPSG3857Projection("http://www.opengis.net/def/crs/EPSG/0/3857"),new EPSG3857Projection("http://www.opengis.net/gml/srs/epsg.xml#3857")];function fromEPSG4326(t,e,r){var o=t.length;r=r>1?r:2,void 0===e&&(e=r>2?t.slice():new Array(o));for(var n=0;n<o;n+=r){e[n]=HALF_SIZE*t[n]/180;var i=RADIUS*Math.log(Math.tan(Math.PI*(+t[n+1]+90)/360));i>MAX_SAFE_Y?i=MAX_SAFE_Y:i<-MAX_SAFE_Y&&(i=-MAX_SAFE_Y),e[n+1]=i}return e}function toEPSG4326(t,e,r){var o=t.length;r=r>1?r:2,void 0===e&&(e=r>2?t.slice():new Array(o));for(var n=0;n<o;n+=r)e[n]=180*t[n]/HALF_SIZE,e[n+1]=360*Math.atan(Math.exp(t[n+1]/RADIUS))/Math.PI-90;return e}

},{"./Projection.js":124}],127:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.RADIUS=exports.PROJECTIONS=exports.METERS_PER_UNIT=exports.EXTENT=void 0;var _Projection2=_interopRequireDefault(require("./Projection.js"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var RADIUS=exports.RADIUS=6378137,EXTENT=exports.EXTENT=[-180,-90,180,90],METERS_PER_UNIT=exports.METERS_PER_UNIT=Math.PI*RADIUS/180,EPSG4326Projection=function(e){function t(e,r){return _classCallCheck(this,t),_callSuper(this,t,[{code:e,units:"degrees",extent:EXTENT,axisOrientation:r,global:!0,metersPerUnit:METERS_PER_UNIT,worldExtent:EXTENT}])}return _inherits(t,_Projection2["default"]),_createClass(t)}(),PROJECTIONS=exports.PROJECTIONS=[new EPSG4326Projection("CRS:84"),new EPSG4326Projection("EPSG:4326","neu"),new EPSG4326Projection("urn:ogc:def:crs:OGC:1.3:CRS84"),new EPSG4326Projection("urn:ogc:def:crs:OGC:2:84"),new EPSG4326Projection("http://www.opengis.net/def/crs/OGC/1.3/CRS84"),new EPSG4326Projection("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new EPSG4326Projection("http://www.opengis.net/def/crs/EPSG/0/4326","neu")];

},{"./Projection.js":124}],128:[function(require,module,exports){
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.epsgLookupMapTiler=epsgLookupMapTiler,exports.fromEPSGCode=fromEPSGCode,exports.getEPSGLookup=getEPSGLookup,exports.isRegistered=isRegistered,exports.register=register,exports.setEPSGLookup=setEPSGLookup,exports.unregister=unregister;var _Projection=_interopRequireDefault(require("./Projection.js")),_proj=require("../proj.js"),_transforms=require("./transforms.js");function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _regeneratorRuntime(){_regeneratorRuntime=function(){return r};var t,r={},e=Object.prototype,n=e.hasOwnProperty,o=Object.defineProperty||function(t,r,e){t[r]=e.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function s(t,r,e){return Object.defineProperty(t,r,{value:e,enumerable:!0,configurable:!0,writable:!0}),t[r]}try{s({},"")}catch(t){s=function(t,r,e){return t[r]=e}}function f(t,r,e,n){var i=r&&r.prototype instanceof g?r:g,a=Object.create(i.prototype),u=new O(n||[]);return o(a,"_invoke",{value:k(t,e,u)}),a}function l(t,r,e){try{return{type:"normal",arg:t.call(r,e)}}catch(t){return{type:"throw",arg:t}}}r.wrap=f;var p="suspendedStart",h="suspendedYield",d="executing",v="completed",y={};function g(){}function m(){}function w(){}var _={};s(_,a,function(){return this});var x=Object.getPrototypeOf,b=x&&x(x(T([])));b&&b!==e&&n.call(b,a)&&(_=b);var j=w.prototype=g.prototype=Object.create(_);function E(t){["next","throw","return"].forEach(function(r){s(t,r,function(t){return this._invoke(r,t)})})}function L(t,r){function e(o,i,a,u){var c=l(t[o],t,i);if("throw"!==c.type){var s=c.arg,f=s.value;return f&&"object"==_typeof(f)&&n.call(f,"__await")?r.resolve(f.__await).then(function(t){e("next",t,a,u)},function(t){e("throw",t,a,u)}):r.resolve(f).then(function(t){s.value=t,a(s)},function(t){return e("throw",t,a,u)})}u(c.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new r(function(r,o){e(t,n,r,o)})}return i=i?i.then(o,o):o()}})}function k(r,e,n){var o=p;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===v){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var c=P(u,n);if(c){if(c===y)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===p)throw o=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var s=l(r,e,n);if("normal"===s.type){if(o=n.done?v:h,s.arg===y)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=v,n.method="throw",n.arg=s.arg)}}}function P(r,e){var n=e.method,o=r.iterator[n];if(o===t)return e.delegate=null,"throw"===n&&r.iterator.return&&(e.method="return",e.arg=t,P(r,e),"throw"===e.method)||"return"!==n&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;var i=l(o,r.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,y;var a=i.arg;return a?a.done?(e[r.resultName]=a.value,e.next=r.nextLoc,"return"!==e.method&&(e.method="next",e.arg=t),e.delegate=null,y):a:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,y)}function S(t){var r={tryLoc:t[0]};1 in t&&(r.catchLoc=t[1]),2 in t&&(r.finallyLoc=t[2],r.afterLoc=t[3]),this.tryEntries.push(r)}function G(t){var r=t.completion||{};r.type="normal",delete r.arg,t.completion=r}function O(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(S,this),this.reset(!0)}function T(r){if(r||""===r){var e=r[a];if(e)return e.call(r);if("function"==typeof r.next)return r;if(!isNaN(r.length)){var o=-1,i=function e(){for(;++o<r.length;)if(n.call(r,o))return e.value=r[o],e.done=!1,e;return e.value=t,e.done=!0,e};return i.next=i}}throw new TypeError(_typeof(r)+" is not iterable")}return m.prototype=w,o(j,"constructor",{value:w,configurable:!0}),o(w,"constructor",{value:m,configurable:!0}),m.displayName=s(w,c,"GeneratorFunction"),r.isGeneratorFunction=function(t){var r="function"==typeof t&&t.constructor;return!!r&&(r===m||"GeneratorFunction"===(r.displayName||r.name))},r.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,w):(t.__proto__=w,s(t,c,"GeneratorFunction")),t.prototype=Object.create(j),t},r.awrap=function(t){return{__await:t}},E(L.prototype),s(L.prototype,u,function(){return this}),r.AsyncIterator=L,r.async=function(t,e,n,o,i){void 0===i&&(i=Promise);var a=new L(f(t,e,n,o),i);return r.isGeneratorFunction(e)?a:a.next().then(function(t){return t.done?t.value:a.next()})},E(j),s(j,c,"Generator"),s(j,a,function(){return this}),s(j,"toString",function(){return"[object Generator]"}),r.keys=function(t){var r=Object(t),e=[];for(var n in r)e.push(n);return e.reverse(),function t(){for(;e.length;){var n=e.pop();if(n in r)return t.value=n,t.done=!1,t}return t.done=!0,t}},r.values=T,O.prototype={constructor:O,reset:function(r){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(G),!r)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var e=this;function o(n,o){return u.type="throw",u.arg=r,e.next=n,o&&(e.method="next",e.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(c&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,r){for(var e=this.tryEntries.length-1;e>=0;--e){var o=this.tryEntries[e];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=r&&r<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=r,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function(t,r){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&r&&(this.next=r),y},finish:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e.finallyLoc===t)return this.complete(e.completion,e.afterLoc),G(e),y}},catch:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e.tryLoc===t){var n=e.completion;if("throw"===n.type){var o=n.arg;G(e)}return o}}throw Error("illegal catch attempt")},delegateYield:function(r,e,n){return this.delegate={iterator:T(r),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=t),y}},r}function asyncGeneratorStep(t,r,e,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void e(t)}u.done?r(c):Promise.resolve(c).then(n,o)}function _asyncToGenerator(t){return function(){var r=this,e=arguments;return new Promise(function(n,o){var i=t.apply(r,e);function a(t){asyncGeneratorStep(i,n,o,a,u,"next",t)}function u(t){asyncGeneratorStep(i,n,o,a,u,"throw",t)}a(void 0)})}}var registered=null;function isRegistered(){return!!registered}function unregister(){registered=null}function register(t){registered=t;var r,e,n=Object.keys(t.defs),o=n.length;for(r=0;r<o;++r){var i=n[r];if(!(0,_proj.get)(i)){var a=t.defs(i),u=a.units;u||"longlat"!==a.projName||(u="degrees"),(0,_proj.addProjection)(new _Projection.default({code:i,axisOrientation:a.axis,metersPerUnit:a.to_meter,units:u}))}}for(r=0;r<o;++r){var c=n[r],s=(0,_proj.get)(c);for(e=0;e<o;++e){var f=n[e],l=(0,_proj.get)(f);if(!(0,_transforms.get)(c,f))if(t.defs[c]===t.defs[f])(0,_proj.addEquivalentProjections)([s,l]);else{var p=t(c,f);(0,_proj.addCoordinateTransforms)(s,l,(0,_proj.createSafeCoordinateTransform)(s,l,p.forward),(0,_proj.createSafeCoordinateTransform)(l,s,p.inverse))}}}}var epsgLookup=function(){var t=_asyncToGenerator(_regeneratorRuntime().mark(function t(r){var e;return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("https://epsg.io/".concat(r,".proj4"));case 2:if((e=t.sent).ok){t.next=5;break}throw new Error("Unexpected response from epsg.io: ".concat(e.status));case 5:return t.abrupt("return",e.text());case 6:case"end":return t.stop()}},t)}));return function(r){return t.apply(this,arguments)}}();function setEPSGLookup(t){epsgLookup=t}function getEPSGLookup(){return epsgLookup}function fromEPSGCode(t){return _fromEPSGCode.apply(this,arguments)}function _fromEPSGCode(){return(_fromEPSGCode=_asyncToGenerator(_regeneratorRuntime().mark(function t(r){var e,n;return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if("string"==typeof r&&(r=parseInt(r.split(":").pop(),10)),e=registered){t.next=4;break}throw new Error("Proj4 must be registered first with register(proj4)");case 4:if(n="EPSG:"+r,!e.defs(n)){t.next=7;break}return t.abrupt("return",(0,_proj.get)(n));case 7:return t.t0=e,t.t1=n,t.next=11,epsgLookup(r);case 11:return t.t2=t.sent,t.t0.defs.call(t.t0,t.t1,t.t2),register(e),t.abrupt("return",(0,_proj.get)(n));case 15:case"end":return t.stop()}},t)}))).apply(this,arguments)}function epsgLookupMapTiler(t){return function(){var r=_asyncToGenerator(_regeneratorRuntime().mark(function r(e){var n;return _regeneratorRuntime().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,fetch("https://api.maptiler.com/coordinates/search/code:".concat(e,".json?transformations=true&exports=true&key=").concat(t));case 2:if((n=r.sent).ok){r.next=5;break}throw new Error("Unexpected response from maptiler.com: ".concat(n.status));case 5:return r.abrupt("return",n.json().then(function(t){var r=t.results;if((null==r?void 0:r.length)>0){var n=r.filter(function(t){var r,n;return"EPSG"===(null===(r=t.id)||void 0===r?void 0:r.authority)&&(null===(n=t.id)||void 0===n?void 0:n.code)===e})[0];if(n){var o,i=n.transformations;if((null==i?void 0:i.length)>0){var a,u,c=n.default_transformation;if(i.filter(function(t){var r,e,n;return(null===(r=t.id)||void 0===r?void 0:r.authority)===(null==c?void 0:c.authority)&&(null===(e=t.id)||void 0===e?void 0:e.code)===(null==c?void 0:c.code)&&0===(null===(n=t.grids)||void 0===n?void 0:n.length)}).length>0)return null===(u=n.exports)||void 0===u?void 0:u.proj4;var s=null===(a=i.filter(function(t){var r,e,n;return 0===(null===(r=t.grids)||void 0===r?void 0:r.length)&&"EPSG"===(null===(e=t.target_crs)||void 0===e?void 0:e.authority)&&4326===(null===(n=t.target_crs)||void 0===n?void 0:n.code)&&!1===t.deprecated&&!0===t.usable}).sort(function(t,r){return t.accuracy-r.accuracy})[0])||void 0===a||null===(a=a.exports)||void 0===a?void 0:a.proj4;if(s)return s}return null===(o=n.exports)||void 0===o?void 0:o.proj4}}}));case 6:case"end":return r.stop()}},r)}));return function(t){return r.apply(this,arguments)}}()}

},{"../proj.js":123,"./Projection.js":124,"./transforms.js":130}],129:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.add=add,exports.clear=clear,exports.get=get;var cache={};function clear(){cache={}}function get(e){return cache[e]||cache[e.replace(/urn:(x-)?ogc:def:crs:EPSG:(.*:)?(\w+)$/,"EPSG:$3")]||null}function add(e,c){cache[e]=c}

},{}],130:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.add=add,exports.clear=clear,exports.get=get,exports.remove=remove;var _obj=require("../obj.js"),transforms={};function clear(){transforms={}}function add(r,e,t){var s=r.getCode(),o=e.getCode();s in transforms||(transforms[s]={}),transforms[s][o]=t}function remove(r,e){var t=r.getCode(),s=e.getCode(),o=transforms[t][s];return delete transforms[t][s],(0,_obj.isEmpty)(transforms[t])&&delete transforms[t],o}function get(r,e){var t;return r in transforms&&e in transforms[r]&&(t=transforms[r][e]),t}

},{"../obj.js":121}],131:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _Disposable2=_interopRequireDefault(require("../Disposable.js")),_Polygon=_interopRequireDefault(require("../geom/Polygon.js"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var RenderBox=function(e){function t(e){var r;return _classCallCheck(this,t),(r=_callSuper(this,t)).geometry_=null,r.element_=document.createElement("div"),r.element_.style.position="absolute",r.element_.style.pointerEvents="auto",r.element_.className="ol-box "+e,r.map_=null,r.startPixel_=null,r.endPixel_=null,r}return _inherits(t,_Disposable2["default"]),_createClass(t,[{key:"disposeInternal",value:function(){this.setMap(null)}},{key:"render_",value:function(){var e=this.startPixel_,t=this.endPixel_,r=this.element_.style;r.left=Math.min(e[0],t[0])+"px",r.top=Math.min(e[1],t[1])+"px",r.width=Math.abs(t[0]-e[0])+"px",r.height=Math.abs(t[1]-e[1])+"px"}},{key:"setMap",value:function(e){if(this.map_){this.map_.getOverlayContainer().removeChild(this.element_);var t=this.element_.style;t.left="inherit",t.top="inherit",t.width="inherit",t.height="inherit"}this.map_=e,this.map_&&this.map_.getOverlayContainer().appendChild(this.element_)}},{key:"setPixels",value:function(e,t){this.startPixel_=e,this.endPixel_=t,this.createOrUpdateGeometry(),this.render_()}},{key:"createOrUpdateGeometry",value:function(){if(this.map_){var e=this.startPixel_,t=this.endPixel_,r=[e,[e[0],t[1]],t,[t[0],e[1]]].map(this.map_.getCoordinateFromPixelInternal,this.map_);r[4]=r[0].slice(),this.geometry_?this.geometry_.setCoordinates([r]):this.geometry_=new _Polygon.default([r])}}},{key:"getGeometry",value:function(){return this.geometry_}}])}(),_default=exports.default=RenderBox;

},{"../Disposable.js":12,"../geom/Polygon.js":73}],132:[function(require,module,exports){
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _Event2=_interopRequireDefault(require("../events/Event.js"));function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,_toPropertyKey(o.key),o)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var o=r.call(t,e||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _callSuper(t,e,r){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,r||[],_getPrototypeOf(t).constructor):e.apply(t,r))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var RenderEvent=function(t){function e(t,r,o,n){var i;return _classCallCheck(this,e),(i=_callSuper(this,e,[t])).inversePixelTransform=r,i.frameState=o,i.context=n,i}return _inherits(e,_Event2["default"]),_createClass(e)}(),_default=exports.default=RenderEvent;

},{"../events/Event.js":52}],133:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _default=exports.default={PRERENDER:"prerender",POSTRENDER:"postrender",PRECOMPOSE:"precompose",POSTCOMPOSE:"postcompose",RENDERCOMPLETE:"rendercomplete"};

},{}],134:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0,exports.toFeature=toFeature,exports.toGeometry=toGeometry;var _Feature=_interopRequireDefault(require("../Feature.js")),_geom=require("../geom.js"),_transform=require("../transform.js"),_extent=require("../extent.js"),_simplify=require("../geom/flat/simplify.js"),_array=require("../array.js"),_interiorpoint=require("../geom/flat/interiorpoint.js"),_proj=require("../proj.js"),_orient=require("../geom/flat/orient.js"),_interpolate=require("../geom/flat/interpolate.js"),_center=require("../geom/flat/center.js"),_functions=require("../functions.js"),_transform2=require("../geom/flat/transform.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,_toPropertyKey(i.key),i)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}var tmpTransform=(0,_transform.create)(),RenderFeature=function(){function e(t,r,i,n,o,s){_classCallCheck(this,e),this.styleFunction,this.extent_,this.id_=s,this.type_=t,this.flatCoordinates_=r,this.flatInteriorPoints_=null,this.flatMidpoints_=null,this.ends_=i||null,this.properties_=o,this.squaredTolerance_,this.stride_=n,this.simplifiedGeometry_}return _createClass(e,[{key:"get",value:function(e){return this.properties_[e]}},{key:"getExtent",value:function(){return this.extent_||(this.extent_="Point"===this.type_?(0,_extent.createOrUpdateFromCoordinate)(this.flatCoordinates_):(0,_extent.createOrUpdateFromFlatCoordinates)(this.flatCoordinates_,0,this.flatCoordinates_.length,2)),this.extent_}},{key:"getFlatInteriorPoint",value:function(){if(!this.flatInteriorPoints_){var e=(0,_extent.getCenter)(this.getExtent());this.flatInteriorPoints_=(0,_interiorpoint.getInteriorPointOfArray)(this.flatCoordinates_,0,this.ends_,2,e,0)}return this.flatInteriorPoints_}},{key:"getFlatInteriorPoints",value:function(){if(!this.flatInteriorPoints_){var e=(0,_orient.inflateEnds)(this.flatCoordinates_,this.ends_),t=(0,_center.linearRingss)(this.flatCoordinates_,0,e,2);this.flatInteriorPoints_=(0,_interiorpoint.getInteriorPointsOfMultiArray)(this.flatCoordinates_,0,e,2,t)}return this.flatInteriorPoints_}},{key:"getFlatMidpoint",value:function(){return this.flatMidpoints_||(this.flatMidpoints_=(0,_interpolate.interpolatePoint)(this.flatCoordinates_,0,this.flatCoordinates_.length,2,.5)),this.flatMidpoints_}},{key:"getFlatMidpoints",value:function(){if(!this.flatMidpoints_){this.flatMidpoints_=[];for(var e=this.flatCoordinates_,t=0,r=this.ends_,i=0,n=r.length;i<n;++i){var o=r[i],s=(0,_interpolate.interpolatePoint)(e,t,o,2,.5);(0,_array.extend)(this.flatMidpoints_,s),t=o}}return this.flatMidpoints_}},{key:"getId",value:function(){return this.id_}},{key:"getOrientedFlatCoordinates",value:function(){return this.flatCoordinates_}},{key:"getGeometry",value:function(){return this}},{key:"getSimplifiedGeometry",value:function(e){return this}},{key:"simplifyTransformed",value:function(e,t){return this}},{key:"getProperties",value:function(){return this.properties_}},{key:"getPropertiesInternal",value:function(){return this.properties_}},{key:"getStride",value:function(){return this.stride_}},{key:"getStyleFunction",value:function(){return this.styleFunction}},{key:"getType",value:function(){return this.type_}},{key:"transform",value:function(e){var t=(e=(0,_proj.get)(e)).getExtent(),r=e.getWorldExtent();if(t&&r){var i=(0,_extent.getHeight)(r)/(0,_extent.getHeight)(t);(0,_transform.compose)(tmpTransform,r[0],r[3],i,-i,0,0,0),(0,_transform2.transform2D)(this.flatCoordinates_,0,this.flatCoordinates_.length,2,tmpTransform,this.flatCoordinates_)}}},{key:"applyTransform",value:function(e){e(this.flatCoordinates_,this.flatCoordinates_,this.stride_)}},{key:"clone",value:function(){var t;return new e(this.type_,this.flatCoordinates_.slice(),null===(t=this.ends_)||void 0===t?void 0:t.slice(),this.stride_,Object.assign({},this.properties_),this.id_)}},{key:"getEnds",value:function(){return this.ends_}},{key:"enableSimplifyTransformed",value:function(){var t=this;return this.simplifyTransformed=(0,_functions.memoizeOne)(function(r,i){if(r===t.squaredTolerance_)return t.simplifiedGeometry_;t.simplifiedGeometry_=t.clone(),i&&t.simplifiedGeometry_.applyTransform(i);var n,o=t.simplifiedGeometry_.getFlatCoordinates();switch(t.type_){case"LineString":o.length=(0,_simplify.douglasPeucker)(o,0,t.simplifiedGeometry_.flatCoordinates_.length,t.simplifiedGeometry_.stride_,r,o,0),n=[o.length];break;case"MultiLineString":n=[],o.length=(0,_simplify.douglasPeuckerArray)(o,0,t.simplifiedGeometry_.ends_,t.simplifiedGeometry_.stride_,r,o,0,n);break;case"Polygon":n=[],o.length=(0,_simplify.quantizeArray)(o,0,t.simplifiedGeometry_.ends_,t.simplifiedGeometry_.stride_,Math.sqrt(r),o,0,n)}return n&&(t.simplifiedGeometry_=new e(t.type_,o,n,2,t.properties_,t.id_)),t.squaredTolerance_=r,t.simplifiedGeometry_}),this}}])}();function toGeometry(e){var t=e.getType();switch(t){case"Point":return new _geom.Point(e.getFlatCoordinates());case"MultiPoint":return new _geom.MultiPoint(e.getFlatCoordinates(),"XY");case"LineString":return new _geom.LineString(e.getFlatCoordinates(),"XY");case"MultiLineString":return new _geom.MultiLineString(e.getFlatCoordinates(),"XY",e.getEnds());case"Polygon":var r=e.getFlatCoordinates(),i=e.getEnds(),n=(0,_orient.inflateEnds)(r,i);return n.length>1?new _geom.MultiPolygon(r,"XY",n):new _geom.Polygon(r,"XY",i);default:throw new Error("Invalid geometry type:"+t)}}function toFeature(e,t){var r=e.getId(),i=toGeometry(e),n=e.getProperties(),o=new _Feature.default;return void 0!==t&&o.setGeometryName(t),o.setGeometry(i),void 0!==r&&o.setId(r),o.setProperties(n,!0),o}RenderFeature.prototype.getFlatCoordinates=RenderFeature.prototype.getOrientedFlatCoordinates;var _default=exports.default=RenderFeature;

},{"../Feature.js":13,"../array.js":36,"../extent.js":59,"../functions.js":62,"../geom.js":63,"../geom/flat/center.js":76,"../geom/flat/interiorpoint.js":81,"../geom/flat/interpolate.js":82,"../geom/flat/orient.js":86,"../geom/flat/simplify.js":89,"../geom/flat/transform.js":92,"../proj.js":123,"../transform.js":203}],135:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey(n.key),n)}}function _createClass(e,t,o){return t&&_defineProperties(e.prototype,t),o&&_defineProperties(e,o),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var n=o.call(e,t||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var VectorContext=function(){return _createClass(function e(){_classCallCheck(this,e)},[{key:"drawCustom",value:function(e,t,o,n,r){}},{key:"drawGeometry",value:function(e){}},{key:"setStyle",value:function(e){}},{key:"drawCircle",value:function(e,t,o){}},{key:"drawFeature",value:function(e,t,o){}},{key:"drawGeometryCollection",value:function(e,t,o){}},{key:"drawLineString",value:function(e,t,o){}},{key:"drawMultiLineString",value:function(e,t,o){}},{key:"drawMultiPoint",value:function(e,t,o){}},{key:"drawMultiPolygon",value:function(e,t,o){}},{key:"drawPoint",value:function(e,t,o){}},{key:"drawPolygon",value:function(e,t,o){}},{key:"drawText",value:function(e,t,o){}},{key:"setFillStrokeStyle",value:function(e,t){}},{key:"setImageStyle",value:function(e,t){}},{key:"setTextStyle",value:function(e,t){}}])}(),_default=exports.default=VectorContext;

},{}],136:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.defaultTextBaseline=exports.defaultTextAlign=exports.defaultStrokeStyle=exports.defaultPadding=exports.defaultMiterLimit=exports.defaultLineWidth=exports.defaultLineJoin=exports.defaultLineDashOffset=exports.defaultLineDash=exports.defaultLineCap=exports.defaultFont=exports.defaultFillStyle=exports.checkedFonts=void 0,exports.drawImageOrLabel=drawImageOrLabel,exports.getTextDimensions=getTextDimensions,exports.measureAndCacheTextWidth=measureAndCacheTextWidth,exports.measureTextHeight=void 0,exports.measureTextWidth=measureTextWidth,exports.registerFont=void 0,exports.rotateAtOffset=rotateAtOffset,exports.textHeights=void 0;var _Object=_interopRequireDefault(require("../Object.js")),_has=require("../has.js"),_obj=require("../obj.js"),_dom=require("../dom.js"),_css=require("../css.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_unsupportedIterableToArray(e,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=Array(t);r<t;r++)a[r]=e[r];return a}function _iterableToArrayLimit(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var a,n,o,s,i=[],l=!0,u=!1;try{if(o=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(a=o.call(r)).done)&&(i.push(a.value),i.length!==t);l=!0);}catch(e){u=!0,n=e}finally{try{if(!l&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(u)throw n}}return i}}function _arrayWithHoles(e){if(Array.isArray(e))return e}var measureFont,defaultFont=exports.defaultFont="10px sans-serif",defaultFillStyle=exports.defaultFillStyle="#000",defaultLineCap=exports.defaultLineCap="round",defaultLineDash=exports.defaultLineDash=[],defaultLineDashOffset=exports.defaultLineDashOffset=0,defaultLineJoin=exports.defaultLineJoin="round",defaultMiterLimit=exports.defaultMiterLimit=10,defaultStrokeStyle=exports.defaultStrokeStyle="#000",defaultTextAlign=exports.defaultTextAlign="center",defaultTextBaseline=exports.defaultTextBaseline="middle",defaultPadding=exports.defaultPadding=[0,0,0,0],defaultLineWidth=exports.defaultLineWidth=1,checkedFonts=exports.checkedFonts=new _Object.default,measureContext=null,textHeights=exports.textHeights={},registerFont=exports.registerFont=function(){var e,t,r=100,a="32px ",n=["monospace","serif"],o=n.length,s="wmytzilWMYTZIL@#/&?$%10";function i(e,r,i){for(var l=!0,u=0;u<o;++u){var d=n[u];if(t=measureTextWidth(e+" "+r+" "+a+d,s),i!=d){var f=measureTextWidth(e+" "+r+" "+a+i+","+d,s);l=l&&f!=t}}return!!l}function l(){for(var t=!0,a=checkedFonts.getKeys(),n=0,o=a.length;n<o;++n){var s=a[n];if(checkedFonts.get(s)<r){var l=_slicedToArray(s.split("\n"),3);i(l[0],l[1],l[2])?((0,_obj.clear)(textHeights),measureContext=null,measureFont=void 0,checkedFonts.set(s,r)):(checkedFonts.set(s,checkedFonts.get(s)+1,!0),t=!1)}}t&&(clearInterval(e),e=void 0)}return function(t){var a=(0,_css.getFontParameters)(t);if(a)for(var n=a.families,o=0,s=n.length;o<s;++o){var u=n[o],d=a.style+"\n"+a.weight+"\n"+u;void 0===checkedFonts.get(d)&&(checkedFonts.set(d,r,!0),i(a.style,a.weight,u)||(checkedFonts.set(d,0,!0),void 0===e&&(e=setInterval(l,32))))}}}(),measureTextHeight=exports.measureTextHeight=function(){var e;return function(t){var r=textHeights[t];if(null==r){if(_has.WORKER_OFFSCREEN_CANVAS){var a=(0,_css.getFontParameters)(t),n=measureText(t,"Žg");r=(isNaN(Number(a.lineHeight))?1.2:Number(a.lineHeight))*(n.actualBoundingBoxAscent+n.actualBoundingBoxDescent)}else e||((e=document.createElement("div")).innerHTML="M",e.style.minHeight="0",e.style.maxHeight="none",e.style.height="auto",e.style.padding="0",e.style.border="none",e.style.position="absolute",e.style.display="block",e.style.left="-99999px"),e.style.font=t,document.body.appendChild(e),r=e.offsetHeight,document.body.removeChild(e);textHeights[t]=r}return r}}();function measureText(e,t){return measureContext||(measureContext=(0,_dom.createCanvasContext2D)(1,1)),e!=measureFont&&(measureContext.font=e,measureFont=measureContext.font),measureContext.measureText(t)}function measureTextWidth(e,t){return measureText(e,t).width}function measureAndCacheTextWidth(e,t,r){if(t in r)return r[t];var a=t.split("\n").reduce(function(t,r){return Math.max(t,measureTextWidth(e,r))},0);return r[t]=a,a}function getTextDimensions(e,t){for(var r=[],a=[],n=[],o=0,s=0,i=0,l=0,u=0,d=t.length;u<=d;u+=2){var f=t[u];if("\n"!==f&&u!==d){var c=t[u+1]||e.font,x=measureTextWidth(c,f);r.push(x),s+=x;var h=measureTextHeight(c);a.push(h),l=Math.max(l,h)}else o=Math.max(o,s),n.push(s),s=0,i+=l,l=0}return{width:o,height:i,widths:r,heights:a,lineWidths:n}}function rotateAtOffset(e,t,r,a){0!==t&&(e.translate(r,a),e.rotate(t),e.translate(-r,-a))}function drawImageOrLabel(e,t,r,a,n,o,s,i,l,u,d){e.save(),1!==r&&(void 0===e.globalAlpha?e.globalAlpha=function(e){return e.globalAlpha*=r}:e.globalAlpha*=r),t&&e.transform.apply(e,t),a.contextInstructions?(e.translate(l,u),e.scale(d[0],d[1]),executeLabelInstructions(a,e)):d[0]<0||d[1]<0?(e.translate(l,u),e.scale(d[0],d[1]),e.drawImage(a,n,o,s,i,0,0,s,i)):e.drawImage(a,n,o,s,i,l,u,s*d[0],i*d[1]),e.restore()}function executeLabelInstructions(e,t){for(var r=e.contextInstructions,a=0,n=r.length;a<n;a+=2)Array.isArray(r[a+1])?t[r[a]].apply(t,r[a+1]):t[r[a]]=r[a+1]}

},{"../Object.js":25,"../css.js":48,"../dom.js":49,"../has.js":93,"../obj.js":121}],137:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _Instruction=_interopRequireDefault(require("./Instruction.js")),_Relationship=_interopRequireDefault(require("../../extent/Relationship.js")),_VectorContext2=_interopRequireDefault(require("../VectorContext.js")),_colorlike=require("../../colorlike.js"),_extent=require("../../extent.js"),_canvas=require("../canvas.js"),_array=require("../../array.js"),_inflate=require("../../geom/flat/inflate.js");function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,_toPropertyKey(n.key),n)}}function _createClass(t,e,i){return e&&_defineProperties(t.prototype,e),i&&_defineProperties(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,e||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _callSuper(t,e,i){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,i||[],_getPrototypeOf(t).constructor):e.apply(t,i))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var CanvasBuilder=function(t){function e(t,i,n,r){var o;return _classCallCheck(this,e),(o=_callSuper(this,e)).tolerance=t,o.maxExtent=i,o.pixelRatio=r,o.maxLineWidth=0,o.resolution=n,o.beginGeometryInstruction1_=null,o.beginGeometryInstruction2_=null,o.bufferedMaxExtent_=null,o.instructions=[],o.coordinates=[],o.tmpCoordinate_=[],o.hitDetectionInstructions=[],o.state={},o}return _inherits(e,_VectorContext2["default"]),_createClass(e,[{key:"applyPixelRatio",value:function(t){var e=this.pixelRatio;return 1==e?t:t.map(function(t){return t*e})}},{key:"appendFlatPointCoordinates",value:function(t,e){for(var i=this.getBufferedMaxExtent(),n=this.tmpCoordinate_,r=this.coordinates,o=r.length,s=0,a=t.length;s<a;s+=e)n[0]=t[s],n[1]=t[s+1],(0,_extent.containsCoordinate)(i,n)&&(r[o++]=n[0],r[o++]=n[1]);return o}},{key:"appendFlatLineCoordinates",value:function(t,e,i,n,r,o){var s=this.coordinates,a=s.length,u=this.getBufferedMaxExtent();o&&(e+=n);var l,c,f,h=t[e],d=t[e+1],_=this.tmpCoordinate_,p=!0;for(l=e+n;l<i;l+=n)_[0]=t[l],_[1]=t[l+1],(f=(0,_extent.coordinateRelationship)(u,_))!==c?(p&&(s[a++]=h,s[a++]=d,p=!1),s[a++]=_[0],s[a++]=_[1]):f===_Relationship.default.INTERSECTING?(s[a++]=_[0],s[a++]=_[1],p=!1):p=!0,h=_[0],d=_[1],c=f;return(r&&p||l===e+n)&&(s[a++]=h,s[a++]=d),a}},{key:"drawCustomCoordinates_",value:function(t,e,i,n,r){for(var o=0,s=i.length;o<s;++o){var a=i[o],u=this.appendFlatLineCoordinates(t,e,a,n,!1,!1);r.push(u),e=a}return e}},{key:"drawCustom",value:function(t,e,i,n,r){this.beginGeometry(t,e,r);var o,s,a,u,l,c=t.getType(),f=t.getStride(),h=this.coordinates.length;switch(c){case"MultiPolygon":o=t.getOrientedFlatCoordinates(),u=[];var d=t.getEndss();l=0;for(var _=0,p=d.length;_<p;++_){var y=[];l=this.drawCustomCoordinates_(o,l,d[_],f,y),u.push(y)}this.instructions.push([_Instruction.default.CUSTOM,h,u,t,i,_inflate.inflateMultiCoordinatesArray,r]),this.hitDetectionInstructions.push([_Instruction.default.CUSTOM,h,u,t,n||i,_inflate.inflateMultiCoordinatesArray,r]);break;case"Polygon":case"MultiLineString":a=[],o="Polygon"==c?t.getOrientedFlatCoordinates():t.getFlatCoordinates(),l=this.drawCustomCoordinates_(o,0,t.getEnds(),f,a),this.instructions.push([_Instruction.default.CUSTOM,h,a,t,i,_inflate.inflateCoordinatesArray,r]),this.hitDetectionInstructions.push([_Instruction.default.CUSTOM,h,a,t,n||i,_inflate.inflateCoordinatesArray,r]);break;case"LineString":case"Circle":o=t.getFlatCoordinates(),s=this.appendFlatLineCoordinates(o,0,o.length,f,!1,!1),this.instructions.push([_Instruction.default.CUSTOM,h,s,t,i,_inflate.inflateCoordinates,r]),this.hitDetectionInstructions.push([_Instruction.default.CUSTOM,h,s,t,n||i,_inflate.inflateCoordinates,r]);break;case"MultiPoint":o=t.getFlatCoordinates(),(s=this.appendFlatPointCoordinates(o,f))>h&&(this.instructions.push([_Instruction.default.CUSTOM,h,s,t,i,_inflate.inflateCoordinates,r]),this.hitDetectionInstructions.push([_Instruction.default.CUSTOM,h,s,t,n||i,_inflate.inflateCoordinates,r]));break;case"Point":o=t.getFlatCoordinates(),this.coordinates.push(o[0],o[1]),s=this.coordinates.length,this.instructions.push([_Instruction.default.CUSTOM,h,s,t,i,void 0,r]),this.hitDetectionInstructions.push([_Instruction.default.CUSTOM,h,s,t,n||i,void 0,r])}this.endGeometry(e)}},{key:"beginGeometry",value:function(t,e,i){this.beginGeometryInstruction1_=[_Instruction.default.BEGIN_GEOMETRY,e,0,t,i],this.instructions.push(this.beginGeometryInstruction1_),this.beginGeometryInstruction2_=[_Instruction.default.BEGIN_GEOMETRY,e,0,t,i],this.hitDetectionInstructions.push(this.beginGeometryInstruction2_)}},{key:"finish",value:function(){return{instructions:this.instructions,hitDetectionInstructions:this.hitDetectionInstructions,coordinates:this.coordinates}}},{key:"reverseHitDetectionInstructions",value:function(){var t,e=this.hitDetectionInstructions;e.reverse();var i,n,r=e.length,o=-1;for(t=0;t<r;++t)(n=(i=e[t])[0])==_Instruction.default.END_GEOMETRY?o=t:n==_Instruction.default.BEGIN_GEOMETRY&&(i[2]=t,(0,_array.reverseSubArray)(this.hitDetectionInstructions,o,t),o=-1)}},{key:"setFillStrokeStyle",value:function(t,e){var i=this.state;if(t){var n=t.getColor();i.fillPatternScale=n&&"object"===_typeof(n)&&"src"in n?this.pixelRatio:1,i.fillStyle=(0,_colorlike.asColorLike)(n||_canvas.defaultFillStyle)}else i.fillStyle=void 0;if(e){var r=e.getColor();i.strokeStyle=(0,_colorlike.asColorLike)(r||_canvas.defaultStrokeStyle);var o=e.getLineCap();i.lineCap=void 0!==o?o:_canvas.defaultLineCap;var s=e.getLineDash();i.lineDash=s?s.slice():_canvas.defaultLineDash;var a=e.getLineDashOffset();i.lineDashOffset=a||_canvas.defaultLineDashOffset;var u=e.getLineJoin();i.lineJoin=void 0!==u?u:_canvas.defaultLineJoin;var l=e.getWidth();i.lineWidth=void 0!==l?l:_canvas.defaultLineWidth;var c=e.getMiterLimit();i.miterLimit=void 0!==c?c:_canvas.defaultMiterLimit,i.lineWidth>this.maxLineWidth&&(this.maxLineWidth=i.lineWidth,this.bufferedMaxExtent_=null)}else i.strokeStyle=void 0,i.lineCap=void 0,i.lineDash=null,i.lineDashOffset=void 0,i.lineJoin=void 0,i.lineWidth=void 0,i.miterLimit=void 0}},{key:"createFill",value:function(t){var e=t.fillStyle,i=[_Instruction.default.SET_FILL_STYLE,e];return"string"!=typeof e&&i.push(t.fillPatternScale),i}},{key:"applyStroke",value:function(t){this.instructions.push(this.createStroke(t))}},{key:"createStroke",value:function(t){return[_Instruction.default.SET_STROKE_STYLE,t.strokeStyle,t.lineWidth*this.pixelRatio,t.lineCap,t.lineJoin,t.miterLimit,this.applyPixelRatio(t.lineDash),t.lineDashOffset*this.pixelRatio]}},{key:"updateFillStyle",value:function(t,e){var i=t.fillStyle;"string"==typeof i&&t.currentFillStyle==i||(void 0!==i&&this.instructions.push(e.call(this,t)),t.currentFillStyle=i)}},{key:"updateStrokeStyle",value:function(t,e){var i=t.strokeStyle,n=t.lineCap,r=t.lineDash,o=t.lineDashOffset,s=t.lineJoin,a=t.lineWidth,u=t.miterLimit;(t.currentStrokeStyle!=i||t.currentLineCap!=n||r!=t.currentLineDash&&!(0,_array.equals)(t.currentLineDash,r)||t.currentLineDashOffset!=o||t.currentLineJoin!=s||t.currentLineWidth!=a||t.currentMiterLimit!=u)&&(void 0!==i&&e.call(this,t),t.currentStrokeStyle=i,t.currentLineCap=n,t.currentLineDash=r,t.currentLineDashOffset=o,t.currentLineJoin=s,t.currentLineWidth=a,t.currentMiterLimit=u)}},{key:"endGeometry",value:function(t){this.beginGeometryInstruction1_[2]=this.instructions.length,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_[2]=this.hitDetectionInstructions.length,this.beginGeometryInstruction2_=null;var e=[_Instruction.default.END_GEOMETRY,t];this.instructions.push(e),this.hitDetectionInstructions.push(e)}},{key:"getBufferedMaxExtent",value:function(){if(!this.bufferedMaxExtent_&&(this.bufferedMaxExtent_=(0,_extent.clone)(this.maxExtent),this.maxLineWidth>0)){var t=this.resolution*(this.maxLineWidth+1)/2;(0,_extent.buffer)(this.bufferedMaxExtent_,t,this.bufferedMaxExtent_)}return this.bufferedMaxExtent_}}])}(),_default=exports.default=CanvasBuilder;

},{"../../array.js":36,"../../colorlike.js":40,"../../extent.js":59,"../../extent/Relationship.js":60,"../../geom/flat/inflate.js":80,"../VectorContext.js":135,"../canvas.js":136,"./Instruction.js":143}],138:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _Builder=_interopRequireDefault(require("./Builder.js")),_ImageBuilder=_interopRequireDefault(require("./ImageBuilder.js")),_LineStringBuilder=_interopRequireDefault(require("./LineStringBuilder.js")),_PolygonBuilder=_interopRequireDefault(require("./PolygonBuilder.js")),_TextBuilder=_interopRequireDefault(require("./TextBuilder.js"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,r){for(var t=0;t<r.length;t++){var i=r[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,_toPropertyKey(i.key),i)}}function _createClass(e,r,t){return r&&_defineProperties(e.prototype,r),t&&_defineProperties(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var r=_toPrimitive(e,"string");return"symbol"==_typeof(r)?r:r+""}function _toPrimitive(e,r){if("object"!=_typeof(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var i=t.call(e,r||"default");if("object"!=_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(e)}var BATCH_CONSTRUCTORS={Circle:_PolygonBuilder.default,Default:_Builder.default,Image:_ImageBuilder.default,LineString:_LineStringBuilder.default,Polygon:_PolygonBuilder.default,Text:_TextBuilder.default},BuilderGroup=function(){return _createClass(function e(r,t,i,o){_classCallCheck(this,e),this.tolerance_=r,this.maxExtent_=t,this.pixelRatio_=o,this.resolution_=i,this.buildersByZIndex_={}},[{key:"finish",value:function(){var e={};for(var r in this.buildersByZIndex_){e[r]=e[r]||{};var t=this.buildersByZIndex_[r];for(var i in t){var o=t[i].finish();e[r][i]=o}}return e}},{key:"getBuilder",value:function(e,r){var t=void 0!==e?e.toString():"0",i=this.buildersByZIndex_[t];void 0===i&&(i={},this.buildersByZIndex_[t]=i);var o=i[r];void 0===o&&(o=new(0,BATCH_CONSTRUCTORS[r])(this.tolerance_,this.maxExtent_,this.resolution_,this.pixelRatio_),i[r]=o);return o}}])}(),_default=exports.default=BuilderGroup;

},{"./Builder.js":137,"./ImageBuilder.js":141,"./LineStringBuilder.js":144,"./PolygonBuilder.js":145,"./TextBuilder.js":146}],139:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _Instruction=_interopRequireDefault(require("./Instruction.js")),_ZIndexContext=_interopRequireDefault(require("../canvas/ZIndexContext.js")),_TextBuilder=require("./TextBuilder.js"),_transform=require("../../transform.js"),_extent=require("../../extent.js"),_canvas=require("../canvas.js"),_textpath=require("../../geom/flat/textpath.js"),_array=require("../../array.js"),_length=require("../../geom/flat/length.js"),_transform2=require("../../geom/flat/transform.js");function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,_toPropertyKey(r.key),r)}}function _createClass(t,e,i){return e&&_defineProperties(t.prototype,e),i&&_defineProperties(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=_typeof(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var tmpExtent=(0,_extent.createEmpty)(),p1=[],p2=[],p3=[],p4=[];function getDeclutterBox(t){return t[3].declutterBox}var rtlRegEx=new RegExp("["+String.fromCharCode(1425)+"-"+String.fromCharCode(2303)+String.fromCharCode(64285)+"-"+String.fromCharCode(65023)+String.fromCharCode(65136)+"-"+String.fromCharCode(65276)+String.fromCharCode(67584)+"-"+String.fromCharCode(69631)+String.fromCharCode(124928)+"-"+String.fromCharCode(126975)+"]");function horizontalTextAlign(t,e){return"start"===e?e=rtlRegEx.test(t)?"right":"left":"end"===e&&(e=rtlRegEx.test(t)?"left":"right"),_TextBuilder.TEXT_ALIGN[e]}function createTextChunks(t,e,i){return i>0&&t.push("\n",""),t.push(e,""),t}var Executor=function(){return _createClass(function t(e,i,r,a,n){_classCallCheck(this,t),this.overlaps=r,this.pixelRatio=i,this.resolution=e,this.alignAndScaleFill_,this.instructions=a.instructions,this.coordinates=a.coordinates,this.coordinateCache_={},this.renderedTransform_=(0,_transform.create)(),this.hitDetectionInstructions=a.hitDetectionInstructions,this.pixelCoordinates_=null,this.viewRotation_=0,this.fillStates=a.fillStates||{},this.strokeStates=a.strokeStates||{},this.textStates=a.textStates||{},this.widths_={},this.labels_={},this.zIndexContext_=n?new _ZIndexContext.default:null},[{key:"getZIndexContext",value:function(){return this.zIndexContext_}},{key:"createLabel",value:function(t,e,i,r){var a=t+e+i+r;if(this.labels_[a])return this.labels_[a];var n=r?this.strokeStates[r]:null,s=i?this.fillStates[i]:null,o=this.textStates[e],l=this.pixelRatio,h=[o.scale[0]*l,o.scale[1]*l],u=o.justify?_TextBuilder.TEXT_ALIGN[o.justify]:horizontalTextAlign(Array.isArray(t)?t[0]:t,o.textAlign||_canvas.defaultTextAlign),c=r&&n.lineWidth?n.lineWidth:0,d=Array.isArray(t)?t:String(t).split("\n").reduce(createTextChunks,[]),p=(0,_canvas.getTextDimensions)(o,d),f=p.width,_=p.height,v=p.widths,m=p.heights,x=p.lineWidths,g=f+c,y=[],b=(g+2)*h[0],I=(_+c)*h[1],S={width:b<0?Math.floor(b):Math.ceil(b),height:I<0?Math.floor(I):Math.ceil(I),contextInstructions:y};1==h[0]&&1==h[1]||y.push("scale",h),r&&(y.push("strokeStyle",n.strokeStyle),y.push("lineWidth",c),y.push("lineCap",n.lineCap),y.push("lineJoin",n.lineJoin),y.push("miterLimit",n.miterLimit),y.push("setLineDash",[n.lineDash]),y.push("lineDashOffset",n.lineDashOffset)),i&&y.push("fillStyle",s.fillStyle),y.push("textBaseline","middle"),y.push("textAlign","center");for(var T,C=.5-u,k=u*g+C*c,w=[],E=[],A=0,L=0,M=0,R=0,O=0,P=d.length;O<P;O+=2){var D=d[O];if("\n"!==D){var B=d[O+1]||o.font;B!==T&&(r&&w.push("font",B),i&&E.push("font",B),T=B),A=Math.max(A,m[M]);var j=[D,k+C*v[M]+u*(v[M]-x[R]),.5*(c+A)+L];k+=v[M],r&&w.push("strokeText",j),i&&E.push("fillText",j),++M}else L+=A,A=0,k=u*g+C*c,++R}return Array.prototype.push.apply(y,w),Array.prototype.push.apply(y,E),this.labels_[a]=S,S}},{key:"replayTextBackground_",value:function(t,e,i,r,a,n,s){t.beginPath(),t.moveTo.apply(t,e),t.lineTo.apply(t,i),t.lineTo.apply(t,r),t.lineTo.apply(t,a),t.lineTo.apply(t,e),n&&(this.alignAndScaleFill_=n[2],this.fill_(t)),s&&(this.setStrokeStyle_(t,s),t.stroke())}},{key:"calculateImageOrLabelDimensions_",value:function(t,e,i,r,a,n,s,o,l,h,u,c,d,p,f,_){var v,m=i-(s*=c[0]),x=r-(o*=c[1]),g=a+l>t?t-l:a,y=n+h>e?e-h:n,b=p[3]+g*c[0]+p[1],I=p[0]+y*c[1]+p[2],S=m-p[3],T=x-p[0];return(f||0!==u)&&(p1[0]=S,p4[0]=S,p1[1]=T,p2[1]=T,p2[0]=S+b,p3[0]=p2[0],p3[1]=T+I,p4[1]=p3[1]),0!==u?(v=(0,_transform.compose)((0,_transform.create)(),i,r,1,1,u,-i,-r),(0,_transform.apply)(v,p1),(0,_transform.apply)(v,p2),(0,_transform.apply)(v,p3),(0,_transform.apply)(v,p4),(0,_extent.createOrUpdate)(Math.min(p1[0],p2[0],p3[0],p4[0]),Math.min(p1[1],p2[1],p3[1],p4[1]),Math.max(p1[0],p2[0],p3[0],p4[0]),Math.max(p1[1],p2[1],p3[1],p4[1]),tmpExtent)):(0,_extent.createOrUpdate)(Math.min(S,S+b),Math.min(T,T+I),Math.max(S,S+b),Math.max(T,T+I),tmpExtent),d&&(m=Math.round(m),x=Math.round(x)),{drawImageX:m,drawImageY:x,drawImageW:g,drawImageH:y,originX:l,originY:h,declutterBox:{minX:tmpExtent[0],minY:tmpExtent[1],maxX:tmpExtent[2],maxY:tmpExtent[3],value:_},canvasTransform:v,scale:c}}},{key:"replayImageOrLabel_",value:function(t,e,i,r,a,n,s){var o=!(!n&&!s),l=r.declutterBox,h=s?s[2]*r.scale[0]/2:0;return l.minX-h<=e[0]&&l.maxX+h>=0&&l.minY-h<=e[1]&&l.maxY+h>=0&&(o&&this.replayTextBackground_(t,p1,p2,p3,p4,n,s),(0,_canvas.drawImageOrLabel)(t,r.canvasTransform,a,i,r.originX,r.originY,r.drawImageW,r.drawImageH,r.drawImageX,r.drawImageY,r.scale)),!0}},{key:"fill_",value:function(t){var e=this.alignAndScaleFill_;if(e){var i=(0,_transform.apply)(this.renderedTransform_,[0,0]),r=512*this.pixelRatio;t.save(),t.translate(i[0]%r,i[1]%r),1!==e&&t.scale(e,e),t.rotate(this.viewRotation_)}t.fill(),e&&t.restore()}},{key:"setStrokeStyle_",value:function(t,e){t.strokeStyle=e[1],t.lineWidth=e[2],t.lineCap=e[3],t.lineJoin=e[4],t.miterLimit=e[5],t.lineDashOffset=e[7],t.setLineDash(e[6])}},{key:"drawLabelWithPointPlacement_",value:function(t,e,i,r){var a=this.textStates[e],n=this.createLabel(t,e,r,i),s=this.strokeStates[i],o=this.pixelRatio,l=horizontalTextAlign(Array.isArray(t)?t[0]:t,a.textAlign||_canvas.defaultTextAlign),h=_TextBuilder.TEXT_ALIGN[a.textBaseline||_canvas.defaultTextBaseline],u=s&&s.lineWidth?s.lineWidth:0;return{label:n,anchorX:l*(n.width/o-2*a.scale[0])+2*(.5-l)*u,anchorY:h*n.height/o+2*(.5-h)*u}}},{key:"execute_",value:function(t,e,i,r,a,n,s,o){var l,h=this.zIndexContext_;this.pixelCoordinates_&&(0,_array.equals)(i,this.renderedTransform_)?l=this.pixelCoordinates_:(this.pixelCoordinates_||(this.pixelCoordinates_=[]),l=(0,_transform2.transform2D)(this.coordinates,0,this.coordinates.length,2,i,this.pixelCoordinates_),(0,_transform.setFromArray)(this.renderedTransform_,i));for(var u,c,d,p,f,_,v,m,x,g,y,b,I,S,T,C,k,w=0,E=r.length,A=0,L=0,M=0,R=null,O=null,P=this.coordinateCache_,D=this.viewRotation_,B=Math.round(1e12*Math.atan2(-i[1],i[0]))/1e12,j={context:t,pixelRatio:this.pixelRatio,resolution:this.resolution,rotation:D},q=this.instructions!=r||this.overlaps?0:200;w<E;){var W=r[w];switch(W[0]){case _Instruction.default.BEGIN_GEOMETRY:S=W[1],k=W[3],S.getGeometry()?void 0===s||(0,_extent.intersects)(s,k.getExtent())?++w:w=W[2]+1:w=W[2],h&&(h.zIndex=W[4]);break;case _Instruction.default.BEGIN_PATH:L>q&&(this.fill_(t),L=0),M>q&&(t.stroke(),M=0),L||M||(t.beginPath(),f=NaN,_=NaN),++w;break;case _Instruction.default.CIRCLE:var Y=l[A=W[1]],X=l[A+1],N=l[A+2]-Y,z=l[A+3]-X,G=Math.sqrt(N*N+z*z);t.moveTo(Y+G,X),t.arc(Y,X,G,0,2*Math.PI,!0),++w;break;case _Instruction.default.CLOSE_PATH:t.closePath(),++w;break;case _Instruction.default.CUSTOM:A=W[1],u=W[2];var F=W[3],H=W[4],K=W[5];j.geometry=F,j.feature=S,w in P||(P[w]=[]);var Z=P[w];K?K(l,A,u,2,Z):(Z[0]=l[A],Z[1]=l[A+1],Z.length=2),h&&(h.zIndex=W[6]),H(Z,j),++w;break;case _Instruction.default.DRAW_IMAGE:A=W[1],u=W[2],x=W[3],c=W[4],d=W[5];var J=W[6],U=W[7],V=W[8],Q=W[9],$=W[10],tt=W[11],et=W[12],it=W[13];p=W[14]||"declutter";var rt=W[15];if(!x&&W.length>=20){g=W[19],y=W[20],b=W[21],I=W[22];var at=this.drawLabelWithPointPlacement_(g,y,b,I);x=at.label,W[3]=x;var nt=W[23];c=(at.anchorX-nt)*this.pixelRatio,W[4]=c;var st=W[24];d=(at.anchorY-st)*this.pixelRatio,W[5]=d,J=x.height,W[6]=J,it=x.width,W[13]=it}var ot=void 0;W.length>25&&(ot=W[25]);var lt=void 0,ht=void 0,ut=void 0;W.length>17?(lt=W[16],ht=W[17],ut=W[18]):(lt=_canvas.defaultPadding,ht=!1,ut=!1),$&&B?tt+=D:$||B||(tt-=D);for(var ct=0;A<u;A+=2)if(!(ot&&ot[ct++]<it/this.pixelRatio)){var dt=this.calculateImageOrLabelDimensions_(x.width,x.height,l[A],l[A+1],it,J,c,d,V,Q,tt,et,a,lt,ht||ut,S),pt=[t,e,x,dt,U,ht?R:null,ut?O:null];if(o){var ft=void 0,_t=void 0,vt=void 0;if(rt){var mt=u-A;if(!rt[mt]){rt[mt]={args:pt,declutterMode:p};continue}var xt=rt[mt];ft=xt.args,_t=xt.declutterMode,delete rt[mt],vt=getDeclutterBox(ft)}var gt=void 0,yt=void 0;if(!ft||"declutter"===_t&&o.collides(vt)||(gt=!0),"declutter"===p&&o.collides(dt.declutterBox)||(yt=!0),"declutter"===_t&&"declutter"===p){var bt=gt&&yt;gt=bt,yt=bt}gt&&("none"!==_t&&o.insert(vt),this.replayImageOrLabel_.apply(this,ft)),yt&&("none"!==p&&o.insert(dt.declutterBox),this.replayImageOrLabel_.apply(this,pt))}else this.replayImageOrLabel_.apply(this,pt)}++w;break;case _Instruction.default.DRAW_CHARS:var It=W[1],St=W[2],Tt=W[3],Ct=W[4];I=W[5];var kt=W[6],wt=W[7],Et=W[8];b=W[9];var At=W[10];g=W[11],y=W[12];var Lt=[W[13],W[13]];p=W[14]||"declutter";var Mt=this.textStates[y],Rt=Mt.font,Ot=[Mt.scale[0]*wt,Mt.scale[1]*wt],Pt=void 0;Rt in this.widths_?Pt=this.widths_[Rt]:(Pt={},this.widths_[Rt]=Pt);var Dt=(0,_length.lineStringLength)(l,It,St,2),Bt=Math.abs(Ot[0])*(0,_canvas.measureAndCacheTextWidth)(Rt,g,Pt);if(Ct||Bt<=Dt){var jt=(Dt-Bt)*horizontalTextAlign(g,this.textStates[y].textAlign),qt=(0,_textpath.drawTextOnPath)(l,It,St,2,g,jt,kt,Math.abs(Ot[0]),_canvas.measureAndCacheTextWidth,Rt,Pt,B?0:this.viewRotation_);t:if(qt){var Wt=[],Yt=void 0,Xt=void 0,Nt=void 0,zt=void 0,Gt=void 0;if(b)for(Yt=0,Xt=qt.length;Yt<Xt;++Yt){Nt=(Gt=qt[Yt])[4],zt=this.createLabel(Nt,y,"",b),c=Gt[2]+(Ot[0]<0?-At:At),d=Tt*zt.height+2*(.5-Tt)*At*Ot[1]/Ot[0]-Et;var Ft=this.calculateImageOrLabelDimensions_(zt.width,zt.height,Gt[0],Gt[1],zt.width,zt.height,c,d,0,0,Gt[3],Lt,!1,_canvas.defaultPadding,!1,S);if(o&&"declutter"===p&&o.collides(Ft.declutterBox))break t;Wt.push([t,e,zt,Ft,1,null,null])}if(I)for(Yt=0,Xt=qt.length;Yt<Xt;++Yt){Nt=(Gt=qt[Yt])[4],zt=this.createLabel(Nt,y,I,""),c=Gt[2],d=Tt*zt.height-Et;var Ht=this.calculateImageOrLabelDimensions_(zt.width,zt.height,Gt[0],Gt[1],zt.width,zt.height,c,d,0,0,Gt[3],Lt,!1,_canvas.defaultPadding,!1,S);if(o&&"declutter"===p&&o.collides(Ht.declutterBox))break t;Wt.push([t,e,zt,Ht,1,null,null])}o&&"none"!==p&&o.load(Wt.map(getDeclutterBox));for(var Kt=0,Zt=Wt.length;Kt<Zt;++Kt)this.replayImageOrLabel_.apply(this,Wt[Kt])}}++w;break;case _Instruction.default.END_GEOMETRY:if(void 0!==n){var Jt=n(S=W[1],k,p);if(Jt)return Jt}++w;break;case _Instruction.default.FILL:q?L++:this.fill_(t),++w;break;case _Instruction.default.MOVE_TO_LINE_TO:for(A=W[1],u=W[2],T=l[A],C=l[A+1],t.moveTo(T,C),f=T+.5|0,_=C+.5|0,A+=2;A<u;A+=2)v=(T=l[A])+.5|0,m=(C=l[A+1])+.5|0,A!=u-2&&v===f&&m===_||(t.lineTo(T,C),f=v,_=m);++w;break;case _Instruction.default.SET_FILL_STYLE:R=W,this.alignAndScaleFill_=W[2],L&&(this.fill_(t),L=0,M&&(t.stroke(),M=0)),t.fillStyle=W[1],++w;break;case _Instruction.default.SET_STROKE_STYLE:O=W,M&&(t.stroke(),M=0),this.setStrokeStyle_(t,W),++w;break;case _Instruction.default.STROKE:q?M++:t.stroke(),++w;break;default:++w}}L&&this.fill_(t),M&&t.stroke()}},{key:"execute",value:function(t,e,i,r,a,n){this.viewRotation_=r,this.execute_(t,e,i,this.instructions,a,void 0,void 0,n)}},{key:"executeHitDetection",value:function(t,e,i,r,a){return this.viewRotation_=i,this.execute_(t,[t.canvas.width,t.canvas.height],e,this.hitDetectionInstructions,!0,r,a)}}])}(),_default=exports.default=Executor;

},{"../../array.js":36,"../../extent.js":59,"../../geom/flat/length.js":84,"../../geom/flat/textpath.js":91,"../../geom/flat/transform.js":92,"../../transform.js":203,"../canvas.js":136,"../canvas/ZIndexContext.js":147,"./Instruction.js":143,"./TextBuilder.js":146}],140:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=exports.NON_DECLUTTER=exports.DECLUTTER=exports.ALL=void 0,exports.getPixelIndexArray=getPixelIndexArray;var _Executor=_interopRequireDefault(require("./Executor.js")),_array=require("../../array.js"),_extent=require("../../extent.js"),_transform=require("../../transform.js"),_dom=require("../../dom.js"),_obj=require("../../obj.js"),_transform2=require("../../geom/flat/transform.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,r){if(e){if("string"==typeof e)return _arrayLikeToArray(e,r);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?_arrayLikeToArray(e,r):void 0}}function _iterableToArray(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _arrayLikeToArray(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,n=Array(r);t<r;t++)n[t]=e[t];return n}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey(n.key),n)}}function _createClass(e,r,t){return r&&_defineProperties(e.prototype,r),t&&_defineProperties(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var r=_toPrimitive(e,"string");return"symbol"==_typeof(r)?r:r+""}function _toPrimitive(e,r){if("object"!=_typeof(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,r||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(e)}var ALL=exports.ALL=["Polygon","Circle","LineString","Image","Text","Default"],DECLUTTER=exports.DECLUTTER=["Image","Text"],NON_DECLUTTER=exports.NON_DECLUTTER=ALL.filter(function(e){return!DECLUTTER.includes(e)}),ExecutorGroup=function(){return _createClass(function e(r,t,n,o,i,a,u){_classCallCheck(this,e),this.maxExtent_=r,this.overlaps_=o,this.pixelRatio_=n,this.resolution_=t,this.renderBuffer_=a,this.executorsByZIndex_={},this.hitDetectionContext_=null,this.hitDetectionTransform_=(0,_transform.create)(),this.renderedContext_=null,this.deferredZIndexContexts_={},this.createExecutors_(i,u)},[{key:"clip",value:function(e,r){var t=this.getClipCoords(r);e.beginPath(),e.moveTo(t[0],t[1]),e.lineTo(t[2],t[3]),e.lineTo(t[4],t[5]),e.lineTo(t[6],t[7]),e.clip()}},{key:"createExecutors_",value:function(e,r){for(var t in e){var n=this.executorsByZIndex_[t];void 0===n&&(n={},this.executorsByZIndex_[t]=n);var o=e[t];for(var i in o){var a=o[i];n[i]=new _Executor.default(this.resolution_,this.pixelRatio_,this.overlaps_,a,r)}}}},{key:"hasExecutors",value:function(e){for(var r in this.executorsByZIndex_)for(var t=this.executorsByZIndex_[r],n=0,o=e.length;n<o;++n)if(e[n]in t)return!0;return!1}},{key:"forEachFeatureAtCoordinate",value:function(e,r,t,n,o,i){var a=2*(n=Math.round(n))+1,u=(0,_transform.compose)(this.hitDetectionTransform_,n+.5,n+.5,1/r,-1/r,-t,-e[0],-e[1]),s=!this.hitDetectionContext_;s&&(this.hitDetectionContext_=(0,_dom.createCanvasContext2D)(a,a,void 0,{willReadFrequently:!0}));var l,c=this.hitDetectionContext_;c.canvas.width!==a||c.canvas.height!==a?(c.canvas.width=a,c.canvas.height=a):s||c.clearRect(0,0,a,a),void 0!==this.renderBuffer_&&(l=(0,_extent.createEmpty)(),(0,_extent.extendCoordinate)(l,e),(0,_extent.buffer)(l,r*(this.renderBuffer_+n),l));var f,d=getPixelIndexArray(n);function x(e,r,t){for(var u=c.getImageData(0,0,a,a).data,s=0,l=d.length;s<l;s++)if(u[d[s]]>0){if(!i||"none"===t||"Image"!==f&&"Text"!==f||i.includes(e)){var x=(d[s]-3)/4,y=n-x%a,_=n-(x/a|0),h=o(e,r,y*y+_*_);if(h)return h}c.clearRect(0,0,a,a);break}}var y,_,h,v,p,m=Object.keys(this.executorsByZIndex_).map(Number);for(m.sort(_array.ascending),y=m.length-1;y>=0;--y){var b=m[y].toString();for(h=this.executorsByZIndex_[b],_=ALL.length-1;_>=0;--_)if(void 0!==(v=h[f=ALL[_]])&&(p=v.executeHitDetection(c,u,t,x,l)))return p}}},{key:"getClipCoords",value:function(e){var r=this.maxExtent_;if(!r)return null;var t=r[0],n=r[1],o=r[2],i=r[3],a=[t,n,t,i,o,i,o,n];return(0,_transform2.transform2D)(a,0,8,2,e,a),a}},{key:"isEmpty",value:function(){return(0,_obj.isEmpty)(this.executorsByZIndex_)}},{key:"execute",value:function(e,r,t,n,o,i,a){var u=this,s=Object.keys(this.executorsByZIndex_).map(Number);s.sort(_array.ascending),i=i||ALL;var l,c,f,d,x,y=ALL.length;for(a&&s.reverse(),l=0,c=s.length;l<c;++l){var _=s[l].toString();x=this.executorsByZIndex_[_];var h=function(){var c=i[f],d=x[c];if(void 0!==d){var _=null===a?void 0:d.getZIndexContext(),h=_?_.getContext():e,v=u.maxExtent_&&"Image"!==c&&"Text"!==c;if(v&&(h.save(),u.clip(h,t)),_&&"Text"!==c&&"Image"!==c?_.pushFunction(function(e){return d.execute(e,r,t,n,o,a)}):d.execute(h,r,t,n,o,a),v&&h.restore(),_){_.offset();var p=s[l]*y+f;u.deferredZIndexContexts_[p]||(u.deferredZIndexContexts_[p]=[]),u.deferredZIndexContexts_[p].push(_)}}};for(f=0,d=i.length;f<d;++f)h()}this.renderedContext_=e}},{key:"getDeferredZIndexContexts",value:function(){return this.deferredZIndexContexts_}},{key:"getRenderedContext",value:function(){return this.renderedContext_}},{key:"renderDeferred",value:function(){for(var e=this,r=this.deferredZIndexContexts_,t=Object.keys(r).map(Number).sort(_array.ascending),n=0,o=t.length;n<o;++n)r[t[n]].forEach(function(r){r.draw(e.renderedContext_),r.clear()}),r[t[n]].length=0}}])}(),circlePixelIndexArrayCache={};function getPixelIndexArray(e){if(void 0!==circlePixelIndexArrayCache[e])return circlePixelIndexArrayCache[e];for(var r=2*e+1,t=e*e,n=new Array(t+1),o=0;o<=e;++o)for(var i=0;i<=e;++i){var a=o*o+i*i;if(a>t)break;var u=n[a];u||(u=[],n[a]=u),u.push(4*((e+o)*r+(e+i))+3),o>0&&u.push(4*((e-o)*r+(e+i))+3),i>0&&(u.push(4*((e+o)*r+(e-i))+3),o>0&&u.push(4*((e-o)*r+(e-i))+3))}for(var s=[],l=0,c=n.length;l<c;++l)n[l]&&s.push.apply(s,_toConsumableArray(n[l]));return circlePixelIndexArrayCache[e]=s,s}var _default=exports.default=ExecutorGroup;

},{"../../array.js":36,"../../dom.js":49,"../../extent.js":59,"../../geom/flat/transform.js":92,"../../obj.js":121,"../../transform.js":203,"./Executor.js":139}],141:[function(require,module,exports){
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _Builder=_interopRequireDefault(require("./Builder.js")),_Instruction=_interopRequireDefault(require("./Instruction.js")),_extent=require("../../extent.js");function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var i=0;i<e.length;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,_toPropertyKey(o.key),o)}}function _createClass(t,e,i){return e&&_defineProperties(t.prototype,e),i&&_defineProperties(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var o=i.call(t,e||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _callSuper(t,e,i){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,i||[],_getPrototypeOf(t).constructor):e.apply(t,i))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _superPropGet(t,e,i,o){var r=_get(_getPrototypeOf(1&o?t.prototype:t),e,i);return 2&o?function(t){return r.apply(i,t)}:r}function _get(){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,i){var o=_superPropBase(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(arguments.length<3?t:i):r.value}}).apply(null,arguments)}function _superPropBase(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=_getPrototypeOf(t)););return t}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var CanvasImageBuilder=function(t){function e(t,i,o,r){var n;return _classCallCheck(this,e),(n=_callSuper(this,e,[t,i,o,r])).hitDetectionImage_=null,n.image_=null,n.imagePixelRatio_=void 0,n.anchorX_=void 0,n.anchorY_=void 0,n.height_=void 0,n.opacity_=void 0,n.originX_=void 0,n.originY_=void 0,n.rotateWithView_=void 0,n.rotation_=void 0,n.scale_=void 0,n.width_=void 0,n.declutterMode_=void 0,n.declutterImageWithText_=void 0,n}return _inherits(e,_Builder["default"]),_createClass(e,[{key:"drawPoint",value:function(t,e,i){if(this.image_&&(!this.maxExtent||(0,_extent.containsCoordinate)(this.maxExtent,t.getFlatCoordinates()))){this.beginGeometry(t,e,i);var o=t.getFlatCoordinates(),r=t.getStride(),n=this.coordinates.length,s=this.appendFlatPointCoordinates(o,r);this.instructions.push([_Instruction.default.DRAW_IMAGE,n,s,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([_Instruction.default.DRAW_IMAGE,n,s,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(e)}}},{key:"drawMultiPoint",value:function(t,e,i){if(this.image_){this.beginGeometry(t,e,i);for(var o=t.getFlatCoordinates(),r=[],n=0,s=o.length;n<s;n+=t.getStride())this.maxExtent&&!(0,_extent.containsCoordinate)(this.maxExtent,o.slice(n,n+2))||r.push(o[n],o[n+1]);var a=this.coordinates.length,h=this.appendFlatPointCoordinates(r,2);this.instructions.push([_Instruction.default.DRAW_IMAGE,a,h,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([_Instruction.default.DRAW_IMAGE,a,h,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(e)}}},{key:"finish",value:function(){return this.reverseHitDetectionInstructions(),this.anchorX_=void 0,this.anchorY_=void 0,this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.height_=void 0,this.scale_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.width_=void 0,_superPropGet(e,"finish",this,3)([])}},{key:"setImageStyle",value:function(t,e){var i=t.getAnchor(),o=t.getSize(),r=t.getOrigin();this.imagePixelRatio_=t.getPixelRatio(this.pixelRatio),this.anchorX_=i[0],this.anchorY_=i[1],this.hitDetectionImage_=t.getHitDetectionImage(),this.image_=t.getImage(this.pixelRatio),this.height_=o[1],this.opacity_=t.getOpacity(),this.originX_=r[0],this.originY_=r[1],this.rotateWithView_=t.getRotateWithView(),this.rotation_=t.getRotation(),this.scale_=t.getScaleArray(),this.width_=o[0],this.declutterMode_=t.getDeclutterMode(),this.declutterImageWithText_=e}}])}(),_default=exports.default=CanvasImageBuilder;

},{"../../extent.js":59,"./Builder.js":137,"./Instruction.js":143}],142:[function(require,module,exports){
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _VectorContext2=_interopRequireDefault(require("../VectorContext.js")),_colorlike=require("../../colorlike.js"),_transform=require("../../transform.js"),_canvas=require("../canvas.js"),_array=require("../../array.js"),_extent=require("../../extent.js"),_math=require("../../math.js"),_transform2=require("../../geom/flat/transform.js"),_SimpleGeometry=require("../../geom/SimpleGeometry.js");function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var i=0;i<e.length;i++){var a=e[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,_toPropertyKey(a.key),a)}}function _createClass(t,e,i){return e&&_defineProperties(t.prototype,e),i&&_defineProperties(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var a=i.call(t,e||"default");if("object"!=_typeof(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _callSuper(t,e,i){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,i||[],_getPrototypeOf(t).constructor):e.apply(t,i))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var CanvasImmediateRenderer=function(t){function e(t,i,a,r,s,n,o){var l;return _classCallCheck(this,e),(l=_callSuper(this,e)).context_=t,l.pixelRatio_=i,l.extent_=a,l.transform_=r,l.transformRotation_=r?(0,_math.toFixed)(Math.atan2(r[1],r[0]),10):0,l.viewRotation_=s,l.squaredTolerance_=n,l.userTransform_=o,l.contextFillState_=null,l.contextStrokeState_=null,l.contextTextState_=null,l.fillState_=null,l.strokeState_=null,l.image_=null,l.imageAnchorX_=0,l.imageAnchorY_=0,l.imageHeight_=0,l.imageOpacity_=0,l.imageOriginX_=0,l.imageOriginY_=0,l.imageRotateWithView_=!1,l.imageRotation_=0,l.imageScale_=[0,0],l.imageWidth_=0,l.text_="",l.textOffsetX_=0,l.textOffsetY_=0,l.textRotateWithView_=!1,l.textRotation_=0,l.textScale_=[0,0],l.textFillState_=null,l.textStrokeState_=null,l.textState_=null,l.pixelCoordinates_=[],l.tmpLocalTransform_=(0,_transform.create)(),l}return _inherits(e,_VectorContext2["default"]),_createClass(e,[{key:"drawImages_",value:function(t,e,i,a){if(this.image_){var r=(0,_transform2.transform2D)(t,e,i,a,this.transform_,this.pixelCoordinates_),s=this.context_,n=this.tmpLocalTransform_,o=s.globalAlpha;1!=this.imageOpacity_&&(s.globalAlpha=o*this.imageOpacity_);var l=this.imageRotation_;0===this.transformRotation_&&(l-=this.viewRotation_),this.imageRotateWithView_&&(l+=this.viewRotation_);for(var h=0,_=r.length;h<_;h+=2){var f=r[h]-this.imageAnchorX_,c=r[h+1]-this.imageAnchorY_;if(0!==l||1!=this.imageScale_[0]||1!=this.imageScale_[1]){var u=f+this.imageAnchorX_,g=c+this.imageAnchorY_;(0,_transform.compose)(n,u,g,1,1,l,-u,-g),s.save(),s.transform.apply(s,n),s.translate(u,g),s.scale(this.imageScale_[0],this.imageScale_[1]),s.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,-this.imageAnchorX_,-this.imageAnchorY_,this.imageWidth_,this.imageHeight_),s.restore()}else s.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,f,c,this.imageWidth_,this.imageHeight_)}1!=this.imageOpacity_&&(s.globalAlpha=o)}}},{key:"drawText_",value:function(t,e,i,a){if(this.textState_&&""!==this.text_){this.textFillState_&&this.setContextFillState_(this.textFillState_),this.textStrokeState_&&this.setContextStrokeState_(this.textStrokeState_),this.setContextTextState_(this.textState_);var r=(0,_transform2.transform2D)(t,e,i,a,this.transform_,this.pixelCoordinates_),s=this.context_,n=this.textRotation_;for(0===this.transformRotation_&&(n-=this.viewRotation_),this.textRotateWithView_&&(n+=this.viewRotation_);e<i;e+=a){var o=r[e]+this.textOffsetX_,l=r[e+1]+this.textOffsetY_;0!==n||1!=this.textScale_[0]||1!=this.textScale_[1]?(s.save(),s.translate(o-this.textOffsetX_,l-this.textOffsetY_),s.rotate(n),s.translate(this.textOffsetX_,this.textOffsetY_),s.scale(this.textScale_[0],this.textScale_[1]),this.textStrokeState_&&s.strokeText(this.text_,0,0),this.textFillState_&&s.fillText(this.text_,0,0),s.restore()):(this.textStrokeState_&&s.strokeText(this.text_,o,l),this.textFillState_&&s.fillText(this.text_,o,l))}}}},{key:"moveToLineTo_",value:function(t,e,i,a,r){var s=this.context_,n=(0,_transform2.transform2D)(t,e,i,a,this.transform_,this.pixelCoordinates_);s.moveTo(n[0],n[1]);var o=n.length;r&&(o-=2);for(var l=2;l<o;l+=2)s.lineTo(n[l],n[l+1]);return r&&s.closePath(),i}},{key:"drawRings_",value:function(t,e,i,a){for(var r=0,s=i.length;r<s;++r)e=this.moveToLineTo_(t,e,i[r],a,!0);return e}},{key:"drawCircle",value:function(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),(0,_extent.intersects)(this.extent_,t.getExtent())){if(this.fillState_||this.strokeState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);var e=(0,_SimpleGeometry.transformGeom2D)(t,this.transform_,this.pixelCoordinates_),i=e[2]-e[0],a=e[3]-e[1],r=Math.sqrt(i*i+a*a),s=this.context_;s.beginPath(),s.arc(e[0],e[1],r,0,2*Math.PI),this.fillState_&&s.fill(),this.strokeState_&&s.stroke()}""!==this.text_&&this.drawText_(t.getCenter(),0,2,2)}}},{key:"setStyle",value:function(t){this.setFillStrokeStyle(t.getFill(),t.getStroke()),this.setImageStyle(t.getImage()),this.setTextStyle(t.getText())}},{key:"setTransform",value:function(t){this.transform_=t}},{key:"drawGeometry",value:function(t){switch(t.getType()){case"Point":this.drawPoint(t);break;case"LineString":this.drawLineString(t);break;case"Polygon":this.drawPolygon(t);break;case"MultiPoint":this.drawMultiPoint(t);break;case"MultiLineString":this.drawMultiLineString(t);break;case"MultiPolygon":this.drawMultiPolygon(t);break;case"GeometryCollection":this.drawGeometryCollection(t);break;case"Circle":this.drawCircle(t)}}},{key:"drawFeature",value:function(t,e){var i=e.getGeometryFunction()(t);i&&(this.setStyle(e),this.drawGeometry(i))}},{key:"drawGeometryCollection",value:function(t){for(var e=t.getGeometriesArray(),i=0,a=e.length;i<a;++i)this.drawGeometry(e[i])}},{key:"drawPoint",value:function(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));var e=t.getFlatCoordinates(),i=t.getStride();this.image_&&this.drawImages_(e,0,e.length,i),""!==this.text_&&this.drawText_(e,0,e.length,i)}},{key:"drawMultiPoint",value:function(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));var e=t.getFlatCoordinates(),i=t.getStride();this.image_&&this.drawImages_(e,0,e.length,i),""!==this.text_&&this.drawText_(e,0,e.length,i)}},{key:"drawLineString",value:function(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),(0,_extent.intersects)(this.extent_,t.getExtent())){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);var e=this.context_,i=t.getFlatCoordinates();e.beginPath(),this.moveToLineTo_(i,0,i.length,t.getStride(),!1),e.stroke()}if(""!==this.text_){var a=t.getFlatMidpoint();this.drawText_(a,0,2,2)}}}},{key:"drawMultiLineString",value:function(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));var e=t.getExtent();if((0,_extent.intersects)(this.extent_,e)){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);var i=this.context_,a=t.getFlatCoordinates(),r=0,s=t.getEnds(),n=t.getStride();i.beginPath();for(var o=0,l=s.length;o<l;++o)r=this.moveToLineTo_(a,r,s[o],n,!1);i.stroke()}if(""!==this.text_){var h=t.getFlatMidpoints();this.drawText_(h,0,h.length,2)}}}},{key:"drawPolygon",value:function(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),(0,_extent.intersects)(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);var e=this.context_;e.beginPath(),this.drawRings_(t.getOrientedFlatCoordinates(),0,t.getEnds(),t.getStride()),this.fillState_&&e.fill(),this.strokeState_&&e.stroke()}if(""!==this.text_){var i=t.getFlatInteriorPoint();this.drawText_(i,0,2,2)}}}},{key:"drawMultiPolygon",value:function(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),(0,_extent.intersects)(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);var e=this.context_,i=t.getOrientedFlatCoordinates(),a=0,r=t.getEndss(),s=t.getStride();e.beginPath();for(var n=0,o=r.length;n<o;++n){var l=r[n];a=this.drawRings_(i,a,l,s)}this.fillState_&&e.fill(),this.strokeState_&&e.stroke()}if(""!==this.text_){var h=t.getFlatInteriorPoints();this.drawText_(h,0,h.length,2)}}}},{key:"setContextFillState_",value:function(t){var e=this.context_,i=this.contextFillState_;i?i.fillStyle!=t.fillStyle&&(i.fillStyle=t.fillStyle,e.fillStyle=t.fillStyle):(e.fillStyle=t.fillStyle,this.contextFillState_={fillStyle:t.fillStyle})}},{key:"setContextStrokeState_",value:function(t){var e=this.context_,i=this.contextStrokeState_;i?(i.lineCap!=t.lineCap&&(i.lineCap=t.lineCap,e.lineCap=t.lineCap),(0,_array.equals)(i.lineDash,t.lineDash)||e.setLineDash(i.lineDash=t.lineDash),i.lineDashOffset!=t.lineDashOffset&&(i.lineDashOffset=t.lineDashOffset,e.lineDashOffset=t.lineDashOffset),i.lineJoin!=t.lineJoin&&(i.lineJoin=t.lineJoin,e.lineJoin=t.lineJoin),i.lineWidth!=t.lineWidth&&(i.lineWidth=t.lineWidth,e.lineWidth=t.lineWidth),i.miterLimit!=t.miterLimit&&(i.miterLimit=t.miterLimit,e.miterLimit=t.miterLimit),i.strokeStyle!=t.strokeStyle&&(i.strokeStyle=t.strokeStyle,e.strokeStyle=t.strokeStyle)):(e.lineCap=t.lineCap,e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset,e.lineJoin=t.lineJoin,e.lineWidth=t.lineWidth,e.miterLimit=t.miterLimit,e.strokeStyle=t.strokeStyle,this.contextStrokeState_={lineCap:t.lineCap,lineDash:t.lineDash,lineDashOffset:t.lineDashOffset,lineJoin:t.lineJoin,lineWidth:t.lineWidth,miterLimit:t.miterLimit,strokeStyle:t.strokeStyle})}},{key:"setContextTextState_",value:function(t){var e=this.context_,i=this.contextTextState_,a=t.textAlign?t.textAlign:_canvas.defaultTextAlign;i?(i.font!=t.font&&(i.font=t.font,e.font=t.font),i.textAlign!=a&&(i.textAlign=a,e.textAlign=a),i.textBaseline!=t.textBaseline&&(i.textBaseline=t.textBaseline,e.textBaseline=t.textBaseline)):(e.font=t.font,e.textAlign=a,e.textBaseline=t.textBaseline,this.contextTextState_={font:t.font,textAlign:a,textBaseline:t.textBaseline})}},{key:"setFillStrokeStyle",value:function(t,e){var i=this;if(t){var a=t.getColor();this.fillState_={fillStyle:(0,_colorlike.asColorLike)(a||_canvas.defaultFillStyle)}}else this.fillState_=null;if(e){var r=e.getColor(),s=e.getLineCap(),n=e.getLineDash(),o=e.getLineDashOffset(),l=e.getLineJoin(),h=e.getWidth(),_=e.getMiterLimit(),f=n||_canvas.defaultLineDash;this.strokeState_={lineCap:void 0!==s?s:_canvas.defaultLineCap,lineDash:1===this.pixelRatio_?f:f.map(function(t){return t*i.pixelRatio_}),lineDashOffset:(o||_canvas.defaultLineDashOffset)*this.pixelRatio_,lineJoin:void 0!==l?l:_canvas.defaultLineJoin,lineWidth:(void 0!==h?h:_canvas.defaultLineWidth)*this.pixelRatio_,miterLimit:void 0!==_?_:_canvas.defaultMiterLimit,strokeStyle:(0,_colorlike.asColorLike)(r||_canvas.defaultStrokeStyle)}}else this.strokeState_=null}},{key:"setImageStyle",value:function(t){var e;if(t&&(e=t.getSize())){var i=t.getPixelRatio(this.pixelRatio_),a=t.getAnchor(),r=t.getOrigin();this.image_=t.getImage(this.pixelRatio_),this.imageAnchorX_=a[0]*i,this.imageAnchorY_=a[1]*i,this.imageHeight_=e[1]*i,this.imageOpacity_=t.getOpacity(),this.imageOriginX_=r[0],this.imageOriginY_=r[1],this.imageRotateWithView_=t.getRotateWithView(),this.imageRotation_=t.getRotation();var s=t.getScaleArray();this.imageScale_=[s[0]*this.pixelRatio_/i,s[1]*this.pixelRatio_/i],this.imageWidth_=e[0]*i}else this.image_=null}},{key:"setTextStyle",value:function(t){if(t){var e=t.getFill();if(e){var i=e.getColor();this.textFillState_={fillStyle:(0,_colorlike.asColorLike)(i||_canvas.defaultFillStyle)}}else this.textFillState_=null;var a=t.getStroke();if(a){var r=a.getColor(),s=a.getLineCap(),n=a.getLineDash(),o=a.getLineDashOffset(),l=a.getLineJoin(),h=a.getWidth(),_=a.getMiterLimit();this.textStrokeState_={lineCap:void 0!==s?s:_canvas.defaultLineCap,lineDash:n||_canvas.defaultLineDash,lineDashOffset:o||_canvas.defaultLineDashOffset,lineJoin:void 0!==l?l:_canvas.defaultLineJoin,lineWidth:void 0!==h?h:_canvas.defaultLineWidth,miterLimit:void 0!==_?_:_canvas.defaultMiterLimit,strokeStyle:(0,_colorlike.asColorLike)(r||_canvas.defaultStrokeStyle)}}else this.textStrokeState_=null;var f=t.getFont(),c=t.getOffsetX(),u=t.getOffsetY(),g=t.getRotateWithView(),m=t.getRotation(),x=t.getScaleArray(),d=t.getText(),S=t.getTextAlign(),y=t.getTextBaseline();this.textState_={font:void 0!==f?f:_canvas.defaultFont,textAlign:void 0!==S?S:_canvas.defaultTextAlign,textBaseline:void 0!==y?y:_canvas.defaultTextBaseline},this.text_=void 0!==d?Array.isArray(d)?d.reduce(function(t,e,i){return t+(i%2?" ":e)},""):d:"",this.textOffsetX_=void 0!==c?this.pixelRatio_*c:0,this.textOffsetY_=void 0!==u?this.pixelRatio_*u:0,this.textRotateWithView_=void 0!==g&&g,this.textRotation_=void 0!==m?m:0,this.textScale_=[this.pixelRatio_*x[0],this.pixelRatio_*x[1]]}else this.text_=""}}])}(),_default=exports.default=CanvasImmediateRenderer;

},{"../../array.js":36,"../../colorlike.js":40,"../../extent.js":59,"../../geom/SimpleGeometry.js":74,"../../geom/flat/transform.js":92,"../../math.js":120,"../../transform.js":203,"../VectorContext.js":135,"../canvas.js":136}],143:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.strokeInstruction=exports.fillInstruction=exports.default=exports.closePathInstruction=exports.beginPathInstruction=void 0;var Instruction={BEGIN_GEOMETRY:0,BEGIN_PATH:1,CIRCLE:2,CLOSE_PATH:3,CUSTOM:4,DRAW_CHARS:5,DRAW_IMAGE:6,END_GEOMETRY:7,FILL:8,MOVE_TO_LINE_TO:9,SET_FILL_STYLE:10,SET_STROKE_STYLE:11,STROKE:12},fillInstruction=exports.fillInstruction=[Instruction.FILL],strokeInstruction=exports.strokeInstruction=[Instruction.STROKE],beginPathInstruction=exports.beginPathInstruction=[Instruction.BEGIN_PATH],closePathInstruction=exports.closePathInstruction=[Instruction.CLOSE_PATH],_default=exports.default=Instruction;

},{}],144:[function(require,module,exports){
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _Builder=_interopRequireDefault(require("./Builder.js")),_Instruction=_interopRequireWildcard(require("./Instruction.js")),_canvas=require("../canvas.js");function _getRequireWildcardCache(t){if("function"!=typeof WeakMap)return null;var e=new WeakMap,r=new WeakMap;return(_getRequireWildcardCache=function(t){return t?r:e})(t)}function _interopRequireWildcard(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!=_typeof(t)&&"function"!=typeof t)return{default:t};var r=_getRequireWildcardCache(e);if(r&&r.has(t))return r.get(t);var n={__proto__:null},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in t)if("default"!==o&&{}.hasOwnProperty.call(t,o)){var s=i?Object.getOwnPropertyDescriptor(t,o):null;s&&(s.get||s.set)?Object.defineProperty(n,o,s):n[o]=t[o]}return n.default=t,r&&r.set(t,n),n}function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,_toPropertyKey(n.key),n)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _callSuper(t,e,r){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,r||[],_getPrototypeOf(t).constructor):e.apply(t,r))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _superPropGet(t,e,r,n){var i=_get(_getPrototypeOf(1&n?t.prototype:t),e,r);return 2&n?function(t){return i.apply(r,t)}:i}function _get(){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,r){var n=_superPropBase(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}}).apply(null,arguments)}function _superPropBase(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=_getPrototypeOf(t)););return t}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var CanvasLineStringBuilder=function(t){function e(t,r,n,i){return _classCallCheck(this,e),_callSuper(this,e,[t,r,n,i])}return _inherits(e,_Builder["default"]),_createClass(e,[{key:"drawFlatCoordinates_",value:function(t,e,r,n){var i=this.coordinates.length,o=this.appendFlatLineCoordinates(t,e,r,n,!1,!1),s=[_Instruction.default.MOVE_TO_LINE_TO,i,o];return this.instructions.push(s),this.hitDetectionInstructions.push(s),r}},{key:"drawLineString",value:function(t,e,r){var n=this.state,i=n.strokeStyle,o=n.lineWidth;if(void 0!==i&&void 0!==o){this.updateStrokeStyle(n,this.applyStroke),this.beginGeometry(t,e,r),this.hitDetectionInstructions.push([_Instruction.default.SET_STROKE_STYLE,n.strokeStyle,n.lineWidth,n.lineCap,n.lineJoin,n.miterLimit,_canvas.defaultLineDash,_canvas.defaultLineDashOffset],_Instruction.beginPathInstruction);var s=t.getFlatCoordinates(),u=t.getStride();this.drawFlatCoordinates_(s,0,s.length,u),this.hitDetectionInstructions.push(_Instruction.strokeInstruction),this.endGeometry(e)}}},{key:"drawMultiLineString",value:function(t,e,r){var n=this.state,i=n.strokeStyle,o=n.lineWidth;if(void 0!==i&&void 0!==o){this.updateStrokeStyle(n,this.applyStroke),this.beginGeometry(t,e,r),this.hitDetectionInstructions.push([_Instruction.default.SET_STROKE_STYLE,n.strokeStyle,n.lineWidth,n.lineCap,n.lineJoin,n.miterLimit,_canvas.defaultLineDash,_canvas.defaultLineDashOffset],_Instruction.beginPathInstruction);for(var s=t.getEnds(),u=t.getFlatCoordinates(),a=t.getStride(),c=0,l=0,f=s.length;l<f;++l)c=this.drawFlatCoordinates_(u,c,s[l],a);this.hitDetectionInstructions.push(_Instruction.strokeInstruction),this.endGeometry(e)}}},{key:"finish",value:function(){var t=this.state;return null!=t.lastStroke&&t.lastStroke!=this.coordinates.length&&this.instructions.push(_Instruction.strokeInstruction),this.reverseHitDetectionInstructions(),this.state=null,_superPropGet(e,"finish",this,3)([])}},{key:"applyStroke",value:function(t){null!=t.lastStroke&&t.lastStroke!=this.coordinates.length&&(this.instructions.push(_Instruction.strokeInstruction),t.lastStroke=this.coordinates.length),t.lastStroke=0,_superPropGet(e,"applyStroke",this,3)([t]),this.instructions.push(_Instruction.beginPathInstruction)}}])}(),_default=exports.default=CanvasLineStringBuilder;

},{"../canvas.js":136,"./Builder.js":137,"./Instruction.js":143}],145:[function(require,module,exports){
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _Builder=_interopRequireDefault(require("./Builder.js")),_Instruction=_interopRequireWildcard(require("./Instruction.js")),_canvas=require("../canvas.js"),_simplify=require("../../geom/flat/simplify.js");function _getRequireWildcardCache(t){if("function"!=typeof WeakMap)return null;var e=new WeakMap,i=new WeakMap;return(_getRequireWildcardCache=function(t){return t?i:e})(t)}function _interopRequireWildcard(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!=_typeof(t)&&"function"!=typeof t)return{default:t};var i=_getRequireWildcardCache(e);if(i&&i.has(t))return i.get(t);var n={__proto__:null},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in t)if("default"!==o&&{}.hasOwnProperty.call(t,o)){var s=r?Object.getOwnPropertyDescriptor(t,o):null;s&&(s.get||s.set)?Object.defineProperty(n,o,s):n[o]=t[o]}return n.default=t,i&&i.set(t,n),n}function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,_toPropertyKey(n.key),n)}}function _createClass(t,e,i){return e&&_defineProperties(t.prototype,e),i&&_defineProperties(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,e||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _callSuper(t,e,i){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,i||[],_getPrototypeOf(t).constructor):e.apply(t,i))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _superPropGet(t,e,i,n){var r=_get(_getPrototypeOf(1&n?t.prototype:t),e,i);return 2&n?function(t){return r.apply(i,t)}:r}function _get(){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,i){var n=_superPropBase(t,e);if(n){var r=Object.getOwnPropertyDescriptor(n,e);return r.get?r.get.call(arguments.length<3?t:i):r.value}}).apply(null,arguments)}function _superPropBase(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=_getPrototypeOf(t)););return t}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var CanvasPolygonBuilder=function(t){function e(t,i,n,r){return _classCallCheck(this,e),_callSuper(this,e,[t,i,n,r])}return _inherits(e,_Builder["default"]),_createClass(e,[{key:"drawFlatCoordinatess_",value:function(t,e,i,n){var r=this.state,o=void 0!==r.fillStyle,s=void 0!==r.strokeStyle,u=i.length;this.instructions.push(_Instruction.beginPathInstruction),this.hitDetectionInstructions.push(_Instruction.beginPathInstruction);for(var l=0;l<u;++l){var a=i[l],c=this.coordinates.length,f=this.appendFlatLineCoordinates(t,e,a,n,!0,!s),p=[_Instruction.default.MOVE_TO_LINE_TO,c,f];this.instructions.push(p),this.hitDetectionInstructions.push(p),s&&(this.instructions.push(_Instruction.closePathInstruction),this.hitDetectionInstructions.push(_Instruction.closePathInstruction)),e=a}return o&&(this.instructions.push(_Instruction.fillInstruction),this.hitDetectionInstructions.push(_Instruction.fillInstruction)),s&&(this.instructions.push(_Instruction.strokeInstruction),this.hitDetectionInstructions.push(_Instruction.strokeInstruction)),e}},{key:"drawCircle",value:function(t,e,i){var n=this.state,r=n.fillStyle,o=n.strokeStyle;if(void 0!==r||void 0!==o){this.setFillStrokeStyles_(),this.beginGeometry(t,e,i),void 0!==n.fillStyle&&this.hitDetectionInstructions.push([_Instruction.default.SET_FILL_STYLE,_canvas.defaultFillStyle]),void 0!==n.strokeStyle&&this.hitDetectionInstructions.push([_Instruction.default.SET_STROKE_STYLE,n.strokeStyle,n.lineWidth,n.lineCap,n.lineJoin,n.miterLimit,_canvas.defaultLineDash,_canvas.defaultLineDashOffset]);var s=t.getFlatCoordinates(),u=t.getStride(),l=this.coordinates.length;this.appendFlatLineCoordinates(s,0,s.length,u,!1,!1);var a=[_Instruction.default.CIRCLE,l];this.instructions.push(_Instruction.beginPathInstruction,a),this.hitDetectionInstructions.push(_Instruction.beginPathInstruction,a),void 0!==n.fillStyle&&(this.instructions.push(_Instruction.fillInstruction),this.hitDetectionInstructions.push(_Instruction.fillInstruction)),void 0!==n.strokeStyle&&(this.instructions.push(_Instruction.strokeInstruction),this.hitDetectionInstructions.push(_Instruction.strokeInstruction)),this.endGeometry(e)}}},{key:"drawPolygon",value:function(t,e,i){var n=this.state,r=n.fillStyle,o=n.strokeStyle;if(void 0!==r||void 0!==o){this.setFillStrokeStyles_(),this.beginGeometry(t,e,i),void 0!==n.fillStyle&&this.hitDetectionInstructions.push([_Instruction.default.SET_FILL_STYLE,_canvas.defaultFillStyle]),void 0!==n.strokeStyle&&this.hitDetectionInstructions.push([_Instruction.default.SET_STROKE_STYLE,n.strokeStyle,n.lineWidth,n.lineCap,n.lineJoin,n.miterLimit,_canvas.defaultLineDash,_canvas.defaultLineDashOffset]);var s=t.getEnds(),u=t.getOrientedFlatCoordinates(),l=t.getStride();this.drawFlatCoordinatess_(u,0,s,l),this.endGeometry(e)}}},{key:"drawMultiPolygon",value:function(t,e,i){var n=this.state,r=n.fillStyle,o=n.strokeStyle;if(void 0!==r||void 0!==o){this.setFillStrokeStyles_(),this.beginGeometry(t,e,i),void 0!==n.fillStyle&&this.hitDetectionInstructions.push([_Instruction.default.SET_FILL_STYLE,_canvas.defaultFillStyle]),void 0!==n.strokeStyle&&this.hitDetectionInstructions.push([_Instruction.default.SET_STROKE_STYLE,n.strokeStyle,n.lineWidth,n.lineCap,n.lineJoin,n.miterLimit,_canvas.defaultLineDash,_canvas.defaultLineDashOffset]);for(var s=t.getEndss(),u=t.getOrientedFlatCoordinates(),l=t.getStride(),a=0,c=0,f=s.length;c<f;++c)a=this.drawFlatCoordinatess_(u,a,s[c],l);this.endGeometry(e)}}},{key:"finish",value:function(){this.reverseHitDetectionInstructions(),this.state=null;var t=this.tolerance;if(0!==t)for(var i=this.coordinates,n=0,r=i.length;n<r;++n)i[n]=(0,_simplify.snap)(i[n],t);return _superPropGet(e,"finish",this,3)([])}},{key:"setFillStrokeStyles_",value:function(){var t=this.state;void 0!==t.fillStyle&&this.updateFillStyle(t,this.createFill),void 0!==t.strokeStyle&&this.updateStrokeStyle(t,this.applyStroke)}}])}(),_default=exports.default=CanvasPolygonBuilder;

},{"../../geom/flat/simplify.js":89,"../canvas.js":136,"./Builder.js":137,"./Instruction.js":143}],146:[function(require,module,exports){
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=exports.TEXT_ALIGN=void 0;var _Builder=_interopRequireDefault(require("./Builder.js")),_Instruction=_interopRequireDefault(require("./Instruction.js")),_colorlike=require("../../colorlike.js"),_canvas=require("../canvas.js"),_util=require("../../util.js"),_extent=require("../../extent.js"),_linechunk=require("../../geom/flat/linechunk.js"),_straightchunk=require("../../geom/flat/straightchunk.js");function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,_toPropertyKey(r.key),r)}}function _createClass(t,e,i){return e&&_defineProperties(t.prototype,e),i&&_defineProperties(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=_typeof(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _callSuper(t,e,i){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,i||[],_getPrototypeOf(t).constructor):e.apply(t,i))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _superPropGet(t,e,i,r){var n=_get(_getPrototypeOf(1&r?t.prototype:t),e,i);return 2&r?function(t){return n.apply(i,t)}:n}function _get(){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,i){var r=_superPropBase(t,e);if(r){var n=Object.getOwnPropertyDescriptor(r,e);return n.get?n.get.call(arguments.length<3?t:i):n.value}}).apply(null,arguments)}function _superPropBase(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=_getPrototypeOf(t)););return t}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var TEXT_ALIGN=exports.TEXT_ALIGN={left:0,center:.5,right:1,top:0,middle:.5,hanging:.2,alphabetic:.8,ideographic:.8,bottom:1},CanvasTextBuilder=function(t){function e(t,i,r,n){var l;return _classCallCheck(this,e),(l=_callSuper(this,e,[t,i,r,n])).labels_=null,l.text_="",l.textOffsetX_=0,l.textOffsetY_=0,l.textRotateWithView_=void 0,l.textRotation_=0,l.textFillState_=null,l.fillStates={},l.fillStates[_canvas.defaultFillStyle]={fillStyle:_canvas.defaultFillStyle},l.textStrokeState_=null,l.strokeStates={},l.textState_={},l.textStates={},l.textKey_="",l.fillKey_="",l.strokeKey_="",l.declutterMode_=void 0,l.declutterImageWithText_=void 0,l}return _inherits(e,_Builder["default"]),_createClass(e,[{key:"finish",value:function(){var t=_superPropGet(e,"finish",this,3)([]);return t.textStates=this.textStates,t.fillStates=this.fillStates,t.strokeStates=this.strokeStates,t}},{key:"drawText",value:function(t,e,i){var r=this.textFillState_,n=this.textStrokeState_,l=this.textState_;if(""!==this.text_&&l&&(r||n)){var s=this.coordinates,a=s.length,o=t.getType(),u=null,f=t.getStride();if("line"!==l.placement||"LineString"!=o&&"MultiLineString"!=o&&"Polygon"!=o&&"MultiPolygon"!=o){var c=l.overflow?null:[];switch(o){case"Point":case"MultiPoint":u=t.getFlatCoordinates();break;case"LineString":u=t.getFlatMidpoint();break;case"Circle":u=t.getCenter();break;case"MultiLineString":u=t.getFlatMidpoints(),f=2;break;case"Polygon":u=t.getFlatInteriorPoint(),l.overflow||c.push(u[2]/this.resolution),f=3;break;case"MultiPolygon":var h=t.getFlatInteriorPoints();u=[];for(var _=0,d=h.length;_<d;_+=3)l.overflow||c.push(h[_+2]/this.resolution),u.push(h[_],h[_+1]);if(0===u.length)return;f=2}var g=this.appendFlatPointCoordinates(u,f);if(g===a)return;if(c&&(g-a)/2!=u.length/f){var p=a/2;c=c.filter(function(t,e){var i=s[2*(p+e)]===u[e*f]&&s[2*(p+e)+1]===u[e*f+1];return i||--p,i})}this.saveTextStates_(),(l.backgroundFill||l.backgroundStroke)&&(this.setFillStrokeStyle(l.backgroundFill,l.backgroundStroke),l.backgroundFill&&this.updateFillStyle(this.state,this.createFill),l.backgroundStroke&&(this.updateStrokeStyle(this.state,this.applyStroke),this.hitDetectionInstructions.push(this.createStroke(this.state)))),this.beginGeometry(t,e,i);var y=l.padding;if(y!=_canvas.defaultPadding&&(l.scale[0]<0||l.scale[1]<0)){var v=l.padding[0],S=l.padding[1],x=l.padding[2],k=l.padding[3];l.scale[0]<0&&(S=-S,k=-k),l.scale[1]<0&&(v=-v,x=-x),y=[v,S,x,k]}var b=this.pixelRatio;this.instructions.push([_Instruction.default.DRAW_IMAGE,a,g,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[1,1],NaN,this.declutterMode_,this.declutterImageWithText_,y==_canvas.defaultPadding?_canvas.defaultPadding:y.map(function(t){return t*b}),!!l.backgroundFill,!!l.backgroundStroke,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,c]);var m=1/b,P=this.state.fillStyle;l.backgroundFill&&(this.state.fillStyle=_canvas.defaultFillStyle,this.hitDetectionInstructions.push(this.createFill(this.state))),this.hitDetectionInstructions.push([_Instruction.default.DRAW_IMAGE,a,g,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[m,m],NaN,this.declutterMode_,this.declutterImageWithText_,y,!!l.backgroundFill,!!l.backgroundStroke,this.text_,this.textKey_,this.strokeKey_,this.fillKey_?_canvas.defaultFillStyle:this.fillKey_,this.textOffsetX_,this.textOffsetY_,c]),l.backgroundFill&&(this.state.fillStyle=P,this.hitDetectionInstructions.push(this.createFill(this.state))),this.endGeometry(e)}else{if(!(0,_extent.intersects)(this.maxExtent,t.getExtent()))return;var O;if(u=t.getFlatCoordinates(),"LineString"==o)O=[u.length];else if("MultiLineString"==o)O=t.getEnds();else if("Polygon"==o)O=t.getEnds().slice(0,1);else if("MultiPolygon"==o){var F=t.getEndss();O=[];for(var C=0,R=F.length;C<R;++C)O.push(F[C][0])}this.beginGeometry(t,e,i);for(var w=l.repeat,T=w?void 0:l.textAlign,j=0,D=0,L=O.length;D<L;++D)for(var A=void 0,I=0,M=(A=w?(0,_linechunk.lineChunk)(w*this.resolution,u,j,O[D],f):[u.slice(j,O[D])]).length;I<M;++I){var N=A[I],K=0,W=N.length;if(null==T){var B=(0,_straightchunk.matchingChunk)(l.maxAngle,N,0,N.length,2);K=B[0],W=B[1]}for(var E=K;E<W;E+=f)s.push(N[E],N[E+1]);var G=s.length;j=O[D],this.drawChars_(a,G),a=G}this.endGeometry(e)}}}},{key:"saveTextStates_",value:function(){var t=this.textStrokeState_,e=this.textState_,i=this.textFillState_,r=this.strokeKey_;t&&(r in this.strokeStates||(this.strokeStates[r]={strokeStyle:t.strokeStyle,lineCap:t.lineCap,lineDashOffset:t.lineDashOffset,lineWidth:t.lineWidth,lineJoin:t.lineJoin,miterLimit:t.miterLimit,lineDash:t.lineDash}));var n=this.textKey_;n in this.textStates||(this.textStates[n]={font:e.font,textAlign:e.textAlign||_canvas.defaultTextAlign,justify:e.justify,textBaseline:e.textBaseline||_canvas.defaultTextBaseline,scale:e.scale});var l=this.fillKey_;i&&(l in this.fillStates||(this.fillStates[l]={fillStyle:i.fillStyle}))}},{key:"drawChars_",value:function(t,e){var i=this.textStrokeState_,r=this.textState_,n=this.strokeKey_,l=this.textKey_,s=this.fillKey_;this.saveTextStates_();var a=this.pixelRatio,o=TEXT_ALIGN[r.textBaseline],u=this.textOffsetY_*a,f=this.text_,c=i?i.lineWidth*Math.abs(r.scale[0])/2:0;this.instructions.push([_Instruction.default.DRAW_CHARS,t,e,o,r.overflow,s,r.maxAngle,a,u,n,c*a,f,l,1,this.declutterMode_]),this.hitDetectionInstructions.push([_Instruction.default.DRAW_CHARS,t,e,o,r.overflow,s?_canvas.defaultFillStyle:s,r.maxAngle,a,u,n,c*a,f,l,1/a,this.declutterMode_])}},{key:"setTextStyle",value:function(t,e){var i,r,n;if(t){var l=t.getFill();l?((r=this.textFillState_)||(r={},this.textFillState_=r),r.fillStyle=(0,_colorlike.asColorLike)(l.getColor()||_canvas.defaultFillStyle)):(r=null,this.textFillState_=r);var s=t.getStroke();if(s){(n=this.textStrokeState_)||(n={},this.textStrokeState_=n);var a=s.getLineDash(),o=s.getLineDashOffset(),u=s.getWidth(),f=s.getMiterLimit();n.lineCap=s.getLineCap()||_canvas.defaultLineCap,n.lineDash=a?a.slice():_canvas.defaultLineDash,n.lineDashOffset=void 0===o?_canvas.defaultLineDashOffset:o,n.lineJoin=s.getLineJoin()||_canvas.defaultLineJoin,n.lineWidth=void 0===u?_canvas.defaultLineWidth:u,n.miterLimit=void 0===f?_canvas.defaultMiterLimit:f,n.strokeStyle=(0,_colorlike.asColorLike)(s.getColor()||_canvas.defaultStrokeStyle)}else n=null,this.textStrokeState_=n;i=this.textState_;var c=t.getFont()||_canvas.defaultFont;(0,_canvas.registerFont)(c);var h=t.getScaleArray();i.overflow=t.getOverflow(),i.font=c,i.maxAngle=t.getMaxAngle(),i.placement=t.getPlacement(),i.textAlign=t.getTextAlign(),i.repeat=t.getRepeat(),i.justify=t.getJustify(),i.textBaseline=t.getTextBaseline()||_canvas.defaultTextBaseline,i.backgroundFill=t.getBackgroundFill(),i.backgroundStroke=t.getBackgroundStroke(),i.padding=t.getPadding()||_canvas.defaultPadding,i.scale=void 0===h?[1,1]:h;var _=t.getOffsetX(),d=t.getOffsetY(),g=t.getRotateWithView(),p=t.getRotation();this.text_=t.getText()||"",this.textOffsetX_=void 0===_?0:_,this.textOffsetY_=void 0===d?0:d,this.textRotateWithView_=void 0!==g&&g,this.textRotation_=void 0===p?0:p,this.strokeKey_=n?("string"==typeof n.strokeStyle?n.strokeStyle:(0,_util.getUid)(n.strokeStyle))+n.lineCap+n.lineDashOffset+"|"+n.lineWidth+n.lineJoin+n.miterLimit+"["+n.lineDash.join()+"]":"",this.textKey_=i.font+i.scale+(i.textAlign||"?")+(i.repeat||"?")+(i.justify||"?")+(i.textBaseline||"?"),this.fillKey_=r&&r.fillStyle?"string"==typeof r.fillStyle?r.fillStyle:"|"+(0,_util.getUid)(r.fillStyle):""}else this.text_="";this.declutterMode_=t.getDeclutterMode(),this.declutterImageWithText_=e}}])}(),_default=exports.default=CanvasTextBuilder;

},{"../../colorlike.js":40,"../../extent.js":59,"../../geom/flat/linechunk.js":85,"../../geom/flat/straightchunk.js":90,"../../util.js":205,"../canvas.js":136,"./Builder.js":137,"./Instruction.js":143}],147:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _dom=require("../../dom.js");function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _toConsumableArray(t){return _arrayWithoutHoles(t)||_iterableToArray(t)||_unsupportedIterableToArray(t)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(t,e){if(t){if("string"==typeof t)return _arrayLikeToArray(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(t,e):void 0}}function _iterableToArray(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function _arrayWithoutHoles(t){if(Array.isArray(t))return _arrayLikeToArray(t)}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,_toPropertyKey(n.key),n)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _defineProperty(t,e,r){return(e=_toPropertyKey(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var ZIndexContext=function(){return _createClass(function t(){var e=this;_classCallCheck(this,t),_defineProperty(this,"pushMethodArgs_",function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return e.instructions_[e.zIndex+e.offset_].push(r),e}),this.instructions_=[],this.zIndex=0,this.offset_=0,this.context_=new Proxy((0,_dom.getSharedCanvasContext2D)(),{get:function(t,r){if("function"==typeof(0,_dom.getSharedCanvasContext2D)()[r])return e.instructions_[e.zIndex+e.offset_]||(e.instructions_[e.zIndex+e.offset_]=[]),e.instructions_[e.zIndex+e.offset_].push(r),e.pushMethodArgs_},set:function(t,r,n){return e.instructions_[e.zIndex+e.offset_]||(e.instructions_[e.zIndex+e.offset_]=[]),e.instructions_[e.zIndex+e.offset_].push(r,n),!0}})},[{key:"pushFunction",value:function(t){this.instructions_[this.zIndex+this.offset_].push(t)}},{key:"getContext",value:function(){return this.context_}},{key:"draw",value:function(t){this.instructions_.forEach(function(e){for(var r=0,n=e.length;r<n;++r){var o=e[r];if("function"!=typeof o){var i=e[++r];if("function"==typeof t[o])t[o].apply(t,_toConsumableArray(i));else{if("function"==typeof i){t[o]=i(t);continue}t[o]=i}}else o(t)}})}},{key:"clear",value:function(){this.instructions_.length=0,this.zIndex=0,this.offset_=0}},{key:"offset",value:function(){this.offset_=this.instructions_.length,this.zIndex=0}}])}(),_default=exports.default=ZIndexContext;

},{"../../dom.js":49}],148:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.HIT_DETECT_RESOLUTION=void 0,exports.createHitDetectionImageData=createHitDetectionImageData,exports.hitDetect=hitDetect;var _Immediate=_interopRequireDefault(require("./Immediate.js")),_style=require("../../style.js"),_array=require("../../array.js"),_math=require("../../math.js"),_dom=require("../../dom.js"),_proj=require("../../proj.js"),_extent=require("../../extent.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var HIT_DETECT_RESOLUTION=exports.HIT_DETECT_RESOLUTION=.5;function createHitDetectionImageData(e,t,r,a,o,i,n,l,s){var g=s?(0,_proj.toUserExtent)(o,s):o,c=e[0]*HIT_DETECT_RESOLUTION,h=e[1]*HIT_DETECT_RESOLUTION,_=(0,_dom.createCanvasContext2D)(c,h);_.imageSmoothingEnabled=!1;for(var u=_.canvas,T=new _Immediate.default(_,HIT_DETECT_RESOLUTION,o,null,n,l,s?(0,_proj.getTransformFromProjections)((0,_proj.getUserProjection)(),s):null),m=r.length,v=Math.floor(16777215/m),f={},d=1;d<=m;++d){var p=r[d-1],I=p.getStyleFunction()||a;if(I){var E=I(p,i);if(E){Array.isArray(E)||(E=[E]);for(var D=(d*v).toString(16).padStart(7,"#00000"),y=0,O=E.length;y<O;++y){var S=E[y],j=S.getGeometryFunction()(p);if(j&&(0,_extent.intersects)(g,j.getExtent())){var x=S.clone(),C=x.getFill();C&&C.setColor(D);var R=x.getStroke();R&&(R.setColor(D),R.setLineDash(null)),x.setText(void 0);var U=S.getImage();if(U){var H=U.getImageSize();if(!H)continue;var L=(0,_dom.createCanvasContext2D)(H[0],H[1],void 0,{alpha:!1}),M=L.canvas;L.fillStyle=D,L.fillRect(0,0,M.width,M.height),x.setImage(new _style.Icon({img:M,anchor:U.getAnchor(),anchorXUnits:"pixels",anchorYUnits:"pixels",offset:U.getOrigin(),opacity:1,size:U.getSize(),scale:U.getScale(),rotation:U.getRotation(),rotateWithView:U.getRotateWithView()}))}var q=x.getZIndex()||0,w=f[q];w||(w={},f[q]=w,w.Polygon=[],w.Circle=[],w.LineString=[],w.Point=[]);var N=j.getType();if("GeometryCollection"===N)for(var P=j.getGeometriesArrayRecursive(),b=0,A=P.length;b<A;++b){var F=P[b];w[F.getType().replace("Multi","")].push(F,x)}else w[N.replace("Multi","")].push(j,x)}}}}}for(var G=Object.keys(f).map(Number).sort(_array.ascending),z=0,k=G.length;z<k;++z){var V=f[G[z]];for(var W in V)for(var X=V[W],Y=0,Z=X.length;Y<Z;Y+=2){T.setStyle(X[Y+1]);for(var B=0,J=t.length;B<J;++B)T.setTransform(t[B]),T.drawGeometry(X[Y])}}return _.getImageData(0,0,u.width,u.height)}function hitDetect(e,t,r){var a=[];if(r){var o=Math.floor(Math.round(e[0])*HIT_DETECT_RESOLUTION),i=Math.floor(Math.round(e[1])*HIT_DETECT_RESOLUTION),n=4*((0,_math.clamp)(o,0,r.width-1)+(0,_math.clamp)(i,0,r.height-1)*r.width),l=r.data[n],s=r.data[n+1],g=r.data[n+2]+256*(s+256*l),c=Math.floor(16777215/t.length);g&&g%c==0&&a.push(t[g/c-1])}return a}

},{"../../array.js":36,"../../dom.js":49,"../../extent.js":59,"../../math.js":120,"../../proj.js":123,"../../style.js":186,"./Immediate.js":142}],149:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.buildRuleSet=buildRuleSet,exports.buildStyle=buildStyle,exports.flatStylesToStyleFunction=flatStylesToStyleFunction,exports.rulesToStyleFunction=rulesToStyleFunction;var _Circle=_interopRequireDefault(require("../../style/Circle.js")),_Fill=_interopRequireDefault(require("../../style/Fill.js")),_Icon=_interopRequireDefault(require("../../style/Icon.js")),_RegularShape=_interopRequireDefault(require("../../style/RegularShape.js")),_Stroke=_interopRequireDefault(require("../../style/Stroke.js")),_Style=_interopRequireDefault(require("../../style/Style.js")),_Text=_interopRequireDefault(require("../../style/Text.js")),_expression=require("../../expr/expression.js"),_cpu=require("../../expr/cpu.js"),_obj=require("../../obj.js"),_size=require("../../size.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _createForOfIteratorHelper(e,r){var t="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=_unsupportedIterableToArray(e))||r&&e&&"number"==typeof e.length){t&&(e=t);var o=0,n=function(){};return{s:n,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,u=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return a=e.done,e},e:function(e){u=!0,i=e},f:function(){try{a||null==t.return||t.return()}finally{if(u)throw i}}}}function _unsupportedIterableToArray(e,r){if(e){if("string"==typeof e)return _arrayLikeToArray(e,r);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?_arrayLikeToArray(e,r):void 0}}function _arrayLikeToArray(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,o=Array(r);t<r;t++)o[t]=e[t];return o}function always(e){return!0}function rulesToStyleFunction(e){var r=(0,_expression.newParsingContext)(),t=buildRuleSet(e,r),o=(0,_cpu.newEvaluationContext)();return function(e,n){if(o.properties=e.getPropertiesInternal(),o.resolution=n,r.featureId){var i=e.getId();o.featureId=void 0!==i?i:null}return r.geometryType&&(o.geometryType=(0,_expression.computeGeometryType)(e.getGeometry())),t(o)}}function flatStylesToStyleFunction(e){for(var r=(0,_expression.newParsingContext)(),t=e.length,o=new Array(t),n=0;n<t;++n)o[n]=buildStyle(e[n],r);var i=(0,_cpu.newEvaluationContext)(),a=new Array(t);return function(e,n){if(i.properties=e.getPropertiesInternal(),i.resolution=n,r.featureId){var u=e.getId();i.featureId=void 0!==u?u:null}for(var l=0,s=0;s<t;++s){var c=o[s](i);c&&(a[l]=c,l+=1)}return a.length=l,a}}function buildRuleSet(e,r){for(var t=e.length,o=new Array(t),n=0;n<t;++n){var i=e[n],a="filter"in i?(0,_cpu.buildExpression)(i.filter,_expression.BooleanType,r):always,u=void 0;if(Array.isArray(i.style)){var l=i.style.length;u=new Array(l);for(var s=0;s<l;++s)u[s]=buildStyle(i.style[s],r)}else u=[buildStyle(i.style,r)];o[n]={filter:a,styles:u}}return function(r){for(var n=[],i=!1,a=0;a<t;++a){if((0,o[a].filter)(r)&&(!e[a].else||!i)){i=!0;var u,l=_createForOfIteratorHelper(o[a].styles);try{for(l.s();!(u=l.n()).done;){var s=(0,u.value)(r);s&&n.push(s)}}catch(e){l.e(e)}finally{l.f()}}}return n}}function buildStyle(e,r){var t=buildFill(e,"",r),o=buildStroke(e,"",r),n=buildText(e,r),i=buildImage(e,r),a=numberEvaluator(e,"z-index",r);if(!(t||o||n||i||(0,_obj.isEmpty)(e)))throw new Error("No fill, stroke, point, or text symbolizer properties in style: "+JSON.stringify(e));var u=new _Style.default;return function(e){var r=!0;if(t){var l=t(e);l&&(r=!1),u.setFill(l)}if(o){var s=o(e);s&&(r=!1),u.setStroke(s)}if(n){var c=n(e);c&&(r=!1),u.setText(c)}if(i){var f=i(e);f&&(r=!1),u.setImage(f)}return a&&u.setZIndex(a(e)),r?null:u}}function buildFill(e,r,t){var o;if(r+"fill-pattern-src"in e)o=patternEvaluator(e,r+"fill-",t);else{if("none"===e[r+"fill-color"])return function(e){return null};o=colorLikeEvaluator(e,r+"fill-color",t)}if(!o)return null;var n=new _Fill.default;return function(e){var r=o(e);return"none"===r?null:(n.setColor(r),n)}}function buildStroke(e,r,t){var o=numberEvaluator(e,r+"stroke-width",t),n=colorLikeEvaluator(e,r+"stroke-color",t);if(!o&&!n)return null;var i=stringEvaluator(e,r+"stroke-line-cap",t),a=stringEvaluator(e,r+"stroke-line-join",t),u=numberArrayEvaluator(e,r+"stroke-line-dash",t),l=numberEvaluator(e,r+"stroke-line-dash-offset",t),s=numberEvaluator(e,r+"stroke-miter-limit",t),c=new _Stroke.default;return function(e){if(n){var r=n(e);if("none"===r)return null;c.setColor(r)}if(o&&c.setWidth(o(e)),i){var t=i(e);if("butt"!==t&&"round"!==t&&"square"!==t)throw new Error("Expected butt, round, or square line cap");c.setLineCap(t)}if(a){var f=a(e);if("bevel"!==f&&"round"!==f&&"miter"!==f)throw new Error("Expected bevel, round, or miter line join");c.setLineJoin(f)}return u&&c.setLineDash(u(e)),l&&c.setLineDashOffset(l(e)),s&&c.setMiterLimit(s(e)),c}}function buildText(e,r){var t="text-",o=stringEvaluator(e,"text-value",r);if(!o)return null;var n=buildFill(e,t,r),i=buildFill(e,"text-background-",r),a=buildStroke(e,t,r),u=buildStroke(e,"text-background-",r),l=stringEvaluator(e,"text-font",r),s=numberEvaluator(e,"text-max-angle",r),c=numberEvaluator(e,"text-offset-x",r),f=numberEvaluator(e,"text-offset-y",r),p=booleanEvaluator(e,"text-overflow",r),d=stringEvaluator(e,"text-placement",r),v=numberEvaluator(e,"text-repeat",r),b=sizeLikeEvaluator(e,"text-scale",r),y=booleanEvaluator(e,"text-rotate-with-view",r),E=numberEvaluator(e,"text-rotation",r),h=stringEvaluator(e,"text-align",r),m=stringEvaluator(e,"text-justify",r),x=stringEvaluator(e,"text-baseline",r),g=numberArrayEvaluator(e,"text-padding",r),w=optionalDeclutterMode(e,"text-declutter-mode"),S=new _Text.default({declutterMode:w});return function(e){if(S.setText(o(e)),n&&S.setFill(n(e)),i&&S.setBackgroundFill(i(e)),a&&S.setStroke(a(e)),u&&S.setBackgroundStroke(u(e)),l&&S.setFont(l(e)),s&&S.setMaxAngle(s(e)),c&&S.setOffsetX(c(e)),f&&S.setOffsetY(f(e)),p&&S.setOverflow(p(e)),d){var r=d(e);if("point"!==r&&"line"!==r)throw new Error("Expected point or line for text-placement");S.setPlacement(r)}if(v&&S.setRepeat(v(e)),b&&S.setScale(b(e)),y&&S.setRotateWithView(y(e)),E&&S.setRotation(E(e)),h){var t=h(e);if("left"!==t&&"center"!==t&&"right"!==t&&"end"!==t&&"start"!==t)throw new Error("Expected left, right, center, start, or end for text-align");S.setTextAlign(t)}if(m){var w=m(e);if("left"!==w&&"right"!==w&&"center"!==w)throw new Error("Expected left, right, or center for text-justify");S.setJustify(w)}if(x){var _=x(e);if("bottom"!==_&&"top"!==_&&"middle"!==_&&"alphabetic"!==_&&"hanging"!==_)throw new Error("Expected bottom, top, middle, alphabetic, or hanging for text-baseline");S.setTextBaseline(_)}return g&&S.setPadding(g(e)),S}}function buildImage(e,r){return"icon-src"in e?buildIcon(e,r):"shape-points"in e?buildShape(e,r):"circle-radius"in e?buildCircle(e,r):null}function buildIcon(e,r){var t=requireString(e["icon-src"],"icon-src"),o=coordinateEvaluator(e,"icon-anchor",r),n=sizeLikeEvaluator(e,"icon-scale",r),i=numberEvaluator(e,"icon-opacity",r),a=coordinateEvaluator(e,"icon-displacement",r),u=numberEvaluator(e,"icon-rotation",r),l=booleanEvaluator(e,"icon-rotate-with-view",r),s=optionalIconOrigin(e,"icon-anchor-origin"),c=optionalIconAnchorUnits(e,"icon-anchor-x-units"),f=optionalIconAnchorUnits(e,"icon-anchor-y-units"),p=optionalColorLike(e,"icon-color"),d=optionalString(e,"icon-cross-origin"),v=optionalNumberArray(e,"icon-offset"),b=optionalIconOrigin(e,"icon-offset-origin"),y=optionalNumber(e,"icon-width"),E=optionalNumber(e,"icon-height"),h=optionalSize(e,"icon-size"),m=optionalDeclutterMode(e,"icon-declutter-mode"),x=new _Icon.default({src:t,anchorOrigin:s,anchorXUnits:c,anchorYUnits:f,color:p,crossOrigin:d,offset:v,offsetOrigin:b,height:E,width:y,size:h,declutterMode:m});return function(e){return i&&x.setOpacity(i(e)),a&&x.setDisplacement(a(e)),u&&x.setRotation(u(e)),l&&x.setRotateWithView(l(e)),n&&x.setScale(n(e)),o&&x.setAnchor(o(e)),x}}function buildShape(e,r){var t="shape-",o=requireNumber(e["shape-points"],"shape-points"),n=requireNumber(e["shape-radius"],"shape-radius"),i=buildFill(e,t,r),a=buildStroke(e,t,r),u=sizeLikeEvaluator(e,"shape-scale",r),l=coordinateEvaluator(e,"shape-displacement",r),s=numberEvaluator(e,"shape-rotation",r),c=booleanEvaluator(e,"shape-rotate-with-view",r),f=optionalNumber(e,"shape-radius2"),p=optionalNumber(e,"shape-angle"),d=optionalDeclutterMode(e,"shape-declutter-mode"),v=new _RegularShape.default({points:o,radius:n,radius2:f,angle:p,declutterMode:d});return function(e){return i&&v.setFill(i(e)),a&&v.setStroke(a(e)),l&&v.setDisplacement(l(e)),s&&v.setRotation(s(e)),c&&v.setRotateWithView(c(e)),u&&v.setScale(u(e)),v}}function buildCircle(e,r){var t="circle-",o=buildFill(e,t,r),n=buildStroke(e,t,r),i=numberEvaluator(e,"circle-radius",r),a=sizeLikeEvaluator(e,"circle-scale",r),u=coordinateEvaluator(e,"circle-displacement",r),l=numberEvaluator(e,"circle-rotation",r),s=booleanEvaluator(e,"circle-rotate-with-view",r),c=optionalDeclutterMode(e,"circle-declutter-mode"),f=new _Circle.default({radius:5,declutterMode:c});return function(e){return i&&f.setRadius(i(e)),o&&f.setFill(o(e)),n&&f.setStroke(n(e)),u&&f.setDisplacement(u(e)),l&&f.setRotation(l(e)),s&&f.setRotateWithView(s(e)),a&&f.setScale(a(e)),f}}function numberEvaluator(e,r,t){if(r in e){var o=(0,_cpu.buildExpression)(e[r],_expression.NumberType,t);return function(e){return requireNumber(o(e),r)}}}function stringEvaluator(e,r,t){if(!(r in e))return null;var o=(0,_cpu.buildExpression)(e[r],_expression.StringType,t);return function(e){return requireString(o(e),r)}}function patternEvaluator(e,r,t){var o=stringEvaluator(e,r+"pattern-src",t),n=sizeEvaluator(e,r+"pattern-offset",t),i=sizeEvaluator(e,r+"pattern-size",t),a=colorLikeEvaluator(e,r+"color",t);return function(e){return{src:o(e),offset:n&&n(e),size:i&&i(e),color:a&&a(e)}}}function booleanEvaluator(e,r,t){if(!(r in e))return null;var o=(0,_cpu.buildExpression)(e[r],_expression.BooleanType,t);return function(e){var t=o(e);if("boolean"!=typeof t)throw new Error("Expected a boolean for ".concat(r));return t}}function colorLikeEvaluator(e,r,t){if(!(r in e))return null;var o=(0,_cpu.buildExpression)(e[r],_expression.ColorType,t);return function(e){return requireColorLike(o(e),r)}}function numberArrayEvaluator(e,r,t){if(!(r in e))return null;var o=(0,_cpu.buildExpression)(e[r],_expression.NumberArrayType,t);return function(e){return requireNumberArray(o(e),r)}}function coordinateEvaluator(e,r,t){if(!(r in e))return null;var o=(0,_cpu.buildExpression)(e[r],_expression.NumberArrayType,t);return function(e){var t=requireNumberArray(o(e),r);if(2!==t.length)throw new Error("Expected two numbers for ".concat(r));return t}}function sizeEvaluator(e,r,t){if(!(r in e))return null;var o=(0,_cpu.buildExpression)(e[r],_expression.NumberArrayType,t);return function(e){return requireSize(o(e),r)}}function sizeLikeEvaluator(e,r,t){if(!(r in e))return null;var o=(0,_cpu.buildExpression)(e[r],_expression.NumberArrayType|_expression.NumberType,t);return function(e){return requireSizeLike(o(e),r)}}function optionalNumber(e,r){var t=e[r];if(void 0!==t){if("number"!=typeof t)throw new Error("Expected a number for ".concat(r));return t}}function optionalSize(e,r){var t=e[r];if(void 0!==t){if("number"==typeof t)return(0,_size.toSize)(t);if(!Array.isArray(t))throw new Error("Expected a number or size array for ".concat(r));if(2!==t.length||"number"!=typeof t[0]||"number"!=typeof t[1])throw new Error("Expected a number or size array for ".concat(r));return t}}function optionalString(e,r){var t=e[r];if(void 0!==t){if("string"!=typeof t)throw new Error("Expected a string for ".concat(r));return t}}function optionalIconOrigin(e,r){var t=e[r];if(void 0!==t){if("bottom-left"!==t&&"bottom-right"!==t&&"top-left"!==t&&"top-right"!==t)throw new Error("Expected bottom-left, bottom-right, top-left, or top-right for ".concat(r));return t}}function optionalIconAnchorUnits(e,r){var t=e[r];if(void 0!==t){if("pixels"!==t&&"fraction"!==t)throw new Error("Expected pixels or fraction for ".concat(r));return t}}function optionalNumberArray(e,r){var t=e[r];if(void 0!==t)return requireNumberArray(t,r)}function optionalDeclutterMode(e,r){var t=e[r];if(void 0!==t){if("string"!=typeof t)throw new Error("Expected a string for ".concat(r));if("declutter"!==t&&"obstacle"!==t&&"none"!==t)throw new Error("Expected declutter, obstacle, or none for ".concat(r));return t}}function optionalColorLike(e,r){var t=e[r];if(void 0!==t)return requireColorLike(t,r)}function requireNumberArray(e,r){if(!Array.isArray(e))throw new Error("Expected an array for ".concat(r));for(var t=e.length,o=0;o<t;++o)if("number"!=typeof e[o])throw new Error("Expected an array of numbers for ".concat(r));return e}function requireString(e,r){if("string"!=typeof e)throw new Error("Expected a string for ".concat(r));return e}function requireNumber(e,r){if("number"!=typeof e)throw new Error("Expected a number for ".concat(r));return e}function requireColorLike(e,r){if("string"==typeof e)return e;var t=requireNumberArray(e,r),o=t.length;if(o<3||o>4)throw new Error("Expected a color with 3 or 4 values for ".concat(r));return t}function requireSize(e,r){var t=requireNumberArray(e,r);if(2!==t.length)throw new Error("Expected an array of two numbers for ".concat(r));return t}function requireSizeLike(e,r){return"number"==typeof e?e:requireSize(e,r)}

},{"../../expr/cpu.js":57,"../../expr/expression.js":58,"../../obj.js":121,"../../size.js":167,"../../style/Circle.js":187,"../../style/Fill.js":188,"../../style/Icon.js":189,"../../style/RegularShape.js":193,"../../style/Stroke.js":194,"../../style/Style.js":195,"../../style/Text.js":196}],150:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _BaseVector=_interopRequireDefault(require("../layer/BaseVector.js")),_Map=_interopRequireDefault(require("./Map.js")),_ObjectEventType=_interopRequireDefault(require("../ObjectEventType.js")),_Event=_interopRequireDefault(require("../render/Event.js")),_EventType=_interopRequireDefault(require("../render/EventType.js")),_css=require("../css.js"),_canvas=require("../render/canvas.js"),_Layer=require("../layer/Layer.js"),_events=require("../events.js"),_dom=require("../dom.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey(n.key),n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _superPropGet(e,t,r,n){var o=_get(_getPrototypeOf(1&n?e.prototype:e),t,r);return 2&n?function(e){return o.apply(r,e)}:o}function _get(){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=_superPropBase(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}}).apply(null,arguments)}function _superPropBase(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf(e)););return e}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var CompositeMapRenderer=function(e){function t(e){var r;_classCallCheck(this,t),(r=_callSuper(this,t,[e])).fontChangeListenerKey_=(0,_events.listen)(_canvas.checkedFonts,_ObjectEventType.default.PROPERTYCHANGE,e.redrawText.bind(e)),r.element_=document.createElement("div");var n=r.element_.style;n.position="absolute",n.width="100%",n.height="100%",n.zIndex="0",r.element_.className=_css.CLASS_UNSELECTABLE+" ol-layers";var o=e.getViewport();return o.insertBefore(r.element_,o.firstChild||null),r.children_=[],r.renderedVisible_=!0,r}return _inherits(t,_Map["default"]),_createClass(t,[{key:"dispatchRenderEvent",value:function(e,t){var r=this.getMap();if(r.hasListener(e)){var n=new _Event.default(e,void 0,t);r.dispatchEvent(n)}}},{key:"disposeInternal",value:function(){(0,_events.unlistenByKey)(this.fontChangeListenerKey_),this.element_.remove(),_superPropGet(t,"disposeInternal",this,3)([])}},{key:"renderFrame",value:function(e){if(e){this.calculateMatrices2D(e),this.dispatchRenderEvent(_EventType.default.PRECOMPOSE,e);var t=e.layerStatesArray.sort(function(e,t){return e.zIndex-t.zIndex});t.some(function(e){return e.layer instanceof _BaseVector.default&&e.layer.getDeclutter()})&&(e.declutter={});var r=e.viewState;this.children_.length=0;for(var n=[],o=null,i=0,u=t.length;i<u;++i){var s=t[i];e.layerIndex=i;var a=s.layer,l=a.getSourceState();if(!(0,_Layer.inView)(s,r)||"ready"!=l&&"undefined"!=l)a.unrender();else{var c=a.render(e,o);c&&(c!==o&&(this.children_.push(c),o=c),n.push(s))}}this.declutter(e,n),(0,_dom.replaceChildren)(this.element_,this.children_),this.dispatchRenderEvent(_EventType.default.POSTCOMPOSE,e),this.renderedVisible_||(this.element_.style.display="",this.renderedVisible_=!0),this.scheduleExpireIconCache(e)}else this.renderedVisible_&&(this.element_.style.display="none",this.renderedVisible_=!1)}},{key:"declutter",value:function(e,t){if(e.declutter){for(var r=t.length-1;r>=0;--r){var n=t[r],o=n.layer;o.getDeclutter()&&o.renderDeclutter(e,n)}t.forEach(function(t){return t.layer.renderDeferred(e)})}}}])}(),_default=exports.default=CompositeMapRenderer;

},{"../ObjectEventType.js":26,"../css.js":48,"../dom.js":49,"../events.js":51,"../layer/BaseVector.js":111,"../layer/Layer.js":114,"../render/Event.js":132,"../render/EventType.js":133,"../render/canvas.js":136,"./Map.js":152}],151:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _EventType=_interopRequireDefault(require("../events/EventType.js")),_ImageState=_interopRequireDefault(require("../ImageState.js")),_Observable2=_interopRequireDefault(require("../Observable.js")),_util=require("../util.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey(n.key),n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _superPropGet(e,t,r,n){var o=_get(_getPrototypeOf(1&n?e.prototype:e),t,r);return 2&n?function(e){return o.apply(r,e)}:o}function _get(){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=_superPropBase(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}}).apply(null,arguments)}function _superPropBase(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf(e)););return e}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var maxStaleKeys=5,LayerRenderer=function(e){function t(e){var r;return _classCallCheck(this,t),(r=_callSuper(this,t)).ready=!0,r.boundHandleImageChange_=r.handleImageChange_.bind(r),r.layer_=e,r.staleKeys_=new Array,r.maxStaleKeys=maxStaleKeys,r}return _inherits(t,_Observable2["default"]),_createClass(t,[{key:"getStaleKeys",value:function(){return this.staleKeys_}},{key:"prependStaleKey",value:function(e){this.staleKeys_.unshift(e),this.staleKeys_.length>this.maxStaleKeys&&(this.staleKeys_.length=this.maxStaleKeys)}},{key:"getFeatures",value:function(e){return(0,_util.abstract)()}},{key:"getData",value:function(e){return null}},{key:"prepareFrame",value:function(e){return(0,_util.abstract)()}},{key:"renderFrame",value:function(e,t){return(0,_util.abstract)()}},{key:"forEachFeatureAtCoordinate",value:function(e,t,r,n,o){}},{key:"getLayer",value:function(){return this.layer_}},{key:"handleFontsChanged",value:function(){}},{key:"handleImageChange_",value:function(e){var t=e.target;t.getState()!==_ImageState.default.LOADED&&t.getState()!==_ImageState.default.ERROR||this.renderIfReadyAndVisible()}},{key:"loadImage",value:function(e){var t=e.getState();return t!=_ImageState.default.LOADED&&t!=_ImageState.default.ERROR&&e.addEventListener(_EventType.default.CHANGE,this.boundHandleImageChange_),t==_ImageState.default.IDLE&&(e.load(),t=e.getState()),t==_ImageState.default.LOADED}},{key:"renderIfReadyAndVisible",value:function(){var e=this.getLayer();e&&e.getVisible()&&"ready"===e.getSourceState()&&e.changed()}},{key:"renderDeferred",value:function(e){}},{key:"disposeInternal",value:function(){delete this.layer_,_superPropGet(t,"disposeInternal",this,3)([])}}])}(),_default=exports.default=LayerRenderer;

},{"../ImageState.js":15,"../Observable.js":27,"../events/EventType.js":53,"../util.js":205}],152:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _Disposable2=_interopRequireDefault(require("../Disposable.js")),_functions=require("../functions.js"),_util=require("../util.js"),_transform=require("../transform.js"),_extent=require("../extent.js"),_IconImageCache=require("../style/IconImageCache.js"),_Layer=require("../layer/Layer.js"),_coordinate=require("../coordinate.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var MapRenderer=function(e){function t(e){var r;return _classCallCheck(this,t),(r=_callSuper(this,t)).map_=e,r}return _inherits(t,_Disposable2["default"]),_createClass(t,[{key:"dispatchRenderEvent",value:function(e,t){(0,_util.abstract)()}},{key:"calculateMatrices2D",value:function(e){var t=e.viewState,r=e.coordinateToPixelTransform,o=e.pixelToCoordinateTransform;(0,_transform.compose)(r,e.size[0]/2,e.size[1]/2,1/t.resolution,-1/t.resolution,-t.rotation,-t.center[0],-t.center[1]),(0,_transform.makeInverse)(o,r)}},{key:"forEachFeatureAtCoordinate",value:function(e,t,r,o,n,i,a,u){var c,s=t.viewState;function f(e,t,r,o){return n.call(i,t,e?r:null,o)}var l=s.projection,p=(0,_coordinate.wrapX)(e.slice(),l),y=[[0,0]];if(l.canWrapX()&&o){var _=l.getExtent(),d=(0,_extent.getWidth)(_);y.push([-d,0],[d,0])}for(var v=t.layerStatesArray,h=v.length,b=[],m=[],g=0;g<y.length;g++)for(var P=h-1;P>=0;--P){var C=v[P],j=C.layer;if(j.hasRenderer()&&(0,_Layer.inView)(C,s)&&a.call(u,j)){var O=j.getRenderer(),w=j.getSource();if(O&&w){var R=w.getWrapX()?p:e,S=f.bind(null,C.managed);m[0]=R[0]+y[g][0],m[1]=R[1]+y[g][1],c=O.forEachFeatureAtCoordinate(m,t,r,S,b)}if(c)return c}}if(0!==b.length){var x=1/b.length;return b.forEach(function(e,t){return e.distanceSq+=t*x}),b.sort(function(e,t){return e.distanceSq-t.distanceSq}),b.some(function(e){return c=e.callback(e.feature,e.layer,e.geometry)}),c}}},{key:"hasFeatureAtCoordinate",value:function(e,t,r,o,n,i){return void 0!==this.forEachFeatureAtCoordinate(e,t,r,o,_functions.TRUE,this,n,i)}},{key:"getMap",value:function(){return this.map_}},{key:"renderFrame",value:function(e){(0,_util.abstract)()}},{key:"scheduleExpireIconCache",value:function(e){_IconImageCache.shared.canExpireCache()&&e.postRenderFunctions.push(expireIconCache)}}])}();function expireIconCache(e,t){_IconImageCache.shared.expire()}var _default=exports.default=MapRenderer;

},{"../Disposable.js":12,"../coordinate.js":47,"../extent.js":59,"../functions.js":62,"../layer/Layer.js":114,"../style/IconImageCache.js":191,"../transform.js":203,"../util.js":205}],153:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _Layer=_interopRequireDefault(require("./Layer.js")),_ImageState=_interopRequireDefault(require("../../ImageState.js")),_ViewHint=_interopRequireDefault(require("../../ViewHint.js")),_transform=require("../../transform.js"),_extent=require("../../extent.js"),_proj=require("../../proj.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_unsupportedIterableToArray(e,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function _iterableToArrayLimit(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i,a,u=[],l=!0,s=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(u.push(n.value),u.length!==t);l=!0);}catch(e){s=!0,o=e}finally{try{if(!l&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(s)throw o}}return u}}function _arrayWithHoles(e){if(Array.isArray(e))return e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey(n.key),n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var CanvasImageLayerRenderer=function(e){function t(e){var r;return _classCallCheck(this,t),(r=_callSuper(this,t,[e])).image=null,r}return _inherits(t,_Layer["default"]),_createClass(t,[{key:"getImage",value:function(){return this.image?this.image.getImage():null}},{key:"prepareFrame",value:function(e){var t=e.layerStatesArray[e.layerIndex],r=e.pixelRatio,n=e.viewState,o=n.resolution,i=this.getLayer().getSource(),a=e.viewHints,u=e.extent;if(void 0!==t.extent&&(u=(0,_extent.getIntersection)(u,(0,_proj.fromUserExtent)(t.extent,n.projection))),!a[_ViewHint.default.ANIMATING]&&!a[_ViewHint.default.INTERACTING]&&!(0,_extent.isEmpty)(u))if(i){var l=n.projection,s=i.getImage(u,o,r,l);s&&(this.loadImage(s)?this.image=s:s.getState()===_ImageState.default.EMPTY&&(this.image=null))}else this.image=null;return!!this.image}},{key:"getData",value:function(e){var t=this.frameState;if(!t)return null;var r=this.getLayer(),n=(0,_transform.apply)(t.pixelToCoordinateTransform,e.slice()),o=r.getExtent();if(o&&!(0,_extent.containsCoordinate)(o,n))return null;var i=this.image.getExtent(),a=this.image.getImage(),u=(0,_extent.getWidth)(i),l=Math.floor(a.width*((n[0]-i[0])/u));if(l<0||l>=a.width)return null;var s=(0,_extent.getHeight)(i),f=Math.floor(a.height*((i[3]-n[1])/s));return f<0||f>=a.height?null:this.getImageData(a,l,f)}},{key:"renderFrame",value:function(e,t){var r=this.image,n=r.getExtent(),o=r.getResolution(),i=_slicedToArray(Array.isArray(o)?o:[o,o],2),a=i[0],u=i[1],l=r.getPixelRatio(),s=e.layerStatesArray[e.layerIndex],f=e.pixelRatio,c=e.viewState,y=c.center,p=c.resolution,_=f*a/(p*l),h=f*u/(p*l);this.prepareContainer(e,t);var g=this.context.canvas.width,m=this.context.canvas.height,d=this.getRenderContext(e),v=!1,b=!0;if(s.extent){var x=(0,_proj.fromUserExtent)(s.extent,c.projection);(v=(b=(0,_extent.intersects)(x,e.extent))&&!(0,_extent.containsExtent)(x,e.extent))&&this.clipUnrotated(d,e,x)}var j=r.getImage(),w=(0,_transform.compose)(this.tempTransform,g/2,m/2,_,h,0,l*(n[0]-y[0])/a,l*(y[1]-n[3])/u);this.renderedResolution=u*f/l;var I=j.width*w[0],S=j.height*w[3];if(this.getLayer().getSource().getInterpolate()||(d.imageSmoothingEnabled=!1),this.preRender(d,e),b&&I>=.5&&S>=.5){var P=w[4],O=w[5],R=s.opacity;1!==R&&(d.save(),d.globalAlpha=R),d.drawImage(j,0,0,+j.width,+j.height,P,O,I,S),1!==R&&d.restore()}return this.postRender(this.context,e),v&&d.restore(),d.imageSmoothingEnabled=!0,this.container}}])}(),_default=exports.default=CanvasImageLayerRenderer;

},{"../../ImageState.js":15,"../../ViewHint.js":34,"../../extent.js":59,"../../proj.js":123,"../../transform.js":203,"./Layer.js":154}],154:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=exports.canvasPool=void 0;var _Layer=_interopRequireDefault(require("../Layer.js")),_Event=_interopRequireDefault(require("../../render/Event.js")),_EventType=_interopRequireDefault(require("../../render/EventType.js")),_ZIndexContext=_interopRequireDefault(require("../../render/canvas/ZIndexContext.js")),_transform=require("../../transform.js"),_color=require("../../color.js"),_dom=require("../../dom.js"),_array=require("../../array.js"),_extent=require("../../extent.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey(n.key),n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _superPropGet(e,t,r,n){var o=_get(_getPrototypeOf(1&n?e.prototype:e),t,r);return 2&n?function(e){return o.apply(r,e)}:o}function _get(){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=_superPropBase(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}}).apply(null,arguments)}function _superPropBase(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf(e)););return e}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var canvasPool=exports.canvasPool=[],pixelContext=null;function createPixelContext(){pixelContext=(0,_dom.createCanvasContext2D)(1,1,void 0,{willReadFrequently:!0})}var CanvasLayerRenderer=function(e){function t(e){var r;return _classCallCheck(this,t),(r=_callSuper(this,t,[e])).container=null,r.renderedResolution,r.tempTransform=(0,_transform.create)(),r.pixelTransform=(0,_transform.create)(),r.inversePixelTransform=(0,_transform.create)(),r.context=null,r.deferredContext_=null,r.containerReused=!1,r.frameState=null,r}return _inherits(t,_Layer["default"]),_createClass(t,[{key:"getImageData",value:function(e,t,r){var n;pixelContext||createPixelContext(),pixelContext.clearRect(0,0,1,1);try{pixelContext.drawImage(e,t,r,1,1,0,0,1,1),n=pixelContext.getImageData(0,0,1,1).data}catch(e){return pixelContext=null,null}return n}},{key:"getBackground",value:function(e){var t=this.getLayer().getBackground();return"function"==typeof t&&(t=t(e.viewState.resolution)),t||void 0}},{key:"useContainer",value:function(e,t,r){var n,o,a=this.getLayer().getClassName();if(e&&e.className===a&&(!r||e&&e.style.backgroundColor&&(0,_array.equals)((0,_color.asArray)(e.style.backgroundColor),(0,_color.asArray)(r)))){var i=e.firstElementChild;i instanceof HTMLCanvasElement&&(o=i.getContext("2d"))}if(o&&o.canvas.style.transform===t?(this.container=e,this.context=o,this.containerReused=!0):this.containerReused?(this.container=null,this.context=null,this.containerReused=!1):this.container&&(this.container.style.backgroundColor=null),!this.container){(n=document.createElement("div")).className=a;var s=n.style;s.position="absolute",s.width="100%",s.height="100%";var l=(o=(0,_dom.createCanvasContext2D)()).canvas;n.appendChild(l),(s=l.style).position="absolute",s.left="0",s.transformOrigin="top left",this.container=n,this.context=o}this.containerReused||!r||this.container.style.backgroundColor||(this.container.style.backgroundColor=r)}},{key:"clipUnrotated",value:function(e,t,r){var n=(0,_extent.getTopLeft)(r),o=(0,_extent.getTopRight)(r),a=(0,_extent.getBottomRight)(r),i=(0,_extent.getBottomLeft)(r);(0,_transform.apply)(t.coordinateToPixelTransform,n),(0,_transform.apply)(t.coordinateToPixelTransform,o),(0,_transform.apply)(t.coordinateToPixelTransform,a),(0,_transform.apply)(t.coordinateToPixelTransform,i);var s=this.inversePixelTransform;(0,_transform.apply)(s,n),(0,_transform.apply)(s,o),(0,_transform.apply)(s,a),(0,_transform.apply)(s,i),e.save(),e.beginPath(),e.moveTo(Math.round(n[0]),Math.round(n[1])),e.lineTo(Math.round(o[0]),Math.round(o[1])),e.lineTo(Math.round(a[0]),Math.round(a[1])),e.lineTo(Math.round(i[0]),Math.round(i[1])),e.clip()}},{key:"prepareContainer",value:function(e,t){var r=e.extent,n=e.viewState.resolution,o=e.viewState.rotation,a=e.pixelRatio,i=Math.round((0,_extent.getWidth)(r)/n*a),s=Math.round((0,_extent.getHeight)(r)/n*a);(0,_transform.compose)(this.pixelTransform,e.size[0]/2,e.size[1]/2,1/a,1/a,o,-i/2,-s/2),(0,_transform.makeInverse)(this.inversePixelTransform,this.pixelTransform);var l=(0,_transform.toString)(this.pixelTransform);if(this.useContainer(t,l,this.getBackground(e)),!this.containerReused){var u=this.context.canvas;u.width!=i||u.height!=s?(u.width=i,u.height=s):this.context.clearRect(0,0,i,s),l!==u.style.transform&&(u.style.transform=l)}}},{key:"dispatchRenderEvent_",value:function(e,t,r){var n=this.getLayer();if(n.hasListener(e)){var o=new _Event.default(e,this.inversePixelTransform,r,t);n.dispatchEvent(o)}}},{key:"preRender",value:function(e,t){this.frameState=t,t.declutter||this.dispatchRenderEvent_(_EventType.default.PRERENDER,e,t)}},{key:"postRender",value:function(e,t){t.declutter||this.dispatchRenderEvent_(_EventType.default.POSTRENDER,e,t)}},{key:"renderDeferredInternal",value:function(e){}},{key:"getRenderContext",value:function(e){return e.declutter&&!this.deferredContext_&&(this.deferredContext_=new _ZIndexContext.default),e.declutter?this.deferredContext_.getContext():this.context}},{key:"renderDeferred",value:function(e){e.declutter&&(this.dispatchRenderEvent_(_EventType.default.PRERENDER,this.context,e),e.declutter&&this.deferredContext_&&(this.deferredContext_.draw(this.context),this.deferredContext_.clear()),this.renderDeferredInternal(e),this.dispatchRenderEvent_(_EventType.default.POSTRENDER,this.context,e))}},{key:"getRenderTransform",value:function(e,t,r,n,o,a,i){var s=o/2,l=a/2,u=n/t,c=-u,f=-e[0]+i,p=-e[1];return(0,_transform.compose)(this.tempTransform,s,l,u,c,-r,f,p)}},{key:"disposeInternal",value:function(){delete this.frameState,_superPropGet(t,"disposeInternal",this,3)([])}}])}(),_default=exports.default=CanvasLayerRenderer;

},{"../../array.js":36,"../../color.js":39,"../../dom.js":49,"../../extent.js":59,"../../render/Event.js":132,"../../render/EventType.js":133,"../../render/canvas/ZIndexContext.js":147,"../../transform.js":203,"../Layer.js":151}],155:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _Layer=_interopRequireDefault(require("./Layer.js")),_DataTile=_interopRequireWildcard(require("../../DataTile.js")),_ImageTile=_interopRequireDefault(require("../../ImageTile.js")),_LRUCache=_interopRequireDefault(require("../../structs/LRUCache.js")),_DataTile2=_interopRequireDefault(require("../../reproj/DataTile.js")),_Tile=_interopRequireDefault(require("../../reproj/Tile.js")),_TileRange=_interopRequireDefault(require("../../TileRange.js")),_TileState=_interopRequireDefault(require("../../TileState.js")),_transform=require("../../transform.js"),_array=require("../../array.js"),_extent=require("../../extent.js"),_tilecoord=require("../../tilecoord.js"),_proj=require("../../proj.js"),_util=require("../../util.js"),_size=require("../../size.js");function _getRequireWildcardCache(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(_getRequireWildcardCache=function(e){return e?r:t})(e)}function _interopRequireWildcard(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=_typeof(e)&&"function"!=typeof e)return{default:e};var r=_getRequireWildcardCache(t);if(r&&r.has(e))return r.get(e);var i={__proto__:null},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&{}.hasOwnProperty.call(e,o)){var a=n?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(i,o,a):i[o]=e[o]}return i.default=e,r&&r.set(e,i),i}function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _createForOfIteratorHelper(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var i=0,n=function(){};return{s:n,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,l=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){l=!0,o=e},f:function(){try{a||null==r.return||r.return()}finally{if(l)throw o}}}}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=Array(t);r<t;r++)i[r]=e[r];return i}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,_toPropertyKey(i.key),i)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function getCacheKey(e,t,r,i){return"".concat(e,",").concat((0,_tilecoord.getKeyZXY)(t,r,i))}function addTileToLookup(e,t,r){if(!(r in e))return e[r]=new Set([t]),!0;var i=e[r],n=i.has(t);return n||i.add(t),!n}function removeTileFromLookup(e,t,r){var i=e[r];return!!i&&i.delete(t)}function getRenderExtent(e,t){var r=e.layerStatesArray[e.layerIndex];r.extent&&(t=(0,_extent.getIntersection)(t,(0,_proj.fromUserExtent)(r.extent,e.viewState.projection)));var i=r.layer.getRenderSource();if(!i.getWrapX()){var n=i.getTileGridForProjection(e.viewState.projection).getExtent();n&&(t=(0,_extent.getIntersection)(t,n))}return t}var CanvasTileLayerRenderer=function(e){function t(e,r){var i;_classCallCheck(this,t),r=r||{},(i=_callSuper(this,t,[e])).extentChanged=!0,i.renderComplete=!1,i.renderedExtent_=null,i.renderedPixelRatio,i.renderedProjection=null,i.renderedRevision,i.renderedTiles=[],i.renderedSourceKey_,i.renderedSourceRevision_,i.tempExtent=(0,_extent.createEmpty)(),i.tempTileRange_=new _TileRange.default(0,0,0,0),i.tempTileCoord_=(0,_tilecoord.createOrUpdate)(0,0,0);var n=void 0!==r.cacheSize?r.cacheSize:512;return i.tileCache_=new _LRUCache.default(n),i.maxStaleKeys=.5*n,i}return _inherits(t,_Layer["default"]),_createClass(t,[{key:"getTileCache",value:function(){return this.tileCache_}},{key:"getOrCreateTile",value:function(e,t,r,i){var n,o=this.tileCache_,a=this.getLayer().getSource(),l=getCacheKey(a.getKey(),e,t,r);if(o.containsKey(l))n=o.get(l);else{if(!(n=a.getTile(e,t,r,i.pixelRatio,i.viewState.projection)))return null;o.set(l,n)}return n}},{key:"getTile",value:function(e,t,r,i){var n=this.getOrCreateTile(e,t,r,i);return n||null}},{key:"getData",value:function(e){var t=this.frameState;if(!t)return null;var r=this.getLayer(),i=(0,_transform.apply)(t.pixelToCoordinateTransform,e.slice()),n=r.getExtent();if(n&&!(0,_extent.containsCoordinate)(n,i))return null;for(var o=t.viewState,a=r.getRenderSource(),l=a.getTileGridForProjection(o.projection),u=a.getTilePixelRatio(t.pixelRatio),s=l.getZForResolution(o.resolution);s>=l.getMinZoom();--s){var c=l.getTileCoordForCoordAndZ(i,s),f=this.getTile(s,c[1],c[2],t);if(f&&f.getState()===_TileState.default.LOADED){var d=l.getOrigin(s),p=(0,_size.toSize)(l.getTileSize(s)),g=l.getResolution(s),h=void 0;if(f instanceof _ImageTile.default)h=f.getImage();else{if(!(f instanceof _DataTile.default))continue;if(!(h=(0,_DataTile.asImageLike)(f.getData())))continue}var _=Math.floor(u*((i[0]-d[0])/g-c[1]*p[0])),y=Math.floor(u*((d[1]-i[1])/g-c[2]*p[1])),v=Math.round(u*a.getGutterForProjection(o.projection));return this.getImageData(h,_+v,y+v)}}return null}},{key:"prepareFrame",value:function(e){var t=this.getLayer().getSource();if(!t)return!1;var r=this.getLayer().getSource().getRevision();return this.renderedRevision_?this.renderedRevision_!==r&&(this.renderedRevision_=r,this.renderedSourceKey_===t.getKey()&&this.tileCache_.clear()):this.renderedRevision_=r,!0}},{key:"enqueueTiles",value:function(e,t,r,i,n){var o=e.viewState,a=this.getLayer(),l=a.getRenderSource(),u=l.getTileGridForProjection(o.projection),s=(0,_util.getUid)(l);s in e.wantedTiles||(e.wantedTiles[s]={});for(var c=e.wantedTiles[s],f=a.getMapInternal(),d=Math.max(r-n,u.getMinZoom(),u.getZForResolution(Math.min(a.getMaxResolution(),f?f.getView().getResolutionForZoom(Math.max(a.getMinZoom(),0)):u.getResolution(0)),l.zDirection)),p=r;p>=d;--p)for(var g=u.getTileRangeForExtentAndZ(t,p,this.tempTileRange_),h=u.getResolution(p),_=g.minX;_<=g.maxX;++_)for(var y=g.minY;y<=g.maxY;++y){var v=this.getTile(p,_,y,e);if(v)if(addTileToLookup(i,v,p)){var T=v.getKey();if(c[T]=!0,v.getState()===_TileState.default.IDLE&&!e.tileQueue.isKeyQueued(T)){var m=(0,_tilecoord.createOrUpdate)(p,_,y,this.tempTileCoord_);e.tileQueue.enqueue([v,s,u.getTileCoordCenter(m),h])}}}}},{key:"findStaleTile_",value:function(e,t){for(var r=this.tileCache_,i=e[0],n=e[1],o=e[2],a=this.getStaleKeys(),l=0;l<a.length;++l){var u=getCacheKey(a[l],i,n,o);if(r.containsKey(u)){var s=r.get(u);if(s.getState()===_TileState.default.LOADED)return s.endTransition((0,_util.getUid)(this)),addTileToLookup(t,s,i),!0}}return!1}},{key:"findAltTiles_",value:function(e,t,r,i){var n=e.getTileRangeForTileCoordAndZ(t,r,this.tempTileRange_);if(!n)return!1;for(var o=!0,a=this.tileCache_,l=this.getLayer().getRenderSource().getKey(),u=n.minX;u<=n.maxX;++u)for(var s=n.minY;s<=n.maxY;++s){var c=getCacheKey(l,r,u,s),f=!1;if(a.containsKey(c)){var d=a.get(c);d.getState()===_TileState.default.LOADED&&(addTileToLookup(i,d,r),f=!0)}f||(o=!1)}return o}},{key:"renderFrame",value:function(e,t){var r=this;this.renderComplete=!0;var i=e.layerStatesArray[e.layerIndex],n=e.viewState,o=n.projection,a=n.resolution,l=n.center,u=e.pixelRatio,s=this.getLayer(),c=s.getSource(),f=c.getRevision(),d=c.getTileGridForProjection(o),p=d.getZForResolution(a,c.zDirection),g=d.getResolution(p),h=c.getKey();this.renderedSourceKey_?this.renderedSourceKey_!==h&&(this.prependStaleKey(this.renderedSourceKey_),this.renderedSourceKey_=h):this.renderedSourceKey_=h;var _=e.extent,y=c.getTilePixelRatio(u);this.prepareContainer(e,t);var v=this.context.canvas.width,T=this.context.canvas.height,m=i.extent&&(0,_proj.fromUserExtent)(i.extent,o);m&&(_=(0,_extent.getIntersection)(_,(0,_proj.fromUserExtent)(i.extent,o)));var R=g*v/2/y,x=g*T/2/y,S=[l[0]-R,l[1]-x,l[0]+R,l[1]+x],b={},C=s.getPreload();if(e.nextExtent){var j=d.getZForResolution(n.nextResolution,c.zDirection),O=getRenderExtent(e,e.nextExtent);this.enqueueTiles(e,O,j,b,C)}var P=getRenderExtent(e,_);this.enqueueTiles(e,P,p,b,0),C>0&&setTimeout(function(){r.enqueueTiles(e,P,p-1,b,C-1)},0);var w,D=(0,_util.getUid)(this),k=e.time,q=_createForOfIteratorHelper(b[p]);try{for(q.s();!(w=q.n()).done;){var E=w.value,L=E.getState();if(!(E instanceof _Tile.default||E instanceof _DataTile2.default)||L!==_TileState.default.EMPTY){var I=E.tileCoord;if(L===_TileState.default.LOADED)if(1===E.getAlpha(D,k)){E.endTransition(D);continue}if(this.renderComplete=!1,this.findStaleTile_(I,b))removeTileFromLookup(b,E,p),e.animate=!0;else if(!this.findAltTiles_(d,I,p+1,b))for(var A=d.getMinZoom(),K=p-1;K>=A;--K){if(this.findAltTiles_(d,I,K,b))break}}}}catch(e){q.e(e)}finally{q.f()}var M=g/a*u/y,F=this.getRenderContext(e);(0,_transform.compose)(this.tempTransform,v/2,T/2,M,M,0,-v/2,-T/2),i.extent&&this.clipUnrotated(F,e,m),c.getInterpolate()||(F.imageSmoothingEnabled=!1),this.preRender(F,e),this.renderedTiles.length=0;var U,z=Object.keys(b).map(Number);z.sort(_array.ascending);for(var Z=[],W=[],G=z.length-1;G>=0;--G){var X,Y=z[G],N=c.getTilePixelSize(Y,u,o),H=d.getResolution(Y)/g,Q=N[0]*H*M,B=N[1]*H*M,V=d.getTileCoordForCoordAndZ((0,_extent.getTopLeft)(S),Y),$=d.getTileCoordExtent(V),J=(0,_transform.apply)(this.tempTransform,[y*($[0]-S[0])/g,y*(S[3]-$[3])/g]),ee=y*c.getGutterForProjection(o),te=_createForOfIteratorHelper(b[Y]);try{for(te.s();!(X=te.n()).done;){var re=X.value;if(re.getState()===_TileState.default.LOADED){var ie=re.tileCoord,ne=V[1]-ie[1],oe=Math.round(J[0]-(ne-1)*Q),ae=V[2]-ie[2],le=Math.round(J[1]-(ae-1)*B),ue=Math.round(J[0]-ne*Q),se=Math.round(J[1]-ae*B),ce=oe-ue,fe=le-se,de=1===z.length,pe=!1;U=[ue,se,ue+ce,se,ue+ce,se+fe,ue,se+fe];for(var ge=0,he=Z.length;ge<he;++ge)if(!de&&Y<W[ge]){var _e=Z[ge];(0,_extent.intersects)([ue,se,ue+ce,se+fe],[_e[0],_e[3],_e[4],_e[7]])&&(pe||(F.save(),pe=!0),F.beginPath(),F.moveTo(U[0],U[1]),F.lineTo(U[2],U[3]),F.lineTo(U[4],U[5]),F.lineTo(U[6],U[7]),F.moveTo(_e[6],_e[7]),F.lineTo(_e[4],_e[5]),F.lineTo(_e[2],_e[3]),F.lineTo(_e[0],_e[1]),F.clip())}Z.push(U),W.push(Y),this.drawTile(re,e,ue,se,ce,fe,ee,de),pe&&F.restore(),this.renderedTiles.unshift(re),this.updateUsedTiles(e.usedTiles,c,re)}}}catch(e){te.e(e)}finally{te.f()}}this.renderedRevision=f,this.renderedResolution=g,this.extentChanged=!this.renderedExtent_||!(0,_extent.equals)(this.renderedExtent_,S),this.renderedExtent_=S,this.renderedPixelRatio=u,this.renderedProjection=o,this.postRender(this.context,e),i.extent&&F.restore(),F.imageSmoothingEnabled=!0;return e.postRenderFunctions.push(function(e,t){var i=(0,_util.getUid)(c),n=t.wantedTiles[i],o=n?Object.keys(n).length:0;r.updateCacheSize(o),r.tileCache_.expireCache()}),this.container}},{key:"updateCacheSize",value:function(e){this.tileCache_.highWaterMark=Math.max(this.tileCache_.highWaterMark,2*e)}},{key:"drawTile",value:function(e,t,r,i,n,o,a,l){var u;if(e instanceof _DataTile.default){if(!(u=(0,_DataTile.asImageLike)(e.getData())))throw new Error("Rendering array data is not yet supported")}else u=this.getTileImage(e);if(u){var s=this.getRenderContext(t),c=(0,_util.getUid)(this),f=t.layerStatesArray[t.layerIndex],d=f.opacity*(l?e.getAlpha(c,t.time):1),p=d!==s.globalAlpha;p&&(s.save(),s.globalAlpha=d),s.drawImage(u,a,a,u.width-2*a,u.height-2*a,r,i,n,o),p&&s.restore(),d!==f.opacity?t.animate=!0:l&&e.endTransition(c)}}},{key:"getImage",value:function(){var e=this.context;return e?e.canvas:null}},{key:"getTileImage",value:function(e){return e.getImage()}},{key:"updateUsedTiles",value:function(e,t,r){var i=(0,_util.getUid)(t);i in e||(e[i]={}),e[i][r.getKey()]=!0}}])}(),_default=exports.default=CanvasTileLayerRenderer;

},{"../../DataTile.js":11,"../../ImageTile.js":16,"../../TileRange.js":31,"../../TileState.js":32,"../../array.js":36,"../../extent.js":59,"../../proj.js":123,"../../reproj/DataTile.js":159,"../../reproj/Tile.js":161,"../../size.js":167,"../../structs/LRUCache.js":183,"../../tilecoord.js":197,"../../transform.js":203,"../../util.js":205,"./Layer.js":154}],156:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _BuilderGroup=_interopRequireDefault(require("../../render/canvas/BuilderGroup.js")),_Layer=_interopRequireWildcard(require("./Layer.js")),_ExecutorGroup=_interopRequireWildcard(require("../../render/canvas/ExecutorGroup.js")),_EventType=_interopRequireDefault(require("../../render/EventType.js")),_ViewHint=_interopRequireDefault(require("../../ViewHint.js")),_hitdetect=require("../../render/canvas/hitdetect.js"),_extent2=require("../../extent.js"),_dom=require("../../dom.js"),_vector=require("../vector.js"),_array=require("../../array.js"),_proj=require("../../proj.js"),_util=require("../../util.js"),_coordinate=require("../../coordinate.js");function _getRequireWildcardCache(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(_getRequireWildcardCache=function(e){return e?r:t})(e)}function _interopRequireWildcard(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=_typeof(e)&&"function"!=typeof e)return{default:e};var r=_getRequireWildcardCache(t);if(r&&r.has(e))return r.get(e);var n={__proto__:null},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&{}.hasOwnProperty.call(e,o)){var a=i?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(n,o,a):n[o]=e[o]}return n.default=e,r&&r.set(e,n),n}function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey(n.key),n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var CanvasVectorLayerRenderer=function(e){function t(e){var r;return _classCallCheck(this,t),(r=_callSuper(this,t,[e])).boundHandleStyleImageChange_=r.handleStyleImageChange_.bind(r),r.animatingOrInteracting_,r.hitDetectionImageData_=null,r.clipped_=!1,r.renderedFeatures_=null,r.renderedRevision_=-1,r.renderedResolution_=NaN,r.renderedExtent_=(0,_extent2.createEmpty)(),r.wrappedRenderedExtent_=(0,_extent2.createEmpty)(),r.renderedRotation_,r.renderedCenter_=null,r.renderedProjection_=null,r.renderedPixelRatio_=1,r.renderedRenderOrder_=null,r.renderedFrameDeclutter_,r.replayGroup_=null,r.replayGroupChanged=!0,r.clipping=!0,r.targetContext_=null,r.opacity_=1,r}return _inherits(t,_Layer["default"]),_createClass(t,[{key:"renderWorlds",value:function(e,t,r){var n=t.extent,i=t.viewState,o=i.center,a=i.resolution,u=i.projection,s=i.rotation,l=u.getExtent(),c=this.getLayer().getSource(),d=this.getLayer().getDeclutter(),_=t.pixelRatio,p=t.viewHints,h=!(p[_ViewHint.default.ANIMATING]||p[_ViewHint.default.INTERACTING]),f=this.context,y=Math.round((0,_extent2.getWidth)(n)/a*_),g=Math.round((0,_extent2.getHeight)(n)/a*_),v=c.getWrapX()&&u.canWrapX(),x=v?(0,_extent2.getWidth)(l):null,R=v?Math.ceil((n[2]-l[2])/x)+1:1,m=v?Math.floor((n[0]-l[0])/x):0;do{var E=this.getRenderTransform(o,a,0,_,y,g,m*x);t.declutter&&(E=E.slice(0)),e.execute(f,[f.canvas.width,f.canvas.height],E,s,h,void 0===r?_ExecutorGroup.ALL:r?_ExecutorGroup.DECLUTTER:_ExecutorGroup.NON_DECLUTTER,r?d&&t.declutter[d]:void 0)}while(++m<R)}},{key:"setDrawContext_",value:function(){1!==this.opacity_&&(this.targetContext_=this.context,this.context=(0,_dom.createCanvasContext2D)(this.context.canvas.width,this.context.canvas.height,_Layer.canvasPool))}},{key:"resetDrawContext_",value:function(){if(1!==this.opacity_){var e=this.targetContext_.globalAlpha;this.targetContext_.globalAlpha=this.opacity_,this.targetContext_.drawImage(this.context.canvas,0,0),this.targetContext_.globalAlpha=e,(0,_dom.releaseCanvas)(this.context),_Layer.canvasPool.push(this.context.canvas),this.context=this.targetContext_,this.targetContext_=null}}},{key:"renderDeclutter",value:function(e){this.replayGroup_&&this.getLayer().getDeclutter()&&this.renderWorlds(this.replayGroup_,e,!0)}},{key:"renderDeferredInternal",value:function(e){this.replayGroup_&&(this.replayGroup_.renderDeferred(),this.clipped_&&this.context.restore(),this.resetDrawContext_())}},{key:"renderFrame",value:function(e,t){var r=e.layerStatesArray[e.layerIndex];this.opacity_=r.opacity;var n=e.viewState;this.prepareContainer(e,t);var i=this.context,o=this.replayGroup_,a=o&&!o.isEmpty();if(!a&&!(this.getLayer().hasListener(_EventType.default.PRERENDER)||this.getLayer().hasListener(_EventType.default.POSTRENDER)))return null;this.setDrawContext_(),this.preRender(i,e);var u=n.projection;if(this.clipped_=!1,a&&r.extent&&this.clipping){var s=(0,_proj.fromUserExtent)(r.extent,u);a=(0,_extent2.intersects)(s,e.extent),this.clipped_=a&&!(0,_extent2.containsExtent)(s,e.extent),this.clipped_&&this.clipUnrotated(i,e,s)}return a&&this.renderWorlds(o,e,!this.getLayer().getDeclutter()&&void 0),!e.declutter&&this.clipped_&&i.restore(),this.postRender(i,e),this.renderedRotation_!==n.rotation&&(this.renderedRotation_=n.rotation,this.hitDetectionImageData_=null),e.declutter||this.resetDrawContext_(),this.container}},{key:"getFeatures",value:function(e){var t=this;return new Promise(function(r){if(t.frameState&&!t.hitDetectionImageData_&&!t.animatingOrInteracting_){var n=t.frameState.size.slice(),i=t.renderedCenter_,o=t.renderedResolution_,a=t.renderedRotation_,u=t.renderedProjection_,s=t.wrappedRenderedExtent_,l=t.getLayer(),c=[],d=n[0]*_hitdetect.HIT_DETECT_RESOLUTION,_=n[1]*_hitdetect.HIT_DETECT_RESOLUTION;c.push(t.getRenderTransform(i,o,a,_hitdetect.HIT_DETECT_RESOLUTION,d,_,0).slice());var p=l.getSource(),h=u.getExtent();if(p.getWrapX()&&u.canWrapX()&&!(0,_extent2.containsExtent)(h,s)){for(var f,y=s[0],g=(0,_extent2.getWidth)(h),v=0;y<h[0];)f=g*--v,c.push(t.getRenderTransform(i,o,a,_hitdetect.HIT_DETECT_RESOLUTION,d,_,f).slice()),y+=g;for(v=0,y=s[2];y>h[2];)f=g*++v,c.push(t.getRenderTransform(i,o,a,_hitdetect.HIT_DETECT_RESOLUTION,d,_,f).slice()),y-=g}var x=(0,_proj.getUserProjection)();t.hitDetectionImageData_=(0,_hitdetect.createHitDetectionImageData)(n,c,t.renderedFeatures_,l.getStyleFunction(),s,o,a,(0,_vector.getSquaredTolerance)(o,t.renderedPixelRatio_),x?u:null)}r((0,_hitdetect.hitDetect)(e,t.renderedFeatures_,t.hitDetectionImageData_))})}},{key:"forEachFeatureAtCoordinate",value:function(e,t,r,n,i){if(this.replayGroup_){var o,a=t.viewState.resolution,u=t.viewState.rotation,s=this.getLayer(),l={},c=function(e,t,r){var o=(0,_util.getUid)(e),a=l[o];if(a){if(!0!==a&&r<a.distanceSq){if(0===r)return l[o]=!0,i.splice(i.lastIndexOf(a),1),n(e,s,t);a.geometry=t,a.distanceSq=r}}else{if(0===r)return l[o]=!0,n(e,s,t);i.push(l[o]={feature:e,layer:s,geometry:t,distanceSq:r,callback:n})}},d=[this.replayGroup_],_=this.getLayer().getDeclutter();return d.some(function(n){return o=n.forEachFeatureAtCoordinate(e,a,u,r,c,_&&t.declutter[_]?t.declutter[_].all().map(function(e){return e.value}):null)}),o}}},{key:"handleFontsChanged",value:function(){var e=this.getLayer();e.getVisible()&&this.replayGroup_&&e.changed()}},{key:"handleStyleImageChange_",value:function(e){this.renderIfReadyAndVisible()}},{key:"prepareFrame",value:function(e){var t=this,r=this.getLayer(),n=r.getSource();if(!n)return!1;var i=e.viewHints[_ViewHint.default.ANIMATING],o=e.viewHints[_ViewHint.default.INTERACTING],a=r.getUpdateWhileAnimating(),u=r.getUpdateWhileInteracting();if(this.ready&&!a&&i||!u&&o)return this.animatingOrInteracting_=!0,!0;this.animatingOrInteracting_=!1;var s=e.extent,l=e.viewState,c=l.projection,d=l.resolution,_=e.pixelRatio,p=r.getRevision(),h=r.getRenderBuffer(),f=r.getRenderOrder();void 0===f&&(f=_vector.defaultOrder);var y=l.center.slice(),g=(0,_extent2.buffer)(s,h*d),v=g.slice(),x=[g.slice()],R=c.getExtent();if(n.getWrapX()&&c.canWrapX()&&!(0,_extent2.containsExtent)(R,e.extent)){var m=(0,_extent2.getWidth)(R),E=Math.max((0,_extent2.getWidth)(g)/2,m);g[0]=R[0]-E,g[2]=R[2]+E,(0,_coordinate.wrapX)(y,c);var C=(0,_extent2.wrapX)(x[0],c);C[0]<R[0]&&C[2]<R[2]?x.push([C[0]+m,C[1],C[2]+m,C[3]]):C[0]>R[0]&&C[2]>R[2]&&x.push([C[0]-m,C[1],C[2]-m,C[3]])}if(this.ready&&this.renderedResolution_==d&&this.renderedRevision_==p&&this.renderedRenderOrder_==f&&this.renderedFrameDeclutter_===!!e.declutter&&(0,_extent2.containsExtent)(this.wrappedRenderedExtent_,g))return(0,_array.equals)(this.renderedExtent_,v)||(this.hitDetectionImageData_=null,this.renderedExtent_=v),this.renderedCenter_=y,this.replayGroupChanged=!1,!0;this.replayGroup_=null;var b,O=new _BuilderGroup.default((0,_vector.getTolerance)(d,_),g,d,_),w=(0,_proj.getUserProjection)();if(w){for(var j=0,D=x.length;j<D;++j){var T=x[j],I=(0,_proj.toUserExtent)(T,c);n.loadFeatures(I,(0,_proj.toUserResolution)(d,c),w)}b=(0,_proj.getTransformFromProjections)(w,c)}else for(var P=0,S=x.length;P<S;++P)n.loadFeatures(x[P],d,c);var L=(0,_vector.getSquaredTolerance)(d,_),q=!0,G=function(e,n){var i,o=e.getStyleFunction()||r.getStyleFunction();if(o&&(i=o(e,d)),i){var a=t.renderFeature(e,L,i,O,b,t.getLayer().getDeclutter(),n);q=q&&!a}},W=(0,_proj.toUserExtent)(g,c),F=n.getFeaturesInExtent(W);f&&F.sort(f);for(var N=0,k=F.length;N<k;++N)G(F[N],N);this.renderedFeatures_=F,this.ready=q;var H=O.finish(),A=new _ExecutorGroup.default(g,d,_,n.getOverlaps(),H,r.getRenderBuffer(),!!e.declutter);return this.renderedResolution_=d,this.renderedRevision_=p,this.renderedRenderOrder_=f,this.renderedFrameDeclutter_=!!e.declutter,this.renderedExtent_=v,this.wrappedRenderedExtent_=g,this.renderedCenter_=y,this.renderedProjection_=c,this.renderedPixelRatio_=_,this.replayGroup_=A,this.hitDetectionImageData_=null,this.replayGroupChanged=!0,!0}},{key:"renderFeature",value:function(e,t,r,n,i,o,a){if(!r)return!1;var u=!1;if(Array.isArray(r))for(var s=0,l=r.length;s<l;++s)u=(0,_vector.renderFeature)(n,e,r[s],t,this.boundHandleStyleImageChange_,i,o,a)||u;else u=(0,_vector.renderFeature)(n,e,r,t,this.boundHandleStyleImageChange_,i,o,a);return u}}])}(),_default=exports.default=CanvasVectorLayerRenderer;

},{"../../ViewHint.js":34,"../../array.js":36,"../../coordinate.js":47,"../../dom.js":49,"../../extent.js":59,"../../proj.js":123,"../../render/EventType.js":133,"../../render/canvas/BuilderGroup.js":138,"../../render/canvas/ExecutorGroup.js":140,"../../render/canvas/hitdetect.js":148,"../../util.js":205,"../vector.js":157,"./Layer.js":154}],157:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.defaultOrder=defaultOrder,exports.getSquaredTolerance=getSquaredTolerance,exports.getTolerance=getTolerance,exports.renderFeature=renderFeature;var _ImageState=_interopRequireDefault(require("../ImageState.js")),_util=require("../util.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var SIMPLIFY_TOLERANCE=.5,GEOMETRY_RENDERERS={Point:renderPointGeometry,LineString:renderLineStringGeometry,Polygon:renderPolygonGeometry,MultiPoint:renderMultiPointGeometry,MultiLineString:renderMultiLineStringGeometry,MultiPolygon:renderMultiPolygonGeometry,GeometryCollection:renderGeometryCollectionGeometry,Circle:renderCircleGeometry};function defaultOrder(e,t){return parseInt((0,_util.getUid)(e),10)-parseInt((0,_util.getUid)(t),10)}function getSquaredTolerance(e,t){var r=getTolerance(e,t);return r*r}function getTolerance(e,t){return SIMPLIFY_TOLERANCE*e/t}function renderCircleGeometry(e,t,r,n,i){var l=r.getFill(),a=r.getStroke();if(l||a){var g=e.getBuilder(r.getZIndex(),"Circle");g.setFillStrokeStyle(l,a),g.drawCircle(t,n,i)}var o=r.getText();if(o&&o.getText()){var d=e.getBuilder(r.getZIndex(),"Text");d.setTextStyle(o),d.drawText(t,n)}}function renderFeature(e,t,r,n,i,l,a,g){var o=[],d=r.getImage();if(d){var u=!0,y=d.getImageState();y==_ImageState.default.LOADED||y==_ImageState.default.ERROR?u=!1:y==_ImageState.default.IDLE&&d.load(),u&&o.push(d.ready())}var x=r.getFill();x&&x.loading()&&o.push(x.ready());var f=o.length>0;return f&&Promise.all(o).then(function(){return i(null)}),renderFeatureInternal(e,t,r,n,l,a,g),f}function renderFeatureInternal(e,t,r,n,i,l,a){var g=r.getGeometryFunction()(t);if(g){var o=g.simplifyTransformed(n,i);if(r.getRenderer())renderGeometry(e,o,r,t,a);else(0,GEOMETRY_RENDERERS[o.getType()])(e,o,r,t,a,l)}}function renderGeometry(e,t,r,n,i){if("GeometryCollection"!=t.getType())e.getBuilder(r.getZIndex(),"Default").drawCustom(t,n,r.getRenderer(),r.getHitDetectionRenderer(),i);else for(var l=t.getGeometries(),a=0,g=l.length;a<g;++a)renderGeometry(e,l[a],r,n,i)}function renderGeometryCollectionGeometry(e,t,r,n,i,l){var a,g,o=t.getGeometriesArray();for(a=0,g=o.length;a<g;++a){(0,GEOMETRY_RENDERERS[o[a].getType()])(e,o[a],r,n,i,l)}}function renderLineStringGeometry(e,t,r,n,i){var l=r.getStroke();if(l){var a=e.getBuilder(r.getZIndex(),"LineString");a.setFillStrokeStyle(null,l),a.drawLineString(t,n,i)}var g=r.getText();if(g&&g.getText()){var o=e.getBuilder(r.getZIndex(),"Text");o.setTextStyle(g),o.drawText(t,n,i)}}function renderMultiLineStringGeometry(e,t,r,n,i){var l=r.getStroke();if(l){var a=e.getBuilder(r.getZIndex(),"LineString");a.setFillStrokeStyle(null,l),a.drawMultiLineString(t,n,i)}var g=r.getText();if(g&&g.getText()){var o=e.getBuilder(r.getZIndex(),"Text");o.setTextStyle(g),o.drawText(t,n,i)}}function renderMultiPolygonGeometry(e,t,r,n,i){var l=r.getFill(),a=r.getStroke();if(a||l){var g=e.getBuilder(r.getZIndex(),"Polygon");g.setFillStrokeStyle(l,a),g.drawMultiPolygon(t,n,i)}var o=r.getText();if(o&&o.getText()){var d=e.getBuilder(r.getZIndex(),"Text");d.setTextStyle(o),d.drawText(t,n,i)}}function renderPointGeometry(e,t,r,n,i,l){var a=r.getImage(),g=r.getText(),o=g&&g.getText(),d=l&&a&&o?{}:void 0;if(a){if(a.getImageState()!=_ImageState.default.LOADED)return;var u=e.getBuilder(r.getZIndex(),"Image");u.setImageStyle(a,d),u.drawPoint(t,n,i)}if(o){var y=e.getBuilder(r.getZIndex(),"Text");y.setTextStyle(g,d),y.drawText(t,n,i)}}function renderMultiPointGeometry(e,t,r,n,i,l){var a=r.getImage(),g=a&&0!==a.getOpacity(),o=r.getText(),d=o&&o.getText(),u=l&&g&&d?{}:void 0;if(g){if(a.getImageState()!=_ImageState.default.LOADED)return;var y=e.getBuilder(r.getZIndex(),"Image");y.setImageStyle(a,u),y.drawMultiPoint(t,n,i)}if(d){var x=e.getBuilder(r.getZIndex(),"Text");x.setTextStyle(o,u),x.drawText(t,n,i)}}function renderPolygonGeometry(e,t,r,n,i){var l=r.getFill(),a=r.getStroke();if(l||a){var g=e.getBuilder(r.getZIndex(),"Polygon");g.setFillStrokeStyle(l,a),g.drawPolygon(t,n,i)}var o=r.getText();if(o&&o.getText()){var d=e.getBuilder(r.getZIndex(),"Text");d.setTextStyle(o),d.drawText(t,n,i)}}

},{"../ImageState.js":15,"../util.js":205}],158:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.calculateSourceExtentResolution=calculateSourceExtentResolution,exports.calculateSourceResolution=calculateSourceResolution,exports.canvasPool=void 0,exports.render=render;var brokenDiagonalRendering_,_extent=require("./extent.js"),_dom=require("./dom.js"),_proj=require("./proj.js"),_math=require("./math.js"),canvasPool=exports.canvasPool=[];function drawTestTriangle(e,t,n,a,o){e.beginPath(),e.moveTo(0,0),e.lineTo(t,n),e.lineTo(a,o),e.closePath(),e.save(),e.clip(),e.fillRect(0,0,Math.max(t,a)+1,Math.max(n,o)),e.restore()}function verifyBrokenDiagonalRendering(e,t){return Math.abs(e[4*t]-210)>2||Math.abs(e[4*t+3]-191.25)>2}function isBrokenDiagonalRendering(){if(void 0===brokenDiagonalRendering_){var e=(0,_dom.createCanvasContext2D)(6,6,canvasPool);e.globalCompositeOperation="lighter",e.fillStyle="rgba(210, 0, 0, 0.75)",drawTestTriangle(e,4,5,4,0),drawTestTriangle(e,4,5,0,5);var t=e.getImageData(0,0,3,3).data;brokenDiagonalRendering_=verifyBrokenDiagonalRendering(t,0)||verifyBrokenDiagonalRendering(t,4)||verifyBrokenDiagonalRendering(t,8),(0,_dom.releaseCanvas)(e),canvasPool.push(e.canvas)}return brokenDiagonalRendering_}function calculateSourceResolution(e,t,n,a){var o=(0,_proj.transform)(n,t,e),r=(0,_proj.getPointResolution)(t,a,n),i=t.getMetersPerUnit();void 0!==i&&(r*=i);var l=e.getMetersPerUnit();void 0!==l&&(r/=l);var s=e.getExtent();if(!s||(0,_extent.containsCoordinate)(s,o)){var c=(0,_proj.getPointResolution)(e,r,o)/r;isFinite(c)&&c>0&&(r/=c)}return r}function calculateSourceExtentResolution(e,t,n,a){var o=(0,_extent.getCenter)(n),r=calculateSourceResolution(e,t,o,a);return(!isFinite(r)||r<=0)&&(0,_extent.forEachCorner)(n,function(n){return r=calculateSourceResolution(e,t,n,a),isFinite(r)&&r>0}),r}function render(e,t,n,a,o,r,i,l,s,c,g,u,h,d){var v=(0,_dom.createCanvasContext2D)(Math.round(n*e),Math.round(n*t),canvasPool);if(u||(v.imageSmoothingEnabled=!1),0===s.length)return v.canvas;function x(e){return Math.round(e*n)/n}v.scale(n,n),v.globalCompositeOperation="lighter";var f,m=(0,_extent.createEmpty)();s.forEach(function(e,t,n){(0,_extent.extend)(m,e.extent)});var _=n/a,p=(u?1:1+Math.pow(2,-24))/_;if(!h||1!==s.length||0!==c){if(f=(0,_dom.createCanvasContext2D)(Math.round((0,_extent.getWidth)(m)*_),Math.round((0,_extent.getHeight)(m)*_),canvasPool),u||(f.imageSmoothingEnabled=!1),o&&d){var M=(o[0]-m[0])*_,T=-(o[3]-m[3])*_,R=(0,_extent.getWidth)(o)*_,E=(0,_extent.getHeight)(o)*_;f.rect(M,T,R,E),f.clip()}s.forEach(function(e,t,n){if(e.image.width>0&&e.image.height>0){if(e.clipExtent){f.save();var a=(e.clipExtent[0]-m[0])*_,o=-(e.clipExtent[3]-m[3])*_,r=(0,_extent.getWidth)(e.clipExtent)*_,i=(0,_extent.getHeight)(e.clipExtent)*_;f.rect(u?a:Math.round(a),u?o:Math.round(o),u?r:Math.round(a+r)-Math.round(a),u?i:Math.round(o+i)-Math.round(o)),f.clip()}var l=(e.extent[0]-m[0])*_,s=-(e.extent[3]-m[3])*_,g=(0,_extent.getWidth)(e.extent)*_,h=(0,_extent.getHeight)(e.extent)*_;f.drawImage(e.image,c,c,e.image.width-2*c,e.image.height-2*c,u?l:Math.round(l),u?s:Math.round(s),u?g:Math.round(l+g)-Math.round(l),u?h:Math.round(s+h)-Math.round(s)),e.clipExtent&&f.restore()}})}var P=(0,_extent.getTopLeft)(i);return l.getTriangles().forEach(function(e,t,n){var a=e.source,o=e.target,i=a[0][0],l=a[0][1],c=a[1][0],g=a[1][1],h=a[2][0],d=a[2][1],_=x((o[0][0]-P[0])/r),M=x(-(o[0][1]-P[1])/r),T=x((o[1][0]-P[0])/r),R=x(-(o[1][1]-P[1])/r),E=x((o[2][0]-P[0])/r),b=x(-(o[2][1]-P[1])/r),C=i,D=l;i=0,l=0;var k=[[c-=C,g-=D,0,0,T-_],[h-=C,d-=D,0,0,E-_],[0,0,c,g,R-M],[0,0,h,d,b-M]],S=(0,_math.solveLinearSystem)(k);if(S){if(v.save(),v.beginPath(),isBrokenDiagonalRendering()||!u){v.moveTo(T,R);for(var j=_-T,w=M-R,y=0;y<4;y++)v.lineTo(T+x((y+1)*j/4),R+x(y*w/3)),3!=y&&v.lineTo(T+x((y+1)*j/4),R+x((y+1)*w/3));v.lineTo(E,b)}else v.moveTo(T,R),v.lineTo(_,M),v.lineTo(E,b);var B;if(v.clip(),v.transform(S[0],S[2],S[1],S[3],_,M),v.translate(m[0]-C,m[3]-D),f)B=f.canvas,v.scale(p,-p);else{var W=s[0],H=W.extent;B=W.image,v.scale((0,_extent.getWidth)(H)/B.width,-(0,_extent.getHeight)(H)/B.height)}v.drawImage(B,0,0),v.restore()}}),f&&((0,_dom.releaseCanvas)(f),canvasPool.push(f.canvas)),g&&(v.save(),v.globalCompositeOperation="source-over",v.strokeStyle="black",v.lineWidth=1,l.getTriangles().forEach(function(e,t,n){var a=e.target,o=(a[0][0]-P[0])/r,i=-(a[0][1]-P[1])/r,l=(a[1][0]-P[0])/r,s=-(a[1][1]-P[1])/r,c=(a[2][0]-P[0])/r,g=-(a[2][1]-P[1])/r;v.beginPath(),v.moveTo(l,s),v.lineTo(o,i),v.lineTo(c,g),v.closePath(),v.stroke()}),v.restore()),v.canvas}

},{"./dom.js":49,"./extent.js":59,"./math.js":120,"./proj.js":123}],159:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _common=require("./common.js"),_DataTile2=_interopRequireWildcard(require("../DataTile.js")),_EventType=_interopRequireDefault(require("../events/EventType.js")),_TileState=_interopRequireDefault(require("../TileState.js")),_Triangulation=_interopRequireDefault(require("./Triangulation.js")),_reproj=require("../reproj.js"),_math=require("../math.js"),_dom=require("../dom.js"),_extent=require("../extent.js"),_events=require("../events.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _getRequireWildcardCache(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(_getRequireWildcardCache=function(e){return e?r:t})(e)}function _interopRequireWildcard(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=_typeof(e)&&"function"!=typeof e)return{default:e};var r=_getRequireWildcardCache(t);if(r&&r.has(e))return r.get(e);var i={__proto__:null},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&{}.hasOwnProperty.call(e,a)){var n=o?Object.getOwnPropertyDescriptor(e,a):null;n&&(n.get||n.set)?Object.defineProperty(i,a,n):i[a]=e[a]}return i.default=e,r&&r.set(e,i),i}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,_toPropertyKey(i.key),i)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var ReprojDataTile=function(e){function t(e){var r;_classCallCheck(this,t),(r=_callSuper(this,t,[{tileCoord:e.tileCoord,loader:function(){return Promise.resolve(new Uint8ClampedArray(4))},interpolate:e.interpolate,transition:e.transition}])).pixelRatio_=e.pixelRatio,r.gutter_=e.gutter,r.reprojData_=null,r.reprojError_=null,r.reprojSize_=void 0,r.sourceTileGrid_=e.sourceTileGrid,r.targetTileGrid_=e.targetTileGrid,r.wrappedTileCoord_=e.wrappedTileCoord||e.tileCoord,r.sourceTiles_=[],r.sourcesListenerKeys_=null,r.sourceZ_=0;var i=e.sourceProj,o=i.getExtent(),a=e.sourceTileGrid.getExtent();r.clipExtent_=i.canWrapX()?a?(0,_extent.getIntersection)(o,a):o:a;var n=r.targetTileGrid_.getTileCoordExtent(r.wrappedTileCoord_),l=r.targetTileGrid_.getExtent(),u=r.sourceTileGrid_.getExtent(),s=l?(0,_extent.getIntersection)(n,l):n;if(0===(0,_extent.getArea)(s))return r.state=_TileState.default.EMPTY,_possibleConstructorReturn(r);o&&(u=u?(0,_extent.getIntersection)(u,o):o);var c=r.targetTileGrid_.getResolution(r.wrappedTileCoord_[0]),_=e.targetProj,f=(0,_reproj.calculateSourceExtentResolution)(i,_,s,c);if(!isFinite(f)||f<=0)return r.state=_TileState.default.EMPTY,_possibleConstructorReturn(r);var p=void 0!==e.errorThreshold?e.errorThreshold:_common.ERROR_THRESHOLD;if(r.triangulation_=new _Triangulation.default(i,_,s,u,f*p,c),0===r.triangulation_.getTriangles().length)return r.state=_TileState.default.EMPTY,_possibleConstructorReturn(r);r.sourceZ_=r.sourceTileGrid_.getZForResolution(f);var d=r.triangulation_.calculateSourceExtent();if(u&&(i.canWrapX()?(d[1]=(0,_math.clamp)(d[1],u[1],u[3]),d[3]=(0,_math.clamp)(d[3],u[1],u[3])):d=(0,_extent.getIntersection)(d,u)),(0,_extent.getArea)(d)){var h=0,g=0;i.canWrapX()&&(h=(0,_extent.getWidth)(o),g=Math.floor((d[0]-o[0])/h)),(0,_extent.wrapAndSliceX)(d.slice(),i,!0).forEach(function(t){for(var i=r.sourceTileGrid_.getTileRangeForExtentAndZ(t,r.sourceZ_),o=e.getTileFunction,a=i.minX;a<=i.maxX;a++)for(var n=i.minY;n<=i.maxY;n++){var l=o(r.sourceZ_,a,n,r.pixelRatio_);if(l){var u=g*h;r.sourceTiles_.push({tile:l,offset:u})}}++g}),0===r.sourceTiles_.length&&(r.state=_TileState.default.EMPTY)}else r.state=_TileState.default.EMPTY;return r}return _inherits(t,_DataTile2["default"]),_createClass(t,[{key:"getSize",value:function(){return this.reprojSize_}},{key:"getData",value:function(){return this.reprojData_}},{key:"getError",value:function(){return this.reprojError_}},{key:"reproject_",value:function(){var e=this,t=[],r=!1;if(this.sourceTiles_.forEach(function(i){var o,a=i.tile;if(a&&a.getState()===_TileState.default.LOADED){var n,l=a.getSize(),u=e.gutter_,s=(0,_DataTile2.asArrayLike)(a.getData());s?n=s:(r=!0,n=(0,_DataTile2.toArray)((0,_DataTile2.asImageLike)(a.getData())));var c=[l[0]+2*u,l[1]+2*u],_=n instanceof Float32Array,f=c[0]*c[1],p=_?Float32Array:Uint8ClampedArray,d=new p(n.buffer),h=p.BYTES_PER_ELEMENT,g=h*d.length/f,y=d.byteLength/c[1],v=Math.floor(y/h/c[0]),T=f*v,m=d;if(d.length!==T){m=new p(T);for(var b=0,E=0,j=c[0]*v,x=0;x<c[1];++x){for(var R=0;R<j;++R)m[b++]=d[E+R];E+=y/h}}var S=e.sourceTileGrid_.getTileCoordExtent(a.tileCoord);S[0]+=i.offset,S[2]+=i.offset;var P=null===(o=e.clipExtent_)||void 0===o?void 0:o.slice();P&&(P[0]+=i.offset,P[2]+=i.offset),t.push({extent:S,clipExtent:P,data:new Uint8ClampedArray(m.buffer),dataType:p,bytesPerPixel:g,pixelSize:c})}}),this.sourceTiles_.length=0,0===t.length)return this.state=_TileState.default.ERROR,void this.changed();for(var i,o,a=this.wrappedTileCoord_[0],n=this.targetTileGrid_.getTileSize(a),l="number"==typeof n?n:n[0],u="number"==typeof n?n:n[1],s=this.targetTileGrid_.getResolution(a),c=this.sourceTileGrid_.getResolution(this.sourceZ_),_=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_),f=t[0].bytesPerPixel,p=Math.ceil(f/3)-1;p>=0;--p){for(var d=[],h=0,g=t.length;h<g;++h){for(var y=t[h],v=y.data,T=y.pixelSize,m=T[0],b=T[1],E=(0,_dom.createCanvasContext2D)(m,b,_reproj.canvasPool),j=E.createImageData(m,b),x=j.data,R=3*p,S=0,P=x.length;S<P;S+=4)x[S]=v[R],x[S+1]=v[R+1],x[S+2]=v[R+2],x[S+3]=255,R+=f;E.putImageData(j,0,0),d.push({extent:y.extent,clipExtent:y.clipExtent,image:E.canvas})}for(var C=(0,_reproj.render)(l,u,this.pixelRatio_,c,this.sourceTileGrid_.getExtent(),s,_,this.triangulation_,d,this.gutter_,!1,!1,!1),D=0,O=d.length;D<O;++D){var w=d[D].image.getContext("2d");(0,_dom.releaseCanvas)(w),_reproj.canvasPool.push(w.canvas)}var G=C.getContext("2d"),q=G.getImageData(0,0,C.width,C.height);(0,_dom.releaseCanvas)(G),_reproj.canvasPool.push(C),i||(o=new Uint8ClampedArray(f*q.width*q.height),i=new t[0].dataType(o.buffer));for(var A=q.data,L=3*p,M=0,I=A.length;M<I;M+=4)255===A[M+3]?(o[L]=A[M],o[L+1]=A[M+1],o[L+2]=A[M+2]):(o[L]=0,o[L+1]=0,o[L+2]=0),L+=f}if(r){var k=(0,_dom.createCanvasContext2D)(l,u),W=new ImageData(i,l);k.putImageData(W,0,0),this.reprojData_=k.canvas}else this.reprojData_=i;this.reprojSize_=[Math.round(l*this.pixelRatio_),Math.round(u*this.pixelRatio_)],this.state=_TileState.default.LOADED,this.changed()}},{key:"load",value:function(){var e=this;if(this.state===_TileState.default.IDLE||this.state===_TileState.default.ERROR){this.state=_TileState.default.LOADING,this.changed();var t=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach(function(r){var i=r.tile,o=i.getState();if(o===_TileState.default.IDLE||o===_TileState.default.LOADING){t++;var a=(0,_events.listen)(i,_EventType.default.CHANGE,function(){var r=i.getState();r!=_TileState.default.LOADED&&r!=_TileState.default.ERROR&&r!=_TileState.default.EMPTY||((0,_events.unlistenByKey)(a),0===--t&&(e.unlistenSources_(),e.reproject_()))});e.sourcesListenerKeys_.push(a)}}),0===t?setTimeout(this.reproject_.bind(this),0):this.sourceTiles_.forEach(function(e){var t=e.tile;t.getState()==_TileState.default.IDLE&&t.load()})}}},{key:"unlistenSources_",value:function(){this.sourcesListenerKeys_.forEach(_events.unlistenByKey),this.sourcesListenerKeys_=null}}])}(),_default=exports.default=ReprojDataTile;

},{"../DataTile.js":11,"../TileState.js":32,"../dom.js":49,"../events.js":51,"../events/EventType.js":53,"../extent.js":59,"../math.js":120,"../reproj.js":158,"./Triangulation.js":162,"./common.js":163}],160:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _common=require("./common.js"),_EventType=_interopRequireDefault(require("../events/EventType.js")),_ImageState=_interopRequireDefault(require("../ImageState.js")),_Image=_interopRequireDefault(require("../Image.js")),_Triangulation=_interopRequireDefault(require("./Triangulation.js")),_reproj=require("../reproj.js"),_resolution=require("../resolution.js"),_extent=require("../extent.js"),_events=require("../events.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _superPropGet(e,t,r,o){var n=_get(_getPrototypeOf(1&o?e.prototype:e),t,r);return 2&o?function(e){return n.apply(r,e)}:n}function _get(){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var o=_superPropBase(e,t);if(o){var n=Object.getOwnPropertyDescriptor(o,t);return n.get?n.get.call(arguments.length<3?e:r):n.value}}).apply(null,arguments)}function _superPropBase(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf(e)););return e}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var ReprojImage=function(e){function t(e,r,o,n,i,a,u){var s;_classCallCheck(this,t);var l=e.getExtent();l&&e.canWrapX()&&((l=l.slice())[0]=-1/0,l[2]=1/0);var c=r.getExtent();c&&r.canWrapX()&&((c=c.slice())[0]=-1/0,c[2]=1/0);var _=c?(0,_extent.getIntersection)(o,c):o,f=(0,_extent.getCenter)(_),p=(0,_reproj.calculateSourceResolution)(e,r,f,n),g=_common.ERROR_THRESHOLD,y=new _Triangulation.default(e,r,_,l,p*g,n),m=y.calculateSourceExtent(),h=(0,_extent.isEmpty)(m)?null:a(m,p,i),v=h?_ImageState.default.IDLE:_ImageState.default.EMPTY,d=h?h.getPixelRatio():1;return(s=_callSuper(this,t,[o,n,d,v])).targetProj_=r,s.maxSourceExtent_=l,s.triangulation_=y,s.targetResolution_=n,s.targetExtent_=o,s.sourceImage_=h,s.sourcePixelRatio_=d,s.interpolate_=u,s.canvas_=null,s.sourceListenerKey_=null,s}return _inherits(t,_Image["default"]),_createClass(t,[{key:"disposeInternal",value:function(){this.state==_ImageState.default.LOADING&&this.unlistenSource_(),_superPropGet(t,"disposeInternal",this,3)([])}},{key:"getImage",value:function(){return this.canvas_}},{key:"getProjection",value:function(){return this.targetProj_}},{key:"reproject_",value:function(){var e=this.sourceImage_.getState();if(e==_ImageState.default.LOADED){var t=(0,_extent.getWidth)(this.targetExtent_)/this.targetResolution_,r=(0,_extent.getHeight)(this.targetExtent_)/this.targetResolution_;this.canvas_=(0,_reproj.render)(t,r,this.sourcePixelRatio_,(0,_resolution.fromResolutionLike)(this.sourceImage_.getResolution()),this.maxSourceExtent_,this.targetResolution_,this.targetExtent_,this.triangulation_,[{extent:this.sourceImage_.getExtent(),image:this.sourceImage_.getImage()}],0,void 0,this.interpolate_,!0)}this.state=e,this.changed()}},{key:"load",value:function(){var e=this;if(this.state==_ImageState.default.IDLE){this.state=_ImageState.default.LOADING,this.changed();var t=this.sourceImage_.getState();t==_ImageState.default.LOADED||t==_ImageState.default.ERROR?this.reproject_():(this.sourceListenerKey_=(0,_events.listen)(this.sourceImage_,_EventType.default.CHANGE,function(t){var r=e.sourceImage_.getState();r!=_ImageState.default.LOADED&&r!=_ImageState.default.ERROR||(e.unlistenSource_(),e.reproject_())}),this.sourceImage_.load())}}},{key:"unlistenSource_",value:function(){(0,_events.unlistenByKey)(this.sourceListenerKey_),this.sourceListenerKey_=null}}])}(),_default=exports.default=ReprojImage;

},{"../Image.js":14,"../ImageState.js":15,"../events.js":51,"../events/EventType.js":53,"../extent.js":59,"../reproj.js":158,"../resolution.js":164,"./Triangulation.js":162,"./common.js":163}],161:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _common=require("./common.js"),_EventType=_interopRequireDefault(require("../events/EventType.js")),_Tile2=_interopRequireDefault(require("../Tile.js")),_TileState=_interopRequireDefault(require("../TileState.js")),_Triangulation=_interopRequireDefault(require("./Triangulation.js")),_reproj=require("../reproj.js"),_math=require("../math.js"),_extent=require("../extent.js"),_events=require("../events.js"),_dom=require("../dom.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,_toPropertyKey(i.key),i)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _superPropGet(e,t,r,i){var o=_get(_getPrototypeOf(1&i?e.prototype:e),t,r);return 2&i?function(e){return o.apply(r,e)}:o}function _get(){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var i=_superPropBase(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}}).apply(null,arguments)}function _superPropBase(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf(e)););return e}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var ReprojTile=function(e){function t(e,r,i,o,n,a,s,u,l,c,_,f){var p;_classCallCheck(this,t),(p=_callSuper(this,t,[n,_TileState.default.IDLE,f])).renderEdges_=void 0!==_&&_,p.pixelRatio_=s,p.gutter_=u,p.canvas_=null,p.sourceTileGrid_=r,p.targetTileGrid_=o,p.wrappedTileCoord_=a||n,p.sourceTiles_=[],p.sourcesListenerKeys_=null,p.sourceZ_=0,p.clipExtent_=e.canWrapX()?e.getExtent():void 0;var d=o.getTileCoordExtent(p.wrappedTileCoord_),y=p.targetTileGrid_.getExtent(),v=p.sourceTileGrid_.getExtent(),h=y?(0,_extent.getIntersection)(d,y):d;if(0===(0,_extent.getArea)(h))return p.state=_TileState.default.EMPTY,_possibleConstructorReturn(p);var g=e.getExtent();g&&(v=v?(0,_extent.getIntersection)(v,g):g);var T=o.getResolution(p.wrappedTileCoord_[0]),b=(0,_reproj.calculateSourceExtentResolution)(e,i,h,T);if(!isFinite(b)||b<=0)return p.state=_TileState.default.EMPTY,_possibleConstructorReturn(p);var E=void 0!==c?c:_common.ERROR_THRESHOLD;if(p.triangulation_=new _Triangulation.default(e,i,h,v,b*E,T),0===p.triangulation_.getTriangles().length)return p.state=_TileState.default.EMPTY,_possibleConstructorReturn(p);p.sourceZ_=r.getZForResolution(b);var m=p.triangulation_.calculateSourceExtent();if(v&&(e.canWrapX()?(m[1]=(0,_math.clamp)(m[1],v[1],v[3]),m[3]=(0,_math.clamp)(m[3],v[1],v[3])):m=(0,_extent.getIntersection)(m,v)),(0,_extent.getArea)(m)){var P=0,S=0;e.canWrapX()&&(P=(0,_extent.getWidth)(g),S=Math.floor((m[0]-g[0])/P)),(0,_extent.wrapAndSliceX)(m.slice(),e,!0).forEach(function(e){for(var t=r.getTileRangeForExtentAndZ(e,p.sourceZ_),i=t.minX;i<=t.maxX;i++)for(var o=t.minY;o<=t.maxY;o++){var n=l(p.sourceZ_,i,o,s);if(n){var a=S*P;p.sourceTiles_.push({tile:n,offset:a})}}++S}),0===p.sourceTiles_.length&&(p.state=_TileState.default.EMPTY)}else p.state=_TileState.default.EMPTY;return p}return _inherits(t,_Tile2["default"]),_createClass(t,[{key:"getImage",value:function(){return this.canvas_}},{key:"reproject_",value:function(){var e=this,t=[];if(this.sourceTiles_.forEach(function(r){var i=r.tile;if(i&&i.getState()==_TileState.default.LOADED){var o,n=e.sourceTileGrid_.getTileCoordExtent(i.tileCoord);n[0]+=r.offset,n[2]+=r.offset;var a=null===(o=e.clipExtent_)||void 0===o?void 0:o.slice();a&&(a[0]+=r.offset,a[2]+=r.offset),t.push({extent:n,clipExtent:a,image:i.getImage()})}}),this.sourceTiles_.length=0,0===t.length)this.state=_TileState.default.ERROR;else{var r=this.wrappedTileCoord_[0],i=this.targetTileGrid_.getTileSize(r),o="number"==typeof i?i:i[0],n="number"==typeof i?i:i[1],a=this.targetTileGrid_.getResolution(r),s=this.sourceTileGrid_.getResolution(this.sourceZ_),u=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=(0,_reproj.render)(o,n,this.pixelRatio_,s,this.sourceTileGrid_.getExtent(),a,u,this.triangulation_,t,this.gutter_,this.renderEdges_,this.interpolate),this.state=_TileState.default.LOADED}this.changed()}},{key:"load",value:function(){var e=this;if(this.state==_TileState.default.IDLE){this.state=_TileState.default.LOADING,this.changed();var t=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach(function(r){var i=r.tile,o=i.getState();if(o==_TileState.default.IDLE||o==_TileState.default.LOADING){t++;var n=(0,_events.listen)(i,_EventType.default.CHANGE,function(r){var o=i.getState();o!=_TileState.default.LOADED&&o!=_TileState.default.ERROR&&o!=_TileState.default.EMPTY||((0,_events.unlistenByKey)(n),0===--t&&(e.unlistenSources_(),e.reproject_()))});e.sourcesListenerKeys_.push(n)}}),0===t?setTimeout(this.reproject_.bind(this),0):this.sourceTiles_.forEach(function(e,t,r){var i=e.tile;i.getState()==_TileState.default.IDLE&&i.load()})}}},{key:"unlistenSources_",value:function(){this.sourcesListenerKeys_.forEach(_events.unlistenByKey),this.sourcesListenerKeys_=null}},{key:"release",value:function(){this.canvas_&&((0,_dom.releaseCanvas)(this.canvas_.getContext("2d")),_reproj.canvasPool.push(this.canvas_),this.canvas_=null),_superPropGet(t,"release",this,3)([])}}])}(),_default=exports.default=ReprojTile;

},{"../Tile.js":28,"../TileState.js":32,"../dom.js":49,"../events.js":51,"../events/EventType.js":53,"../extent.js":59,"../math.js":120,"../reproj.js":158,"./Triangulation.js":162,"./common.js":163}],162:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _extent=require("../extent.js"),_proj=require("../proj.js"),_math=require("../math.js");function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,_toPropertyKey(i.key),i)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!=_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var MAX_SUBDIVISION=10,MAX_TRIANGLE_WIDTH=.25,Triangulation=function(){return _createClass(function t(e,r,i,o,n,s){var a=this;_classCallCheck(this,t),this.sourceProj_=e,this.targetProj_=r;var u={},_=(0,_proj.getTransform)(this.targetProj_,this.sourceProj_);this.transformInv_=function(t){var e=t[0]+"/"+t[1];return u[e]||(u[e]=_(t)),u[e]},this.maxSourceExtent_=o,this.errorThresholdSquared_=n*n,this.triangles_=[],this.wrapsXInSource_=!1,this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!o&&!!this.sourceProj_.getExtent()&&(0,_extent.getWidth)(o)>=(0,_extent.getWidth)(this.sourceProj_.getExtent()),this.sourceWorldWidth_=this.sourceProj_.getExtent()?(0,_extent.getWidth)(this.sourceProj_.getExtent()):null,this.targetWorldWidth_=this.targetProj_.getExtent()?(0,_extent.getWidth)(this.targetProj_.getExtent()):null;var h=(0,_extent.getTopLeft)(i),c=(0,_extent.getTopRight)(i),d=(0,_extent.getBottomRight)(i),l=(0,_extent.getBottomLeft)(i),f=this.transformInv_(h),g=this.transformInv_(c),m=this.transformInv_(d),v=this.transformInv_(l),p=MAX_SUBDIVISION+(s?Math.max(0,Math.ceil(Math.log2((0,_extent.getArea)(i)/(s*s*256*256)))):0);if(this.addQuad_(h,c,d,l,f,g,m,v,p),this.wrapsXInSource_){var x=1/0;this.triangles_.forEach(function(t,e,r){x=Math.min(x,t.source[0][0],t.source[1][0],t.source[2][0])}),this.triangles_.forEach(function(t){if(Math.max(t.source[0][0],t.source[1][0],t.source[2][0])-x>a.sourceWorldWidth_/2){var e=[[t.source[0][0],t.source[0][1]],[t.source[1][0],t.source[1][1]],[t.source[2][0],t.source[2][1]]];e[0][0]-x>a.sourceWorldWidth_/2&&(e[0][0]-=a.sourceWorldWidth_),e[1][0]-x>a.sourceWorldWidth_/2&&(e[1][0]-=a.sourceWorldWidth_),e[2][0]-x>a.sourceWorldWidth_/2&&(e[2][0]-=a.sourceWorldWidth_);var r=Math.min(e[0][0],e[1][0],e[2][0]);Math.max(e[0][0],e[1][0],e[2][0])-r<a.sourceWorldWidth_/2&&(t.source=e)}})}u={}},[{key:"addTriangle_",value:function(t,e,r,i,o,n){this.triangles_.push({source:[i,o,n],target:[t,e,r]})}},{key:"addQuad_",value:function(t,e,r,i,o,n,s,a,u){var _=(0,_extent.boundingExtent)([o,n,s,a]),h=this.sourceWorldWidth_?(0,_extent.getWidth)(_)/this.sourceWorldWidth_:null,c=this.sourceWorldWidth_,d=this.sourceProj_.canWrapX()&&h>.5&&h<1,l=!1;if(u>0){if(this.targetProj_.isGlobal()&&this.targetWorldWidth_){var f=(0,_extent.boundingExtent)([t,e,r,i]);l=(0,_extent.getWidth)(f)/this.targetWorldWidth_>MAX_TRIANGLE_WIDTH||l}!d&&this.sourceProj_.isGlobal()&&h&&(l=h>MAX_TRIANGLE_WIDTH||l)}if(!(!l&&this.maxSourceExtent_&&isFinite(_[0])&&isFinite(_[1])&&isFinite(_[2])&&isFinite(_[3]))||(0,_extent.intersects)(_,this.maxSourceExtent_)){var g=0;if(!(l||isFinite(o[0])&&isFinite(o[1])&&isFinite(n[0])&&isFinite(n[1])&&isFinite(s[0])&&isFinite(s[1])&&isFinite(a[0])&&isFinite(a[1])))if(u>0)l=!0;else if(1!=(g=(isFinite(o[0])&&isFinite(o[1])?0:8)+(isFinite(n[0])&&isFinite(n[1])?0:4)+(isFinite(s[0])&&isFinite(s[1])?0:2)+(isFinite(a[0])&&isFinite(a[1])?0:1))&&2!=g&&4!=g&&8!=g)return;if(u>0){if(!l){var m,v=[(t[0]+r[0])/2,(t[1]+r[1])/2],p=this.transformInv_(v);if(d)m=((0,_math.modulo)(o[0],c)+(0,_math.modulo)(s[0],c))/2-(0,_math.modulo)(p[0],c);else m=(o[0]+s[0])/2-p[0];var x=(o[1]+s[1])/2-p[1];l=m*m+x*x>this.errorThresholdSquared_}if(l){if(Math.abs(t[0]-r[0])<=Math.abs(t[1]-r[1])){var W=[(e[0]+r[0])/2,(e[1]+r[1])/2],y=this.transformInv_(W),I=[(i[0]+t[0])/2,(i[1]+t[1])/2],b=this.transformInv_(I);this.addQuad_(t,e,W,I,o,n,y,b,u-1),this.addQuad_(I,W,r,i,b,y,s,a,u-1)}else{var P=[(t[0]+e[0])/2,(t[1]+e[1])/2],j=this.transformInv_(P),S=[(r[0]+i[0])/2,(r[1]+i[1])/2],E=this.transformInv_(S);this.addQuad_(t,P,S,i,o,j,E,a,u-1),this.addQuad_(P,e,r,S,j,n,s,E,u-1)}return}}if(d){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}0==(11&g)&&this.addTriangle_(t,r,i,o,s,a),0==(14&g)&&this.addTriangle_(t,r,e,o,s,n),g&&(0==(13&g)&&this.addTriangle_(e,i,t,n,a,o),0==(7&g)&&this.addTriangle_(e,i,r,n,a,s))}}},{key:"calculateSourceExtent",value:function(){var t=(0,_extent.createEmpty)();return this.triangles_.forEach(function(e,r,i){var o=e.source;(0,_extent.extendCoordinate)(t,o[0]),(0,_extent.extendCoordinate)(t,o[1]),(0,_extent.extendCoordinate)(t,o[2])}),t}},{key:"getTriangles",value:function(){return this.triangles_}}])}(),_default=exports.default=Triangulation;

},{"../extent.js":59,"../math.js":120,"../proj.js":123}],163:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ERROR_THRESHOLD=void 0;var ERROR_THRESHOLD=exports.ERROR_THRESHOLD=.5;

},{}],164:[function(require,module,exports){
"use strict";function _toConsumableArray(r){return _arrayWithoutHoles(r)||_iterableToArray(r)||_unsupportedIterableToArray(r)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(r,e){if(r){if("string"==typeof r)return _arrayLikeToArray(r,e);var t={}.toString.call(r).slice(8,-1);return"Object"===t&&r.constructor&&(t=r.constructor.name),"Map"===t||"Set"===t?Array.from(r):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?_arrayLikeToArray(r,e):void 0}}function _iterableToArray(r){if("undefined"!=typeof Symbol&&null!=r[Symbol.iterator]||null!=r["@@iterator"])return Array.from(r)}function _arrayWithoutHoles(r){if(Array.isArray(r))return _arrayLikeToArray(r)}function _arrayLikeToArray(r,e){(null==e||e>r.length)&&(e=r.length);for(var t=0,o=Array(e);t<e;t++)o[t]=r[t];return o}function fromResolutionLike(r){return Array.isArray(r)?Math.min.apply(Math,_toConsumableArray(r)):r}Object.defineProperty(exports,"__esModule",{value:!0}),exports.fromResolutionLike=fromResolutionLike;

},{}],165:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.createMinMaxResolution=createMinMaxResolution,exports.createSnapToPower=createSnapToPower,exports.createSnapToResolutions=createSnapToResolutions;var _math=require("./math.js"),_extent=require("./extent.js"),_array=require("./array.js");function getViewportClampedResolution(t,e,a,o){var r=(0,_extent.getWidth)(e)/a[0],n=(0,_extent.getHeight)(e)/a[1];return o?Math.min(t,Math.max(r,n)):Math.min(t,Math.min(r,n))}function getSmoothClampedResolution(t,e,a){var o=Math.min(t,e);return o*=Math.log(1+50*Math.max(0,t/e-1))/50+1,a&&(o=Math.max(o,a),o/=Math.log(1+50*Math.max(0,a/t-1))/50+1),(0,_math.clamp)(o,a/2,2*e)}function createSnapToResolutions(t,e,a,o){return e=void 0===e||e,function(r,n,i,l){if(void 0!==r){var u=t[0],h=t[t.length-1],m=a?getViewportClampedResolution(u,a,i,o):u;if(l)return e?getSmoothClampedResolution(r,m,h):(0,_math.clamp)(r,h,m);var p=Math.min(m,r),s=Math.floor((0,_array.linearFindNearest)(t,p,n));return t[s]>m&&s<t.length-1?t[s+1]:t[s]}}}function createSnapToPower(t,e,a,o,r,n){return o=void 0===o||o,a=void 0!==a?a:0,function(i,l,u,h){if(void 0!==i){var m=r?getViewportClampedResolution(e,r,u,n):e;if(h)return o?getSmoothClampedResolution(i,m,a):(0,_math.clamp)(i,a,m);var p=Math.ceil(Math.log(e/m)/Math.log(t)-1e-9),s=-l*(.5-1e-9)+.5,M=Math.min(m,i),c=Math.floor(Math.log(e/M)/Math.log(t)+s),d=Math.max(p,c),g=e/Math.pow(t,d);return(0,_math.clamp)(g,a,m)}}}function createMinMaxResolution(t,e,a,o,r){return a=void 0===a||a,function(n,i,l,u){if(void 0!==n){var h=o?getViewportClampedResolution(t,o,l,r):t;return a&&u?getSmoothClampedResolution(n,h,e):(0,_math.clamp)(n,e,h)}}}

},{"./array.js":36,"./extent.js":59,"./math.js":120}],166:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.createSnapToN=createSnapToN,exports.createSnapToZero=createSnapToZero,exports.disable=disable,exports.none=none;var _math=require("./math.js");function disable(e){if(void 0!==e)return 0}function none(e){if(void 0!==e)return e}function createSnapToN(e){var r=2*Math.PI/e;return function(e,o){return o?e:void 0!==e?e=Math.floor(e/r+.5)*r:void 0}}function createSnapToZero(e){var r=void 0===e?(0,_math.toRadians)(5):e;return function(e,o){return o||void 0===e?e:Math.abs(e)<=r?0:e}}

},{"./math.js":120}],167:[function(require,module,exports){
"use strict";function buffer(e,r,t){return void 0===t&&(t=[0,0]),t[0]=e[0]+2*r,t[1]=e[1]+2*r,t}function hasArea(e){return e[0]>0&&e[1]>0}function scale(e,r,t){return void 0===t&&(t=[0,0]),t[0]=e[0]*r+.5|0,t[1]=e[1]*r+.5|0,t}function toSize(e,r){return Array.isArray(e)?e:(void 0===r?r=[e,e]:(r[0]=e,r[1]=e),r)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.buffer=buffer,exports.hasArea=hasArea,exports.scale=scale,exports.toSize=toSize;

},{}],168:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=exports.ImageSourceEventType=exports.ImageSourceEvent=void 0,exports.defaultImageLoadFunction=defaultImageLoadFunction,exports.getRequestExtent=getRequestExtent;var _Event2=_interopRequireDefault(require("../events/Event.js")),_EventType=_interopRequireDefault(require("../events/EventType.js")),_ImageState=_interopRequireDefault(require("../ImageState.js")),_Image=_interopRequireDefault(require("../Image.js")),_Image2=_interopRequireDefault(require("../reproj/Image.js")),_Source2=_interopRequireDefault(require("./Source.js")),_common=require("./common.js"),_math=require("../math.js"),_extent=require("../extent.js"),_proj=require("../proj.js"),_resolution=require("../resolution.js"),_array=require("../array.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var ImageSourceEventType=exports.ImageSourceEventType={IMAGELOADSTART:"imageloadstart",IMAGELOADEND:"imageloadend",IMAGELOADERROR:"imageloaderror"},ImageSourceEvent=exports.ImageSourceEvent=function(e){function t(e,r){var o;return _classCallCheck(this,t),(o=_callSuper(this,t,[e])).image=r,o}return _inherits(t,_Event2["default"]),_createClass(t)}(),ImageSource=function(e){function t(e){var r;return _classCallCheck(this,t),(r=_callSuper(this,t,[{attributions:e.attributions,projection:e.projection,state:e.state,interpolate:void 0===e.interpolate||e.interpolate}])).on,r.once,r.un,r.loader=e.loader||null,r.resolutions_=void 0!==e.resolutions?e.resolutions:null,r.reprojectedImage_=null,r.reprojectedRevision_=0,r.image=null,r.wantedExtent_,r.wantedResolution_,r.static_=!!e.loader&&0===e.loader.length,r.wantedProjection_=null,r}return _inherits(t,_Source2["default"]),_createClass(t,[{key:"getResolutions",value:function(){return this.resolutions_}},{key:"setResolutions",value:function(e){this.resolutions_=e}},{key:"findNearestResolution",value:function(e){var t=this.getResolutions();t&&(e=t[(0,_array.linearFindNearest)(t,e,0)]);return e}},{key:"getImage",value:function(e,t,r,o){var n=this,i=this.getProjection();if(!i||!o||(0,_proj.equivalent)(i,o))return i&&(o=i),this.getImageInternal(e,t,r,o);if(this.reprojectedImage_){if(this.reprojectedRevision_==this.getRevision()&&(0,_proj.equivalent)(this.reprojectedImage_.getProjection(),o)&&this.reprojectedImage_.getResolution()==t&&(0,_extent.equals)(this.reprojectedImage_.getExtent(),e))return this.reprojectedImage_;this.reprojectedImage_.dispose(),this.reprojectedImage_=null}return this.reprojectedImage_=new _Image2.default(i,o,e,t,r,function(e,t,r){return n.getImageInternal(e,t,r,i)},this.getInterpolate()),this.reprojectedRevision_=this.getRevision(),this.reprojectedImage_}},{key:"getImageInternal",value:function(e,t,r,o){if(this.loader){var n=getRequestExtent(e,t,r,1),i=this.findNearestResolution(t);if(this.image&&(this.static_||this.wantedProjection_===o&&(this.wantedExtent_&&(0,_extent.containsExtent)(this.wantedExtent_,n)||(0,_extent.containsExtent)(this.image.getExtent(),n))&&(this.wantedResolution_&&(0,_resolution.fromResolutionLike)(this.wantedResolution_)===i||(0,_resolution.fromResolutionLike)(this.image.getResolution())===i)))return this.image;this.wantedProjection_=o,this.wantedExtent_=n,this.wantedResolution_=i,this.image=new _Image.default(n,i,r,this.loader),this.image.addEventListener(_EventType.default.CHANGE,this.handleImageChange.bind(this))}return this.image}},{key:"handleImageChange",value:function(e){var t,r=e.target;switch(r.getState()){case _ImageState.default.LOADING:this.loading=!0,t=ImageSourceEventType.IMAGELOADSTART;break;case _ImageState.default.LOADED:this.loading=!1,t=ImageSourceEventType.IMAGELOADEND;break;case _ImageState.default.ERROR:this.loading=!1,t=ImageSourceEventType.IMAGELOADERROR;break;default:return}this.hasListener(t)&&this.dispatchEvent(new ImageSourceEvent(t,r))}}])}();function defaultImageLoadFunction(e,t){e.getImage().src=t}function getRequestExtent(e,t,r,o){var n=t/r,i=(0,_extent.getCenter)(e),a=(0,_math.ceil)((0,_extent.getWidth)(e)/n,_common.DECIMALS),u=(0,_math.ceil)((0,_extent.getHeight)(e)/n,_common.DECIMALS),s=a+2*(0,_math.ceil)((o-1)*a/2,_common.DECIMALS),l=u+2*(0,_math.ceil)((o-1)*u/2,_common.DECIMALS);return(0,_extent.getForViewAndSize)(i,n,0,[s,l])}var _default=exports.default=ImageSource;

},{"../Image.js":14,"../ImageState.js":15,"../array.js":36,"../events/Event.js":52,"../events/EventType.js":53,"../extent.js":59,"../math.js":120,"../proj.js":123,"../reproj/Image.js":160,"../resolution.js":164,"./Source.js":171,"./common.js":179}],169:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _EventType=_interopRequireDefault(require("../events/EventType.js")),_Image=_interopRequireWildcard(require("./Image.js")),_Image2=_interopRequireWildcard(require("../Image.js")),_static=require("./static.js"),_proj=require("../proj.js"),_extent=require("../extent.js");function _getRequireWildcardCache(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(_getRequireWildcardCache=function(e){return e?r:t})(e)}function _interopRequireWildcard(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=_typeof(e)&&"function"!=typeof e)return{default:e};var r=_getRequireWildcardCache(t);if(r&&r.has(e))return r.get(e);var n={__proto__:null},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&{}.hasOwnProperty.call(e,i)){var u=o?Object.getOwnPropertyDescriptor(e,i):null;u&&(u.get||u.set)?Object.defineProperty(n,i,u):n[i]=e[i]}return n.default=e,r&&r.set(e,n),n}function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey(n.key),n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var Static=function(e){function t(e){var r;_classCallCheck(this,t);var n=void 0!==e.crossOrigin?e.crossOrigin:null,o=void 0!==e.imageLoadFunction?e.imageLoadFunction:_Image.defaultImageLoadFunction;return(r=_callSuper(this,t,[{attributions:e.attributions,interpolate:e.interpolate,projection:(0,_proj.get)(e.projection)}])).url_=e.url,r.imageExtent_=e.imageExtent,r.image=null,r.image=new _Image2.default(r.imageExtent_,void 0,1,(0,_static.createLoader)({url:e.url,imageExtent:e.imageExtent,crossOrigin:n,load:function(e,t){return r.image.setImage(e),o(r.image,t),(0,_Image2.decode)(e)}})),r.image.addEventListener(_EventType.default.CHANGE,r.handleImageChange.bind(r)),r}return _inherits(t,_Image["default"]),_createClass(t,[{key:"getImageExtent",value:function(){return this.imageExtent_}},{key:"getImageInternal",value:function(e,t,r,n){return(0,_extent.intersects)(e,this.image.getExtent())?this.image:null}},{key:"getUrl",value:function(){return this.url_}}])}(),_default=exports.default=Static;

},{"../Image.js":14,"../events/EventType.js":53,"../extent.js":59,"../proj.js":123,"./Image.js":168,"./static.js":180}],170:[function(require,module,exports){
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=exports.ATTRIBUTION=void 0;var _XYZ2=_interopRequireDefault(require("./XYZ.js"));function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,_toPropertyKey(o.key),o)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var o=r.call(t,e||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _callSuper(t,e,r){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,r||[],_getPrototypeOf(t).constructor):e.apply(t,r))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var ATTRIBUTION=exports.ATTRIBUTION='&#169; <a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a> contributors.',OSM=function(t){function e(t){var r;_classCallCheck(this,e),r=void 0!==(t=t||{}).attributions?t.attributions:[ATTRIBUTION];var o=void 0!==t.crossOrigin?t.crossOrigin:"anonymous",n=void 0!==t.url?t.url:"https://tile.openstreetmap.org/{z}/{x}/{y}.png";return _callSuper(this,e,[{attributions:r,attributionsCollapsible:!1,cacheSize:t.cacheSize,crossOrigin:o,interpolate:t.interpolate,maxZoom:void 0!==t.maxZoom?t.maxZoom:19,reprojectionErrorThreshold:t.reprojectionErrorThreshold,tileLoadFunction:t.tileLoadFunction,transition:t.transition,url:n,wrapX:t.wrapX,zDirection:t.zDirection}])}return _inherits(e,_XYZ2["default"]),_createClass(e)}(),_default=exports.default=OSM;

},{"./XYZ.js":178}],171:[function(require,module,exports){
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _Object=_interopRequireDefault(require("../Object.js")),_proj=require("../proj.js");function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,_toPropertyKey(o.key),o)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var o=r.call(t,e||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _callSuper(t,e,r){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,r||[],_getPrototypeOf(t).constructor):e.apply(t,r))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var Source=function(t){function e(t){var r,o;_classCallCheck(this,e),(o=_callSuper(this,e)).projection=(0,_proj.get)(t.projection),o.attributions_=adaptAttributions(t.attributions),o.attributionsCollapsible_=null===(r=t.attributionsCollapsible)||void 0===r||r,o.loading=!1,o.state_=void 0!==t.state?t.state:"ready",o.wrapX_=void 0!==t.wrapX&&t.wrapX,o.interpolate_=!!t.interpolate,o.viewResolver=null,o.viewRejector=null;var n=o;return o.viewPromise_=new Promise(function(t,e){n.viewResolver=t,n.viewRejector=e}),o}return _inherits(e,_Object["default"]),_createClass(e,[{key:"getAttributions",value:function(){return this.attributions_}},{key:"getAttributionsCollapsible",value:function(){return this.attributionsCollapsible_}},{key:"getProjection",value:function(){return this.projection}},{key:"getResolutions",value:function(t){return null}},{key:"getView",value:function(){return this.viewPromise_}},{key:"getState",value:function(){return this.state_}},{key:"getWrapX",value:function(){return this.wrapX_}},{key:"getInterpolate",value:function(){return this.interpolate_}},{key:"refresh",value:function(){this.changed()}},{key:"setAttributions",value:function(t){this.attributions_=adaptAttributions(t),this.changed()}},{key:"setState",value:function(t){this.state_=t,this.changed()}}])}();function adaptAttributions(t){return t?"function"==typeof t?t:(Array.isArray(t)||(t=[t]),function(e){return t}):null}var _default=exports.default=Source;

},{"../Object.js":25,"../proj.js":123}],172:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=exports.TileSourceEvent=void 0;var _Event2=_interopRequireDefault(require("../events/Event.js")),_Source2=_interopRequireDefault(require("./Source.js")),_TileCache=_interopRequireDefault(require("../TileCache.js")),_util=require("../util.js"),_asserts=require("../asserts.js"),_proj=require("../proj.js"),_tilegrid=require("../tilegrid.js"),_size=require("../size.js"),_tilecoord=require("../tilecoord.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,_toPropertyKey(i.key),i)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _superPropGet(e,t,r,i){var o=_get(_getPrototypeOf(1&i?e.prototype:e),t,r);return 2&i?function(e){return o.apply(r,e)}:o}function _get(){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var i=_superPropBase(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}}).apply(null,arguments)}function _superPropBase(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf(e)););return e}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var TileSource=function(e){function t(e){var r;_classCallCheck(this,t),(r=_callSuper(this,t,[{attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,projection:e.projection,state:e.state,wrapX:e.wrapX,interpolate:e.interpolate}])).on,r.once,r.un,r.tilePixelRatio_=void 0!==e.tilePixelRatio?e.tilePixelRatio:1,r.tileGrid=void 0!==e.tileGrid?e.tileGrid:null;return r.tileGrid&&(0,_size.toSize)(r.tileGrid.getTileSize(r.tileGrid.getMinZoom()),[256,256]),r.tileCache=new _TileCache.default(e.cacheSize||0),r.tmpSize=[0,0],r.key_=e.key||"",r.tileOptions={transition:e.transition,interpolate:e.interpolate},r.zDirection=e.zDirection?e.zDirection:0,r}return _inherits(t,_Source2["default"]),_createClass(t,[{key:"canExpireCache",value:function(){return this.tileCache.canExpireCache()}},{key:"expireCache",value:function(e,t){var r=this.getTileCacheForProjection(e);r&&r.expireCache(t)}},{key:"getGutterForProjection",value:function(e){return 0}},{key:"getKey",value:function(){return this.key_}},{key:"setKey",value:function(e){this.key_!==e&&(this.key_=e,this.changed())}},{key:"getResolutions",value:function(e){var t=e?this.getTileGridForProjection(e):this.tileGrid;return t?t.getResolutions():null}},{key:"getTile",value:function(e,t,r,i,o){return(0,_util.abstract)()}},{key:"getTileGrid",value:function(){return this.tileGrid}},{key:"getTileGridForProjection",value:function(e){return this.tileGrid?this.tileGrid:(0,_tilegrid.getForProjection)(e)}},{key:"getTileCacheForProjection",value:function(e){var t=this.getProjection();return(0,_asserts.assert)(null===t||(0,_proj.equivalent)(t,e),"A VectorTile source can only be rendered if it has a projection compatible with the view projection."),this.tileCache}},{key:"getTilePixelRatio",value:function(e){return this.tilePixelRatio_}},{key:"getTilePixelSize",value:function(e,t,r){var i=this.getTileGridForProjection(r),o=this.getTilePixelRatio(t),n=(0,_size.toSize)(i.getTileSize(e),this.tmpSize);return 1==o?n:(0,_size.scale)(n,o,this.tmpSize)}},{key:"getTileCoordForTileUrlFunction",value:function(e,t){t=void 0!==t?t:this.getProjection();var r=this.getTileGridForProjection(t);return this.getWrapX()&&t.isGlobal()&&(e=(0,_tilegrid.wrapX)(r,e,t)),(0,_tilecoord.withinExtentAndZ)(e,r)?e:null}},{key:"clear",value:function(){this.tileCache.clear()}},{key:"refresh",value:function(){this.clear(),_superPropGet(t,"refresh",this,3)([])}},{key:"useTile",value:function(e,t,r,i){}}])}(),TileSourceEvent=exports.TileSourceEvent=function(e){function t(e,r){var i;return _classCallCheck(this,t),(i=_callSuper(this,t,[e])).tile=r,i}return _inherits(t,_Event2["default"]),_createClass(t)}(),_default=exports.default=TileSource;

},{"../TileCache.js":29,"../asserts.js":37,"../events/Event.js":52,"../proj.js":123,"../size.js":167,"../tilecoord.js":197,"../tilegrid.js":198,"../util.js":205,"./Source.js":171}],173:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _default=exports.default={TILELOADSTART:"tileloadstart",TILELOADEND:"tileloadend",TILELOADERROR:"tileloaderror"};

},{}],174:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _EventType=_interopRequireDefault(require("../events/EventType.js")),_ImageTile=_interopRequireDefault(require("../ImageTile.js")),_Tile=_interopRequireDefault(require("../reproj/Tile.js")),_TileCache=_interopRequireDefault(require("../TileCache.js")),_TileState=_interopRequireDefault(require("../TileState.js")),_UrlTile2=_interopRequireDefault(require("./UrlTile.js")),_proj=require("../proj.js"),_tilecoord=require("../tilecoord.js"),_tilegrid=require("../tilegrid.js"),_util=require("../util.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,_toPropertyKey(i.key),i)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _superPropGet(e,t,r,i){var o=_get(_getPrototypeOf(1&i?e.prototype:e),t,r);return 2&i?function(e){return o.apply(r,e)}:o}function _get(){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var i=_superPropBase(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}}).apply(null,arguments)}function _superPropBase(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf(e)););return e}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var TileImage=function(e){function t(e){var r;return _classCallCheck(this,t),(r=_callSuper(this,t,[{attributions:e.attributions,cacheSize:e.cacheSize,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tileLoadFunction:e.tileLoadFunction?e.tileLoadFunction:defaultTileLoadFunction,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX,transition:e.transition,interpolate:void 0===e.interpolate||e.interpolate,key:e.key,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}])).crossOrigin=void 0!==e.crossOrigin?e.crossOrigin:null,r.tileClass=void 0!==e.tileClass?e.tileClass:_ImageTile.default,r.tileCacheForProjection={},r.tileGridForProjection={},r.reprojectionErrorThreshold_=e.reprojectionErrorThreshold,r.renderReprojectionEdges_=!1,r}return _inherits(t,_UrlTile2["default"]),_createClass(t,[{key:"canExpireCache",value:function(){if(this.tileCache.canExpireCache())return!0;for(var e in this.tileCacheForProjection)if(this.tileCacheForProjection[e].canExpireCache())return!0;return!1}},{key:"expireCache",value:function(e,t){var r=this.getTileCacheForProjection(e);for(var i in this.tileCache.expireCache(this.tileCache==r?t:{}),this.tileCacheForProjection){var o=this.tileCacheForProjection[i];o.expireCache(o==r?t:{})}}},{key:"getGutterForProjection",value:function(e){return this.getProjection()&&e&&!(0,_proj.equivalent)(this.getProjection(),e)?0:this.getGutter()}},{key:"getGutter",value:function(){return 0}},{key:"getKey",value:function(){var e=_superPropGet(t,"getKey",this,3)([]);return this.getInterpolate()||(e+=":disable-interpolation"),e}},{key:"getTileGridForProjection",value:function(e){var t=this.getProjection();if(this.tileGrid&&(!t||(0,_proj.equivalent)(t,e)))return this.tileGrid;var r=(0,_util.getUid)(e);return r in this.tileGridForProjection||(this.tileGridForProjection[r]=(0,_tilegrid.getForProjection)(e)),this.tileGridForProjection[r]}},{key:"getTileCacheForProjection",value:function(e){var t=this.getProjection();if(!t||(0,_proj.equivalent)(t,e))return this.tileCache;var r=(0,_util.getUid)(e);return r in this.tileCacheForProjection||(this.tileCacheForProjection[r]=new _TileCache.default(this.tileCache.highWaterMark)),this.tileCacheForProjection[r]}},{key:"createTile_",value:function(e,t,r,i,o,n){var l=[e,t,r],a=this.getTileCoordForTileUrlFunction(l,o),c=a?this.tileUrlFunction(a,i,o):void 0,u=new this.tileClass(l,void 0!==c?_TileState.default.IDLE:_TileState.default.EMPTY,void 0!==c?c:"",this.crossOrigin,this.tileLoadFunction,this.tileOptions);return u.key=n,u.addEventListener(_EventType.default.CHANGE,this.handleTileChange.bind(this)),u}},{key:"getTile",value:function(e,t,r,i,o){var n=this,l=this.getProjection();if(!l||!o||(0,_proj.equivalent)(l,o))return this.getTileInternal(e,t,r,i,l||o);var a,c=this.getTileCacheForProjection(o),u=[e,t,r],s=(0,_tilecoord.getKey)(u);c.containsKey(s)&&(a=c.get(s));var f=this.getKey();if(a&&a.key==f)return a;var p=this.getTileGridForProjection(l),h=this.getTileGridForProjection(o),_=this.getTileCoordForTileUrlFunction(u,o),d=new _Tile.default(l,p,o,h,u,_,this.getTilePixelRatio(i),this.getGutter(),function(e,t,r,i){return n.getTileInternal(e,t,r,i,l)},this.reprojectionErrorThreshold_,this.renderReprojectionEdges_,this.tileOptions);return d.key=f,a?c.replace(s,d):c.set(s,d),d}},{key:"getTileInternal",value:function(e,t,r,i,o){var n=(0,_tilecoord.getKeyZXY)(e,t,r),l=this.getKey();if(!this.tileCache.containsKey(n)){var a=this.createTile_(e,t,r,i,o,l);return this.tileCache.set(n,a),a}var c=this.tileCache.get(n);return c.key!=l&&(c=this.createTile_(e,t,r,i,o,l),this.tileCache.replace(n,c)),c}},{key:"setRenderReprojectionEdges",value:function(e){if(this.renderReprojectionEdges_!=e){for(var t in this.renderReprojectionEdges_=e,this.tileCacheForProjection)this.tileCacheForProjection[t].clear();this.changed()}}},{key:"setTileGridForProjection",value:function(e,t){var r=(0,_proj.get)(e);if(r){var i=(0,_util.getUid)(r);i in this.tileGridForProjection||(this.tileGridForProjection[i]=t)}}},{key:"clear",value:function(){for(var e in _superPropGet(t,"clear",this,3)([]),this.tileCacheForProjection)this.tileCacheForProjection[e].clear()}}])}();function defaultTileLoadFunction(e,t){e.getImage().src=t}var _default=exports.default=TileImage;

},{"../ImageTile.js":16,"../TileCache.js":29,"../TileState.js":32,"../events/EventType.js":53,"../proj.js":123,"../reproj/Tile.js":161,"../tilecoord.js":197,"../tilegrid.js":198,"../util.js":205,"./UrlTile.js":175}],175:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _TileEventType=_interopRequireDefault(require("./TileEventType.js")),_Tile=_interopRequireWildcard(require("./Tile.js")),_TileState=_interopRequireDefault(require("../TileState.js")),_tileurlfunction=require("../tileurlfunction.js"),_uri=require("../uri.js"),_tilecoord=require("../tilecoord.js"),_util=require("../util.js");function _getRequireWildcardCache(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,i=new WeakMap;return(_getRequireWildcardCache=function(e){return e?i:t})(e)}function _interopRequireWildcard(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=_typeof(e)&&"function"!=typeof e)return{default:e};var i=_getRequireWildcardCache(t);if(i&&i.has(e))return i.get(e);var r={__proto__:null},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&{}.hasOwnProperty.call(e,o)){var l=n?Object.getOwnPropertyDescriptor(e,o):null;l&&(l.get||l.set)?Object.defineProperty(r,o,l):r[o]=e[o]}return r.default=e,i&&i.set(e,r),r}function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,_toPropertyKey(r.key),r)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=_typeof(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,i){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,i||[],_getPrototypeOf(e).constructor):t.apply(e,i))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var UrlTile=function(e){function t(e){var i;return _classCallCheck(this,t),(i=_callSuper(this,t,[{attributions:e.attributions,cacheSize:e.cacheSize,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tilePixelRatio:e.tilePixelRatio,wrapX:e.wrapX,transition:e.transition,interpolate:e.interpolate,key:e.key,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}])).generateTileUrlFunction_=i.tileUrlFunction===t.prototype.tileUrlFunction,i.tileLoadFunction=e.tileLoadFunction,e.tileUrlFunction&&(i.tileUrlFunction=e.tileUrlFunction),i.urls=null,e.urls?i.setUrls(e.urls):e.url&&i.setUrl(e.url),i.tileLoadingKeys_={},i}return _inherits(t,_Tile["default"]),_createClass(t,[{key:"getTileLoadFunction",value:function(){return this.tileLoadFunction}},{key:"getTileUrlFunction",value:function(){return Object.getPrototypeOf(this).tileUrlFunction===this.tileUrlFunction?this.tileUrlFunction.bind(this):this.tileUrlFunction}},{key:"getUrls",value:function(){return this.urls}},{key:"handleTileChange",value:function(e){var t,i=e.target,r=(0,_util.getUid)(i),n=i.getState();n==_TileState.default.LOADING?(this.tileLoadingKeys_[r]=!0,t=_TileEventType.default.TILELOADSTART):r in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[r],t=n==_TileState.default.ERROR?_TileEventType.default.TILELOADERROR:n==_TileState.default.LOADED?_TileEventType.default.TILELOADEND:void 0),null!=t&&this.dispatchEvent(new _Tile.TileSourceEvent(t,i))}},{key:"setTileLoadFunction",value:function(e){this.tileCache.clear(),this.tileLoadFunction=e,this.changed()}},{key:"setTileUrlFunction",value:function(e,t){this.tileUrlFunction=e,this.tileCache.pruneExceptNewestZ(),void 0!==t?this.setKey(t):this.changed()}},{key:"setUrl",value:function(e){var t=(0,_uri.expandUrl)(e);this.urls=t,this.setUrls(t)}},{key:"setUrls",value:function(e){this.urls=e;var t=e.join("\n");this.generateTileUrlFunction_?this.setTileUrlFunction((0,_tileurlfunction.createFromTemplates)(e,this.tileGrid),t):this.setKey(t)}},{key:"tileUrlFunction",value:function(e,t,i){}},{key:"useTile",value:function(e,t,i){var r=(0,_tilecoord.getKeyZXY)(e,t,i);this.tileCache.containsKey(r)&&this.tileCache.get(r)}}])}(),_default=exports.default=UrlTile;

},{"../TileState.js":32,"../tilecoord.js":197,"../tileurlfunction.js":202,"../uri.js":204,"../util.js":205,"./Tile.js":172,"./TileEventType.js":173}],176:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=exports.VectorSourceEvent=void 0;var _Collection=_interopRequireDefault(require("../Collection.js")),_CollectionEventType=_interopRequireDefault(require("../CollectionEventType.js")),_Event2=_interopRequireDefault(require("../events/Event.js")),_EventType=_interopRequireDefault(require("../events/EventType.js")),_ObjectEventType=_interopRequireDefault(require("../ObjectEventType.js")),_RBush=_interopRequireDefault(require("../structs/RBush.js")),_Feature=_interopRequireDefault(require("../render/Feature.js")),_Source2=_interopRequireDefault(require("./Source.js")),_VectorEventType=_interopRequireDefault(require("./VectorEventType.js")),_functions=require("../functions.js"),_loadingstrategy=require("../loadingstrategy.js"),_asserts=require("../asserts.js"),_extent=require("../extent.js"),_array=require("../array.js"),_util=require("../util.js"),_obj=require("../obj.js"),_events=require("../events.js"),_featureloader=require("../featureloader.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(e,t):void 0}}function _iterableToArray(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function _superPropGet(e,t,r,n){var i=_get(_getPrototypeOf(1&n?e.prototype:e),t,r);return 2&n?function(e){return i.apply(r,e)}:i}function _get(){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=_superPropBase(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(arguments.length<3?e:r):i.value}}).apply(null,arguments)}function _superPropBase(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf(e)););return e}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey(n.key),n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var VectorSourceEvent=exports.VectorSourceEvent=function(e){function t(e,r,n){var i;return _classCallCheck(this,t),(i=_callSuper(this,t,[e])).feature=r,i.features=n,i}return _inherits(t,_Event2["default"]),_createClass(t)}(),VectorSource=function(e){function t(e){var r;_classCallCheck(this,t),(r=_callSuper(this,t,[{attributions:(e=e||{}).attributions,interpolate:!0,projection:void 0,state:"ready",wrapX:void 0===e.wrapX||e.wrapX}])).on,r.once,r.un,r.loader_=_functions.VOID,r.format_=e.format||null,r.overlaps_=void 0===e.overlaps||e.overlaps,r.url_=e.url,void 0!==e.loader?r.loader_=e.loader:void 0!==r.url_&&((0,_asserts.assert)(r.format_,"`format` must be set when `url` is set"),r.loader_=(0,_featureloader.xhr)(r.url_,r.format_)),r.strategy_=void 0!==e.strategy?e.strategy:_loadingstrategy.all;var n,i,a=void 0===e.useSpatialIndex||e.useSpatialIndex;return r.featuresRtree_=a?new _RBush.default:null,r.loadedExtentsRtree_=new _RBush.default,r.loadingExtentsCount_=0,r.nullGeometryFeatures_={},r.idIndex_={},r.uidIndex_={},r.featureChangeKeys_={},r.featuresCollection_=null,Array.isArray(e.features)?i=e.features:e.features&&(i=(n=e.features).getArray()),a||void 0!==n||(n=new _Collection.default(i)),void 0!==i&&r.addFeaturesInternal(i),void 0!==n&&r.bindFeaturesCollection_(n),r}return _inherits(t,_Source2["default"]),_createClass(t,[{key:"addFeature",value:function(e){this.addFeatureInternal(e),this.changed()}},{key:"addFeatureInternal",value:function(e){var t=(0,_util.getUid)(e);if(this.addToIndex_(t,e)){this.setupChangeEvents_(t,e);var r=e.getGeometry();if(r){var n=r.getExtent();this.featuresRtree_&&this.featuresRtree_.insert(n,e)}else this.nullGeometryFeatures_[t]=e;this.dispatchEvent(new VectorSourceEvent(_VectorEventType.default.ADDFEATURE,e))}else this.featuresCollection_&&this.featuresCollection_.remove(e)}},{key:"setupChangeEvents_",value:function(e,t){t instanceof _Feature.default||(this.featureChangeKeys_[e]=[(0,_events.listen)(t,_EventType.default.CHANGE,this.handleFeatureChange_,this),(0,_events.listen)(t,_ObjectEventType.default.PROPERTYCHANGE,this.handleFeatureChange_,this)])}},{key:"addToIndex_",value:function(e,t){var r=!0;if(void 0!==t.getId()){var n=String(t.getId());if(n in this.idIndex_)if(t instanceof _Feature.default){var i=this.idIndex_[n];i instanceof _Feature.default?Array.isArray(i)?i.push(t):this.idIndex_[n]=[i,t]:r=!1}else r=!1;else this.idIndex_[n]=t}return r&&((0,_asserts.assert)(!(e in this.uidIndex_),"The passed `feature` was already added to the source"),this.uidIndex_[e]=t),r}},{key:"addFeatures",value:function(e){this.addFeaturesInternal(e),this.changed()}},{key:"addFeaturesInternal",value:function(e){for(var t=[],r=[],n=[],i=0,a=e.length;i<a;i++){var o=e[i],u=(0,_util.getUid)(o);this.addToIndex_(u,o)&&r.push(o)}for(var s=0,l=r.length;s<l;s++){var f=r[s],c=(0,_util.getUid)(f);this.setupChangeEvents_(c,f);var _=f.getGeometry();if(_){var d=_.getExtent();t.push(d),n.push(f)}else this.nullGeometryFeatures_[c]=f}if(this.featuresRtree_&&this.featuresRtree_.load(t,n),this.hasListener(_VectorEventType.default.ADDFEATURE))for(var h=0,v=r.length;h<v;h++)this.dispatchEvent(new VectorSourceEvent(_VectorEventType.default.ADDFEATURE,r[h]))}},{key:"bindFeaturesCollection_",value:function(e){var t=this,r=!1;this.addEventListener(_VectorEventType.default.ADDFEATURE,function(t){r||(r=!0,e.push(t.feature),r=!1)}),this.addEventListener(_VectorEventType.default.REMOVEFEATURE,function(t){r||(r=!0,e.remove(t.feature),r=!1)}),e.addEventListener(_CollectionEventType.default.ADD,function(e){r||(r=!0,t.addFeature(e.element),r=!1)}),e.addEventListener(_CollectionEventType.default.REMOVE,function(e){r||(r=!0,t.removeFeature(e.element),r=!1)}),this.featuresCollection_=e}},{key:"clear",value:function(e){var t=this;if(e){for(var r in this.featureChangeKeys_){this.featureChangeKeys_[r].forEach(_events.unlistenByKey)}this.featuresCollection_||(this.featureChangeKeys_={},this.idIndex_={},this.uidIndex_={})}else if(this.featuresRtree_){for(var n in this.featuresRtree_.forEach(function(e){t.removeFeatureInternal(e)}),this.nullGeometryFeatures_)this.removeFeatureInternal(this.nullGeometryFeatures_[n])}this.featuresCollection_&&this.featuresCollection_.clear(),this.featuresRtree_&&this.featuresRtree_.clear(),this.nullGeometryFeatures_={};var i=new VectorSourceEvent(_VectorEventType.default.CLEAR);this.dispatchEvent(i),this.changed()}},{key:"forEachFeature",value:function(e){if(this.featuresRtree_)return this.featuresRtree_.forEach(e);this.featuresCollection_&&this.featuresCollection_.forEach(e)}},{key:"forEachFeatureAtCoordinateDirect",value:function(e,t){var r=[e[0],e[1],e[0],e[1]];return this.forEachFeatureInExtent(r,function(r){var n=r.getGeometry();if(n instanceof _Feature.default||n.intersectsCoordinate(e))return t(r)})}},{key:"forEachFeatureInExtent",value:function(e,t){if(this.featuresRtree_)return this.featuresRtree_.forEachInExtent(e,t);this.featuresCollection_&&this.featuresCollection_.forEach(t)}},{key:"forEachFeatureIntersectingExtent",value:function(e,t){return this.forEachFeatureInExtent(e,function(r){var n=r.getGeometry();if(n instanceof _Feature.default||n.intersectsExtent(e)){var i=t(r);if(i)return i}})}},{key:"getFeaturesCollection",value:function(){return this.featuresCollection_}},{key:"getFeatures",value:function(){var e;return this.featuresCollection_?e=this.featuresCollection_.getArray().slice(0):this.featuresRtree_&&(e=this.featuresRtree_.getAll(),(0,_obj.isEmpty)(this.nullGeometryFeatures_)||(0,_array.extend)(e,Object.values(this.nullGeometryFeatures_))),e}},{key:"getFeaturesAtCoordinate",value:function(e){var t=[];return this.forEachFeatureAtCoordinateDirect(e,function(e){t.push(e)}),t}},{key:"getFeaturesInExtent",value:function(e,t){var r=this;if(this.featuresRtree_){var n;if(!(t&&t.canWrapX()&&this.getWrapX()))return this.featuresRtree_.getInExtent(e);var i=(0,_extent.wrapAndSliceX)(e,t);return(n=[]).concat.apply(n,_toConsumableArray(i.map(function(e){return r.featuresRtree_.getInExtent(e)})))}return this.featuresCollection_?this.featuresCollection_.getArray().slice(0):[]}},{key:"getClosestFeatureToCoordinate",value:function(e,t){var r=e[0],n=e[1],i=null,a=[NaN,NaN],o=1/0,u=[-1/0,-1/0,1/0,1/0];return t=t||_functions.TRUE,this.featuresRtree_.forEachInExtent(u,function(e){if(t(e)){var s=e.getGeometry(),l=o;if((o=s instanceof _Feature.default?0:s.closestPointXY(r,n,a,o))<l){i=e;var f=Math.sqrt(o);u[0]=r-f,u[1]=n-f,u[2]=r+f,u[3]=n+f}}}),i}},{key:"getExtent",value:function(e){return this.featuresRtree_.getExtent(e)}},{key:"getFeatureById",value:function(e){var t=this.idIndex_[e.toString()];return void 0!==t?t:null}},{key:"getFeatureByUid",value:function(e){var t=this.uidIndex_[e];return void 0!==t?t:null}},{key:"getFormat",value:function(){return this.format_}},{key:"getOverlaps",value:function(){return this.overlaps_}},{key:"getUrl",value:function(){return this.url_}},{key:"handleFeatureChange_",value:function(e){var t=e.target,r=(0,_util.getUid)(t),n=t.getGeometry();if(n){var i=n.getExtent();r in this.nullGeometryFeatures_?(delete this.nullGeometryFeatures_[r],this.featuresRtree_&&this.featuresRtree_.insert(i,t)):this.featuresRtree_&&this.featuresRtree_.update(i,t)}else r in this.nullGeometryFeatures_||(this.featuresRtree_&&this.featuresRtree_.remove(t),this.nullGeometryFeatures_[r]=t);var a=t.getId();if(void 0!==a){var o=a.toString();this.idIndex_[o]!==t&&(this.removeFromIdIndex_(t),this.idIndex_[o]=t)}else this.removeFromIdIndex_(t),this.uidIndex_[r]=t;this.changed(),this.dispatchEvent(new VectorSourceEvent(_VectorEventType.default.CHANGEFEATURE,t))}},{key:"hasFeature",value:function(e){var t=e.getId();return void 0!==t?t in this.idIndex_:(0,_util.getUid)(e)in this.uidIndex_}},{key:"isEmpty",value:function(){return this.featuresRtree_?this.featuresRtree_.isEmpty()&&(0,_obj.isEmpty)(this.nullGeometryFeatures_):!this.featuresCollection_||0===this.featuresCollection_.getLength()}},{key:"loadFeatures",value:function(e,t,r){for(var n=this,i=this.loadedExtentsRtree_,a=this.strategy_(e,t,r),o=function(){var e=a[u];i.forEachInExtent(e,function(t){return(0,_extent.containsExtent)(t.extent,e)})||(++n.loadingExtentsCount_,n.dispatchEvent(new VectorSourceEvent(_VectorEventType.default.FEATURESLOADSTART)),n.loader_.call(n,e,t,r,function(e){--n.loadingExtentsCount_,n.dispatchEvent(new VectorSourceEvent(_VectorEventType.default.FEATURESLOADEND,void 0,e))},function(){--n.loadingExtentsCount_,n.dispatchEvent(new VectorSourceEvent(_VectorEventType.default.FEATURESLOADERROR))}),i.insert(e,{extent:e.slice()}))},u=0,s=a.length;u<s;++u)o();this.loading=!(this.loader_.length<4)&&this.loadingExtentsCount_>0}},{key:"refresh",value:function(){this.clear(!0),this.loadedExtentsRtree_.clear(),_superPropGet(t,"refresh",this,3)([])}},{key:"removeLoadedExtent",value:function(e){var t,r=this.loadedExtentsRtree_;r.forEachInExtent(e,function(r){if((0,_extent.equals)(r.extent,e))return t=r,!0}),t&&r.remove(t)}},{key:"removeFeatures",value:function(e){for(var t=!1,r=0,n=e.length;r<n;++r)t=this.removeFeatureInternal(e[r])||t;t&&this.changed()}},{key:"removeFeature",value:function(e){e&&(this.removeFeatureInternal(e)&&this.changed())}},{key:"removeFeatureInternal",value:function(e){var t=(0,_util.getUid)(e);if(!(t in this.uidIndex_))return!1;t in this.nullGeometryFeatures_?delete this.nullGeometryFeatures_[t]:this.featuresRtree_&&this.featuresRtree_.remove(e);var r=this.featureChangeKeys_[t];null==r||r.forEach(_events.unlistenByKey),delete this.featureChangeKeys_[t];var n=e.getId();if(void 0!==n){var i=n.toString(),a=this.idIndex_[i];a===e?delete this.idIndex_[i]:Array.isArray(a)&&(a.splice(a.indexOf(e),1),1===a.length&&(this.idIndex_[i]=a[0]))}return delete this.uidIndex_[t],this.hasListener(_VectorEventType.default.REMOVEFEATURE)&&this.dispatchEvent(new VectorSourceEvent(_VectorEventType.default.REMOVEFEATURE,e)),!0}},{key:"removeFromIdIndex_",value:function(e){for(var t in this.idIndex_)if(this.idIndex_[t]===e){delete this.idIndex_[t];break}}},{key:"setLoader",value:function(e){this.loader_=e}},{key:"setUrl",value:function(e){(0,_asserts.assert)(this.format_,"`format` must be set when `url` is set"),this.url_=e,this.setLoader((0,_featureloader.xhr)(e,this.format_))}}])}(),_default=exports.default=VectorSource;

},{"../Collection.js":9,"../CollectionEventType.js":10,"../ObjectEventType.js":26,"../array.js":36,"../asserts.js":37,"../events.js":51,"../events/Event.js":52,"../events/EventType.js":53,"../extent.js":59,"../featureloader.js":61,"../functions.js":62,"../loadingstrategy.js":119,"../obj.js":121,"../render/Feature.js":134,"../structs/RBush.js":185,"../util.js":205,"./Source.js":171,"./VectorEventType.js":177}],177:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _default=exports.default={ADDFEATURE:"addfeature",CHANGEFEATURE:"changefeature",CLEAR:"clear",REMOVEFEATURE:"removefeature",FEATURESLOADSTART:"featuresloadstart",FEATURESLOADEND:"featuresloadend",FEATURESLOADERROR:"featuresloaderror"};

},{}],178:[function(require,module,exports){
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _TileImage2=_interopRequireDefault(require("./TileImage.js")),_tilegrid=require("../tilegrid.js");function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,_toPropertyKey(o.key),o)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var o=r.call(t,e||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _callSuper(t,e,r){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,r||[],_getPrototypeOf(t).constructor):e.apply(t,r))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var XYZ=function(t){function e(t){var r;_classCallCheck(this,e);var o=void 0!==(t=t||{}).projection?t.projection:"EPSG:3857",i=void 0!==t.tileGrid?t.tileGrid:(0,_tilegrid.createXYZ)({extent:(0,_tilegrid.extentFromProjection)(o),maxResolution:t.maxResolution,maxZoom:t.maxZoom,minZoom:t.minZoom,tileSize:t.tileSize});return(r=_callSuper(this,e,[{attributions:t.attributions,cacheSize:t.cacheSize,crossOrigin:t.crossOrigin,interpolate:t.interpolate,projection:o,reprojectionErrorThreshold:t.reprojectionErrorThreshold,tileGrid:i,tileLoadFunction:t.tileLoadFunction,tilePixelRatio:t.tilePixelRatio,tileUrlFunction:t.tileUrlFunction,url:t.url,urls:t.urls,wrapX:void 0===t.wrapX||t.wrapX,transition:t.transition,attributionsCollapsible:t.attributionsCollapsible,zDirection:t.zDirection}])).gutter_=void 0!==t.gutter?t.gutter:0,r}return _inherits(e,_TileImage2["default"]),_createClass(e,[{key:"getGutter",value:function(){return this.gutter_}}])}(),_default=exports.default=XYZ;

},{"../tilegrid.js":198,"./TileImage.js":174}],179:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.DEFAULT_WMS_VERSION=exports.DECIMALS=void 0;var DEFAULT_WMS_VERSION=exports.DEFAULT_WMS_VERSION="1.3.0",DECIMALS=exports.DECIMALS=4;

},{}],180:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.createLoader=createLoader;var _Image=require("../Image.js"),_extent=require("../extent.js");function createLoader(e){var t,r=e.load||_Image.decode,n=e.imageExtent,i=null!==(t=e.crossOrigin)&&void 0!==t?t:null;return function(){var t=new Image;return t.crossOrigin=i,r(t,e.url).then(function(e){var t=(0,_extent.getWidth)(n)/e.width,r=(0,_extent.getHeight)(n)/e.height;return{image:e,extent:n,resolution:t!==r?[t,r]:r,pixelRatio:1}})}}

},{"../Image.js":14,"../extent.js":59}],181:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.DEFAULT_RADIUS=void 0,exports.getArea=getArea,exports.getDistance=getDistance,exports.getLength=getLength,exports.offset=offset;var _math=require("./math.js"),DEFAULT_RADIUS=exports.DEFAULT_RADIUS=6371008.8;function getDistance(t,e,a){a=a||DEFAULT_RADIUS;var n=(0,_math.toRadians)(t[1]),r=(0,_math.toRadians)(e[1]),o=(r-n)/2,s=(0,_math.toRadians)(e[0]-t[0])/2,i=Math.sin(o)*Math.sin(o)+Math.sin(s)*Math.sin(s)*Math.cos(n)*Math.cos(r);return 2*a*Math.atan2(Math.sqrt(i),Math.sqrt(1-i))}function getLengthInternal(t,e){for(var a=0,n=0,r=t.length;n<r-1;++n)a+=getDistance(t[n],t[n+1],e);return a}function getLength(t,e){var a=(e=e||{}).radius||DEFAULT_RADIUS,n=e.projection||"EPSG:3857",r=t.getType();"GeometryCollection"!==r&&(t=t.clone().transform(n,"EPSG:4326"));var o,s,i,g,h,c,l=0;switch(r){case"Point":case"MultiPoint":break;case"LineString":case"LinearRing":l=getLengthInternal(o=t.getCoordinates(),a);break;case"MultiLineString":case"Polygon":for(i=0,g=(o=t.getCoordinates()).length;i<g;++i)l+=getLengthInternal(o[i],a);break;case"MultiPolygon":for(i=0,g=(o=t.getCoordinates()).length;i<g;++i)for(h=0,c=(s=o[i]).length;h<c;++h)l+=getLengthInternal(s[h],a);break;case"GeometryCollection":var M=t.getGeometries();for(i=0,g=M.length;i<g;++i)l+=getLength(M[i],e);break;default:throw new Error("Unsupported geometry type: "+r)}return l}function getAreaInternal(t,e){for(var a=0,n=t.length,r=t[n-1][0],o=t[n-1][1],s=0;s<n;s++){var i=t[s][0],g=t[s][1];a+=(0,_math.toRadians)(i-r)*(2+Math.sin((0,_math.toRadians)(o))+Math.sin((0,_math.toRadians)(g))),r=i,o=g}return a*e*e/2}function getArea(t,e){var a=(e=e||{}).radius||DEFAULT_RADIUS,n=e.projection||"EPSG:3857",r=t.getType();"GeometryCollection"!==r&&(t=t.clone().transform(n,"EPSG:4326"));var o,s,i,g,h,c,l=0;switch(r){case"Point":case"MultiPoint":case"LineString":case"MultiLineString":case"LinearRing":break;case"Polygon":for(o=t.getCoordinates(),l=Math.abs(getAreaInternal(o[0],a)),i=1,g=o.length;i<g;++i)l-=Math.abs(getAreaInternal(o[i],a));break;case"MultiPolygon":for(i=0,g=(o=t.getCoordinates()).length;i<g;++i)for(s=o[i],l+=Math.abs(getAreaInternal(s[0],a)),h=1,c=s.length;h<c;++h)l-=Math.abs(getAreaInternal(s[h],a));break;case"GeometryCollection":var M=t.getGeometries();for(i=0,g=M.length;i<g;++i)l+=getArea(M[i],e);break;default:throw new Error("Unsupported geometry type: "+r)}return l}function offset(t,e,a,n){n=n||DEFAULT_RADIUS;var r=(0,_math.toRadians)(t[1]),o=(0,_math.toRadians)(t[0]),s=e/n,i=Math.asin(Math.sin(r)*Math.cos(s)+Math.cos(r)*Math.sin(s)*Math.cos(a)),g=o+Math.atan2(Math.sin(a)*Math.sin(s)*Math.cos(r),Math.cos(s)-Math.sin(r)*Math.sin(i));return[(0,_math.toDegrees)(g),(0,_math.toDegrees)(i)]}

},{"./math.js":120}],182:[function(require,module,exports){
"use strict";function padNumber(e,r,t){var n=void 0!==t?e.toFixed(t):""+e,o=n.indexOf(".");return(o=-1===o?n.length:o)>r?n:new Array(1+r-o).join("0")+n}function compareVersions(e,r){for(var t=(""+e).split("."),n=(""+r).split("."),o=0;o<Math.max(t.length,n.length);o++){var s=parseInt(t[o]||"0",10),a=parseInt(n[o]||"0",10);if(s>a)return 1;if(a>s)return-1}return 0}Object.defineProperty(exports,"__esModule",{value:!0}),exports.compareVersions=compareVersions,exports.padNumber=padNumber;

},{}],183:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _asserts=require("../asserts.js");function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey(n.key),n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}var LRUCache=function(){return _createClass(function e(t){_classCallCheck(this,e),this.highWaterMark=void 0!==t?t:2048,this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null},[{key:"canExpireCache",value:function(){return this.highWaterMark>0&&this.getCount()>this.highWaterMark}},{key:"expireCache",value:function(e){for(;this.canExpireCache();)this.pop()}},{key:"clear",value:function(){this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}},{key:"containsKey",value:function(e){return this.entries_.hasOwnProperty(e)}},{key:"forEach",value:function(e){for(var t=this.oldest_;t;)e(t.value_,t.key_,this),t=t.newer}},{key:"get",value:function(e,t){var r=this.entries_[e];return(0,_asserts.assert)(void 0!==r,"Tried to get a value for a key that does not exist in the cache"),r===this.newest_?r.value_:(r===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(r.newer.older=r.older,r.older.newer=r.newer),r.newer=null,r.older=this.newest_,this.newest_.newer=r,this.newest_=r,r.value_)}},{key:"remove",value:function(e){var t=this.entries_[e];return(0,_asserts.assert)(void 0!==t,"Tried to get a value for a key that does not exist in the cache"),t===this.newest_?(this.newest_=t.older,this.newest_&&(this.newest_.newer=null)):t===this.oldest_?(this.oldest_=t.newer,this.oldest_&&(this.oldest_.older=null)):(t.newer.older=t.older,t.older.newer=t.newer),delete this.entries_[e],--this.count_,t.value_}},{key:"getCount",value:function(){return this.count_}},{key:"getKeys",value:function(){var e,t=new Array(this.count_),r=0;for(e=this.newest_;e;e=e.older)t[r++]=e.key_;return t}},{key:"getValues",value:function(){var e,t=new Array(this.count_),r=0;for(e=this.newest_;e;e=e.older)t[r++]=e.value_;return t}},{key:"peekLast",value:function(){return this.oldest_.value_}},{key:"peekLastKey",value:function(){return this.oldest_.key_}},{key:"peekFirstKey",value:function(){return this.newest_.key_}},{key:"peek",value:function(e){var t;return null===(t=this.entries_[e])||void 0===t?void 0:t.value_}},{key:"pop",value:function(){var e=this.oldest_;return delete this.entries_[e.key_],e.newer&&(e.newer.older=null),this.oldest_=e.newer,this.oldest_||(this.newest_=null),--this.count_,e.value_}},{key:"replace",value:function(e,t){this.get(e),this.entries_[e].value_=t}},{key:"set",value:function(e,t){(0,_asserts.assert)(!(e in this.entries_),"Tried to set a value for a key that is used already");var r={key_:e,newer:null,older:this.newest_,value_:t};this.newest_?this.newest_.newer=r:this.oldest_=r,this.newest_=r,this.entries_[e]=r,++this.count_}},{key:"setSize",value:function(e){this.highWaterMark=e}}])}(),_default=exports.default=LRUCache;

},{"../asserts.js":37}],184:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=exports.DROP=void 0;var _asserts=require("../asserts.js"),_obj=require("../obj.js");function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey(n.key),n)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}var DROP=exports.DROP=1/0,PriorityQueue=function(){return _createClass(function e(t,i){_classCallCheck(this,e),this.priorityFunction_=t,this.keyFunction_=i,this.elements_=[],this.priorities_=[],this.queuedElements_={}},[{key:"clear",value:function(){this.elements_.length=0,this.priorities_.length=0,(0,_obj.clear)(this.queuedElements_)}},{key:"dequeue",value:function(){var e=this.elements_,t=this.priorities_,i=e[0];1==e.length?(e.length=0,t.length=0):(e[0]=e.pop(),t[0]=t.pop(),this.siftUp_(0));var n=this.keyFunction_(i);return delete this.queuedElements_[n],i}},{key:"enqueue",value:function(e){(0,_asserts.assert)(!(this.keyFunction_(e)in this.queuedElements_),"Tried to enqueue an `element` that was already added to the queue");var t=this.priorityFunction_(e);return t!=DROP&&(this.elements_.push(e),this.priorities_.push(t),this.queuedElements_[this.keyFunction_(e)]=!0,this.siftDown_(0,this.elements_.length-1),!0)}},{key:"getCount",value:function(){return this.elements_.length}},{key:"getLeftChildIndex_",value:function(e){return 2*e+1}},{key:"getRightChildIndex_",value:function(e){return 2*e+2}},{key:"getParentIndex_",value:function(e){return e-1>>1}},{key:"heapify_",value:function(){var e;for(e=(this.elements_.length>>1)-1;e>=0;e--)this.siftUp_(e)}},{key:"isEmpty",value:function(){return 0===this.elements_.length}},{key:"isKeyQueued",value:function(e){return e in this.queuedElements_}},{key:"isQueued",value:function(e){return this.isKeyQueued(this.keyFunction_(e))}},{key:"siftUp_",value:function(e){for(var t=this.elements_,i=this.priorities_,n=t.length,r=t[e],s=i[e],o=e;e<n>>1;){var u=this.getLeftChildIndex_(e),l=this.getRightChildIndex_(e),a=l<n&&i[l]<i[u]?l:u;t[e]=t[a],i[e]=i[a],e=a}t[e]=r,i[e]=s,this.siftDown_(o,e)}},{key:"siftDown_",value:function(e,t){for(var i=this.elements_,n=this.priorities_,r=i[t],s=n[t];t>e;){var o=this.getParentIndex_(t);if(!(n[o]>s))break;i[t]=i[o],n[t]=n[o],t=o}i[t]=r,n[t]=s}},{key:"reprioritize",value:function(){var e,t,i,n=this.priorityFunction_,r=this.elements_,s=this.priorities_,o=0,u=r.length;for(t=0;t<u;++t)(i=n(e=r[t]))==DROP?delete this.queuedElements_[this.keyFunction_(e)]:(s[o]=i,r[o++]=e);r.length=o,s.length=o,this.heapify_()}}])}(),_default=exports.default=PriorityQueue;

},{"../asserts.js":37,"../obj.js":121}],185:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _rbush=_interopRequireDefault(require("rbush")),_extent=require("../extent.js"),_util=require("../util.js"),_obj=require("../obj.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,_toPropertyKey(i.key),i)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}var RBush=function(){return _createClass(function e(t){_classCallCheck(this,e),this.rbush_=new _rbush.default(t),this.items_={}},[{key:"insert",value:function(e,t){var r={minX:e[0],minY:e[1],maxX:e[2],maxY:e[3],value:t};this.rbush_.insert(r),this.items_[(0,_util.getUid)(t)]=r}},{key:"load",value:function(e,t){for(var r=new Array(t.length),i=0,n=t.length;i<n;i++){var u=e[i],o=t[i],a={minX:u[0],minY:u[1],maxX:u[2],maxY:u[3],value:o};r[i]=a,this.items_[(0,_util.getUid)(o)]=a}this.rbush_.load(r)}},{key:"remove",value:function(e){var t=(0,_util.getUid)(e),r=this.items_[t];return delete this.items_[t],null!==this.rbush_.remove(r)}},{key:"update",value:function(e,t){var r=this.items_[(0,_util.getUid)(t)],i=[r.minX,r.minY,r.maxX,r.maxY];(0,_extent.equals)(i,e)||(this.remove(t),this.insert(e,t))}},{key:"getAll",value:function(){return this.rbush_.all().map(function(e){return e.value})}},{key:"getInExtent",value:function(e){var t={minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]};return this.rbush_.search(t).map(function(e){return e.value})}},{key:"forEach",value:function(e){return this.forEach_(this.getAll(),e)}},{key:"forEachInExtent",value:function(e,t){return this.forEach_(this.getInExtent(e),t)}},{key:"forEach_",value:function(e,t){for(var r,i=0,n=e.length;i<n;i++)if(r=t(e[i]))return r;return r}},{key:"isEmpty",value:function(){return(0,_obj.isEmpty)(this.items_)}},{key:"clear",value:function(){this.rbush_.clear(),this.items_={}}},{key:"getExtent",value:function(e){var t=this.rbush_.toJSON();return(0,_extent.createOrUpdate)(t.minX,t.minY,t.maxX,t.maxY,e)}},{key:"concat",value:function(e){for(var t in this.rbush_.load(e.rbush_.all()),e.items_)this.items_[t]=e.items_[t]}}])}(),_default=exports.default=RBush;

},{"../extent.js":59,"../obj.js":121,"../util.js":205,"rbush":207}],186:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),Object.defineProperty(exports,"Circle",{enumerable:!0,get:function(){return _Circle.default}}),Object.defineProperty(exports,"Fill",{enumerable:!0,get:function(){return _Fill.default}}),Object.defineProperty(exports,"Icon",{enumerable:!0,get:function(){return _Icon.default}}),Object.defineProperty(exports,"IconImage",{enumerable:!0,get:function(){return _IconImage.default}}),Object.defineProperty(exports,"Image",{enumerable:!0,get:function(){return _Image.default}}),Object.defineProperty(exports,"RegularShape",{enumerable:!0,get:function(){return _RegularShape.default}}),Object.defineProperty(exports,"Stroke",{enumerable:!0,get:function(){return _Stroke.default}}),Object.defineProperty(exports,"Style",{enumerable:!0,get:function(){return _Style.default}}),Object.defineProperty(exports,"Text",{enumerable:!0,get:function(){return _Text.default}});var _Circle=_interopRequireDefault(require("./style/Circle.js")),_Fill=_interopRequireDefault(require("./style/Fill.js")),_Icon=_interopRequireDefault(require("./style/Icon.js")),_IconImage=_interopRequireDefault(require("./style/IconImage.js")),_Image=_interopRequireDefault(require("./style/Image.js")),_RegularShape=_interopRequireDefault(require("./style/RegularShape.js")),_Stroke=_interopRequireDefault(require("./style/Stroke.js")),_Style=_interopRequireDefault(require("./style/Style.js")),_Text=_interopRequireDefault(require("./style/Text.js"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}

},{"./style/Circle.js":187,"./style/Fill.js":188,"./style/Icon.js":189,"./style/IconImage.js":190,"./style/Image.js":192,"./style/RegularShape.js":193,"./style/Stroke.js":194,"./style/Style.js":195,"./style/Text.js":196}],187:[function(require,module,exports){
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _RegularShape2=_interopRequireDefault(require("./RegularShape.js"));function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,_toPropertyKey(o.key),o)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var o=r.call(t,e||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _callSuper(t,e,r){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,r||[],_getPrototypeOf(t).constructor):e.apply(t,r))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var CircleStyle=function(t){function e(t){return _classCallCheck(this,e),_callSuper(this,e,[{points:1/0,fill:(t=t||{radius:5}).fill,radius:t.radius,stroke:t.stroke,scale:void 0!==t.scale?t.scale:1,rotation:void 0!==t.rotation?t.rotation:0,rotateWithView:void 0!==t.rotateWithView&&t.rotateWithView,displacement:void 0!==t.displacement?t.displacement:[0,0],declutterMode:t.declutterMode}])}return _inherits(e,_RegularShape2["default"]),_createClass(e,[{key:"clone",value:function(){var t=this.getScale(),r=new e({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius(),scale:Array.isArray(t)?t.slice():t,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return r.setOpacity(this.getOpacity()),r}},{key:"setRadius",value:function(t){this.radius=t,this.render()}}])}(),_default=exports.default=CircleStyle;

},{"./RegularShape.js":193}],188:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _ImageState=_interopRequireDefault(require("../ImageState.js")),_IconImage=require("./IconImage.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}var Fill=function(){function e(t){_classCallCheck(this,e),t=t||{},this.patternImage_=null,this.color_=null,void 0!==t.color&&this.setColor(t.color)}return _createClass(e,[{key:"clone",value:function(){var t=this.getColor();return new e({color:Array.isArray(t)?t.slice():t||void 0})}},{key:"getColor",value:function(){return this.color_}},{key:"setColor",value:function(e){var t=this;if(null!==e&&"object"===_typeof(e)&&"src"in e){var r=(0,_IconImage.get)(null,e.src,"anonymous",void 0,e.offset?null:e.color?e.color:null,!(e.offset&&e.size));r.ready().then(function(){t.patternImage_=null}),r.getImageState()===_ImageState.default.IDLE&&r.load(),r.getImageState()===_ImageState.default.LOADING&&(this.patternImage_=r)}this.color_=e}},{key:"loading",value:function(){return!!this.patternImage_}},{key:"ready",value:function(){return this.patternImage_?this.patternImage_.ready():Promise.resolve()}}])}(),_default=exports.default=Fill;

},{"../ImageState.js":15,"./IconImage.js":190}],189:[function(require,module,exports){
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _EventType=_interopRequireDefault(require("../events/EventType.js")),_ImageState=_interopRequireDefault(require("../ImageState.js")),_Image=_interopRequireDefault(require("./Image.js")),_color=require("../color.js"),_asserts=require("../asserts.js"),_IconImage=require("./IconImage.js"),_util=require("../util.js");function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _slicedToArray(t,e){return _arrayWithHoles(t)||_iterableToArrayLimit(t,e)||_unsupportedIterableToArray(t,e)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(t,e){if(t){if("string"==typeof t)return _arrayLikeToArray(t,e);var i={}.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?_arrayLikeToArray(t,e):void 0}}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,r=Array(e);i<e;i++)r[i]=t[i];return r}function _iterableToArrayLimit(t,e){var i=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=i){var r,o,n,a,s=[],c=!0,l=!1;try{if(n=(i=i.call(t)).next,0===e){if(Object(i)!==i)return;c=!1}else for(;!(c=(r=n.call(i)).done)&&(s.push(r.value),s.length!==e);c=!0);}catch(t){l=!0,o=t}finally{try{if(!c&&null!=i.return&&(a=i.return(),Object(a)!==a))return}finally{if(l)throw o}}return s}}function _arrayWithHoles(t){if(Array.isArray(t))return t}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,_toPropertyKey(r.key),r)}}function _createClass(t,e,i){return e&&_defineProperties(t.prototype,e),i&&_defineProperties(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=_typeof(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _callSuper(t,e,i){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,i||[],_getPrototypeOf(t).constructor):e.apply(t,i))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _superPropGet(t,e,i,r){var o=_get(_getPrototypeOf(1&r?t.prototype:t),e,i);return 2&r?function(t){return o.apply(i,t)}:o}function _get(){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,i){var r=_superPropBase(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:i):o.value}}).apply(null,arguments)}function _superPropBase(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=_getPrototypeOf(t)););return t}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function calculateScale(t,e,i,r){return void 0!==i&&void 0!==r?[i/t,r/e]:void 0!==i?i/t:void 0!==r?r/e:1}var Icon=function(t){function e(t){var i;_classCallCheck(this,e);var r=void 0!==(t=t||{}).opacity?t.opacity:1,o=void 0!==t.rotation?t.rotation:0,n=void 0!==t.scale?t.scale:1,a=void 0!==t.rotateWithView&&t.rotateWithView;(i=_callSuper(this,e,[{opacity:r,rotation:o,scale:n,displacement:void 0!==t.displacement?t.displacement:[0,0],rotateWithView:a,declutterMode:t.declutterMode}])).anchor_=void 0!==t.anchor?t.anchor:[.5,.5],i.normalizedAnchor_=null,i.anchorOrigin_=void 0!==t.anchorOrigin?t.anchorOrigin:"top-left",i.anchorXUnits_=void 0!==t.anchorXUnits?t.anchorXUnits:"fraction",i.anchorYUnits_=void 0!==t.anchorYUnits?t.anchorYUnits:"fraction",i.crossOrigin_=void 0!==t.crossOrigin?t.crossOrigin:null;var s,c=void 0!==t.img?t.img:null,l=t.src;if((0,_asserts.assert)(!(void 0!==l&&c),"`image` and `src` cannot be provided at the same time"),void 0!==l&&0!==l.length||!c||(l=c.src||(0,_util.getUid)(c)),(0,_asserts.assert)(void 0!==l&&l.length>0,"A defined and non-empty `src` or `image` must be provided"),(0,_asserts.assert)(!((void 0!==t.width||void 0!==t.height)&&void 0!==t.scale),"`width` or `height` cannot be provided together with `scale`"),void 0!==t.src?s=_ImageState.default.IDLE:void 0!==c&&(s="complete"in c?c.complete?c.src?_ImageState.default.LOADED:_ImageState.default.IDLE:_ImageState.default.LOADING:_ImageState.default.LOADED),i.color_=void 0!==t.color?(0,_color.asArray)(t.color):null,i.iconImage_=(0,_IconImage.get)(c,l,i.crossOrigin_,s,i.color_),i.offset_=void 0!==t.offset?t.offset:[0,0],i.offsetOrigin_=void 0!==t.offsetOrigin?t.offsetOrigin:"top-left",i.origin_=null,i.size_=void 0!==t.size?t.size:null,i.initialOptions_,void 0!==t.width||void 0!==t.height){var u,f;if(t.size){var h=_slicedToArray(t.size,2);u=h[0],f=h[1]}else{var _=i.getImage(1);if(_.width&&_.height)u=_.width,f=_.height;else if(_ instanceof HTMLImageElement){i.initialOptions_=t;var g=function(){if(i.unlistenImageChange(g),i.initialOptions_){var e=i.iconImage_.getSize();i.setScale(calculateScale(e[0],e[1],t.width,t.height))}};return i.listenImageChange(g),_possibleConstructorReturn(i)}}void 0!==u&&i.setScale(calculateScale(u,f,t.width,t.height))}return i}return _inherits(e,_Image["default"]),_createClass(e,[{key:"clone",value:function(){var t,i,r;return this.initialOptions_?(i=this.initialOptions_.width,r=this.initialOptions_.height):(t=this.getScale(),t=Array.isArray(t)?t.slice():t),new e({anchor:this.anchor_.slice(),anchorOrigin:this.anchorOrigin_,anchorXUnits:this.anchorXUnits_,anchorYUnits:this.anchorYUnits_,color:this.color_&&this.color_.slice?this.color_.slice():this.color_||void 0,crossOrigin:this.crossOrigin_,offset:this.offset_.slice(),offsetOrigin:this.offsetOrigin_,opacity:this.getOpacity(),rotateWithView:this.getRotateWithView(),rotation:this.getRotation(),scale:t,width:i,height:r,size:null!==this.size_?this.size_.slice():void 0,src:this.getSrc(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}},{key:"getAnchor",value:function(){var t=this.normalizedAnchor_;if(!t){t=this.anchor_;var e=this.getSize();if("fraction"==this.anchorXUnits_||"fraction"==this.anchorYUnits_){if(!e)return null;t=this.anchor_.slice(),"fraction"==this.anchorXUnits_&&(t[0]*=e[0]),"fraction"==this.anchorYUnits_&&(t[1]*=e[1])}if("top-left"!=this.anchorOrigin_){if(!e)return null;t===this.anchor_&&(t=this.anchor_.slice()),"top-right"!=this.anchorOrigin_&&"bottom-right"!=this.anchorOrigin_||(t[0]=-t[0]+e[0]),"bottom-left"!=this.anchorOrigin_&&"bottom-right"!=this.anchorOrigin_||(t[1]=-t[1]+e[1])}this.normalizedAnchor_=t}var i=this.getDisplacement(),r=this.getScaleArray();return[t[0]-i[0]/r[0],t[1]+i[1]/r[1]]}},{key:"setAnchor",value:function(t){this.anchor_=t,this.normalizedAnchor_=null}},{key:"getColor",value:function(){return this.color_}},{key:"getImage",value:function(t){return this.iconImage_.getImage(t)}},{key:"getPixelRatio",value:function(t){return this.iconImage_.getPixelRatio(t)}},{key:"getImageSize",value:function(){return this.iconImage_.getSize()}},{key:"getImageState",value:function(){return this.iconImage_.getImageState()}},{key:"getHitDetectionImage",value:function(){return this.iconImage_.getHitDetectionImage()}},{key:"getOrigin",value:function(){if(this.origin_)return this.origin_;var t=this.offset_;if("top-left"!=this.offsetOrigin_){var e=this.getSize(),i=this.iconImage_.getSize();if(!e||!i)return null;t=t.slice(),"top-right"!=this.offsetOrigin_&&"bottom-right"!=this.offsetOrigin_||(t[0]=i[0]-e[0]-t[0]),"bottom-left"!=this.offsetOrigin_&&"bottom-right"!=this.offsetOrigin_||(t[1]=i[1]-e[1]-t[1])}return this.origin_=t,this.origin_}},{key:"getSrc",value:function(){return this.iconImage_.getSrc()}},{key:"getSize",value:function(){return this.size_?this.size_:this.iconImage_.getSize()}},{key:"getWidth",value:function(){var t=this.getScaleArray();return this.size_?this.size_[0]*t[0]:this.iconImage_.getImageState()==_ImageState.default.LOADED?this.iconImage_.getSize()[0]*t[0]:void 0}},{key:"getHeight",value:function(){var t=this.getScaleArray();return this.size_?this.size_[1]*t[1]:this.iconImage_.getImageState()==_ImageState.default.LOADED?this.iconImage_.getSize()[1]*t[1]:void 0}},{key:"setScale",value:function(t){delete this.initialOptions_,_superPropGet(e,"setScale",this,3)([t])}},{key:"listenImageChange",value:function(t){this.iconImage_.addEventListener(_EventType.default.CHANGE,t)}},{key:"load",value:function(){this.iconImage_.load()}},{key:"unlistenImageChange",value:function(t){this.iconImage_.removeEventListener(_EventType.default.CHANGE,t)}},{key:"ready",value:function(){return this.iconImage_.ready()}}])}(),_default=exports.default=Icon;

},{"../ImageState.js":15,"../asserts.js":37,"../color.js":39,"../events/EventType.js":53,"../util.js":205,"./IconImage.js":190,"./Image.js":192}],190:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0,exports.get=get;var _Target=_interopRequireDefault(require("../events/Target.js")),_EventType=_interopRequireDefault(require("../events/EventType.js")),_ImageState=_interopRequireDefault(require("../ImageState.js")),_color=require("../color.js"),_dom=require("../dom.js"),_Image=require("../Image.js"),_IconImageCache=require("./IconImageCache.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,_toPropertyKey(a.key),a)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var a=i.call(e,t||"default");if("object"!=_typeof(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,i){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,i||[],_getPrototypeOf(e).constructor):t.apply(e,i))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var taintedTestContext=null,IconImage=function(e){function t(e,i,a,r,n){var o;return _classCallCheck(this,t),(o=_callSuper(this,t)).hitDetectionImage_=null,o.image_=e,o.crossOrigin_=a,o.canvas_={},o.color_=n,o.imageState_=void 0===r?_ImageState.default.IDLE:r,o.size_=e&&e.width&&e.height?[e.width,e.height]:null,o.src_=i,o.tainted_,o.ready_=null,o}return _inherits(t,_Target["default"]),_createClass(t,[{key:"initializeImage_",value:function(){this.image_=new Image,null!==this.crossOrigin_&&(this.image_.crossOrigin=this.crossOrigin_)}},{key:"isTainted_",value:function(){if(void 0===this.tainted_&&this.imageState_===_ImageState.default.LOADED){taintedTestContext||(taintedTestContext=(0,_dom.createCanvasContext2D)(1,1,void 0,{willReadFrequently:!0})),taintedTestContext.drawImage(this.image_,0,0);try{taintedTestContext.getImageData(0,0,1,1),this.tainted_=!1}catch(e){taintedTestContext=null,this.tainted_=!0}}return!0===this.tainted_}},{key:"dispatchChangeEvent_",value:function(){this.dispatchEvent(_EventType.default.CHANGE)}},{key:"handleImageError_",value:function(){this.imageState_=_ImageState.default.ERROR,this.dispatchChangeEvent_()}},{key:"handleImageLoad_",value:function(){this.imageState_=_ImageState.default.LOADED,this.size_=[this.image_.width,this.image_.height],this.dispatchChangeEvent_()}},{key:"getImage",value:function(e){return this.image_||this.initializeImage_(),this.replaceColor_(e),this.canvas_[e]?this.canvas_[e]:this.image_}},{key:"getPixelRatio",value:function(e){return this.replaceColor_(e),this.canvas_[e]?e:1}},{key:"getImageState",value:function(){return this.imageState_}},{key:"getHitDetectionImage",value:function(){if(this.image_||this.initializeImage_(),!this.hitDetectionImage_)if(this.isTainted_()){var e=this.size_[0],t=this.size_[1],i=(0,_dom.createCanvasContext2D)(e,t);i.fillRect(0,0,e,t),this.hitDetectionImage_=i.canvas}else this.hitDetectionImage_=this.image_;return this.hitDetectionImage_}},{key:"getSize",value:function(){return this.size_}},{key:"getSrc",value:function(){return this.src_}},{key:"load",value:function(){var e=this;if(this.imageState_===_ImageState.default.IDLE){this.image_||this.initializeImage_(),this.imageState_=_ImageState.default.LOADING;try{void 0!==this.src_&&(this.image_.src=this.src_)}catch(e){this.handleImageError_()}this.image_ instanceof HTMLImageElement&&(0,_Image.decodeFallback)(this.image_,this.src_).then(function(t){e.image_=t,e.handleImageLoad_()}).catch(this.handleImageError_.bind(this))}}},{key:"replaceColor_",value:function(e){if(this.color_&&!this.canvas_[e]&&this.imageState_===_ImageState.default.LOADED){var t=this.image_,i=document.createElement("canvas");i.width=Math.ceil(t.width*e),i.height=Math.ceil(t.height*e);var a=i.getContext("2d");a.scale(e,e),a.drawImage(t,0,0),a.globalCompositeOperation="multiply",a.fillStyle=(0,_color.asString)(this.color_),a.fillRect(0,0,i.width/e,i.height/e),a.globalCompositeOperation="destination-in",a.drawImage(t,0,0),this.canvas_[e]=i}}},{key:"ready",value:function(){var e=this;return this.ready_||(this.ready_=new Promise(function(t){if(e.imageState_===_ImageState.default.LOADED||e.imageState_===_ImageState.default.ERROR)t();else{var i=function(){e.imageState_!==_ImageState.default.LOADED&&e.imageState_!==_ImageState.default.ERROR||(e.removeEventListener(_EventType.default.CHANGE,i),t())};e.addEventListener(_EventType.default.CHANGE,i)}})),this.ready_}}])}();function get(e,t,i,a,r,n){var o=void 0===t?void 0:_IconImageCache.shared.get(t,i,r);return o||(o=new IconImage(e,e&&"src"in e?e.src||void 0:t,i,a,r),_IconImageCache.shared.set(t,i,r,o,n)),n&&o&&!_IconImageCache.shared.getPattern(t,i,r)&&_IconImageCache.shared.set(t,i,r,o,n),o}var _default=exports.default=IconImage;

},{"../Image.js":14,"../ImageState.js":15,"../color.js":39,"../dom.js":49,"../events/EventType.js":53,"../events/Target.js":55,"./IconImageCache.js":191}],191:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0,exports.getCacheKey=getCacheKey,exports.shared=void 0;var _ImageState=_interopRequireDefault(require("../ImageState.js")),_color=require("../color.js"),_dom=require("../dom.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,_toPropertyKey(r.key),r)}}function _createClass(e,t,a){return t&&_defineProperties(e.prototype,t),a&&_defineProperties(e,a),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var r=a.call(e,t||"default");if("object"!=_typeof(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}var IconImageCache=function(){return _createClass(function e(){_classCallCheck(this,e),this.cache_={},this.patternCache_={},this.cacheSize_=0,this.maxCacheSize_=32},[{key:"clear",value:function(){this.cache_={},this.patternCache_={},this.cacheSize_=0}},{key:"canExpireCache",value:function(){return this.cacheSize_>this.maxCacheSize_}},{key:"expire",value:function(){if(this.canExpireCache()){var e=0;for(var t in this.cache_){var a=this.cache_[t];0!=(3&e++)||a.hasListener()||(delete this.cache_[t],delete this.patternCache_[t],--this.cacheSize_)}}}},{key:"get",value:function(e,t,a){var r=getCacheKey(e,t,a);return r in this.cache_?this.cache_[r]:null}},{key:"getPattern",value:function(e,t,a){var r=getCacheKey(e,t,a);return r in this.patternCache_?this.patternCache_[r]:null}},{key:"set",value:function(e,t,a,r,i){var n=this,o=getCacheKey(e,t,a),c=o in this.cache_;this.cache_[o]=r,i&&(r.getImageState()===_ImageState.default.IDLE&&r.load(),r.getImageState()===_ImageState.default.LOADING?r.ready().then(function(){n.patternCache_[o]=(0,_dom.getSharedCanvasContext2D)().createPattern(r.getImage(1),"repeat")}):this.patternCache_[o]=(0,_dom.getSharedCanvasContext2D)().createPattern(r.getImage(1),"repeat")),c||++this.cacheSize_}},{key:"setSize",value:function(e){this.maxCacheSize_=e,this.expire()}}])}();function getCacheKey(e,t,a){return t+":"+e+":"+(a?(0,_color.asArray)(a):"null")}var _default=exports.default=IconImageCache,shared=exports.shared=new IconImageCache;

},{"../ImageState.js":15,"../color.js":39,"../dom.js":49}],192:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _util=require("../util.js"),_size=require("../size.js");function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,_toPropertyKey(r.key),r)}}function _createClass(t,e,i){return e&&_defineProperties(t.prototype,e),i&&_defineProperties(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=_typeof(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var ImageStyle=function(){function t(e){_classCallCheck(this,t),this.opacity_=e.opacity,this.rotateWithView_=e.rotateWithView,this.rotation_=e.rotation,this.scale_=e.scale,this.scaleArray_=(0,_size.toSize)(e.scale),this.displacement_=e.displacement,this.declutterMode_=e.declutterMode}return _createClass(t,[{key:"clone",value:function(){var e=this.getScale();return new t({opacity:this.getOpacity(),scale:Array.isArray(e)?e.slice():e,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}},{key:"getOpacity",value:function(){return this.opacity_}},{key:"getRotateWithView",value:function(){return this.rotateWithView_}},{key:"getRotation",value:function(){return this.rotation_}},{key:"getScale",value:function(){return this.scale_}},{key:"getScaleArray",value:function(){return this.scaleArray_}},{key:"getDisplacement",value:function(){return this.displacement_}},{key:"getDeclutterMode",value:function(){return this.declutterMode_}},{key:"getAnchor",value:function(){return(0,_util.abstract)()}},{key:"getImage",value:function(t){return(0,_util.abstract)()}},{key:"getHitDetectionImage",value:function(){return(0,_util.abstract)()}},{key:"getPixelRatio",value:function(t){return 1}},{key:"getImageState",value:function(){return(0,_util.abstract)()}},{key:"getImageSize",value:function(){return(0,_util.abstract)()}},{key:"getOrigin",value:function(){return(0,_util.abstract)()}},{key:"getSize",value:function(){return(0,_util.abstract)()}},{key:"setDisplacement",value:function(t){this.displacement_=t}},{key:"setOpacity",value:function(t){this.opacity_=t}},{key:"setRotateWithView",value:function(t){this.rotateWithView_=t}},{key:"setRotation",value:function(t){this.rotation_=t}},{key:"setScale",value:function(t){this.scale_=t,this.scaleArray_=(0,_size.toSize)(t)}},{key:"listenImageChange",value:function(t){(0,_util.abstract)()}},{key:"load",value:function(){(0,_util.abstract)()}},{key:"unlistenImageChange",value:function(t){(0,_util.abstract)()}},{key:"ready",value:function(){return Promise.resolve()}}])}(),_default=exports.default=ImageStyle;

},{"../size.js":167,"../util.js":205}],193:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _ImageState=_interopRequireDefault(require("../ImageState.js")),_Image=_interopRequireDefault(require("./Image.js")),_color=require("../color.js"),_colorlike=require("../colorlike.js"),_dom=require("../dom.js"),_canvas=require("../render/canvas.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,_toPropertyKey(r.key),r)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=_typeof(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,i){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,i||[],_getPrototypeOf(e).constructor):t.apply(e,i))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var RegularShape=function(e){function t(e){var i;return _classCallCheck(this,t),(i=_callSuper(this,t,[{opacity:1,rotateWithView:void 0!==e.rotateWithView&&e.rotateWithView,rotation:void 0!==e.rotation?e.rotation:0,scale:void 0!==e.scale?e.scale:1,displacement:void 0!==e.displacement?e.displacement:[0,0],declutterMode:e.declutterMode}])).canvases_,i.hitDetectionCanvas_=null,i.fill_=void 0!==e.fill?e.fill:null,i.origin_=[0,0],i.points_=e.points,i.radius=e.radius,i.radius2_=e.radius2,i.angle_=void 0!==e.angle?e.angle:0,i.stroke_=void 0!==e.stroke?e.stroke:null,i.size_,i.renderOptions_,i.imageState_=i.fill_&&i.fill_.loading()?_ImageState.default.LOADING:_ImageState.default.LOADED,i.imageState_===_ImageState.default.LOADING&&i.ready().then(function(){return i.imageState_=_ImageState.default.LOADED}),i.render(),i}return _inherits(t,_Image["default"]),_createClass(t,[{key:"clone",value:function(){var e=this.getScale(),i=new t({fill:this.getFill()?this.getFill().clone():void 0,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(e)?e.slice():e,displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return i.setOpacity(this.getOpacity()),i}},{key:"getAnchor",value:function(){var e=this.size_,t=this.getDisplacement(),i=this.getScaleArray();return[e[0]/2-t[0]/i[0],e[1]/2+t[1]/i[1]]}},{key:"getAngle",value:function(){return this.angle_}},{key:"getFill",value:function(){return this.fill_}},{key:"setFill",value:function(e){this.fill_=e,this.render()}},{key:"getHitDetectionImage",value:function(){return this.hitDetectionCanvas_||(this.hitDetectionCanvas_=this.createHitDetectionCanvas_(this.renderOptions_)),this.hitDetectionCanvas_}},{key:"getImage",value:function(e){var t=this.canvases_[e];if(!t){var i=this.renderOptions_,r=(0,_dom.createCanvasContext2D)(i.size*e,i.size*e);this.draw_(i,r,e),t=r.canvas,this.canvases_[e]=t}return t}},{key:"getPixelRatio",value:function(e){return e}},{key:"getImageSize",value:function(){return this.size_}},{key:"getImageState",value:function(){return this.imageState_}},{key:"getOrigin",value:function(){return this.origin_}},{key:"getPoints",value:function(){return this.points_}},{key:"getRadius",value:function(){return this.radius}},{key:"getRadius2",value:function(){return this.radius2_}},{key:"getSize",value:function(){return this.size_}},{key:"getStroke",value:function(){return this.stroke_}},{key:"setStroke",value:function(e){this.stroke_=e,this.render()}},{key:"listenImageChange",value:function(e){}},{key:"load",value:function(){}},{key:"unlistenImageChange",value:function(e){}},{key:"calculateLineJoinSize_",value:function(e,t,i){if(0===t||this.points_===1/0||"bevel"!==e&&"miter"!==e)return t;var r=this.radius,n=void 0===this.radius2_?r:this.radius2_;if(r<n){var a=r;r=n,n=a}var o=void 0===this.radius2_?this.points_:2*this.points_,s=2*Math.PI/o,l=n*Math.sin(s),u=r-Math.sqrt(n*n-l*l),c=Math.sqrt(l*l+u*u),f=c/l;if("miter"===e&&f<=i)return f*t;var h=t/2/f,_=t/2*(u/c),d=Math.sqrt((r+h)*(r+h)+_*_)-r;if(void 0===this.radius2_||"bevel"===e)return 2*d;var v=r*Math.sin(s),y=n-Math.sqrt(r*r-v*v),p=Math.sqrt(v*v+y*y)/v;if(p<=i){var g=p*t/2-n-r;return 2*Math.max(d,g)}return 2*d}},{key:"createRenderOptions",value:function(){var e,t,i,r,n,a,o,s=_canvas.defaultLineCap,l=_canvas.defaultLineJoin,u=0,c=null,f=0,h=0;this.stroke_&&(e=(0,_colorlike.asColorLike)(null!==(t=this.stroke_.getColor())&&void 0!==t?t:_canvas.defaultStrokeStyle),h=null!==(i=this.stroke_.getWidth())&&void 0!==i?i:_canvas.defaultLineWidth,c=this.stroke_.getLineDash(),f=null!==(r=this.stroke_.getLineDashOffset())&&void 0!==r?r:0,l=null!==(n=this.stroke_.getLineJoin())&&void 0!==n?n:_canvas.defaultLineJoin,s=null!==(a=this.stroke_.getLineCap())&&void 0!==a?a:_canvas.defaultLineCap,u=null!==(o=this.stroke_.getMiterLimit())&&void 0!==o?o:_canvas.defaultMiterLimit);var _=this.calculateLineJoinSize_(l,h,u),d=Math.max(this.radius,this.radius2_||0);return{strokeStyle:e,strokeWidth:h,size:Math.ceil(2*d+_),lineCap:s,lineDash:c,lineDashOffset:f,lineJoin:l,miterLimit:u}}},{key:"render",value:function(){this.renderOptions_=this.createRenderOptions();var e=this.renderOptions_.size;this.canvases_={},this.hitDetectionCanvas_=null,this.size_=[e,e]}},{key:"draw_",value:function(e,t,i){if(t.scale(i,i),t.translate(e.size/2,e.size/2),this.createPath_(t),this.fill_){var r=this.fill_.getColor();null===r&&(r=_canvas.defaultFillStyle),t.fillStyle=(0,_colorlike.asColorLike)(r),t.fill()}e.strokeStyle&&(t.strokeStyle=e.strokeStyle,t.lineWidth=e.strokeWidth,e.lineDash&&(t.setLineDash(e.lineDash),t.lineDashOffset=e.lineDashOffset),t.lineCap=e.lineCap,t.lineJoin=e.lineJoin,t.miterLimit=e.miterLimit,t.stroke())}},{key:"createHitDetectionCanvas_",value:function(e){var t;if(this.fill_){var i=this.fill_.getColor(),r=0;"string"==typeof i&&(i=(0,_color.asArray)(i)),null===i?r=1:Array.isArray(i)&&(r=4===i.length?i[3]:1),0===r&&(t=(0,_dom.createCanvasContext2D)(e.size,e.size),this.drawHitDetectionCanvas_(e,t))}return t?t.canvas:this.getImage(1)}},{key:"createPath_",value:function(e){var t=this.points_,i=this.radius;if(t===1/0)e.arc(0,0,i,0,2*Math.PI);else{var r=void 0===this.radius2_?i:this.radius2_;void 0!==this.radius2_&&(t*=2);for(var n=this.angle_-Math.PI/2,a=2*Math.PI/t,o=0;o<t;o++){var s=n+o*a,l=o%2==0?i:r;e.lineTo(l*Math.cos(s),l*Math.sin(s))}e.closePath()}}},{key:"drawHitDetectionCanvas_",value:function(e,t){t.translate(e.size/2,e.size/2),this.createPath_(t),t.fillStyle=_canvas.defaultFillStyle,t.fill(),e.strokeStyle&&(t.strokeStyle=e.strokeStyle,t.lineWidth=e.strokeWidth,e.lineDash&&(t.setLineDash(e.lineDash),t.lineDashOffset=e.lineDashOffset),t.lineJoin=e.lineJoin,t.miterLimit=e.miterLimit,t.stroke())}},{key:"ready",value:function(){return this.fill_?this.fill_.ready():Promise.resolve()}}])}(),_default=exports.default=RegularShape;

},{"../ImageState.js":15,"../color.js":39,"../colorlike.js":40,"../dom.js":49,"../render/canvas.js":136,"./Image.js":192}],194:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey(n.key),n)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var Stroke=function(){function e(t){_classCallCheck(this,e),t=t||{},this.color_=void 0!==t.color?t.color:null,this.lineCap_=t.lineCap,this.lineDash_=void 0!==t.lineDash?t.lineDash:null,this.lineDashOffset_=t.lineDashOffset,this.lineJoin_=t.lineJoin,this.miterLimit_=t.miterLimit,this.width_=t.width}return _createClass(e,[{key:"clone",value:function(){var t=this.getColor();return new e({color:Array.isArray(t)?t.slice():t||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()})}},{key:"getColor",value:function(){return this.color_}},{key:"getLineCap",value:function(){return this.lineCap_}},{key:"getLineDash",value:function(){return this.lineDash_}},{key:"getLineDashOffset",value:function(){return this.lineDashOffset_}},{key:"getLineJoin",value:function(){return this.lineJoin_}},{key:"getMiterLimit",value:function(){return this.miterLimit_}},{key:"getWidth",value:function(){return this.width_}},{key:"setColor",value:function(e){this.color_=e}},{key:"setLineCap",value:function(e){this.lineCap_=e}},{key:"setLineDash",value:function(e){this.lineDash_=e}},{key:"setLineDashOffset",value:function(e){this.lineDashOffset_=e}},{key:"setLineJoin",value:function(e){this.lineJoin_=e}},{key:"setMiterLimit",value:function(e){this.miterLimit_=e}},{key:"setWidth",value:function(e){this.width_=e}}])}(),_default=exports.default=Stroke;

},{}],195:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.createDefaultStyle=createDefaultStyle,exports.createEditingStyle=createEditingStyle,exports.default=void 0,exports.toFunction=toFunction;var _Circle=_interopRequireDefault(require("./Circle.js")),_Fill=_interopRequireDefault(require("./Fill.js")),_Stroke=_interopRequireDefault(require("./Stroke.js")),_asserts=require("../asserts.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey(n.key),n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}var Style=function(){function e(t){_classCallCheck(this,e),t=t||{},this.geometry_=null,this.geometryFunction_=defaultGeometryFunction,void 0!==t.geometry&&this.setGeometry(t.geometry),this.fill_=void 0!==t.fill?t.fill:null,this.image_=void 0!==t.image?t.image:null,this.renderer_=void 0!==t.renderer?t.renderer:null,this.hitDetectionRenderer_=void 0!==t.hitDetectionRenderer?t.hitDetectionRenderer:null,this.stroke_=void 0!==t.stroke?t.stroke:null,this.text_=void 0!==t.text?t.text:null,this.zIndex_=t.zIndex}return _createClass(e,[{key:"clone",value:function(){var t,r,n=this.getGeometry();return n&&"object"===_typeof(n)&&(n=n.clone()),new e({geometry:null!==(t=n)&&void 0!==t?t:void 0,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,renderer:null!==(r=this.getRenderer())&&void 0!==r?r:void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})}},{key:"getRenderer",value:function(){return this.renderer_}},{key:"setRenderer",value:function(e){this.renderer_=e}},{key:"setHitDetectionRenderer",value:function(e){this.hitDetectionRenderer_=e}},{key:"getHitDetectionRenderer",value:function(){return this.hitDetectionRenderer_}},{key:"getGeometry",value:function(){return this.geometry_}},{key:"getGeometryFunction",value:function(){return this.geometryFunction_}},{key:"getFill",value:function(){return this.fill_}},{key:"setFill",value:function(e){this.fill_=e}},{key:"getImage",value:function(){return this.image_}},{key:"setImage",value:function(e){this.image_=e}},{key:"getStroke",value:function(){return this.stroke_}},{key:"setStroke",value:function(e){this.stroke_=e}},{key:"getText",value:function(){return this.text_}},{key:"setText",value:function(e){this.text_=e}},{key:"getZIndex",value:function(){return this.zIndex_}},{key:"setGeometry",value:function(e){"function"==typeof e?this.geometryFunction_=e:"string"==typeof e?this.geometryFunction_=function(t){return t.get(e)}:e?void 0!==e&&(this.geometryFunction_=function(){return e}):this.geometryFunction_=defaultGeometryFunction,this.geometry_=e}},{key:"setZIndex",value:function(e){this.zIndex_=e}}])}();function toFunction(e){var t;if("function"==typeof e)t=e;else{var r;if(Array.isArray(e))r=e;else(0,_asserts.assert)("function"==typeof e.getZIndex,"Expected an `Style` or an array of `Style`"),r=[e];t=function(){return r}}return t}var defaultStyles=null;function createDefaultStyle(e,t){if(!defaultStyles){var r=new _Fill.default({color:"rgba(255,255,255,0.4)"}),n=new _Stroke.default({color:"#3399CC",width:1.25});defaultStyles=[new Style({image:new _Circle.default({fill:r,stroke:n,radius:5}),fill:r,stroke:n})]}return defaultStyles}function createEditingStyle(){var e={},t=[255,255,255,1],r=[0,153,255,1];return e.Polygon=[new Style({fill:new _Fill.default({color:[255,255,255,.5]})})],e.MultiPolygon=e.Polygon,e.LineString=[new Style({stroke:new _Stroke.default({color:t,width:5})}),new Style({stroke:new _Stroke.default({color:r,width:3})})],e.MultiLineString=e.LineString,e.Circle=e.Polygon.concat(e.LineString),e.Point=[new Style({image:new _Circle.default({radius:6,fill:new _Fill.default({color:r}),stroke:new _Stroke.default({color:t,width:1.5})}),zIndex:1/0})],e.MultiPoint=e.Point,e.GeometryCollection=e.Polygon.concat(e.LineString,e.Point),e}function defaultGeometryFunction(e){return e.getGeometry()}var _default=exports.default=Style;

},{"../asserts.js":37,"./Circle.js":187,"./Fill.js":188,"./Stroke.js":194}],196:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _Fill=_interopRequireDefault(require("./Fill.js")),_size=require("../size.js");function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,_toPropertyKey(n.key),n)}}function _createClass(t,e,i){return e&&_defineProperties(t.prototype,e),i&&_defineProperties(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,e||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var DEFAULT_FILL_COLOR="#333",Text=function(){function t(e){_classCallCheck(this,t),e=e||{},this.font_=e.font,this.rotation_=e.rotation,this.rotateWithView_=e.rotateWithView,this.scale_=e.scale,this.scaleArray_=(0,_size.toSize)(void 0!==e.scale?e.scale:1),this.text_=e.text,this.textAlign_=e.textAlign,this.justify_=e.justify,this.repeat_=e.repeat,this.textBaseline_=e.textBaseline,this.fill_=void 0!==e.fill?e.fill:new _Fill.default({color:DEFAULT_FILL_COLOR}),this.maxAngle_=void 0!==e.maxAngle?e.maxAngle:Math.PI/4,this.placement_=void 0!==e.placement?e.placement:"point",this.overflow_=!!e.overflow,this.stroke_=void 0!==e.stroke?e.stroke:null,this.offsetX_=void 0!==e.offsetX?e.offsetX:0,this.offsetY_=void 0!==e.offsetY?e.offsetY:0,this.backgroundFill_=e.backgroundFill?e.backgroundFill:null,this.backgroundStroke_=e.backgroundStroke?e.backgroundStroke:null,this.padding_=void 0===e.padding?null:e.padding,this.declutterMode_=e.declutterMode}return _createClass(t,[{key:"clone",value:function(){var e=this.getScale();return new t({font:this.getFont(),placement:this.getPlacement(),repeat:this.getRepeat(),maxAngle:this.getMaxAngle(),overflow:this.getOverflow(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(e)?e.slice():e,text:this.getText(),textAlign:this.getTextAlign(),justify:this.getJustify(),textBaseline:this.getTextBaseline(),fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,offsetX:this.getOffsetX(),offsetY:this.getOffsetY(),backgroundFill:this.getBackgroundFill()?this.getBackgroundFill().clone():void 0,backgroundStroke:this.getBackgroundStroke()?this.getBackgroundStroke().clone():void 0,padding:this.getPadding()||void 0,declutterMode:this.getDeclutterMode()})}},{key:"getOverflow",value:function(){return this.overflow_}},{key:"getFont",value:function(){return this.font_}},{key:"getMaxAngle",value:function(){return this.maxAngle_}},{key:"getPlacement",value:function(){return this.placement_}},{key:"getRepeat",value:function(){return this.repeat_}},{key:"getOffsetX",value:function(){return this.offsetX_}},{key:"getOffsetY",value:function(){return this.offsetY_}},{key:"getFill",value:function(){return this.fill_}},{key:"getRotateWithView",value:function(){return this.rotateWithView_}},{key:"getRotation",value:function(){return this.rotation_}},{key:"getScale",value:function(){return this.scale_}},{key:"getScaleArray",value:function(){return this.scaleArray_}},{key:"getStroke",value:function(){return this.stroke_}},{key:"getText",value:function(){return this.text_}},{key:"getTextAlign",value:function(){return this.textAlign_}},{key:"getJustify",value:function(){return this.justify_}},{key:"getTextBaseline",value:function(){return this.textBaseline_}},{key:"getBackgroundFill",value:function(){return this.backgroundFill_}},{key:"getBackgroundStroke",value:function(){return this.backgroundStroke_}},{key:"getPadding",value:function(){return this.padding_}},{key:"getDeclutterMode",value:function(){return this.declutterMode_}},{key:"setOverflow",value:function(t){this.overflow_=t}},{key:"setFont",value:function(t){this.font_=t}},{key:"setMaxAngle",value:function(t){this.maxAngle_=t}},{key:"setOffsetX",value:function(t){this.offsetX_=t}},{key:"setOffsetY",value:function(t){this.offsetY_=t}},{key:"setPlacement",value:function(t){this.placement_=t}},{key:"setRepeat",value:function(t){this.repeat_=t}},{key:"setRotateWithView",value:function(t){this.rotateWithView_=t}},{key:"setFill",value:function(t){this.fill_=t}},{key:"setRotation",value:function(t){this.rotation_=t}},{key:"setScale",value:function(t){this.scale_=t,this.scaleArray_=(0,_size.toSize)(void 0!==t?t:1)}},{key:"setStroke",value:function(t){this.stroke_=t}},{key:"setText",value:function(t){this.text_=t}},{key:"setTextAlign",value:function(t){this.textAlign_=t}},{key:"setJustify",value:function(t){this.justify_=t}},{key:"setTextBaseline",value:function(t){this.textBaseline_=t}},{key:"setBackgroundFill",value:function(t){this.backgroundFill_=t}},{key:"setBackgroundStroke",value:function(t){this.backgroundStroke_=t}},{key:"setPadding",value:function(t){this.padding_=t}}])}(),_default=exports.default=Text;

},{"../size.js":167,"./Fill.js":188}],197:[function(require,module,exports){
"use strict";function _slicedToArray(e,r){return _arrayWithHoles(e)||_iterableToArrayLimit(e,r)||_unsupportedIterableToArray(e,r)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,r){if(e){if("string"==typeof e)return _arrayLikeToArray(e,r);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?_arrayLikeToArray(e,r):void 0}}function _arrayLikeToArray(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,n=Array(r);t<r;t++)n[t]=e[t];return n}function _iterableToArrayLimit(e,r){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var n,a,o,i,u=[],l=!0,y=!1;try{if(o=(t=t.call(e)).next,0===r){if(Object(t)!==t)return;l=!1}else for(;!(l=(n=o.call(t)).done)&&(u.push(n.value),u.length!==r);l=!0);}catch(e){y=!0,a=e}finally{try{if(!l&&null!=t.return&&(i=t.return(),Object(i)!==i))return}finally{if(y)throw a}}return u}}function _arrayWithHoles(e){if(Array.isArray(e))return e}function createOrUpdate(e,r,t,n){return void 0!==n?(n[0]=e,n[1]=r,n[2]=t,n):[e,r,t]}function getKeyZXY(e,r,t){return e+"/"+r+"/"+t}function getKey(e){return getKeyZXY(e[0],e[1],e[2])}function getCacheKeyForTileKey(e){var r=_slicedToArray(e.substring(e.lastIndexOf("/")+1,e.length).split(",").map(Number),3);return getKeyZXY(r[0],r[1],r[2])}function fromKey(e){return e.split("/").map(Number)}function hash(e){return hashZXY(e[0],e[1],e[2])}function hashZXY(e,r,t){return(r<<e)+t}function withinExtentAndZ(e,r){var t=e[0],n=e[1],a=e[2];if(r.getMinZoom()>t||t>r.getMaxZoom())return!1;var o=r.getFullTileRange(t);return!o||o.containsXY(n,a)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.createOrUpdate=createOrUpdate,exports.fromKey=fromKey,exports.getCacheKeyForTileKey=getCacheKeyForTileKey,exports.getKey=getKey,exports.getKeyZXY=getKeyZXY,exports.hash=hash,exports.hashZXY=hashZXY,exports.withinExtentAndZ=withinExtentAndZ;

},{}],198:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),Object.defineProperty(exports,"TileGrid",{enumerable:!0,get:function(){return _TileGrid.default}}),Object.defineProperty(exports,"WMTS",{enumerable:!0,get:function(){return _WMTS.default}}),exports.createForExtent=createForExtent,exports.createForProjection=createForProjection,exports.createXYZ=createXYZ,exports.extentFromProjection=extentFromProjection,exports.getForProjection=getForProjection,exports.wrapX=wrapX;var _TileGrid=_interopRequireDefault(require("./tilegrid/TileGrid.js")),_common=require("./tilegrid/common.js"),_proj=require("./proj.js"),_extent=require("./extent.js"),_size=require("./size.js"),_WMTS=_interopRequireDefault(require("./tilegrid/WMTS.js"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function getForProjection(e){var t=e.getDefaultTileGrid();return t||(t=createForProjection(e),e.setDefaultTileGrid(t)),t}function wrapX(e,t,r){var o=t[0],n=e.getTileCoordCenter(t),i=extentFromProjection(r);if(!(0,_extent.containsCoordinate)(i,n)){var u=(0,_extent.getWidth)(i),a=Math.ceil((i[0]-n[0])/u);return n[0]+=u*a,e.getTileCoordForCoordAndZ(n,o)}return t}function createForExtent(e,t,r,o){o=void 0!==o?o:"top-left";var n=resolutionsFromExtent(e,t,r);return new _TileGrid.default({extent:e,origin:(0,_extent.getCorner)(e,o),resolutions:n,tileSize:r})}function createXYZ(e){var t=e||{},r=t.extent||(0,_proj.get)("EPSG:3857").getExtent(),o={extent:r,minZoom:t.minZoom,tileSize:t.tileSize,resolutions:resolutionsFromExtent(r,t.maxZoom,t.tileSize,t.maxResolution)};return new _TileGrid.default(o)}function resolutionsFromExtent(e,t,r,o){t=void 0!==t?t:_common.DEFAULT_MAX_ZOOM,r=(0,_size.toSize)(void 0!==r?r:_common.DEFAULT_TILE_SIZE);var n=(0,_extent.getHeight)(e),i=(0,_extent.getWidth)(e);o=o>0?o:Math.max(i/r[0],n/r[1]);for(var u=t+1,a=new Array(u),c=0;c<u;++c)a[c]=o/Math.pow(2,c);return a}function createForProjection(e,t,r,o){return createForExtent(extentFromProjection(e),t,r,o)}function extentFromProjection(e){var t=(e=(0,_proj.get)(e)).getExtent();if(!t){var r=180*_proj.METERS_PER_UNIT.degrees/e.getMetersPerUnit();t=(0,_extent.createOrUpdate)(-r,-r,r,r)}return t}

},{"./extent.js":59,"./proj.js":123,"./size.js":167,"./tilegrid/TileGrid.js":199,"./tilegrid/WMTS.js":200,"./tilegrid/common.js":201}],199:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _TileRange=_interopRequireWildcard(require("../TileRange.js")),_common=require("./common.js"),_asserts=require("../asserts.js"),_math=require("../math.js"),_extent=require("../extent.js"),_tilecoord=require("../tilecoord.js"),_intersectsextent=require("../geom/flat/intersectsextent.js"),_array=require("../array.js"),_size=require("../size.js");function _getRequireWildcardCache(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,i=new WeakMap;return(_getRequireWildcardCache=function(e){return e?i:t})(e)}function _interopRequireWildcard(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=_typeof(e)&&"function"!=typeof e)return{default:e};var i=_getRequireWildcardCache(t);if(i&&i.has(e))return i.get(e);var r={__proto__:null},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var n in e)if("default"!==n&&{}.hasOwnProperty.call(e,n)){var s=o?Object.getOwnPropertyDescriptor(e,n):null;s&&(s.get||s.set)?Object.defineProperty(r,n,s):r[n]=e[n]}return r.default=e,i&&i.set(e,r),r}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,_toPropertyKey(r.key),r)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=_typeof(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}var tmpTileCoord=[0,0,0],DECIMALS=5,TileGrid=function(){return _createClass(function e(t){var i,r=this;if(_classCallCheck(this,e),this.minZoom=void 0!==t.minZoom?t.minZoom:0,this.resolutions_=t.resolutions,(0,_asserts.assert)((0,_array.isSorted)(this.resolutions_,function(e,t){return t-e},!0),"`resolutions` must be sorted in descending order"),!t.origins)for(var o=0,n=this.resolutions_.length-1;o<n;++o)if(i){if(this.resolutions_[o]/this.resolutions_[o+1]!==i){i=void 0;break}}else i=this.resolutions_[o]/this.resolutions_[o+1];this.zoomFactor_=i,this.maxZoom=this.resolutions_.length-1,this.origin_=void 0!==t.origin?t.origin:null,this.origins_=null,void 0!==t.origins&&(this.origins_=t.origins,(0,_asserts.assert)(this.origins_.length==this.resolutions_.length,"Number of `origins` and `resolutions` must be equal"));var s=t.extent;void 0===s||this.origin_||this.origins_||(this.origin_=(0,_extent.getTopLeft)(s)),(0,_asserts.assert)(!this.origin_&&this.origins_||this.origin_&&!this.origins_,"Either `origin` or `origins` must be configured, never both"),this.tileSizes_=null,void 0!==t.tileSizes&&(this.tileSizes_=t.tileSizes,(0,_asserts.assert)(this.tileSizes_.length==this.resolutions_.length,"Number of `tileSizes` and `resolutions` must be equal")),this.tileSize_=void 0!==t.tileSize?t.tileSize:this.tileSizes_?null:_common.DEFAULT_TILE_SIZE,(0,_asserts.assert)(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,"Either `tileSize` or `tileSizes` must be configured, never both"),this.extent_=void 0!==s?s:null,this.fullTileRanges_=null,this.tmpSize_=[0,0],this.tmpExtent_=[0,0,0,0],void 0!==t.sizes?this.fullTileRanges_=t.sizes.map(function(e,t){var i=new _TileRange.default(Math.min(0,e[0]),Math.max(e[0]-1,-1),Math.min(0,e[1]),Math.max(e[1]-1,-1));if(s){var o=r.getTileRangeForExtentAndZ(s,t);i.minX=Math.max(o.minX,i.minX),i.maxX=Math.min(o.maxX,i.maxX),i.minY=Math.max(o.minY,i.minY),i.maxY=Math.min(o.maxY,i.maxY)}return i}):s&&this.calculateTileRanges_(s)},[{key:"forEachTileCoord",value:function(e,t,i){for(var r=this.getTileRangeForExtentAndZ(e,t),o=r.minX,n=r.maxX;o<=n;++o)for(var s=r.minY,l=r.maxY;s<=l;++s)i([t,o,s])}},{key:"forEachTileCoordParentTileRange",value:function(e,t,i,r){var o,n,s,l=null,a=e[0]-1;for(2===this.zoomFactor_?(n=e[1],s=e[2]):l=this.getTileCoordExtent(e,r);a>=this.minZoom;){if(void 0!==n&&void 0!==s?(n=Math.floor(n/2),s=Math.floor(s/2),o=(0,_TileRange.createOrUpdate)(n,n,s,s,i)):o=this.getTileRangeForExtentAndZ(l,a,i),t(a,o))return!0;--a}return!1}},{key:"getExtent",value:function(){return this.extent_}},{key:"getMaxZoom",value:function(){return this.maxZoom}},{key:"getMinZoom",value:function(){return this.minZoom}},{key:"getOrigin",value:function(e){return this.origin_?this.origin_:this.origins_[e]}},{key:"getResolution",value:function(e){return this.resolutions_[e]}},{key:"getResolutions",value:function(){return this.resolutions_}},{key:"getTileCoordChildTileRange",value:function(e,t,i){if(e[0]<this.maxZoom){if(2===this.zoomFactor_){var r=2*e[1],o=2*e[2];return(0,_TileRange.createOrUpdate)(r,r+1,o,o+1,t)}var n=this.getTileCoordExtent(e,i||this.tmpExtent_);return this.getTileRangeForExtentAndZ(n,e[0]+1,t)}return null}},{key:"getTileRangeForTileCoordAndZ",value:function(e,t,i){if(t>this.maxZoom||t<this.minZoom)return null;var r=e[0],o=e[1],n=e[2];if(t===r)return(0,_TileRange.createOrUpdate)(o,n,o,n,i);if(this.zoomFactor_){var s=Math.pow(this.zoomFactor_,t-r),l=Math.floor(o*s),a=Math.floor(n*s);if(t<r)return(0,_TileRange.createOrUpdate)(l,l,a,a,i);var u=Math.floor(s*(o+1))-1,h=Math.floor(s*(n+1))-1;return(0,_TileRange.createOrUpdate)(l,u,a,h,i)}var _=this.getTileCoordExtent(e,this.tmpExtent_);return this.getTileRangeForExtentAndZ(_,t,i)}},{key:"getTileRangeForExtentAndZ",value:function(e,t,i){this.getTileCoordForXYAndZ_(e[0],e[3],t,!1,tmpTileCoord);var r=tmpTileCoord[1],o=tmpTileCoord[2];this.getTileCoordForXYAndZ_(e[2],e[1],t,!0,tmpTileCoord);var n=tmpTileCoord[1],s=tmpTileCoord[2];return(0,_TileRange.createOrUpdate)(r,n,o,s,i)}},{key:"getTileCoordCenter",value:function(e){var t=this.getOrigin(e[0]),i=this.getResolution(e[0]),r=(0,_size.toSize)(this.getTileSize(e[0]),this.tmpSize_);return[t[0]+(e[1]+.5)*r[0]*i,t[1]-(e[2]+.5)*r[1]*i]}},{key:"getTileCoordExtent",value:function(e,t){var i=this.getOrigin(e[0]),r=this.getResolution(e[0]),o=(0,_size.toSize)(this.getTileSize(e[0]),this.tmpSize_),n=i[0]+e[1]*o[0]*r,s=i[1]-(e[2]+1)*o[1]*r,l=n+o[0]*r,a=s+o[1]*r;return(0,_extent.createOrUpdate)(n,s,l,a,t)}},{key:"getTileCoordForCoordAndResolution",value:function(e,t,i){return this.getTileCoordForXYAndResolution_(e[0],e[1],t,!1,i)}},{key:"getTileCoordForXYAndResolution_",value:function(e,t,i,r,o){var n=this.getZForResolution(i),s=i/this.getResolution(n),l=this.getOrigin(n),a=(0,_size.toSize)(this.getTileSize(n),this.tmpSize_),u=s*(e-l[0])/i/a[0],h=s*(l[1]-t)/i/a[1];return r?(u=(0,_math.ceil)(u,DECIMALS)-1,h=(0,_math.ceil)(h,DECIMALS)-1):(u=(0,_math.floor)(u,DECIMALS),h=(0,_math.floor)(h,DECIMALS)),(0,_tilecoord.createOrUpdate)(n,u,h,o)}},{key:"getTileCoordForXYAndZ_",value:function(e,t,i,r,o){var n=this.getOrigin(i),s=this.getResolution(i),l=(0,_size.toSize)(this.getTileSize(i),this.tmpSize_),a=(e-n[0])/s/l[0],u=(n[1]-t)/s/l[1];return r?(a=(0,_math.ceil)(a,DECIMALS)-1,u=(0,_math.ceil)(u,DECIMALS)-1):(a=(0,_math.floor)(a,DECIMALS),u=(0,_math.floor)(u,DECIMALS)),(0,_tilecoord.createOrUpdate)(i,a,u,o)}},{key:"getTileCoordForCoordAndZ",value:function(e,t,i){return this.getTileCoordForXYAndZ_(e[0],e[1],t,!1,i)}},{key:"getTileCoordResolution",value:function(e){return this.resolutions_[e[0]]}},{key:"getTileSize",value:function(e){return this.tileSize_?this.tileSize_:this.tileSizes_[e]}},{key:"getFullTileRange",value:function(e){return this.fullTileRanges_?this.fullTileRanges_[e]:this.extent_?this.getTileRangeForExtentAndZ(this.extent_,e):null}},{key:"getZForResolution",value:function(e,t){var i=(0,_array.linearFindNearest)(this.resolutions_,e,t||0);return(0,_math.clamp)(i,this.minZoom,this.maxZoom)}},{key:"tileCoordIntersectsViewport",value:function(e,t){return(0,_intersectsextent.intersectsLinearRing)(t,0,t.length,2,this.getTileCoordExtent(e))}},{key:"calculateTileRanges_",value:function(e){for(var t=this.resolutions_.length,i=new Array(t),r=this.minZoom;r<t;++r)i[r]=this.getTileRangeForExtentAndZ(e,r);this.fullTileRanges_=i}}])}(),_default=exports.default=TileGrid;

},{"../TileRange.js":31,"../array.js":36,"../asserts.js":37,"../extent.js":59,"../geom/flat/intersectsextent.js":83,"../math.js":120,"../size.js":167,"../tilecoord.js":197,"./common.js":201}],200:[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.createFromCapabilitiesMatrixSet=createFromCapabilitiesMatrixSet,exports.default=void 0;var _TileGrid2=_interopRequireDefault(require("./TileGrid.js")),_proj=require("../proj.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,_toPropertyKey(i.key),i)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var WMTSTileGrid=function(e){function t(e){var r;return _classCallCheck(this,t),(r=_callSuper(this,t,[{extent:e.extent,origin:e.origin,origins:e.origins,resolutions:e.resolutions,tileSize:e.tileSize,tileSizes:e.tileSizes,sizes:e.sizes}])).matrixIds_=e.matrixIds,r}return _inherits(t,_TileGrid2["default"]),_createClass(t,[{key:"getMatrixId",value:function(e){return this.matrixIds_[e]}},{key:"getMatrixIds",value:function(){return this.matrixIds_}}])}(),_default=exports.default=WMTSTileGrid;function createFromCapabilitiesMatrixSet(e,t,r){var i=[],o=[],n=[],u=[],s=[];r=void 0!==r?r:[];var a=e.SupportedCRS,f=(0,_proj.get)(a),l=f.getMetersPerUnit(),c=f.getAxisOrientation().startsWith("ne");return e.TileMatrix.sort(function(e,t){return t.ScaleDenominator-e.ScaleDenominator}),e.TileMatrix.forEach(function(t){if(!(r.length>0)||r.find(function(r){return t.Identifier==r.TileMatrix||!t.Identifier.includes(":")&&e.Identifier+":"+t.Identifier===r.TileMatrix})){o.push(t.Identifier);var a=28e-5*t.ScaleDenominator/l,f=t.TileWidth,p=t.TileHeight;c?n.push([t.TopLeftCorner[1],t.TopLeftCorner[0]]):n.push(t.TopLeftCorner),i.push(a),u.push(f==p?f:[f,p]),s.push([t.MatrixWidth,t.MatrixHeight])}}),new WMTSTileGrid({extent:t,origins:n,resolutions:i,matrixIds:o,tileSizes:u,sizes:s})}

},{"../proj.js":123,"./TileGrid.js":199}],201:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.DEFAULT_TILE_SIZE=exports.DEFAULT_MAX_ZOOM=void 0;var DEFAULT_MAX_ZOOM=exports.DEFAULT_MAX_ZOOM=42,DEFAULT_TILE_SIZE=exports.DEFAULT_TILE_SIZE=256;

},{}],202:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.createFromTemplate=createFromTemplate,exports.createFromTemplates=createFromTemplates,exports.createFromTileUrlFunctions=createFromTileUrlFunctions,Object.defineProperty(exports,"expandUrl",{enumerable:!0,get:function(){return _uri.expandUrl}}),exports.nullTileUrlFunction=nullTileUrlFunction;var _math=require("./math.js"),_uri=require("./uri.js"),_tilecoord=require("./tilecoord.js");function createFromTemplate(e,r){return function(t,n,l){if(t){var o,i=t[0];if(r){var u=r.getFullTileRange(i);u&&(o=u.getHeight()-1)}return(0,_uri.renderXYZTemplate)(e,i,t[1],t[2],o)}}}function createFromTemplates(e,r){for(var t=e.length,n=new Array(t),l=0;l<t;++l)n[l]=createFromTemplate(e[l],r);return createFromTileUrlFunctions(n)}function createFromTileUrlFunctions(e){return 1===e.length?e[0]:function(r,t,n){if(r){var l=(0,_tilecoord.hash)(r),o=(0,_math.modulo)(l,e.length);return e[o](r,t,n)}}}function nullTileUrlFunction(e,r,t){}

},{"./math.js":120,"./tilecoord.js":197,"./uri.js":204}],203:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.apply=apply,exports.compose=compose,exports.composeCssTransform=composeCssTransform,exports.create=create,exports.determinant=determinant,exports.invert=invert,exports.makeInverse=makeInverse,exports.makeScale=makeScale,exports.multiply=multiply,exports.reset=reset,exports.rotate=rotate,exports.scale=scale,exports.set=set,exports.setFromArray=setFromArray,exports.toString=toString,exports.translate=translate;var _asserts=require("./asserts.js"),tmp_=new Array(6);function create(){return[1,0,0,1,0,0]}function reset(t){return set(t,1,0,0,1,0,0)}function multiply(t,e){var r=t[0],n=t[1],s=t[2],o=t[3],a=t[4],i=t[5],u=e[0],c=e[1],p=e[2],m=e[3],l=e[4],f=e[5];return t[0]=r*u+s*c,t[1]=n*u+o*c,t[2]=r*p+s*m,t[3]=n*p+o*m,t[4]=r*l+s*f+a,t[5]=n*l+o*f+i,t}function set(t,e,r,n,s,o,a){return t[0]=e,t[1]=r,t[2]=n,t[3]=s,t[4]=o,t[5]=a,t}function setFromArray(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t}function apply(t,e){var r=e[0],n=e[1];return e[0]=t[0]*r+t[2]*n+t[4],e[1]=t[1]*r+t[3]*n+t[5],e}function rotate(t,e){var r=Math.cos(e),n=Math.sin(e);return multiply(t,set(tmp_,r,n,-n,r,0,0))}function scale(t,e,r){return multiply(t,set(tmp_,e,0,0,r,0,0))}function makeScale(t,e,r){return set(t,e,0,0,r,0,0)}function translate(t,e,r){return multiply(t,set(tmp_,1,0,0,1,e,r))}function compose(t,e,r,n,s,o,a,i){var u=Math.sin(o),c=Math.cos(o);return t[0]=n*c,t[1]=s*u,t[2]=-n*u,t[3]=s*c,t[4]=a*n*c-i*n*u+e,t[5]=a*s*u+i*s*c+r,t}function composeCssTransform(t,e,r,n,s,o,a){return toString(compose(create(),t,e,r,n,s,o,a))}function invert(t){return makeInverse(t,t)}function makeInverse(t,e){var r=determinant(e);(0,_asserts.assert)(0!==r,"Transformation matrix cannot be inverted");var n=e[0],s=e[1],o=e[2],a=e[3],i=e[4],u=e[5];return t[0]=a/r,t[1]=-s/r,t[2]=-o/r,t[3]=n/r,t[4]=(o*u-a*i)/r,t[5]=-(n*u-s*i)/r,t}function determinant(t){return t[0]*t[3]-t[1]*t[2]}var matrixPrecision=[1e6,1e6,1e6,1e6,2,2];function toString(t){return"matrix("+t.map(function(t,e){return Math.round(t*matrixPrecision[e])/matrixPrecision[e]}).join(", ")+")"}

},{"./asserts.js":37}],204:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.appendParams=appendParams,exports.expandUrl=expandUrl,exports.pickUrl=pickUrl,exports.renderXYZTemplate=renderXYZTemplate;var _tilecoord=require("./tilecoord.js"),_math=require("./math.js");function appendParams(e,r){var t=[];Object.keys(r).forEach(function(e){null!==r[e]&&void 0!==r[e]&&t.push(e+"="+encodeURIComponent(r[e]))});var a=t.join("&");return e=e.replace(/[?&]$/,""),(e+=e.includes("?")?"&":"?")+a}var zRegEx=/\{z\}/g,xRegEx=/\{x\}/g,yRegEx=/\{y\}/g,dashYRegEx=/\{-y\}/g;function renderXYZTemplate(e,r,t,a,n){return e.replace(zRegEx,r.toString()).replace(xRegEx,t.toString()).replace(yRegEx,a.toString()).replace(dashYRegEx,function(){if(void 0===n)throw new Error("If the URL template has a {-y} placeholder, the grid extent must be known");return(n-a).toString()})}function pickUrl(e,r,t,a){var n=(0,_tilecoord.hashZXY)(r,t,a);return e[(0,_math.modulo)(n,e.length)]}function expandUrl(e){var r=[],t=/\{([a-z])-([a-z])\}/.exec(e);if(t){var a,n=t[1].charCodeAt(0),o=t[2].charCodeAt(0);for(a=n;a<=o;++a)r.push(e.replace(t[0],String.fromCharCode(a)));return r}if(t=/\{(\d+)-(\d+)\}/.exec(e)){for(var p=parseInt(t[2],10),c=parseInt(t[1],10);c<=p;c++)r.push(e.replace(t[0],c.toString()));return r}return r.push(e),r}

},{"./math.js":120,"./tilecoord.js":197}],205:[function(require,module,exports){
"use strict";function _abstract(){throw new Error("Unimplemented abstract method.")}Object.defineProperty(exports,"__esModule",{value:!0}),exports.VERSION=void 0,exports.abstract=_abstract,exports.getUid=getUid;var uidCounter_=0;function getUid(t){return t.ol_uid||(t.ol_uid=String(++uidCounter_))}var VERSION=exports.VERSION="10.0.0";

},{}],206:[function(require,module,exports){
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}!function(t,s){"object"===("undefined"==typeof exports?"undefined":_typeof(exports))&&"undefined"!=typeof module?module.exports=s():"function"==typeof define&&define.amd?define(s):(void 0).proj4=s()}(0,function(){var t=1,s=2,i=3,a=4,h=5,e=484813681109536e-20,n=Math.PI/2,r=.16666666666666666,o=.04722222222222222,l=.022156084656084655,u=1e-10,c=.017453292519943295,M=57.29577951308232,f=Math.PI/4,d=2*Math.PI,p=3.14159265359,m={greenwich:0,lisbon:-9.131906111111,paris:2.337229166667,bogota:-74.080916666667,madrid:-3.687938888889,rome:12.452333333333,bern:7.439583333333,jakarta:106.807719444444,ferro:-17.666666666667,brussels:4.367975,stockholm:18.058277777778,athens:23.7163375,oslo:10.722916666667},y={ft:{to_meter:.3048},"us-ft":{to_meter:1200/3937}},_=/[\s_\-\/\(\)]/g;function x(t,s){if(t[s])return t[s];for(var i,a=Object.keys(t),h=s.toLowerCase().replace(_,""),e=-1;++e<a.length;)if((i=a[e]).toLowerCase().replace(_,"")===h)return t[i]}var g=function(t){var s,i,a,h={},e=t.split("+").map(function(t){return t.trim()}).filter(function(t){return t}).reduce(function(t,s){var i=s.split("=");return i.push(!0),t[i[0].toLowerCase()]=i[1],t},{}),n={proj:"projName",datum:"datumCode",rf:function(t){h.rf=parseFloat(t)},lat_0:function(t){h.lat0=t*c},lat_1:function(t){h.lat1=t*c},lat_2:function(t){h.lat2=t*c},lat_ts:function(t){h.lat_ts=t*c},lon_0:function(t){h.long0=t*c},lon_1:function(t){h.long1=t*c},lon_2:function(t){h.long2=t*c},alpha:function(t){h.alpha=parseFloat(t)*c},gamma:function(t){h.rectified_grid_angle=parseFloat(t)},lonc:function(t){h.longc=t*c},x_0:function(t){h.x0=parseFloat(t)},y_0:function(t){h.y0=parseFloat(t)},k_0:function(t){h.k0=parseFloat(t)},k:function(t){h.k0=parseFloat(t)},a:function(t){h.a=parseFloat(t)},b:function(t){h.b=parseFloat(t)},r:function(t){h.a=h.b=parseFloat(t)},r_a:function(){h.R_A=!0},zone:function(t){h.zone=parseInt(t,10)},south:function(){h.utmSouth=!0},towgs84:function(t){h.datum_params=t.split(",").map(function(t){return parseFloat(t)})},to_meter:function(t){h.to_meter=parseFloat(t)},units:function(t){h.units=t;var s=x(y,t);s&&(h.to_meter=s.to_meter)},from_greenwich:function(t){h.from_greenwich=t*c},pm:function(t){var s=x(m,t);h.from_greenwich=(s||parseFloat(t))*c},nadgrids:function(t){"@null"===t?h.datumCode="none":h.nadgrids=t},axis:function(t){3===t.length&&-1!=="ewnsud".indexOf(t.substr(0,1))&&-1!=="ewnsud".indexOf(t.substr(1,1))&&-1!=="ewnsud".indexOf(t.substr(2,1))&&(h.axis=t)},approx:function(){h.approx=!0}};for(s in e)i=e[s],s in n?"function"==typeof(a=n[s])?a(i):h[a]=i:h[s]=i;return"string"==typeof h.datumCode&&"WGS84"!==h.datumCode&&(h.datumCode=h.datumCode.toLowerCase()),h},v=1,b=/\s/,w=/[A-Za-z]/,N=/[A-Za-z84_]/,E=/[,\]]/,A=/[\d\.E\-\+]/;function C(t){if("string"!=typeof t)throw new Error("not a string");this.text=t.trim(),this.level=0,this.place=0,this.root=null,this.stack=[],this.currentObject=null,this.state=v}function P(t,s,i){Array.isArray(s)&&(i.unshift(s),s=null);var a=s?{}:t,h=i.reduce(function(t,s){return S(s,t),t},a);s&&(t[s]=h)}function S(t,s){if(Array.isArray(t)){var i=t.shift();if("PARAMETER"===i&&(i=t.shift()),1===t.length)return Array.isArray(t[0])?(s[i]={},void S(t[0],s[i])):void(s[i]=t[0]);if(t.length)if("TOWGS84"!==i){if("AXIS"===i)return i in s||(s[i]=[]),void s[i].push(t);var a;switch(Array.isArray(i)||(s[i]={}),i){case"UNIT":case"PRIMEM":case"VERT_DATUM":return s[i]={name:t[0].toLowerCase(),convert:t[1]},void(3===t.length&&S(t[2],s[i]));case"SPHEROID":case"ELLIPSOID":return s[i]={name:t[0],a:t[1],rf:t[2]},void(4===t.length&&S(t[3],s[i]));case"PROJECTEDCRS":case"PROJCRS":case"GEOGCS":case"GEOCCS":case"PROJCS":case"LOCAL_CS":case"GEODCRS":case"GEODETICCRS":case"GEODETICDATUM":case"EDATUM":case"ENGINEERINGDATUM":case"VERT_CS":case"VERTCRS":case"VERTICALCRS":case"COMPD_CS":case"COMPOUNDCRS":case"ENGINEERINGCRS":case"ENGCRS":case"FITTED_CS":case"LOCAL_DATUM":case"DATUM":return t[0]=["name",t[0]],void P(s,i,t);default:for(a=-1;++a<t.length;)if(!Array.isArray(t[a]))return S(t,s[i]);return P(s,i,t)}}else s[i]=t;else s[i]=!0}else s[t]=!0}C.prototype.readCharicter=function(){var t=this.text[this.place++];if(4!==this.state)for(;b.test(t);){if(this.place>=this.text.length)return;t=this.text[this.place++]}switch(this.state){case v:return this.neutral(t);case 2:return this.keyword(t);case 4:return this.quoted(t);case 5:return this.afterquote(t);case 3:return this.number(t);case-1:return}},C.prototype.afterquote=function(t){if('"'===t)return this.word+='"',void(this.state=4);if(E.test(t))return this.word=this.word.trim(),void this.afterItem(t);throw new Error("havn't handled \""+t+'" in afterquote yet, index '+this.place)},C.prototype.afterItem=function(t){return","===t?(null!==this.word&&this.currentObject.push(this.word),this.word=null,void(this.state=v)):"]"===t?(this.level--,null!==this.word&&(this.currentObject.push(this.word),this.word=null),this.state=v,this.currentObject=this.stack.pop(),void(this.currentObject||(this.state=-1))):void 0},C.prototype.number=function(t){if(!A.test(t)){if(E.test(t))return this.word=parseFloat(this.word),void this.afterItem(t);throw new Error("havn't handled \""+t+'" in number yet, index '+this.place)}this.word+=t},C.prototype.quoted=function(t){'"'!==t?this.word+=t:this.state=5},C.prototype.keyword=function(t){if(N.test(t))this.word+=t;else{if("["===t){var s=[];return s.push(this.word),this.level++,null===this.root?this.root=s:this.currentObject.push(s),this.stack.push(this.currentObject),this.currentObject=s,void(this.state=v)}if(!E.test(t))throw new Error("havn't handled \""+t+'" in keyword yet, index '+this.place);this.afterItem(t)}},C.prototype.neutral=function(t){if(w.test(t))return this.word=t,void(this.state=2);if('"'===t)return this.word="",void(this.state=4);if(A.test(t))return this.word=t,void(this.state=3);if(!E.test(t))throw new Error("havn't handled \""+t+'" in neutral yet, index '+this.place);this.afterItem(t)},C.prototype.output=function(){for(;this.place<this.text.length;)this.readCharicter();if(-1===this.state)return this.root;throw new Error('unable to parse string "'+this.text+'". State is '+this.state)};var I=.017453292519943295;function O(t){return t*I}var k=function(t){var s=new C(t).output(),i=s.shift(),a=s.shift();s.unshift(["name",a]),s.unshift(["type",i]);var h={};return S(s,h),function(t){if("GEOGCS"===t.type?t.projName="longlat":"LOCAL_CS"===t.type?(t.projName="identity",t.local=!0):"object"===_typeof(t.PROJECTION)?t.projName=Object.keys(t.PROJECTION)[0]:t.projName=t.PROJECTION,t.AXIS){for(var s="",i=0,a=t.AXIS.length;i<a;++i){var h=[t.AXIS[i][0].toLowerCase(),t.AXIS[i][1].toLowerCase()];-1!==h[0].indexOf("north")||("y"===h[0]||"lat"===h[0])&&"north"===h[1]?s+="n":-1!==h[0].indexOf("south")||("y"===h[0]||"lat"===h[0])&&"south"===h[1]?s+="s":-1!==h[0].indexOf("east")||("x"===h[0]||"lon"===h[0])&&"east"===h[1]?s+="e":-1===h[0].indexOf("west")&&("x"!==h[0]&&"lon"!==h[0]||"west"!==h[1])||(s+="w")}2===s.length&&(s+="u"),3===s.length&&(t.axis=s)}t.UNIT&&(t.units=t.UNIT.name.toLowerCase(),"metre"===t.units&&(t.units="meter"),t.UNIT.convert&&("GEOGCS"===t.type?t.DATUM&&t.DATUM.SPHEROID&&(t.to_meter=t.UNIT.convert*t.DATUM.SPHEROID.a):t.to_meter=t.UNIT.convert));var e=t.GEOGCS;function n(s){return s*(t.to_meter||1)}"GEOGCS"===t.type&&(e=t),e&&(e.DATUM?t.datumCode=e.DATUM.name.toLowerCase():t.datumCode=e.name.toLowerCase(),"d_"===t.datumCode.slice(0,2)&&(t.datumCode=t.datumCode.slice(2)),"new_zealand_geodetic_datum_1949"!==t.datumCode&&"new_zealand_1949"!==t.datumCode||(t.datumCode="nzgd49"),"wgs_1984"!==t.datumCode&&"world_geodetic_system_1984"!==t.datumCode||("Mercator_Auxiliary_Sphere"===t.PROJECTION&&(t.sphere=!0),t.datumCode="wgs84"),"_ferro"===t.datumCode.slice(-6)&&(t.datumCode=t.datumCode.slice(0,-6)),"_jakarta"===t.datumCode.slice(-8)&&(t.datumCode=t.datumCode.slice(0,-8)),~t.datumCode.indexOf("belge")&&(t.datumCode="rnb72"),e.DATUM&&e.DATUM.SPHEROID&&(t.ellps=e.DATUM.SPHEROID.name.replace("_19","").replace(/[Cc]larke\_18/,"clrk"),"international"===t.ellps.toLowerCase().slice(0,13)&&(t.ellps="intl"),t.a=e.DATUM.SPHEROID.a,t.rf=parseFloat(e.DATUM.SPHEROID.rf,10)),e.DATUM&&e.DATUM.TOWGS84&&(t.datum_params=e.DATUM.TOWGS84),~t.datumCode.indexOf("osgb_1936")&&(t.datumCode="osgb36"),~t.datumCode.indexOf("osni_1952")&&(t.datumCode="osni52"),(~t.datumCode.indexOf("tm65")||~t.datumCode.indexOf("geodetic_datum_of_1965"))&&(t.datumCode="ire65"),"ch1903+"===t.datumCode&&(t.datumCode="ch1903"),~t.datumCode.indexOf("israel")&&(t.datumCode="isr93")),t.b&&!isFinite(t.b)&&(t.b=t.a),[["standard_parallel_1","Standard_Parallel_1"],["standard_parallel_1","Latitude of 1st standard parallel"],["standard_parallel_2","Standard_Parallel_2"],["standard_parallel_2","Latitude of 2nd standard parallel"],["false_easting","False_Easting"],["false_easting","False easting"],["false-easting","Easting at false origin"],["false_northing","False_Northing"],["false_northing","False northing"],["false_northing","Northing at false origin"],["central_meridian","Central_Meridian"],["central_meridian","Longitude of natural origin"],["central_meridian","Longitude of false origin"],["latitude_of_origin","Latitude_Of_Origin"],["latitude_of_origin","Central_Parallel"],["latitude_of_origin","Latitude of natural origin"],["latitude_of_origin","Latitude of false origin"],["scale_factor","Scale_Factor"],["k0","scale_factor"],["latitude_of_center","Latitude_Of_Center"],["latitude_of_center","Latitude_of_center"],["lat0","latitude_of_center",O],["longitude_of_center","Longitude_Of_Center"],["longitude_of_center","Longitude_of_center"],["longc","longitude_of_center",O],["x0","false_easting",n],["y0","false_northing",n],["long0","central_meridian",O],["lat0","latitude_of_origin",O],["lat0","standard_parallel_1",O],["lat1","standard_parallel_1",O],["lat2","standard_parallel_2",O],["azimuth","Azimuth"],["alpha","azimuth",O],["srsCode","name"]].forEach(function(s){return i=t,h=(a=s)[0],e=a[1],void(!(h in i)&&e in i&&(i[h]=i[e],3===a.length&&(i[h]=a[2](i[h]))));var i,a,h,e}),t.long0||!t.longc||"Albers_Conic_Equal_Area"!==t.projName&&"Lambert_Azimuthal_Equal_Area"!==t.projName||(t.long0=t.longc),t.lat_ts||!t.lat1||"Stereographic_South_Pole"!==t.projName&&"Polar Stereographic (variant B)"!==t.projName?!t.lat_ts&&t.lat0&&"Polar_Stereographic"===t.projName&&(t.lat_ts=t.lat0,t.lat0=O(t.lat0>0?90:-90)):(t.lat0=O(t.lat1>0?90:-90),t.lat_ts=t.lat1)}(h),h};function q(t){var s=this;if(2===arguments.length){var i=arguments[1];"string"==typeof i?"+"===i.charAt(0)?q[t]=g(arguments[1]):q[t]=k(arguments[1]):q[t]=i}else if(1===arguments.length){if(Array.isArray(t))return t.map(function(t){Array.isArray(t)?q.apply(s,t):q(t)});if("string"==typeof t){if(t in q)return q[t]}else"EPSG"in t?q["EPSG:"+t.EPSG]=t:"ESRI"in t?q["ESRI:"+t.ESRI]=t:"IAU2000"in t?q["IAU2000:"+t.IAU2000]=t:console.log(t);return}}!function(t){t("EPSG:4326","+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees"),t("EPSG:4269","+title=NAD83 (long/lat) +proj=longlat +a=6378137.0 +b=6356752.31414036 +ellps=GRS80 +datum=NAD83 +units=degrees"),t("EPSG:3857","+title=WGS 84 / Pseudo-Mercator +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs"),t.WGS84=t["EPSG:4326"],t["EPSG:3785"]=t["EPSG:3857"],t.GOOGLE=t["EPSG:3857"],t["EPSG:900913"]=t["EPSG:3857"],t["EPSG:102113"]=t["EPSG:3857"]}(q);var R=["PROJECTEDCRS","PROJCRS","GEOGCS","GEOCCS","PROJCS","LOCAL_CS","GEODCRS","GEODETICCRS","GEODETICDATUM","ENGCRS","ENGINEERINGCRS"];var L=["3857","900913","3785","102113"];function j(t){if(!function(t){return"string"==typeof t}(t))return t;if(function(t){return t in q}(t))return q[t];if(function(t){return R.some(function(s){return t.indexOf(s)>-1})}(t)){var s=k(t);if(function(t){var s=x(t,"authority");if(s){var i=x(s,"epsg");return i&&L.indexOf(i)>-1}}(s))return q["EPSG:3857"];var i=function(t){var s=x(t,"extension");if(s)return x(s,"proj4")}(s);return i?g(i):s}return function(t){return"+"===t[0]}(t)?g(t):void 0}var G=function(t,s){var i,a;if(t=t||{},!s)return t;for(a in s)void 0!==(i=s[a])&&(t[a]=i);return t},T=function(t,s,i){var a=t*s;return i/Math.sqrt(1-a*a)},B=function(t){return t<0?-1:1},z=function(t){return Math.abs(t)<=p?t:t-B(t)*d},F=function(t,s,i){var a=t*i,h=.5*t;return a=Math.pow((1-a)/(1+a),h),Math.tan(.5*(n-s))/a},D=function(t,s){for(var i,a,h=.5*t,e=n-2*Math.atan(s),r=0;r<=15;r++)if(i=t*Math.sin(e),e+=a=n-2*Math.atan(s*Math.pow((1-i)/(1+i),h))-e,Math.abs(a)<=1e-10)return e;return-9999};function U(t){return t}var Q=[{init:function(){var t=this.b/this.a;this.es=1-t*t,"x0"in this||(this.x0=0),"y0"in this||(this.y0=0),this.e=Math.sqrt(this.es),this.lat_ts?this.sphere?this.k0=Math.cos(this.lat_ts):this.k0=T(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)):this.k0||(this.k?this.k0=this.k:this.k0=1)},forward:function(t){var s,i,a=t.x,h=t.y;if(h*M>90&&h*M<-90&&a*M>180&&a*M<-180)return null;if(Math.abs(Math.abs(h)-n)<=u)return null;if(this.sphere)s=this.x0+this.a*this.k0*z(a-this.long0),i=this.y0+this.a*this.k0*Math.log(Math.tan(f+.5*h));else{var e=Math.sin(h),r=F(this.e,h,e);s=this.x0+this.a*this.k0*z(a-this.long0),i=this.y0-this.a*this.k0*Math.log(r)}return t.x=s,t.y=i,t},inverse:function(t){var s,i,a=t.x-this.x0,h=t.y-this.y0;if(this.sphere)i=n-2*Math.atan(Math.exp(-h/(this.a*this.k0)));else{var e=Math.exp(-h/(this.a*this.k0));if(-9999===(i=D(this.e,e)))return null}return s=z(this.long0+a/(this.a*this.k0)),t.x=s,t.y=i,t},names:["Mercator","Popular Visualisation Pseudo Mercator","Mercator_1SP","Mercator_Auxiliary_Sphere","merc"]},{init:function(){},forward:U,inverse:U,names:["longlat","identity"]}],W={},H=[];function X(t,s){var i=H.length;return t.names?(H[i]=t,t.names.forEach(function(t){W[t.toLowerCase()]=i}),this):(console.log(s),!0)}var K={start:function(){Q.forEach(X)},add:X,get:function(t){if(!t)return!1;var s=t.toLowerCase();return void 0!==W[s]&&H[W[s]]?H[W[s]]:void 0}},J={MERIT:{a:6378137,rf:298.257,ellipseName:"MERIT 1983"},SGS85:{a:6378136,rf:298.257,ellipseName:"Soviet Geodetic System 85"},GRS80:{a:6378137,rf:298.257222101,ellipseName:"GRS 1980(IUGG, 1980)"},IAU76:{a:6378140,rf:298.257,ellipseName:"IAU 1976"},airy:{a:6377563.396,b:6356256.91,ellipseName:"Airy 1830"},APL4:{a:6378137,rf:298.25,ellipseName:"Appl. Physics. 1965"},NWL9D:{a:6378145,rf:298.25,ellipseName:"Naval Weapons Lab., 1965"},mod_airy:{a:6377340.189,b:6356034.446,ellipseName:"Modified Airy"},andrae:{a:6377104.43,rf:300,ellipseName:"Andrae 1876 (Den., Iclnd.)"},aust_SA:{a:6378160,rf:298.25,ellipseName:"Australian Natl & S. Amer. 1969"},GRS67:{a:6378160,rf:298.247167427,ellipseName:"GRS 67(IUGG 1967)"},bessel:{a:6377397.155,rf:299.1528128,ellipseName:"Bessel 1841"},bess_nam:{a:6377483.865,rf:299.1528128,ellipseName:"Bessel 1841 (Namibia)"},clrk66:{a:6378206.4,b:6356583.8,ellipseName:"Clarke 1866"},clrk80:{a:6378249.145,rf:293.4663,ellipseName:"Clarke 1880 mod."},clrk80ign:{a:6378249.2,b:6356515,rf:293.4660213,ellipseName:"Clarke 1880 (IGN)"},clrk58:{a:6378293.645208759,rf:294.2606763692654,ellipseName:"Clarke 1858"},CPM:{a:6375738.7,rf:334.29,ellipseName:"Comm. des Poids et Mesures 1799"},delmbr:{a:6376428,rf:311.5,ellipseName:"Delambre 1810 (Belgium)"},engelis:{a:6378136.05,rf:298.2566,ellipseName:"Engelis 1985"},evrst30:{a:6377276.345,rf:300.8017,ellipseName:"Everest 1830"},evrst48:{a:6377304.063,rf:300.8017,ellipseName:"Everest 1948"},evrst56:{a:6377301.243,rf:300.8017,ellipseName:"Everest 1956"},evrst69:{a:6377295.664,rf:300.8017,ellipseName:"Everest 1969"},evrstSS:{a:6377298.556,rf:300.8017,ellipseName:"Everest (Sabah & Sarawak)"},fschr60:{a:6378166,rf:298.3,ellipseName:"Fischer (Mercury Datum) 1960"},fschr60m:{a:6378155,rf:298.3,ellipseName:"Fischer 1960"},fschr68:{a:6378150,rf:298.3,ellipseName:"Fischer 1968"},helmert:{a:6378200,rf:298.3,ellipseName:"Helmert 1906"},hough:{a:6378270,rf:297,ellipseName:"Hough"},intl:{a:6378388,rf:297,ellipseName:"International 1909 (Hayford)"},kaula:{a:6378163,rf:298.24,ellipseName:"Kaula 1961"},lerch:{a:6378139,rf:298.257,ellipseName:"Lerch 1979"},mprts:{a:6397300,rf:191,ellipseName:"Maupertius 1738"},new_intl:{a:6378157.5,b:6356772.2,ellipseName:"New International 1967"},plessis:{a:6376523,rf:6355863,ellipseName:"Plessis 1817 (France)"},krass:{a:6378245,rf:298.3,ellipseName:"Krassovsky, 1942"},SEasia:{a:6378155,b:6356773.3205,ellipseName:"Southeast Asia"},walbeck:{a:6376896,b:6355834.8467,ellipseName:"Walbeck"},WGS60:{a:6378165,rf:298.3,ellipseName:"WGS 60"},WGS66:{a:6378145,rf:298.25,ellipseName:"WGS 66"},WGS7:{a:6378135,rf:298.26,ellipseName:"WGS 72"}},V=J.WGS84={a:6378137,rf:298.257223563,ellipseName:"WGS 84"};J.sphere={a:6370997,b:6370997,ellipseName:"Normal Sphere (r=6370997)"};var Z={};Z.wgs84={towgs84:"0,0,0",ellipse:"WGS84",datumName:"WGS84"},Z.ch1903={towgs84:"674.374,15.056,405.346",ellipse:"bessel",datumName:"swiss"},Z.ggrs87={towgs84:"-199.87,74.79,246.62",ellipse:"GRS80",datumName:"Greek_Geodetic_Reference_System_1987"},Z.nad83={towgs84:"0,0,0",ellipse:"GRS80",datumName:"North_American_Datum_1983"},Z.nad27={nadgrids:"@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat",ellipse:"clrk66",datumName:"North_American_Datum_1927"},Z.potsdam={towgs84:"598.1,73.7,418.2,0.202,0.045,-2.455,6.7",ellipse:"bessel",datumName:"Potsdam Rauenberg 1950 DHDN"},Z.carthage={towgs84:"-263.0,6.0,431.0",ellipse:"clark80",datumName:"Carthage 1934 Tunisia"},Z.hermannskogel={towgs84:"577.326,90.129,463.919,5.137,1.474,5.297,2.4232",ellipse:"bessel",datumName:"Hermannskogel"},Z.militargeographische_institut={towgs84:"577.326,90.129,463.919,5.137,1.474,5.297,2.4232",ellipse:"bessel",datumName:"Militar-Geographische Institut"},Z.osni52={towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"airy",datumName:"Irish National"},Z.ire65={towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"mod_airy",datumName:"Ireland 1965"},Z.rassadiran={towgs84:"-133.63,-157.5,-158.62",ellipse:"intl",datumName:"Rassadiran"},Z.nzgd49={towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993",ellipse:"intl",datumName:"New Zealand Geodetic Datum 1949"},Z.osgb36={towgs84:"446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894",ellipse:"airy",datumName:"Airy 1830"},Z.s_jtsk={towgs84:"589,76,480",ellipse:"bessel",datumName:"S-JTSK (Ferro)"},Z.beduaram={towgs84:"-106,-87,188",ellipse:"clrk80",datumName:"Beduaram"},Z.gunung_segara={towgs84:"-403,684,41",ellipse:"bessel",datumName:"Gunung Segara Jakarta"},Z.rnb72={towgs84:"106.869,-52.2978,103.724,-0.33657,0.456955,-1.84218,1",ellipse:"intl",datumName:"Reseau National Belge 1972"};var Y={};function $(t){if(0===t.length)return null;var s="@"===t[0];return s&&(t=t.slice(1)),"null"===t?{name:"null",mandatory:!s,grid:null,isNull:!0}:{name:t,mandatory:!s,grid:Y[t]||null,isNull:!1}}function tt(t){return t/3600*Math.PI/180}function st(t,s,i){return String.fromCharCode.apply(null,new Uint8Array(t.buffer.slice(s,i)))}function it(t){return t.map(function(t){return[tt(t.longitudeShift),tt(t.latitudeShift)]})}function at(t,s,i){return{name:st(t,s+8,s+16).trim(),parent:st(t,s+24,s+24+8).trim(),lowerLatitude:t.getFloat64(s+72,i),upperLatitude:t.getFloat64(s+88,i),lowerLongitude:t.getFloat64(s+104,i),upperLongitude:t.getFloat64(s+120,i),latitudeInterval:t.getFloat64(s+136,i),longitudeInterval:t.getFloat64(s+152,i),gridNodeCount:t.getInt32(s+168,i)}}function ht(t,s,i,a){for(var h=s+176,e=[],n=0;n<i.gridNodeCount;n++){var r={latitudeShift:t.getFloat32(h+16*n,a),longitudeShift:t.getFloat32(h+16*n+4,a),latitudeAccuracy:t.getFloat32(h+16*n+8,a),longitudeAccuracy:t.getFloat32(h+16*n+12,a)};e.push(r)}return e}function et(n,c){if(!(this instanceof et))return new et(n);c=c||function(t){if(t)throw t};var M=j(n);if("object"===_typeof(M)){var f=et.projections.get(M.projName);if(f){if(M.datumCode&&"none"!==M.datumCode){var d=x(Z,M.datumCode);d&&(M.datum_params=M.datum_params||(d.towgs84?d.towgs84.split(","):null),M.ellps=d.ellipse,M.datumName=d.datumName?d.datumName:M.datumCode)}M.k0=M.k0||1,M.axis=M.axis||"enu",M.ellps=M.ellps||"wgs84",M.lat1=M.lat1||M.lat0;var p,m,y,_,g,v,b,w=function(t,s,i,a,h){if(!t){var e=x(J,a);e||(e=V),t=e.a,s=e.b,i=e.rf}return i&&!s&&(s=(1-1/i)*t),(0===i||Math.abs(t-s)<u)&&(h=!0,s=t),{a:t,b:s,rf:i,sphere:h}}(M.a,M.b,M.rf,M.ellps,M.sphere),N=(p=w.a,m=w.b,w.rf,y=M.R_A,v=((_=p*p)-(g=m*m))/_,b=0,y?(_=(p*=1-v*(r+v*(o+v*l)))*p,v=0):b=Math.sqrt(v),{es:v,e:b,ep2:(_-g)/g}),E=function(t){return void 0===t?null:t.split(",").map($)}(M.nadgrids),A=M.datum||function(n,r,o,l,u,c,M){var f={};return f.datum_type=void 0===n||"none"===n?h:a,r&&(f.datum_params=r.map(parseFloat),0===f.datum_params[0]&&0===f.datum_params[1]&&0===f.datum_params[2]||(f.datum_type=t),f.datum_params.length>3&&(0===f.datum_params[3]&&0===f.datum_params[4]&&0===f.datum_params[5]&&0===f.datum_params[6]||(f.datum_type=s,f.datum_params[3]*=e,f.datum_params[4]*=e,f.datum_params[5]*=e,f.datum_params[6]=f.datum_params[6]/1e6+1))),M&&(f.datum_type=i,f.grids=M),f.a=o,f.b=l,f.es=u,f.ep2=c,f}(M.datumCode,M.datum_params,w.a,w.b,N.es,N.ep2,E);G(this,M),G(this,f),this.a=w.a,this.b=w.b,this.rf=w.rf,this.sphere=w.sphere,this.es=N.es,this.e=N.e,this.ep2=N.ep2,this.datum=A,this.init(),c(null,this)}else c("Could not get projection name from: "+n)}else c("Could not parse to valid json: "+n)}function nt(t,s,i){var a,h,e,r,o=t.x,l=t.y,u=t.z?t.z:0;if(l<-n&&l>-1.001*n)l=-n;else if(l>n&&l<1.001*n)l=n;else{if(l<-n)return{x:-1/0,y:-1/0,z:t.z};if(l>n)return{x:1/0,y:1/0,z:t.z}}return o>Math.PI&&(o-=2*Math.PI),h=Math.sin(l),r=Math.cos(l),e=h*h,{x:((a=i/Math.sqrt(1-s*e))+u)*r*Math.cos(o),y:(a+u)*r*Math.sin(o),z:(a*(1-s)+u)*h}}function rt(t,s,i,a){var h,e,r,o,l,u,c,M,f,d,p,m,y,_,x,g=t.x,v=t.y,b=t.z?t.z:0;if(h=Math.sqrt(g*g+v*v),e=Math.sqrt(g*g+v*v+b*b),h/i<1e-12){if(_=0,e/i<1e-12)return n,x=-a,{x:t.x,y:t.y,z:t.z}}else _=Math.atan2(v,g);r=b/e,M=(o=h/e)*(1-s)*(l=1/Math.sqrt(1-s*(2-s)*o*o)),f=r*l,y=0;do{y++,u=s*(c=i/Math.sqrt(1-s*f*f))/(c+(x=h*M+b*f-c*(1-s*f*f))),m=(p=r*(l=1/Math.sqrt(1-u*(2-u)*o*o)))*M-(d=o*(1-u)*l)*f,M=d,f=p}while(m*m>1e-24&&y<30);return{x:_,y:Math.atan(p/Math.abs(d)),z:x}}function ot(i){return i===t||i===s}et.projections=K,et.projections.start();var lt=function(a,e,n){if(function(i,a){return i.datum_type===a.datum_type&&!(i.a!==a.a||Math.abs(i.es-a.es)>5e-11)&&(i.datum_type===t?i.datum_params[0]===a.datum_params[0]&&i.datum_params[1]===a.datum_params[1]&&i.datum_params[2]===a.datum_params[2]:i.datum_type!==s||i.datum_params[0]===a.datum_params[0]&&i.datum_params[1]===a.datum_params[1]&&i.datum_params[2]===a.datum_params[2]&&i.datum_params[3]===a.datum_params[3]&&i.datum_params[4]===a.datum_params[4]&&i.datum_params[5]===a.datum_params[5]&&i.datum_params[6]===a.datum_params[6])}(a,e))return n;if(a.datum_type===h||e.datum_type===h)return n;var r=a.a,o=a.es;if(a.datum_type===i){if(0!==ut(a,!1,n))return;r=6378137,o=.0066943799901413165}var l=e.a,u=e.b,c=e.es;if(e.datum_type===i&&(l=6378137,u=6356752.314,c=.0066943799901413165),o===c&&r===l&&!ot(a.datum_type)&&!ot(e.datum_type))return n;if((n=nt(n,o,r),ot(a.datum_type)&&(n=function(i,a,h){if(a===t)return{x:i.x+h[0],y:i.y+h[1],z:i.z+h[2]};if(a===s){var e=h[0],n=h[1],r=h[2],o=h[3],l=h[4],u=h[5],c=h[6];return{x:c*(i.x-u*i.y+l*i.z)+e,y:c*(u*i.x+i.y-o*i.z)+n,z:c*(-l*i.x+o*i.y+i.z)+r}}}(n,a.datum_type,a.datum_params)),ot(e.datum_type)&&(n=function(i,a,h){if(a===t)return{x:i.x-h[0],y:i.y-h[1],z:i.z-h[2]};if(a===s){var e=h[0],n=h[1],r=h[2],o=h[3],l=h[4],u=h[5],c=h[6],M=(i.x-e)/c,f=(i.y-n)/c,d=(i.z-r)/c;return{x:M+u*f-l*d,y:-u*M+f+o*d,z:l*M-o*f+d}}}(n,e.datum_type,e.datum_params)),n=rt(n,c,l,u),e.datum_type===i)&&0!==ut(e,!0,n))return;return n};function ut(t,s,i){if(null===t.grids||0===t.grids.length)return console.log("Grid shift grids not found"),-1;var a={x:-i.x,y:i.y},h={x:Number.NaN,y:Number.NaN},e=[];t:for(var n=0;n<t.grids.length;n++){var r=t.grids[n];if(e.push(r.name),r.isNull){h=a;break}if(null!==r.grid)for(var o=r.grid.subgrids,l=0,u=o.length;l<u;l++){var c=o[l],f=(Math.abs(c.del[1])+Math.abs(c.del[0]))/1e4,d=c.ll[0]-f,p=c.ll[1]-f,m=c.ll[0]+(c.lim[0]-1)*c.del[0]+f,y=c.ll[1]+(c.lim[1]-1)*c.del[1]+f;if(!(p>a.y||d>a.x||y<a.y||m<a.x)&&(h=ct(a,s,c),!isNaN(h.x)))break t}else if(r.mandatory)return console.log("Unable to find mandatory grid '"+r.name+"'"),-1}return isNaN(h.x)?(console.log("Failed to find a grid shift table for location '"+-a.x*M+" "+a.y*M+" tried: '"+e+"'"),-1):(i.x=-h.x,i.y=h.y,0)}function ct(t,s,i){var a={x:Number.NaN,y:Number.NaN};if(isNaN(t.x))return a;var h={x:t.x,y:t.y};h.x-=i.ll[0],h.y-=i.ll[1],h.x=z(h.x-Math.PI)+Math.PI;var e=Mt(h,i);if(s){if(isNaN(e.x))return a;e.x=h.x-e.x,e.y=h.y-e.y;var n,r,o=9;do{if(r=Mt(e,i),isNaN(r.x)){console.log("Inverse grid shift iteration failed, presumably at grid edge.  Using first approximation.");break}n={x:h.x-(r.x+e.x),y:h.y-(r.y+e.y)},e.x+=n.x,e.y+=n.y}while(o--&&Math.abs(n.x)>1e-12&&Math.abs(n.y)>1e-12);if(o<0)return console.log("Inverse grid shift iterator failed to converge."),a;a.x=z(e.x+i.ll[0]),a.y=e.y+i.ll[1]}else isNaN(e.x)||(a.x=t.x+e.x,a.y=t.y+e.y);return a}function Mt(t,s){var i,a={x:t.x/s.del[0],y:t.y/s.del[1]},h=Math.floor(a.x),e=Math.floor(a.y),n=a.x-1*h,r=a.y-1*e,o={x:Number.NaN,y:Number.NaN};if(h<0||h>=s.lim[0])return o;if(e<0||e>=s.lim[1])return o;i=e*s.lim[0]+h;var l=s.cvs[i][0],u=s.cvs[i][1];i++;var c=s.cvs[i][0],M=s.cvs[i][1];i+=s.lim[0];var f=s.cvs[i][0],d=s.cvs[i][1];i--;var p=s.cvs[i][0],m=s.cvs[i][1],y=n*r,_=n*(1-r),x=(1-n)*(1-r),g=(1-n)*r;return o.x=x*l+_*c+g*p+y*f,o.y=x*u+_*M+g*m+y*d,o}var ft=function(t,s,i){var a,h,e,n=i.x,r=i.y,o=i.z||0,l={};for(e=0;e<3;e++)if(!s||2!==e||void 0!==i.z)switch(0===e?(a=n,h=-1!=="ew".indexOf(t.axis[e])?"x":"y"):1===e?(a=r,h=-1!=="ns".indexOf(t.axis[e])?"y":"x"):(a=o,h="z"),t.axis[e]){case"e":l[h]=a;break;case"w":l[h]=-a;break;case"n":l[h]=a;break;case"s":l[h]=-a;break;case"u":void 0!==i[h]&&(l.z=a);break;case"d":void 0!==i[h]&&(l.z=-a);break;default:return null}return l},dt=function(t){var s={x:t[0],y:t[1]};return t.length>2&&(s.z=t[2]),t.length>3&&(s.m=t[3]),s},pt=function(t){mt(t.x),mt(t.y)};function mt(t){if("function"==typeof Number.isFinite){if(Number.isFinite(t))return;throw new TypeError("coordinates must be finite numbers")}if("number"!=typeof t||t!=t||!isFinite(t))throw new TypeError("coordinates must be finite numbers")}function yt(a,h,e,n){var r,o=void 0!==(e=Array.isArray(e)?dt(e):{x:e.x,y:e.y,z:e.z,m:e.m}).z;if(pt(e),a.datum&&h.datum&&function(a,h){return(a.datum.datum_type===t||a.datum.datum_type===s||a.datum.datum_type===i)&&"WGS84"!==h.datumCode||(h.datum.datum_type===t||h.datum.datum_type===s||h.datum.datum_type===i)&&"WGS84"!==a.datumCode}(a,h)&&(e=yt(a,r=new et("WGS84"),e,n),a=r),n&&"enu"!==a.axis&&(e=ft(a,!1,e)),"longlat"===a.projName)e={x:e.x*c,y:e.y*c,z:e.z||0};else if(a.to_meter&&(e={x:e.x*a.to_meter,y:e.y*a.to_meter,z:e.z||0}),!(e=a.inverse(e)))return;if(a.from_greenwich&&(e.x+=a.from_greenwich),e=lt(a.datum,h.datum,e))return h.from_greenwich&&(e={x:e.x-h.from_greenwich,y:e.y,z:e.z||0}),"longlat"===h.projName?e={x:e.x*M,y:e.y*M,z:e.z||0}:(e=h.forward(e),h.to_meter&&(e={x:e.x/h.to_meter,y:e.y/h.to_meter,z:e.z||0})),n&&"enu"!==h.axis?ft(h,!0,e):(e&&!o&&delete e.z,e)}var _t=et("WGS84");function xt(t,s,i,a){var h,e,n;return Array.isArray(i)?(h=yt(t,s,i,a)||{x:NaN,y:NaN},i.length>2?void 0!==t.name&&"geocent"===t.name||void 0!==s.name&&"geocent"===s.name?"number"==typeof h.z?[h.x,h.y,h.z].concat(i.splice(3)):[h.x,h.y,i[2]].concat(i.splice(3)):[h.x,h.y].concat(i.splice(2)):[h.x,h.y]):(e=yt(t,s,i,a),2===(n=Object.keys(i)).length?e:(n.forEach(function(a){if(void 0!==t.name&&"geocent"===t.name||void 0!==s.name&&"geocent"===s.name){if("x"===a||"y"===a||"z"===a)return}else if("x"===a||"y"===a)return;e[a]=i[a]}),e))}function gt(t){return t instanceof et?t:t.oProj?t.oProj:et(t)}function vt(t,s,i){t=gt(t);var a,h=!1;return void 0===s?(s=t,t=_t,h=!0):(void 0!==s.x||Array.isArray(s))&&(i=s,s=t,t=_t,h=!0),s=gt(s),i?xt(t,s,i):(a={forward:function(i,a){return xt(t,s,i,a)},inverse:function(i,a){return xt(s,t,i,a)}},h&&(a.oProj=s),a)}var bt=6,wt="AJSAJS",Nt="AFAFAF",Et=65,At=73,Ct=79,Pt=86,St=90,It={forward:Ot,inverse:function(t){var s=Lt(Tt(t.toUpperCase()));if(s.lat&&s.lon)return[s.lon,s.lat,s.lon,s.lat];return[s.left,s.bottom,s.right,s.top]},toPoint:kt};function Ot(t,s){return s=s||5,function(t,s){var i="00000"+t.easting,a="00000"+t.northing;return t.zoneNumber+t.zoneLetter+(f=t.easting,d=t.northing,p=t.zoneNumber,m=Gt(p),y=Math.floor(f/1e5),_=Math.floor(d/1e5)%20,h=y,e=_,n=m,r=n-1,o=wt.charCodeAt(r),l=Nt.charCodeAt(r),u=o+h-1,c=l+e,M=!1,u>St&&(u=u-St+Et-1,M=!0),(u===At||o<At&&u>At||(u>At||o<At)&&M)&&u++,(u===Ct||o<Ct&&u>Ct||(u>Ct||o<Ct)&&M)&&++u===At&&u++,u>St&&(u=u-St+Et-1),c>Pt?(c=c-Pt+Et-1,M=!0):M=!1,(c===At||l<At&&c>At||(c>At||l<At)&&M)&&c++,(c===Ct||l<Ct&&c>Ct||(c>Ct||l<Ct)&&M)&&++c===At&&c++,c>Pt&&(c=c-Pt+Et-1),String.fromCharCode(u)+String.fromCharCode(c))+i.substr(i.length-5,s)+a.substr(a.length-5,s);var h,e,n,r,o,l,u,c,M;var f,d,p,m,y,_}(function(t){var s,i,a,h,e,n,r,o=t.lat,l=t.lon,u=6378137,c=qt(o),M=qt(l);r=Math.floor((l+180)/6)+1,180===l&&(r=60);o>=56&&o<64&&l>=3&&l<12&&(r=32);o>=72&&o<84&&(l>=0&&l<9?r=31:l>=9&&l<21?r=33:l>=21&&l<33?r=35:l>=33&&l<42&&(r=37));n=qt(6*(r-1)-180+3),.006739496752268451,s=u/Math.sqrt(1-.00669438*Math.sin(c)*Math.sin(c)),i=Math.tan(c)*Math.tan(c),a=.006739496752268451*Math.cos(c)*Math.cos(c),h=Math.cos(c)*(M-n),e=u*(.9983242984503243*c-.002514607064228144*Math.sin(2*c)+2639046602129982e-21*Math.sin(4*c)-3.418046101696858e-9*Math.sin(6*c));var f=.9996*s*(h+(1-i+a)*h*h*h/6+(5-18*i+i*i+72*a-.39089081163157013)*h*h*h*h*h/120)+5e5,d=.9996*(e+s*Math.tan(c)*(h*h/2+(5-i+9*a+4*a*a)*h*h*h*h/24+(61-58*i+i*i+600*a-2.2240339282485886)*h*h*h*h*h*h/720));o<0&&(d+=1e7);return{northing:Math.round(d),easting:Math.round(f),zoneNumber:r,zoneLetter:jt(o)}}({lat:t[1],lon:t[0]}),s)}function kt(t){var s=Lt(Tt(t.toUpperCase()));return s.lat&&s.lon?[s.lon,s.lat]:[(s.left+s.right)/2,(s.top+s.bottom)/2]}function qt(t){return t*(Math.PI/180)}function Rt(t){return t/Math.PI*180}function Lt(t){var s=t.northing,i=t.easting,a=t.zoneLetter,h=t.zoneNumber;if(h<0||h>60)return null;var e,n,r,o,l,u,c,M,f=6378137,d=(1-Math.sqrt(.99330562))/(1+Math.sqrt(.99330562)),p=i-5e5,m=s;a<"N"&&(m-=1e7),u=6*(h-1)-180+3,M=(c=m/.9996/6367449.145945056)+(3*d/2-27*d*d*d/32)*Math.sin(2*c)+(21*d*d/16-55*d*d*d*d/32)*Math.sin(4*c)+151*d*d*d/96*Math.sin(6*c),e=f/Math.sqrt(1-.00669438*Math.sin(M)*Math.sin(M)),n=Math.tan(M)*Math.tan(M),r=.006739496752268451*Math.cos(M)*Math.cos(M),o=.99330562*f/Math.pow(1-.00669438*Math.sin(M)*Math.sin(M),1.5),l=p/(.9996*e);var y=M-e*Math.tan(M)/o*(l*l/2-(5+3*n+10*r-4*r*r-.06065547077041606)*l*l*l*l/24+(61+90*n+298*r+45*n*n-1.6983531815716497-3*r*r)*l*l*l*l*l*l/720);y=Rt(y);var _,x=(l-(1+2*n+r)*l*l*l/6+(5-2*r+28*n-3*r*r+.05391597401814761+24*n*n)*l*l*l*l*l/120)/Math.cos(M);if(x=u+Rt(x),t.accuracy){var g=Lt({northing:t.northing+t.accuracy,easting:t.easting+t.accuracy,zoneLetter:t.zoneLetter,zoneNumber:t.zoneNumber});_={top:g.lat,right:g.lon,bottom:y,left:x}}else _={lat:y,lon:x};return _}function jt(t){var s="Z";return 84>=t&&t>=72?s="X":72>t&&t>=64?s="W":64>t&&t>=56?s="V":56>t&&t>=48?s="U":48>t&&t>=40?s="T":40>t&&t>=32?s="S":32>t&&t>=24?s="R":24>t&&t>=16?s="Q":16>t&&t>=8?s="P":8>t&&t>=0?s="N":0>t&&t>=-8?s="M":-8>t&&t>=-16?s="L":-16>t&&t>=-24?s="K":-24>t&&t>=-32?s="J":-32>t&&t>=-40?s="H":-40>t&&t>=-48?s="G":-48>t&&t>=-56?s="F":-56>t&&t>=-64?s="E":-64>t&&t>=-72?s="D":-72>t&&t>=-80&&(s="C"),s}function Gt(t){var s=t%bt;return 0===s&&(s=bt),s}function Tt(t){if(t&&0===t.length)throw"MGRSPoint coverting from nothing";for(var s,i=t.length,a=null,h="",e=0;!/[A-Z]/.test(s=t.charAt(e));){if(e>=2)throw"MGRSPoint bad conversion from: "+t;h+=s,e++}var n=parseInt(h,10);if(0===e||e+3>i)throw"MGRSPoint bad conversion from: "+t;var r=t.charAt(e++);if(r<="A"||"B"===r||"Y"===r||r>="Z"||"I"===r||"O"===r)throw"MGRSPoint zone letter "+r+" not handled: "+t;a=t.substring(e,e+=2);for(var o=Gt(n),l=function(t,s){var i=wt.charCodeAt(s-1),a=1e5,h=!1;for(;i!==t.charCodeAt(0);){if(++i===At&&i++,i===Ct&&i++,i>St){if(h)throw"Bad character: "+t;i=Et,h=!0}a+=1e5}return a}(a.charAt(0),o),u=function(t,s){if(t>"V")throw"MGRSPoint given invalid Northing "+t;var i=Nt.charCodeAt(s-1),a=0,h=!1;for(;i!==t.charCodeAt(0);){if(++i===At&&i++,i===Ct&&i++,i>Pt){if(h)throw"Bad character: "+t;i=Et,h=!0}a+=1e5}return a}(a.charAt(1),o);u<Bt(r);)u+=2e6;var c=i-e;if(c%2!=0)throw"MGRSPoint has to have an even number \nof digits after the zone letter and two 100km letters - front \nhalf for easting meters, second half for \nnorthing meters"+t;var M,f,d,p=c/2,m=0,y=0;return p>0&&(M=1e5/Math.pow(10,p),f=t.substring(e,e+p),m=parseFloat(f)*M,d=t.substring(e+p),y=parseFloat(d)*M),{easting:m+l,northing:y+u,zoneLetter:r,zoneNumber:n,accuracy:M}}function Bt(t){var s;switch(t){case"C":s=11e5;break;case"D":s=2e6;break;case"E":s=28e5;break;case"F":s=37e5;break;case"G":s=46e5;break;case"H":s=55e5;break;case"J":s=64e5;break;case"K":s=73e5;break;case"L":s=82e5;break;case"M":s=91e5;break;case"N":s=0;break;case"P":s=8e5;break;case"Q":s=17e5;break;case"R":s=26e5;break;case"S":s=35e5;break;case"T":s=44e5;break;case"U":s=53e5;break;case"V":s=62e5;break;case"W":s=7e6;break;case"X":s=79e5;break;default:s=-1}if(s>=0)return s;throw"Invalid zone letter: "+t}function zt(t,s,i){if(!(this instanceof zt))return new zt(t,s,i);if(Array.isArray(t))this.x=t[0],this.y=t[1],this.z=t[2]||0;else if("object"===_typeof(t))this.x=t.x,this.y=t.y,this.z=t.z||0;else if("string"==typeof t&&void 0===s){var a=t.split(",");this.x=parseFloat(a[0],10),this.y=parseFloat(a[1],10),this.z=parseFloat(a[2],10)||0}else this.x=t,this.y=s,this.z=i||0;console.warn("proj4.Point will be removed in version 3, use proj4.toPoint")}zt.fromMGRS=function(t){return new zt(kt(t))},zt.prototype.toMGRS=function(t){return Ot([this.x,this.y],t)};var Ft=.01068115234375,Dt=function(t){var s=[];s[0]=1-t*(.25+t*(.046875+t*(.01953125+t*Ft))),s[1]=t*(.75-t*(.046875+t*(.01953125+t*Ft)));var i=t*t;return s[2]=i*(.46875-t*(.013020833333333334+.007120768229166667*t)),i*=t,s[3]=i*(.3645833333333333-.005696614583333333*t),s[4]=i*t*.3076171875,s},Ut=function(t,s,i,a){return i*=s,s*=s,a[0]*t-i*(a[1]+s*(a[2]+s*(a[3]+s*a[4])))},Qt=function(t,s,i){for(var a=1/(1-s),h=t,e=20;e;--e){var n=Math.sin(h),r=1-s*n*n;if(h-=r=(Ut(h,n,Math.cos(h),i)-t)*(r*Math.sqrt(r))*a,Math.abs(r)<u)return h}return h};var Wt={init:function(){this.x0=void 0!==this.x0?this.x0:0,this.y0=void 0!==this.y0?this.y0:0,this.long0=void 0!==this.long0?this.long0:0,this.lat0=void 0!==this.lat0?this.lat0:0,this.es&&(this.en=Dt(this.es),this.ml0=Ut(this.lat0,Math.sin(this.lat0),Math.cos(this.lat0),this.en))},forward:function(t){var s,i,a,h=t.x,e=t.y,n=z(h-this.long0),r=Math.sin(e),o=Math.cos(e);if(this.es){var l=o*n,c=Math.pow(l,2),M=this.ep2*Math.pow(o,2),f=Math.pow(M,2),d=Math.abs(o)>u?Math.tan(e):0,p=Math.pow(d,2),m=Math.pow(p,2);s=1-this.es*Math.pow(r,2),l/=Math.sqrt(s);var y=Ut(e,r,o,this.en);i=this.a*(this.k0*l*(1+c/6*(1-p+M+c/20*(5-18*p+m+14*M-58*p*M+c/42*(61+179*m-m*p-479*p)))))+this.x0,a=this.a*(this.k0*(y-this.ml0+r*n*l/2*(1+c/12*(5-p+9*M+4*f+c/30*(61+m-58*p+270*M-330*p*M+c/56*(1385+543*m-m*p-3111*p))))))+this.y0}else{var _=o*Math.sin(n);if(Math.abs(Math.abs(_)-1)<u)return 93;if(i=.5*this.a*this.k0*Math.log((1+_)/(1-_))+this.x0,a=o*Math.cos(n)/Math.sqrt(1-Math.pow(_,2)),(_=Math.abs(a))>=1){if(_-1>u)return 93;a=0}else a=Math.acos(a);e<0&&(a=-a),a=this.a*this.k0*(a-this.lat0)+this.y0}return t.x=i,t.y=a,t},inverse:function(t){var s,i,a,h,e=(t.x-this.x0)*(1/this.a),r=(t.y-this.y0)*(1/this.a);if(this.es)if(s=this.ml0+r/this.k0,i=Qt(s,this.es,this.en),Math.abs(i)<n){var o=Math.sin(i),l=Math.cos(i),c=Math.abs(l)>u?Math.tan(i):0,M=this.ep2*Math.pow(l,2),f=Math.pow(M,2),d=Math.pow(c,2),p=Math.pow(d,2);s=1-this.es*Math.pow(o,2);var m=e*Math.sqrt(s)/this.k0,y=Math.pow(m,2);a=i-(s*=c)*y/(1-this.es)*.5*(1-y/12*(5+3*d-9*M*d+M-4*f-y/30*(61+90*d-252*M*d+45*p+46*M-y/56*(1385+3633*d+4095*p+1574*p*d)))),h=z(this.long0+m*(1-y/6*(1+2*d+M-y/20*(5+28*d+24*p+8*M*d+6*M-y/42*(61+662*d+1320*p+720*p*d))))/l)}else a=n*B(r),h=0;else{var _=Math.exp(e/this.k0),x=.5*(_-1/_),g=this.lat0+r/this.k0,v=Math.cos(g);s=Math.sqrt((1-Math.pow(v,2))/(1+Math.pow(x,2))),a=Math.asin(s),r<0&&(a=-a),h=0===x&&0===v?0:z(Math.atan2(x,v)+this.long0)}return t.x=h,t.y=a,t},names:["Fast_Transverse_Mercator","Fast Transverse Mercator"]},Ht=function(t){var s=Math.exp(t);return s=(s-1/s)/2},Xt=function(t,s){t=Math.abs(t),s=Math.abs(s);var i=Math.max(t,s),a=Math.min(t,s)/(i||1);return i*Math.sqrt(1+Math.pow(a,2))},Kt=function(t){var s=Math.abs(t);return s=function(t){var s=1+t,i=s-1;return 0===i?t:t*Math.log(s)/i}(s*(1+s/(Xt(1,s)+1))),t<0?-s:s},Jt=function(t,s){for(var i,a=2*Math.cos(2*s),h=t.length-1,e=t[h],n=0;--h>=0;)i=a*e-n+t[h],n=e,e=i;return s+i*Math.sin(2*s)},Vt=function(t,s){for(var i,a=2*Math.cos(s),h=t.length-1,e=t[h],n=0;--h>=0;)i=a*e-n+t[h],n=e,e=i;return Math.sin(s)*i},Zt=function(t,s,i){for(var a,h,e=Math.sin(s),n=Math.cos(s),r=Ht(i),o=function(t){var s=Math.exp(t);return s=(s+1/s)/2}(i),l=2*n*o,u=-2*e*r,c=t.length-1,M=t[c],f=0,d=0,p=0;--c>=0;)a=d,h=f,M=l*(d=M)-a-u*(f=p)+t[c],p=u*d-h+l*f;return[(l=e*o)*M-(u=n*r)*p,l*p+u*M]};var Yt={init:function(){if(!this.approx&&(isNaN(this.es)||this.es<=0))throw new Error('Incorrect elliptical usage. Try using the +approx option in the proj string, or PROJECTION["Fast_Transverse_Mercator"] in the WKT.');this.approx&&(Wt.init.apply(this),this.forward=Wt.forward,this.inverse=Wt.inverse),this.x0=void 0!==this.x0?this.x0:0,this.y0=void 0!==this.y0?this.y0:0,this.long0=void 0!==this.long0?this.long0:0,this.lat0=void 0!==this.lat0?this.lat0:0,this.cgb=[],this.cbg=[],this.utg=[],this.gtu=[];var t=this.es/(1+Math.sqrt(1-this.es)),s=t/(2-t),i=s;this.cgb[0]=s*(2+s*(-2/3+s*(s*(116/45+s*(26/45+s*(-2854/675)))-2))),this.cbg[0]=s*(s*(2/3+s*(4/3+s*(-82/45+s*(32/45+s*(4642/4725)))))-2),i*=s,this.cgb[1]=i*(7/3+s*(s*(-227/45+s*(2704/315+s*(2323/945)))-1.6)),this.cbg[1]=i*(5/3+s*(-16/15+s*(-13/9+s*(904/315+s*(-1522/945))))),i*=s,this.cgb[2]=i*(56/15+s*(-136/35+s*(-1262/105+s*(73814/2835)))),this.cbg[2]=i*(-26/15+s*(34/21+s*(1.6+s*(-12686/2835)))),i*=s,this.cgb[3]=i*(4279/630+s*(-332/35+s*(-399572/14175))),this.cbg[3]=i*(1237/630+s*(s*(-24832/14175)-2.4)),i*=s,this.cgb[4]=i*(4174/315+s*(-144838/6237)),this.cbg[4]=i*(-734/315+s*(109598/31185)),i*=s,this.cgb[5]=i*(601676/22275),this.cbg[5]=i*(444337/155925),i=Math.pow(s,2),this.Qn=this.k0/(1+s)*(1+i*(.25+i*(1/64+i/256))),this.utg[0]=s*(s*(2/3+s*(-37/96+s*(1/360+s*(81/512+s*(-96199/604800)))))-.5),this.gtu[0]=s*(.5+s*(-2/3+s*(5/16+s*(41/180+s*(-127/288+s*(7891/37800)))))),this.utg[1]=i*(-1/48+s*(-1/15+s*(437/1440+s*(-46/105+s*(1118711/3870720))))),this.gtu[1]=i*(13/48+s*(s*(557/1440+s*(281/630+s*(-1983433/1935360)))-.6)),i*=s,this.utg[2]=i*(-17/480+s*(37/840+s*(209/4480+s*(-5569/90720)))),this.gtu[2]=i*(61/240+s*(-103/140+s*(15061/26880+s*(167603/181440)))),i*=s,this.utg[3]=i*(-4397/161280+s*(11/504+s*(830251/7257600))),this.gtu[3]=i*(49561/161280+s*(-179/168+s*(6601661/7257600))),i*=s,this.utg[4]=i*(-4583/161280+s*(108847/3991680)),this.gtu[4]=i*(34729/80640+s*(-3418889/1995840)),i*=s,this.utg[5]=-.03233083094085698*i,this.gtu[5]=.6650675310896665*i;var a=Jt(this.cbg,this.lat0);this.Zb=-this.Qn*(a+Vt(this.gtu,2*a))},forward:function(t){var s=z(t.x-this.long0),i=t.y;i=Jt(this.cbg,i);var a=Math.sin(i),h=Math.cos(i),e=Math.sin(s),n=Math.cos(s);i=Math.atan2(a,n*h),s=Math.atan2(e*h,Xt(a,h*n)),s=Kt(Math.tan(s));var r,o,l=Zt(this.gtu,2*i,2*s);return i+=l[0],s+=l[1],Math.abs(s)<=2.623395162778?(r=this.a*(this.Qn*s)+this.x0,o=this.a*(this.Qn*i+this.Zb)+this.y0):(r=1/0,o=1/0),t.x=r,t.y=o,t},inverse:function(t){var s,i,a=(t.x-this.x0)*(1/this.a),h=(t.y-this.y0)*(1/this.a);if(h=(h-this.Zb)/this.Qn,a/=this.Qn,Math.abs(a)<=2.623395162778){var e=Zt(this.utg,2*h,2*a);h+=e[0],a+=e[1],a=Math.atan(Ht(a));var n=Math.sin(h),r=Math.cos(h),o=Math.sin(a),l=Math.cos(a);h=Math.atan2(n*l,Xt(o,l*r)),a=Math.atan2(o,l*r),s=z(a+this.long0),i=Jt(this.cgb,h)}else s=1/0,i=1/0;return t.x=s,t.y=i,t},names:["Extended_Transverse_Mercator","Extended Transverse Mercator","etmerc","Transverse_Mercator","Transverse Mercator","Gauss Kruger","Gauss_Kruger","tmerc"]},$t=function(t,s){if(void 0===t){if((t=Math.floor(30*(z(s)+Math.PI)/Math.PI)+1)<0)return 0;if(t>60)return 60}return t};var ts={init:function(){var t=$t(this.zone,this.long0);if(void 0===t)throw new Error("unknown utm zone");this.lat0=0,this.long0=(6*Math.abs(t)-183)*c,this.x0=5e5,this.y0=this.utmSouth?1e7:0,this.k0=.9996,Yt.init.apply(this),this.forward=Yt.forward,this.inverse=Yt.inverse},names:["Universal Transverse Mercator System","utm"],dependsOn:"etmerc"},ss=function(t,s){return Math.pow((1-t)/(1+t),s)},is=20;var as={init:function(){var t=Math.sin(this.lat0),s=Math.cos(this.lat0);s*=s,this.rc=Math.sqrt(1-this.es)/(1-this.es*t*t),this.C=Math.sqrt(1+this.es*s*s/(1-this.es)),this.phic0=Math.asin(t/this.C),this.ratexp=.5*this.C*this.e,this.K=Math.tan(.5*this.phic0+f)/(Math.pow(Math.tan(.5*this.lat0+f),this.C)*ss(this.e*t,this.ratexp))},forward:function(t){var s=t.x,i=t.y;return t.y=2*Math.atan(this.K*Math.pow(Math.tan(.5*i+f),this.C)*ss(this.e*Math.sin(i),this.ratexp))-n,t.x=this.C*s,t},inverse:function(t){for(var s=t.x/this.C,i=t.y,a=Math.pow(Math.tan(.5*i+f)/this.K,1/this.C),h=is;h>0&&(i=2*Math.atan(a*ss(this.e*Math.sin(t.y),-.5*this.e))-n,!(Math.abs(i-t.y)<1e-14));--h)t.y=i;return h?(t.x=s,t.y=i,t):null},names:["gauss"]};var hs={init:function(){as.init.apply(this),this.rc&&(this.sinc0=Math.sin(this.phic0),this.cosc0=Math.cos(this.phic0),this.R2=2*this.rc,this.title||(this.title="Oblique Stereographic Alternative"))},forward:function(t){var s,i,a,h;return t.x=z(t.x-this.long0),as.forward.apply(this,[t]),s=Math.sin(t.y),i=Math.cos(t.y),a=Math.cos(t.x),h=this.k0*this.R2/(1+this.sinc0*s+this.cosc0*i*a),t.x=h*i*Math.sin(t.x),t.y=h*(this.cosc0*s-this.sinc0*i*a),t.x=this.a*t.x+this.x0,t.y=this.a*t.y+this.y0,t},inverse:function(t){var s,i,a,h,e;if(t.x=(t.x-this.x0)/this.a,t.y=(t.y-this.y0)/this.a,t.x/=this.k0,t.y/=this.k0,e=Xt(t.x,t.y)){var n=2*Math.atan2(e,this.R2);s=Math.sin(n),i=Math.cos(n),h=Math.asin(i*this.sinc0+t.y*s*this.cosc0/e),a=Math.atan2(t.x*s,e*this.cosc0*i-t.y*this.sinc0*s)}else h=this.phic0,a=0;return t.x=a,t.y=h,as.inverse.apply(this,[t]),t.x=z(t.x+this.long0),t},names:["Stereographic_North_Pole","Oblique_Stereographic","sterea","Oblique Stereographic Alternative","Double_Stereographic"]};var es={init:function(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.coslat0=Math.cos(this.lat0),this.sinlat0=Math.sin(this.lat0),this.sphere?1===this.k0&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=u&&(this.k0=.5*(1+B(this.lat0)*Math.sin(this.lat_ts))):(Math.abs(this.coslat0)<=u&&(this.lat0>0?this.con=1:this.con=-1),this.cons=Math.sqrt(Math.pow(1+this.e,1+this.e)*Math.pow(1-this.e,1-this.e)),1===this.k0&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=u&&Math.abs(Math.cos(this.lat_ts))>u&&(this.k0=.5*this.cons*T(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts))/F(this.e,this.con*this.lat_ts,this.con*Math.sin(this.lat_ts))),this.ms1=T(this.e,this.sinlat0,this.coslat0),this.X0=2*Math.atan(this.ssfn_(this.lat0,this.sinlat0,this.e))-n,this.cosX0=Math.cos(this.X0),this.sinX0=Math.sin(this.X0))},forward:function(t){var s,i,a,h,e,r,o=t.x,l=t.y,c=Math.sin(l),M=Math.cos(l),f=z(o-this.long0);return Math.abs(Math.abs(o-this.long0)-Math.PI)<=u&&Math.abs(l+this.lat0)<=u?(t.x=NaN,t.y=NaN,t):this.sphere?(s=2*this.k0/(1+this.sinlat0*c+this.coslat0*M*Math.cos(f)),t.x=this.a*s*M*Math.sin(f)+this.x0,t.y=this.a*s*(this.coslat0*c-this.sinlat0*M*Math.cos(f))+this.y0,t):(i=2*Math.atan(this.ssfn_(l,c,this.e))-n,h=Math.cos(i),a=Math.sin(i),Math.abs(this.coslat0)<=u?(e=F(this.e,l*this.con,this.con*c),r=2*this.a*this.k0*e/this.cons,t.x=this.x0+r*Math.sin(o-this.long0),t.y=this.y0-this.con*r*Math.cos(o-this.long0),t):(Math.abs(this.sinlat0)<u?(s=2*this.a*this.k0/(1+h*Math.cos(f)),t.y=s*a):(s=2*this.a*this.k0*this.ms1/(this.cosX0*(1+this.sinX0*a+this.cosX0*h*Math.cos(f))),t.y=s*(this.cosX0*a-this.sinX0*h*Math.cos(f))+this.y0),t.x=s*h*Math.sin(f)+this.x0,t))},inverse:function(t){var s,i,a,h,e;t.x-=this.x0,t.y-=this.y0;var r=Math.sqrt(t.x*t.x+t.y*t.y);if(this.sphere){var o=2*Math.atan(r/(2*this.a*this.k0));return s=this.long0,i=this.lat0,r<=u?(t.x=s,t.y=i,t):(i=Math.asin(Math.cos(o)*this.sinlat0+t.y*Math.sin(o)*this.coslat0/r),s=Math.abs(this.coslat0)<u?this.lat0>0?z(this.long0+Math.atan2(t.x,-1*t.y)):z(this.long0+Math.atan2(t.x,t.y)):z(this.long0+Math.atan2(t.x*Math.sin(o),r*this.coslat0*Math.cos(o)-t.y*this.sinlat0*Math.sin(o))),t.x=s,t.y=i,t)}if(Math.abs(this.coslat0)<=u){if(r<=u)return i=this.lat0,s=this.long0,t.x=s,t.y=i,t;t.x*=this.con,t.y*=this.con,a=r*this.cons/(2*this.a*this.k0),i=this.con*D(this.e,a),s=this.con*z(this.con*this.long0+Math.atan2(t.x,-1*t.y))}else h=2*Math.atan(r*this.cosX0/(2*this.a*this.k0*this.ms1)),s=this.long0,r<=u?e=this.X0:(e=Math.asin(Math.cos(h)*this.sinX0+t.y*Math.sin(h)*this.cosX0/r),s=z(this.long0+Math.atan2(t.x*Math.sin(h),r*this.cosX0*Math.cos(h)-t.y*this.sinX0*Math.sin(h)))),i=-1*D(this.e,Math.tan(.5*(n+e)));return t.x=s,t.y=i,t},names:["stere","Stereographic_South_Pole","Polar Stereographic (variant B)","Polar_Stereographic"],ssfn_:function(t,s,i){return s*=i,Math.tan(.5*(n+t))*Math.pow((1-s)/(1+s),.5*i)}};var ns={init:function(){var t=this.lat0;this.lambda0=this.long0;var s=Math.sin(t),i=this.a,a=1/this.rf,h=2*a-Math.pow(a,2),e=this.e=Math.sqrt(h);this.R=this.k0*i*Math.sqrt(1-h)/(1-h*Math.pow(s,2)),this.alpha=Math.sqrt(1+h/(1-h)*Math.pow(Math.cos(t),4)),this.b0=Math.asin(s/this.alpha);var n=Math.log(Math.tan(Math.PI/4+this.b0/2)),r=Math.log(Math.tan(Math.PI/4+t/2)),o=Math.log((1+e*s)/(1-e*s));this.K=n-this.alpha*r+this.alpha*e/2*o},forward:function(t){var s=Math.log(Math.tan(Math.PI/4-t.y/2)),i=this.e/2*Math.log((1+this.e*Math.sin(t.y))/(1-this.e*Math.sin(t.y))),a=-this.alpha*(s+i)+this.K,h=2*(Math.atan(Math.exp(a))-Math.PI/4),e=this.alpha*(t.x-this.lambda0),n=Math.atan(Math.sin(e)/(Math.sin(this.b0)*Math.tan(h)+Math.cos(this.b0)*Math.cos(e))),r=Math.asin(Math.cos(this.b0)*Math.sin(h)-Math.sin(this.b0)*Math.cos(h)*Math.cos(e));return t.y=this.R/2*Math.log((1+Math.sin(r))/(1-Math.sin(r)))+this.y0,t.x=this.R*n+this.x0,t},inverse:function(t){for(var s=t.x-this.x0,i=t.y-this.y0,a=s/this.R,h=2*(Math.atan(Math.exp(i/this.R))-Math.PI/4),e=Math.asin(Math.cos(this.b0)*Math.sin(h)+Math.sin(this.b0)*Math.cos(h)*Math.cos(a)),n=Math.atan(Math.sin(a)/(Math.cos(this.b0)*Math.cos(a)-Math.sin(this.b0)*Math.tan(h))),r=this.lambda0+n/this.alpha,o=0,l=e,u=-1e3,c=0;Math.abs(l-u)>1e-7;){if(++c>20)return;o=1/this.alpha*(Math.log(Math.tan(Math.PI/4+e/2))-this.K)+this.e*Math.log(Math.tan(Math.PI/4+Math.asin(this.e*Math.sin(l))/2)),u=l,l=2*Math.atan(Math.exp(o))-Math.PI/2}return t.x=r,t.y=l,t},names:["somerc"]},rs=1e-7;var os={init:function(){var t,s,i,a,h,e,r,o,l,M,p,m,y,_=0,x=0,g=0,v=0,b=0,w=0,N=0;this.no_off=(y="object"===_typeof((m=this).PROJECTION)?Object.keys(m.PROJECTION)[0]:m.PROJECTION,"no_uoff"in m||"no_off"in m||-1!==["Hotine_Oblique_Mercator","Hotine_Oblique_Mercator_Azimuth_Natural_Origin"].indexOf(y)),this.no_rot="no_rot"in this;var E=!1;"alpha"in this&&(E=!0);var A=!1;if("rectified_grid_angle"in this&&(A=!0),E&&(N=this.alpha),A&&(_=this.rectified_grid_angle*c),E||A)x=this.longc;else if(g=this.long1,b=this.lat1,v=this.long2,w=this.lat2,Math.abs(b-w)<=rs||(t=Math.abs(b))<=rs||Math.abs(t-n)<=rs||Math.abs(Math.abs(this.lat0)-n)<=rs||Math.abs(Math.abs(w)-n)<=rs)throw new Error;var C=1-this.es;s=Math.sqrt(C),Math.abs(this.lat0)>u?(o=Math.sin(this.lat0),i=Math.cos(this.lat0),t=1-this.es*o*o,this.B=i*i,this.B=Math.sqrt(1+this.es*this.B*this.B/C),this.A=this.B*this.k0*s/t,(h=(a=this.B*s/(i*Math.sqrt(t)))*a-1)<=0?h=0:(h=Math.sqrt(h),this.lat0<0&&(h=-h)),this.E=h+=a,this.E*=Math.pow(F(this.e,this.lat0,o),this.B)):(this.B=1/s,this.A=this.k0,this.E=a=h=1),E||A?(E?(p=Math.asin(Math.sin(N)/a),A||(_=N)):(p=_,N=Math.asin(a*Math.sin(p))),this.lam0=x-Math.asin(.5*(h-1/h)*Math.tan(p))/this.B):(e=Math.pow(F(this.e,b,Math.sin(b)),this.B),r=Math.pow(F(this.e,w,Math.sin(w)),this.B),h=this.E/e,l=(r-e)/(r+e),M=((M=this.E*this.E)-r*e)/(M+r*e),(t=g-v)<-Math.pi?v-=d:t>Math.pi&&(v+=d),this.lam0=z(.5*(g+v)-Math.atan(M*Math.tan(.5*this.B*(g-v))/l)/this.B),p=Math.atan(2*Math.sin(this.B*z(g-this.lam0))/(h-1/h)),_=N=Math.asin(a*Math.sin(p))),this.singam=Math.sin(p),this.cosgam=Math.cos(p),this.sinrot=Math.sin(_),this.cosrot=Math.cos(_),this.rB=1/this.B,this.ArB=this.A*this.rB,this.BrA=1/this.ArB,this.no_off?this.u_0=0:(this.u_0=Math.abs(this.ArB*Math.atan(Math.sqrt(a*a-1)/Math.cos(N))),this.lat0<0&&(this.u_0=-this.u_0)),h=.5*p,this.v_pole_n=this.ArB*Math.log(Math.tan(f-h)),this.v_pole_s=this.ArB*Math.log(Math.tan(f+h))},forward:function(t){var s,i,a,h,e,r,o,l,c={};if(t.x=t.x-this.lam0,Math.abs(Math.abs(t.y)-n)>u){if(s=.5*((e=this.E/Math.pow(F(this.e,t.y,Math.sin(t.y)),this.B))-(r=1/e)),i=.5*(e+r),h=Math.sin(this.B*t.x),a=(s*this.singam-h*this.cosgam)/i,Math.abs(Math.abs(a)-1)<u)throw new Error;l=.5*this.ArB*Math.log((1-a)/(1+a)),r=Math.cos(this.B*t.x),o=Math.abs(r)<rs?this.A*t.x:this.ArB*Math.atan2(s*this.cosgam+h*this.singam,r)}else l=t.y>0?this.v_pole_n:this.v_pole_s,o=this.ArB*t.y;return this.no_rot?(c.x=o,c.y=l):(o-=this.u_0,c.x=l*this.cosrot+o*this.sinrot,c.y=o*this.cosrot-l*this.sinrot),c.x=this.a*c.x+this.x0,c.y=this.a*c.y+this.y0,c},inverse:function(t){var s,i,a,h,e,r,o,l={};if(t.x=(t.x-this.x0)*(1/this.a),t.y=(t.y-this.y0)*(1/this.a),this.no_rot?(i=t.y,s=t.x):(i=t.x*this.cosrot-t.y*this.sinrot,s=t.y*this.cosrot+t.x*this.sinrot+this.u_0),h=.5*((a=Math.exp(-this.BrA*i))-1/a),e=.5*(a+1/a),o=((r=Math.sin(this.BrA*s))*this.cosgam+h*this.singam)/e,Math.abs(Math.abs(o)-1)<u)l.x=0,l.y=o<0?-n:n;else{if(l.y=this.E/Math.sqrt((1+o)/(1-o)),l.y=D(this.e,Math.pow(l.y,1/this.B)),l.y===1/0)throw new Error;l.x=-this.rB*Math.atan2(h*this.cosgam-r*this.singam,Math.cos(this.BrA*s))}return l.x+=this.lam0,l},names:["Hotine_Oblique_Mercator","Hotine Oblique Mercator","Hotine_Oblique_Mercator_Azimuth_Natural_Origin","Hotine_Oblique_Mercator_Two_Point_Natural_Origin","Hotine_Oblique_Mercator_Azimuth_Center","Oblique_Mercator","omerc"]};var ls={init:function(){if(this.lat2||(this.lat2=this.lat1),this.k0||(this.k0=1),this.x0=this.x0||0,this.y0=this.y0||0,!(Math.abs(this.lat1+this.lat2)<u)){var t=this.b/this.a;this.e=Math.sqrt(1-t*t);var s=Math.sin(this.lat1),i=Math.cos(this.lat1),a=T(this.e,s,i),h=F(this.e,this.lat1,s),e=Math.sin(this.lat2),n=Math.cos(this.lat2),r=T(this.e,e,n),o=F(this.e,this.lat2,e),l=F(this.e,this.lat0,Math.sin(this.lat0));Math.abs(this.lat1-this.lat2)>u?this.ns=Math.log(a/r)/Math.log(h/o):this.ns=s,isNaN(this.ns)&&(this.ns=s),this.f0=a/(this.ns*Math.pow(h,this.ns)),this.rh=this.a*this.f0*Math.pow(l,this.ns),this.title||(this.title="Lambert Conformal Conic")}},forward:function(t){var s=t.x,i=t.y;Math.abs(2*Math.abs(i)-Math.PI)<=u&&(i=B(i)*(n-2*u));var a,h,e=Math.abs(Math.abs(i)-n);if(e>u)a=F(this.e,i,Math.sin(i)),h=this.a*this.f0*Math.pow(a,this.ns);else{if((e=i*this.ns)<=0)return null;h=0}var r=this.ns*z(s-this.long0);return t.x=this.k0*(h*Math.sin(r))+this.x0,t.y=this.k0*(this.rh-h*Math.cos(r))+this.y0,t},inverse:function(t){var s,i,a,h,e,r=(t.x-this.x0)/this.k0,o=this.rh-(t.y-this.y0)/this.k0;this.ns>0?(s=Math.sqrt(r*r+o*o),i=1):(s=-Math.sqrt(r*r+o*o),i=-1);var l=0;if(0!==s&&(l=Math.atan2(i*r,i*o)),0!==s||this.ns>0){if(i=1/this.ns,a=Math.pow(s/(this.a*this.f0),i),-9999===(h=D(this.e,a)))return null}else h=-n;return e=z(l/this.ns+this.long0),t.x=e,t.y=h,t},names:["Lambert Tangential Conformal Conic Projection","Lambert_Conformal_Conic","Lambert_Conformal_Conic_1SP","Lambert_Conformal_Conic_2SP","lcc","Lambert Conic Conformal (1SP)","Lambert Conic Conformal (2SP)"]};var us={init:function(){this.a=6377397.155,this.es=.006674372230614,this.e=Math.sqrt(this.es),this.lat0||(this.lat0=.863937979737193),this.long0||(this.long0=.4334234309119251),this.k0||(this.k0=.9999),this.s45=.785398163397448,this.s90=2*this.s45,this.fi0=this.lat0,this.e2=this.es,this.e=Math.sqrt(this.e2),this.alfa=Math.sqrt(1+this.e2*Math.pow(Math.cos(this.fi0),4)/(1-this.e2)),this.uq=1.04216856380474,this.u0=Math.asin(Math.sin(this.fi0)/this.alfa),this.g=Math.pow((1+this.e*Math.sin(this.fi0))/(1-this.e*Math.sin(this.fi0)),this.alfa*this.e/2),this.k=Math.tan(this.u0/2+this.s45)/Math.pow(Math.tan(this.fi0/2+this.s45),this.alfa)*this.g,this.k1=this.k0,this.n0=this.a*Math.sqrt(1-this.e2)/(1-this.e2*Math.pow(Math.sin(this.fi0),2)),this.s0=1.37008346281555,this.n=Math.sin(this.s0),this.ro0=this.k1*this.n0/Math.tan(this.s0),this.ad=this.s90-this.uq},forward:function(t){var s,i,a,h,e,n,r,o=t.x,l=t.y,u=z(o-this.long0);return s=Math.pow((1+this.e*Math.sin(l))/(1-this.e*Math.sin(l)),this.alfa*this.e/2),i=2*(Math.atan(this.k*Math.pow(Math.tan(l/2+this.s45),this.alfa)/s)-this.s45),a=-u*this.alfa,h=Math.asin(Math.cos(this.ad)*Math.sin(i)+Math.sin(this.ad)*Math.cos(i)*Math.cos(a)),e=Math.asin(Math.cos(i)*Math.sin(a)/Math.cos(h)),n=this.n*e,r=this.ro0*Math.pow(Math.tan(this.s0/2+this.s45),this.n)/Math.pow(Math.tan(h/2+this.s45),this.n),t.y=r*Math.cos(n)/1,t.x=r*Math.sin(n)/1,this.czech||(t.y*=-1,t.x*=-1),t},inverse:function(t){var s,i,a,h,e,n,r,o=t.x;t.x=t.y,t.y=o,this.czech||(t.y*=-1,t.x*=-1),e=Math.sqrt(t.x*t.x+t.y*t.y),h=Math.atan2(t.y,t.x)/Math.sin(this.s0),a=2*(Math.atan(Math.pow(this.ro0/e,1/this.n)*Math.tan(this.s0/2+this.s45))-this.s45),s=Math.asin(Math.cos(this.ad)*Math.sin(a)-Math.sin(this.ad)*Math.cos(a)*Math.cos(h)),i=Math.asin(Math.cos(a)*Math.sin(h)/Math.cos(s)),t.x=this.long0-i/this.alfa,n=s,r=0;var l=0;do{t.y=2*(Math.atan(Math.pow(this.k,-1/this.alfa)*Math.pow(Math.tan(s/2+this.s45),1/this.alfa)*Math.pow((1+this.e*Math.sin(n))/(1-this.e*Math.sin(n)),this.e/2))-this.s45),Math.abs(n-t.y)<1e-10&&(r=1),n=t.y,l+=1}while(0===r&&l<15);return l>=15?null:t},names:["Krovak","krovak"]},cs=function(t,s,i,a,h){return t*h-s*Math.sin(2*h)+i*Math.sin(4*h)-a*Math.sin(6*h)},Ms=function(t){return 1-.25*t*(1+t/16*(3+1.25*t))},fs=function(t){return.375*t*(1+.25*t*(1+.46875*t))},ds=function(t){return.05859375*t*t*(1+.75*t)},ps=function(t){return t*t*t*(35/3072)},ms=function(t,s,i){var a=s*i;return t/Math.sqrt(1-a*a)},ys=function(t){return Math.abs(t)<n?t:t-B(t)*Math.PI},_s=function(t,s,i,a,h){var e,n;e=t/s;for(var r=0;r<15;r++)if(e+=n=(t-(s*e-i*Math.sin(2*e)+a*Math.sin(4*e)-h*Math.sin(6*e)))/(s-2*i*Math.cos(2*e)+4*a*Math.cos(4*e)-6*h*Math.cos(6*e)),Math.abs(n)<=1e-10)return e;return NaN};var xs={init:function(){this.sphere||(this.e0=Ms(this.es),this.e1=fs(this.es),this.e2=ds(this.es),this.e3=ps(this.es),this.ml0=this.a*cs(this.e0,this.e1,this.e2,this.e3,this.lat0))},forward:function(t){var s,i,a=t.x,h=t.y;if(a=z(a-this.long0),this.sphere)s=this.a*Math.asin(Math.cos(h)*Math.sin(a)),i=this.a*(Math.atan2(Math.tan(h),Math.cos(a))-this.lat0);else{var e=Math.sin(h),n=Math.cos(h),r=ms(this.a,this.e,e),o=Math.tan(h)*Math.tan(h),l=a*Math.cos(h),u=l*l,c=this.es*n*n/(1-this.es);s=r*l*(1-u*o*(1/6-(8-o+8*c)*u/120)),i=this.a*cs(this.e0,this.e1,this.e2,this.e3,h)-this.ml0+r*e/n*u*(.5+(5-o+6*c)*u/24)}return t.x=s+this.x0,t.y=i+this.y0,t},inverse:function(t){t.x-=this.x0,t.y-=this.y0;var s,i,a=t.x/this.a,h=t.y/this.a;if(this.sphere){var e=h+this.lat0;s=Math.asin(Math.sin(e)*Math.cos(a)),i=Math.atan2(Math.tan(a),Math.cos(e))}else{var r=this.ml0/this.a+h,o=_s(r,this.e0,this.e1,this.e2,this.e3);if(Math.abs(Math.abs(o)-n)<=u)return t.x=this.long0,t.y=n,h<0&&(t.y*=-1),t;var l=ms(this.a,this.e,Math.sin(o)),c=l*l*l/this.a/this.a*(1-this.es),M=Math.pow(Math.tan(o),2),f=a*this.a/l,d=f*f;s=o-l*Math.tan(o)/c*f*f*(.5-(1+3*M)*f*f/24),i=f*(1-d*(M/3+(1+3*M)*M*d/15))/Math.cos(o)}return t.x=z(i+this.long0),t.y=ys(s),t},names:["Cassini","Cassini_Soldner","cass"]},gs=function(t,s){var i;return t>1e-7?(1-t*t)*(s/(1-(i=t*s)*i)-.5/t*Math.log((1-i)/(1+i))):2*s};var vs=.3333333333333333,bs=.17222222222222222,ws=.10257936507936508,Ns=.06388888888888888,Es=.0664021164021164,As=.016415012942191543;var Cs={init:function(){var t,s=Math.abs(this.lat0);if(Math.abs(s-n)<u?this.mode=this.lat0<0?this.S_POLE:this.N_POLE:Math.abs(s)<u?this.mode=this.EQUIT:this.mode=this.OBLIQ,this.es>0)switch(this.qp=gs(this.e,1),this.mmf=.5/(1-this.es),this.apa=function(t){var s,i=[];return i[0]=t*vs,s=t*t,i[0]+=s*bs,i[1]=s*Ns,s*=t,i[0]+=s*ws,i[1]+=s*Es,i[2]=s*As,i}(this.es),this.mode){case this.N_POLE:case this.S_POLE:this.dd=1;break;case this.EQUIT:this.rq=Math.sqrt(.5*this.qp),this.dd=1/this.rq,this.xmf=1,this.ymf=.5*this.qp;break;case this.OBLIQ:this.rq=Math.sqrt(.5*this.qp),t=Math.sin(this.lat0),this.sinb1=gs(this.e,t)/this.qp,this.cosb1=Math.sqrt(1-this.sinb1*this.sinb1),this.dd=Math.cos(this.lat0)/(Math.sqrt(1-this.es*t*t)*this.rq*this.cosb1),this.ymf=(this.xmf=this.rq)/this.dd,this.xmf*=this.dd}else this.mode===this.OBLIQ&&(this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0))},forward:function(t){var s,i,a,h,e,r,o,l,c,M,d=t.x,p=t.y;if(d=z(d-this.long0),this.sphere){if(e=Math.sin(p),M=Math.cos(p),a=Math.cos(d),this.mode===this.OBLIQ||this.mode===this.EQUIT){if((i=this.mode===this.EQUIT?1+M*a:1+this.sinph0*e+this.cosph0*M*a)<=u)return null;s=(i=Math.sqrt(2/i))*M*Math.sin(d),i*=this.mode===this.EQUIT?e:this.cosph0*e-this.sinph0*M*a}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(a=-a),Math.abs(p+this.lat0)<u)return null;i=f-.5*p,s=(i=2*(this.mode===this.S_POLE?Math.cos(i):Math.sin(i)))*Math.sin(d),i*=a}}else{switch(o=0,l=0,c=0,a=Math.cos(d),h=Math.sin(d),e=Math.sin(p),r=gs(this.e,e),this.mode!==this.OBLIQ&&this.mode!==this.EQUIT||(o=r/this.qp,l=Math.sqrt(1-o*o)),this.mode){case this.OBLIQ:c=1+this.sinb1*o+this.cosb1*l*a;break;case this.EQUIT:c=1+l*a;break;case this.N_POLE:c=n+p,r=this.qp-r;break;case this.S_POLE:c=p-n,r=this.qp+r}if(Math.abs(c)<u)return null;switch(this.mode){case this.OBLIQ:case this.EQUIT:c=Math.sqrt(2/c),i=this.mode===this.OBLIQ?this.ymf*c*(this.cosb1*o-this.sinb1*l*a):(c=Math.sqrt(2/(1+l*a)))*o*this.ymf,s=this.xmf*c*l*h;break;case this.N_POLE:case this.S_POLE:r>=0?(s=(c=Math.sqrt(r))*h,i=a*(this.mode===this.S_POLE?c:-c)):s=i=0}}return t.x=this.a*s+this.x0,t.y=this.a*i+this.y0,t},inverse:function(t){t.x-=this.x0,t.y-=this.y0;var s,i,a,h,e,r,o,l,c,M,f=t.x/this.a,d=t.y/this.a;if(this.sphere){var p,m=0,y=0;if((i=.5*(p=Math.sqrt(f*f+d*d)))>1)return null;switch(i=2*Math.asin(i),this.mode!==this.OBLIQ&&this.mode!==this.EQUIT||(y=Math.sin(i),m=Math.cos(i)),this.mode){case this.EQUIT:i=Math.abs(p)<=u?0:Math.asin(d*y/p),f*=y,d=m*p;break;case this.OBLIQ:i=Math.abs(p)<=u?this.lat0:Math.asin(m*this.sinph0+d*y*this.cosph0/p),f*=y*this.cosph0,d=(m-Math.sin(i)*this.sinph0)*p;break;case this.N_POLE:d=-d,i=n-i;break;case this.S_POLE:i-=n}s=0!==d||this.mode!==this.EQUIT&&this.mode!==this.OBLIQ?Math.atan2(f,d):0}else{if(o=0,this.mode===this.OBLIQ||this.mode===this.EQUIT){if(f/=this.dd,d*=this.dd,(r=Math.sqrt(f*f+d*d))<u)return t.x=this.long0,t.y=this.lat0,t;h=2*Math.asin(.5*r/this.rq),a=Math.cos(h),f*=h=Math.sin(h),this.mode===this.OBLIQ?(o=a*this.sinb1+d*h*this.cosb1/r,e=this.qp*o,d=r*this.cosb1*a-d*this.sinb1*h):(o=d*h/r,e=this.qp*o,d=r*a)}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(d=-d),!(e=f*f+d*d))return t.x=this.long0,t.y=this.lat0,t;o=1-e/this.qp,this.mode===this.S_POLE&&(o=-o)}s=Math.atan2(f,d),l=Math.asin(o),c=this.apa,M=l+l,i=l+c[0]*Math.sin(M)+c[1]*Math.sin(M+M)+c[2]*Math.sin(M+M+M)}return t.x=z(this.long0+s),t.y=i,t},names:["Lambert Azimuthal Equal Area","Lambert_Azimuthal_Equal_Area","laea"],S_POLE:1,N_POLE:2,EQUIT:3,OBLIQ:4},Ps=function(t){return Math.abs(t)>1&&(t=t>1?1:-1),Math.asin(t)};var Ss={init:function(){Math.abs(this.lat1+this.lat2)<u||(this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e3=Math.sqrt(this.es),this.sin_po=Math.sin(this.lat1),this.cos_po=Math.cos(this.lat1),this.t1=this.sin_po,this.con=this.sin_po,this.ms1=T(this.e3,this.sin_po,this.cos_po),this.qs1=gs(this.e3,this.sin_po),this.sin_po=Math.sin(this.lat2),this.cos_po=Math.cos(this.lat2),this.t2=this.sin_po,this.ms2=T(this.e3,this.sin_po,this.cos_po),this.qs2=gs(this.e3,this.sin_po),this.sin_po=Math.sin(this.lat0),this.cos_po=Math.cos(this.lat0),this.t3=this.sin_po,this.qs0=gs(this.e3,this.sin_po),Math.abs(this.lat1-this.lat2)>u?this.ns0=(this.ms1*this.ms1-this.ms2*this.ms2)/(this.qs2-this.qs1):this.ns0=this.con,this.c=this.ms1*this.ms1+this.ns0*this.qs1,this.rh=this.a*Math.sqrt(this.c-this.ns0*this.qs0)/this.ns0)},forward:function(t){var s=t.x,i=t.y;this.sin_phi=Math.sin(i),this.cos_phi=Math.cos(i);var a=gs(this.e3,this.sin_phi),h=this.a*Math.sqrt(this.c-this.ns0*a)/this.ns0,e=this.ns0*z(s-this.long0),n=h*Math.sin(e)+this.x0,r=this.rh-h*Math.cos(e)+this.y0;return t.x=n,t.y=r,t},inverse:function(t){var s,i,a,h,e,n;return t.x-=this.x0,t.y=this.rh-t.y+this.y0,this.ns0>=0?(s=Math.sqrt(t.x*t.x+t.y*t.y),a=1):(s=-Math.sqrt(t.x*t.x+t.y*t.y),a=-1),h=0,0!==s&&(h=Math.atan2(a*t.x,a*t.y)),a=s*this.ns0/this.a,this.sphere?n=Math.asin((this.c-a*a)/(2*this.ns0)):(i=(this.c-a*a)/this.ns0,n=this.phi1z(this.e3,i)),e=z(h/this.ns0+this.long0),t.x=e,t.y=n,t},names:["Albers_Conic_Equal_Area","Albers","aea"],phi1z:function(t,s){var i,a,h,e,n=Ps(.5*s);if(t<u)return n;for(var r=t*t,o=1;o<=25;o++)if(n+=e=.5*(h=1-(a=t*(i=Math.sin(n)))*a)*h/Math.cos(n)*(s/(1-r)-i/h+.5/t*Math.log((1-a)/(1+a))),Math.abs(e)<=1e-7)return n;return null}};var Is={init:function(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0),this.infinity_dist=1e3*this.a,this.rc=1},forward:function(t){var s,i,a,h,e,n,r,o=t.x,l=t.y;return a=z(o-this.long0),s=Math.sin(l),i=Math.cos(l),h=Math.cos(a),(e=this.sin_p14*s+this.cos_p14*i*h)>0||Math.abs(e)<=u?(n=this.x0+1*this.a*i*Math.sin(a)/e,r=this.y0+1*this.a*(this.cos_p14*s-this.sin_p14*i*h)/e):(n=this.x0+this.infinity_dist*i*Math.sin(a),r=this.y0+this.infinity_dist*(this.cos_p14*s-this.sin_p14*i*h)),t.x=n,t.y=r,t},inverse:function(t){var s,i,a,h,e,n;return t.x=(t.x-this.x0)/this.a,t.y=(t.y-this.y0)/this.a,t.x/=this.k0,t.y/=this.k0,(s=Math.sqrt(t.x*t.x+t.y*t.y))?(h=Math.atan2(s,this.rc),i=Math.sin(h),a=Math.cos(h),n=Ps(a*this.sin_p14+t.y*i*this.cos_p14/s),e=Math.atan2(t.x*i,s*this.cos_p14*a-t.y*this.sin_p14*i),e=z(this.long0+e)):(n=this.phic0,e=0),t.x=e,t.y=n,t},names:["gnom"]},Os=function(t,s){var i=1-(1-t*t)/(2*t)*Math.log((1-t)/(1+t));if(Math.abs(Math.abs(s)-i)<1e-6)return s<0?-1*n:n;for(var a,h,e,r,o=Math.asin(.5*s),l=0;l<30;l++)if(h=Math.sin(o),e=Math.cos(o),r=t*h,o+=a=Math.pow(1-r*r,2)/(2*e)*(s/(1-t*t)-h/(1-r*r)+.5/t*Math.log((1-r)/(1+r))),Math.abs(a)<=1e-10)return o;return NaN};var ks={init:function(){this.sphere||(this.k0=T(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)))},forward:function(t){var s,i,a=t.x,h=t.y,e=z(a-this.long0);if(this.sphere)s=this.x0+this.a*e*Math.cos(this.lat_ts),i=this.y0+this.a*Math.sin(h)/Math.cos(this.lat_ts);else{var n=gs(this.e,Math.sin(h));s=this.x0+this.a*this.k0*e,i=this.y0+this.a*n*.5/this.k0}return t.x=s,t.y=i,t},inverse:function(t){var s,i;return t.x-=this.x0,t.y-=this.y0,this.sphere?(s=z(this.long0+t.x/this.a/Math.cos(this.lat_ts)),i=Math.asin(t.y/this.a*Math.cos(this.lat_ts))):(i=Os(this.e,2*t.y*this.k0/this.a),s=z(this.long0+t.x/(this.a*this.k0))),t.x=s,t.y=i,t},names:["cea"]};var qs={init:function(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Equidistant Cylindrical (Plate Carre)",this.rc=Math.cos(this.lat_ts)},forward:function(t){var s=t.x,i=t.y,a=z(s-this.long0),h=ys(i-this.lat0);return t.x=this.x0+this.a*a*this.rc,t.y=this.y0+this.a*h,t},inverse:function(t){var s=t.x,i=t.y;return t.x=z(this.long0+(s-this.x0)/(this.a*this.rc)),t.y=ys(this.lat0+(i-this.y0)/this.a),t},names:["Equirectangular","Equidistant_Cylindrical","eqc"]},Rs=20;var Ls={init:function(){this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=Ms(this.es),this.e1=fs(this.es),this.e2=ds(this.es),this.e3=ps(this.es),this.ml0=this.a*cs(this.e0,this.e1,this.e2,this.e3,this.lat0)},forward:function(t){var s,i,a,h=t.x,e=t.y,n=z(h-this.long0);if(a=n*Math.sin(e),this.sphere)Math.abs(e)<=u?(s=this.a*n,i=-1*this.a*this.lat0):(s=this.a*Math.sin(a)/Math.tan(e),i=this.a*(ys(e-this.lat0)+(1-Math.cos(a))/Math.tan(e)));else if(Math.abs(e)<=u)s=this.a*n,i=-1*this.ml0;else{var r=ms(this.a,this.e,Math.sin(e))/Math.tan(e);s=r*Math.sin(a),i=this.a*cs(this.e0,this.e1,this.e2,this.e3,e)-this.ml0+r*(1-Math.cos(a))}return t.x=s+this.x0,t.y=i+this.y0,t},inverse:function(t){var s,i,a,h,e,n,r,o,l;if(a=t.x-this.x0,h=t.y-this.y0,this.sphere)if(Math.abs(h+this.a*this.lat0)<=u)s=z(a/this.a+this.long0),i=0;else{var c;for(n=this.lat0+h/this.a,r=a*a/this.a/this.a+n*n,o=n,e=Rs;e;--e)if(o+=l=-1*(n*(o*(c=Math.tan(o))+1)-o-.5*(o*o+r)*c)/((o-n)/c-1),Math.abs(l)<=u){i=o;break}s=z(this.long0+Math.asin(a*Math.tan(o)/this.a)/Math.sin(i))}else if(Math.abs(h+this.ml0)<=u)i=0,s=z(this.long0+a/this.a);else{var M,f,d,p,m;for(n=(this.ml0+h)/this.a,r=a*a/this.a/this.a+n*n,o=n,e=Rs;e;--e)if(m=this.e*Math.sin(o),M=Math.sqrt(1-m*m)*Math.tan(o),f=this.a*cs(this.e0,this.e1,this.e2,this.e3,o),d=this.e0-2*this.e1*Math.cos(2*o)+4*this.e2*Math.cos(4*o)-6*this.e3*Math.cos(6*o),o-=l=(n*(M*(p=f/this.a)+1)-p-.5*M*(p*p+r))/(this.es*Math.sin(2*o)*(p*p+r-2*n*p)/(4*M)+(n-p)*(M*d-2/Math.sin(2*o))-d),Math.abs(l)<=u){i=o;break}M=Math.sqrt(1-this.es*Math.pow(Math.sin(i),2))*Math.tan(i),s=z(this.long0+Math.asin(a*M/this.a)/Math.sin(i))}return t.x=s,t.y=i,t},names:["Polyconic","poly"]};var js={init:function(){this.A=[],this.A[1]=.6399175073,this.A[2]=-.1358797613,this.A[3]=.063294409,this.A[4]=-.02526853,this.A[5]=.0117879,this.A[6]=-.0055161,this.A[7]=.0026906,this.A[8]=-.001333,this.A[9]=67e-5,this.A[10]=-34e-5,this.B_re=[],this.B_im=[],this.B_re[1]=.7557853228,this.B_im[1]=0,this.B_re[2]=.249204646,this.B_im[2]=.003371507,this.B_re[3]=-.001541739,this.B_im[3]=.04105856,this.B_re[4]=-.10162907,this.B_im[4]=.01727609,this.B_re[5]=-.26623489,this.B_im[5]=-.36249218,this.B_re[6]=-.6870983,this.B_im[6]=-1.1651967,this.C_re=[],this.C_im=[],this.C_re[1]=1.3231270439,this.C_im[1]=0,this.C_re[2]=-.577245789,this.C_im[2]=-.007809598,this.C_re[3]=.508307513,this.C_im[3]=-.112208952,this.C_re[4]=-.15094762,this.C_im[4]=.18200602,this.C_re[5]=1.01418179,this.C_im[5]=1.64497696,this.C_re[6]=1.9660549,this.C_im[6]=2.5127645,this.D=[],this.D[1]=1.5627014243,this.D[2]=.5185406398,this.D[3]=-.03333098,this.D[4]=-.1052906,this.D[5]=-.0368594,this.D[6]=.007317,this.D[7]=.0122,this.D[8]=.00394,this.D[9]=-.0013},forward:function(t){var s,i=t.x,a=t.y-this.lat0,h=i-this.long0,n=a/e*1e-5,r=h,o=1,l=0;for(s=1;s<=10;s++)o*=n,l+=this.A[s]*o;var u,c=l,M=r,f=1,d=0,p=0,m=0;for(s=1;s<=6;s++)u=d*c+f*M,f=f*c-d*M,d=u,p=p+this.B_re[s]*f-this.B_im[s]*d,m=m+this.B_im[s]*f+this.B_re[s]*d;return t.x=m*this.a+this.x0,t.y=p*this.a+this.y0,t},inverse:function(t){var s,i,a=t.x,h=t.y,n=a-this.x0,r=(h-this.y0)/this.a,o=n/this.a,l=1,u=0,c=0,M=0;for(s=1;s<=6;s++)i=u*r+l*o,l=l*r-u*o,u=i,c=c+this.C_re[s]*l-this.C_im[s]*u,M=M+this.C_im[s]*l+this.C_re[s]*u;for(var f=0;f<this.iterations;f++){var d,p=c,m=M,y=r,_=o;for(s=2;s<=6;s++)d=m*c+p*M,p=p*c-m*M,m=d,y+=(s-1)*(this.B_re[s]*p-this.B_im[s]*m),_+=(s-1)*(this.B_im[s]*p+this.B_re[s]*m);p=1,m=0;var x=this.B_re[1],g=this.B_im[1];for(s=2;s<=6;s++)d=m*c+p*M,p=p*c-m*M,m=d,x+=s*(this.B_re[s]*p-this.B_im[s]*m),g+=s*(this.B_im[s]*p+this.B_re[s]*m);var v=x*x+g*g;c=(y*x+_*g)/v,M=(_*x-y*g)/v}var b=c,w=M,N=1,E=0;for(s=1;s<=9;s++)N*=b,E+=this.D[s]*N;var A=this.lat0+E*e*1e5,C=this.long0+w;return t.x=C,t.y=A,t},names:["New_Zealand_Map_Grid","nzmg"]};var Gs={init:function(){},forward:function(t){var s=t.x,i=t.y,a=z(s-this.long0),h=this.x0+this.a*a,e=this.y0+this.a*Math.log(Math.tan(Math.PI/4+i/2.5))*1.25;return t.x=h,t.y=e,t},inverse:function(t){t.x-=this.x0,t.y-=this.y0;var s=z(this.long0+t.x/this.a),i=2.5*(Math.atan(Math.exp(.8*t.y/this.a))-Math.PI/4);return t.x=s,t.y=i,t},names:["Miller_Cylindrical","mill"]},Ts=20;var Bs={init:function(){this.sphere?(this.n=1,this.m=0,this.es=0,this.C_y=Math.sqrt((this.m+1)/this.n),this.C_x=this.C_y/(this.m+1)):this.en=Dt(this.es)},forward:function(t){var s,i,a=t.x,h=t.y;if(a=z(a-this.long0),this.sphere){if(this.m)for(var e=this.n*Math.sin(h),n=Ts;n;--n){var r=(this.m*h+Math.sin(h)-e)/(this.m+Math.cos(h));if(h-=r,Math.abs(r)<u)break}else h=1!==this.n?Math.asin(this.n*Math.sin(h)):h;s=this.a*this.C_x*a*(this.m+Math.cos(h)),i=this.a*this.C_y*h}else{var o=Math.sin(h),l=Math.cos(h);i=this.a*Ut(h,o,l,this.en),s=this.a*a*l/Math.sqrt(1-this.es*o*o)}return t.x=s,t.y=i,t},inverse:function(t){var s,i,a,h;return t.x-=this.x0,a=t.x/this.a,t.y-=this.y0,s=t.y/this.a,this.sphere?(s/=this.C_y,a/=this.C_x*(this.m+Math.cos(s)),this.m?s=Ps((this.m*s+Math.sin(s))/this.n):1!==this.n&&(s=Ps(Math.sin(s)/this.n)),a=z(a+this.long0),s=ys(s)):(s=Qt(t.y/this.a,this.es,this.en),(h=Math.abs(s))<n?(h=Math.sin(s),i=this.long0+t.x*Math.sqrt(1-this.es*h*h)/(this.a*Math.cos(s)),a=z(i)):h-u<n&&(a=this.long0)),t.x=a,t.y=s,t},names:["Sinusoidal","sinu"]};var zs={init:function(){},forward:function(t){for(var s=t.x,i=t.y,a=z(s-this.long0),h=i,e=Math.PI*Math.sin(i);;){var n=-(h+Math.sin(h)-e)/(1+Math.cos(h));if(h+=n,Math.abs(n)<u)break}h/=2,Math.PI/2-Math.abs(i)<u&&(a=0);var r=.900316316158*this.a*a*Math.cos(h)+this.x0,o=1.4142135623731*this.a*Math.sin(h)+this.y0;return t.x=r,t.y=o,t},inverse:function(t){var s,i;t.x-=this.x0,t.y-=this.y0,i=t.y/(1.4142135623731*this.a),Math.abs(i)>.999999999999&&(i=.999999999999),s=Math.asin(i);var a=z(this.long0+t.x/(.900316316158*this.a*Math.cos(s)));a<-Math.PI&&(a=-Math.PI),a>Math.PI&&(a=Math.PI),i=(2*s+Math.sin(2*s))/Math.PI,Math.abs(i)>1&&(i=1);var h=Math.asin(i);return t.x=a,t.y=h,t},names:["Mollweide","moll"]};var Fs={init:function(){Math.abs(this.lat1+this.lat2)<u||(this.lat2=this.lat2||this.lat1,this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=Ms(this.es),this.e1=fs(this.es),this.e2=ds(this.es),this.e3=ps(this.es),this.sinphi=Math.sin(this.lat1),this.cosphi=Math.cos(this.lat1),this.ms1=T(this.e,this.sinphi,this.cosphi),this.ml1=cs(this.e0,this.e1,this.e2,this.e3,this.lat1),Math.abs(this.lat1-this.lat2)<u?this.ns=this.sinphi:(this.sinphi=Math.sin(this.lat2),this.cosphi=Math.cos(this.lat2),this.ms2=T(this.e,this.sinphi,this.cosphi),this.ml2=cs(this.e0,this.e1,this.e2,this.e3,this.lat2),this.ns=(this.ms1-this.ms2)/(this.ml2-this.ml1)),this.g=this.ml1+this.ms1/this.ns,this.ml0=cs(this.e0,this.e1,this.e2,this.e3,this.lat0),this.rh=this.a*(this.g-this.ml0))},forward:function(t){var s,i=t.x,a=t.y;if(this.sphere)s=this.a*(this.g-a);else{var h=cs(this.e0,this.e1,this.e2,this.e3,a);s=this.a*(this.g-h)}var e=this.ns*z(i-this.long0),n=this.x0+s*Math.sin(e),r=this.y0+this.rh-s*Math.cos(e);return t.x=n,t.y=r,t},inverse:function(t){var s,i,a,h;t.x-=this.x0,t.y=this.rh-t.y+this.y0,this.ns>=0?(i=Math.sqrt(t.x*t.x+t.y*t.y),s=1):(i=-Math.sqrt(t.x*t.x+t.y*t.y),s=-1);var e=0;if(0!==i&&(e=Math.atan2(s*t.x,s*t.y)),this.sphere)return h=z(this.long0+e/this.ns),a=ys(this.g-i/this.a),t.x=h,t.y=a,t;var n=this.g-i/this.a;return a=_s(n,this.e0,this.e1,this.e2,this.e3),h=z(this.long0+e/this.ns),t.x=h,t.y=a,t},names:["Equidistant_Conic","eqdc"]};var Ds={init:function(){this.R=this.a},forward:function(t){var s,i,a=t.x,h=t.y,e=z(a-this.long0);Math.abs(h)<=u&&(s=this.x0+this.R*e,i=this.y0);var r=Ps(2*Math.abs(h/Math.PI));(Math.abs(e)<=u||Math.abs(Math.abs(h)-n)<=u)&&(s=this.x0,i=h>=0?this.y0+Math.PI*this.R*Math.tan(.5*r):this.y0+Math.PI*this.R*-Math.tan(.5*r));var o=.5*Math.abs(Math.PI/e-e/Math.PI),l=o*o,c=Math.sin(r),M=Math.cos(r),f=M/(c+M-1),d=f*f,p=f*(2/c-1),m=p*p,y=Math.PI*this.R*(o*(f-m)+Math.sqrt(l*(f-m)*(f-m)-(m+l)*(d-m)))/(m+l);e<0&&(y=-y),s=this.x0+y;var _=l+f;return y=Math.PI*this.R*(p*_-o*Math.sqrt((m+l)*(l+1)-_*_))/(m+l),i=h>=0?this.y0+y:this.y0-y,t.x=s,t.y=i,t},inverse:function(t){var s,i,a,h,e,n,r,o,l,c,M,f;return t.x-=this.x0,t.y-=this.y0,M=Math.PI*this.R,e=(a=t.x/M)*a+(h=t.y/M)*h,M=3*(h*h/(o=-2*(n=-Math.abs(h)*(1+e))+1+2*h*h+e*e)+(2*(r=n-2*h*h+a*a)*r*r/o/o/o-9*n*r/o/o)/27)/(l=(n-r*r/3/o)/o)/(c=2*Math.sqrt(-l/3)),Math.abs(M)>1&&(M=M>=0?1:-1),f=Math.acos(M)/3,i=t.y>=0?(-c*Math.cos(f+Math.PI/3)-r/3/o)*Math.PI:-(-c*Math.cos(f+Math.PI/3)-r/3/o)*Math.PI,s=Math.abs(a)<u?this.long0:z(this.long0+Math.PI*(e-1+Math.sqrt(1+2*(a*a-h*h)+e*e))/2/a),t.x=s,t.y=i,t},names:["Van_der_Grinten_I","VanDerGrinten","vandg"]};var Us={init:function(){this.sin_p12=Math.sin(this.lat0),this.cos_p12=Math.cos(this.lat0)},forward:function(t){var s,i,a,h,e,r,o,l,c,M,f,d,p,m,y,_,x,g,v,b,w,N,E=t.x,A=t.y,C=Math.sin(t.y),P=Math.cos(t.y),S=z(E-this.long0);return this.sphere?Math.abs(this.sin_p12-1)<=u?(t.x=this.x0+this.a*(n-A)*Math.sin(S),t.y=this.y0-this.a*(n-A)*Math.cos(S),t):Math.abs(this.sin_p12+1)<=u?(t.x=this.x0+this.a*(n+A)*Math.sin(S),t.y=this.y0+this.a*(n+A)*Math.cos(S),t):(g=this.sin_p12*C+this.cos_p12*P*Math.cos(S),x=(_=Math.acos(g))?_/Math.sin(_):1,t.x=this.x0+this.a*x*P*Math.sin(S),t.y=this.y0+this.a*x*(this.cos_p12*C-this.sin_p12*P*Math.cos(S)),t):(s=Ms(this.es),i=fs(this.es),a=ds(this.es),h=ps(this.es),Math.abs(this.sin_p12-1)<=u?(e=this.a*cs(s,i,a,h,n),r=this.a*cs(s,i,a,h,A),t.x=this.x0+(e-r)*Math.sin(S),t.y=this.y0-(e-r)*Math.cos(S),t):Math.abs(this.sin_p12+1)<=u?(e=this.a*cs(s,i,a,h,n),r=this.a*cs(s,i,a,h,A),t.x=this.x0+(e+r)*Math.sin(S),t.y=this.y0+(e+r)*Math.cos(S),t):(o=C/P,l=ms(this.a,this.e,this.sin_p12),c=ms(this.a,this.e,C),M=Math.atan((1-this.es)*o+this.es*l*this.sin_p12/(c*P)),v=0===(f=Math.atan2(Math.sin(S),this.cos_p12*Math.tan(M)-this.sin_p12*Math.cos(S)))?Math.asin(this.cos_p12*Math.sin(M)-this.sin_p12*Math.cos(M)):Math.abs(Math.abs(f)-Math.PI)<=u?-Math.asin(this.cos_p12*Math.sin(M)-this.sin_p12*Math.cos(M)):Math.asin(Math.sin(S)*Math.cos(M)/Math.sin(f)),d=this.e*this.sin_p12/Math.sqrt(1-this.es),_=l*v*(1-(b=v*v)*(y=(p=this.e*this.cos_p12*Math.cos(f)/Math.sqrt(1-this.es))*p)*(1-y)/6+(w=b*v)/8*(m=d*p)*(1-2*y)+(N=w*v)/120*(y*(4-7*y)-3*d*d*(1-7*y))-N*v/48*m),t.x=this.x0+_*Math.sin(f),t.y=this.y0+_*Math.cos(f),t))},inverse:function(t){var s,i,a,h,e,r,o,l,c,M,f,d,p,m,y,_,x,g,v,b,w,N,E;if(t.x-=this.x0,t.y-=this.y0,this.sphere){if((s=Math.sqrt(t.x*t.x+t.y*t.y))>2*n*this.a)return;return i=s/this.a,a=Math.sin(i),h=Math.cos(i),e=this.long0,Math.abs(s)<=u?r=this.lat0:(r=Ps(h*this.sin_p12+t.y*a*this.cos_p12/s),o=Math.abs(this.lat0)-n,e=Math.abs(o)<=u?this.lat0>=0?z(this.long0+Math.atan2(t.x,-t.y)):z(this.long0-Math.atan2(-t.x,t.y)):z(this.long0+Math.atan2(t.x*a,s*this.cos_p12*h-t.y*this.sin_p12*a))),t.x=e,t.y=r,t}return l=Ms(this.es),c=fs(this.es),M=ds(this.es),f=ps(this.es),Math.abs(this.sin_p12-1)<=u?(d=this.a*cs(l,c,M,f,n),s=Math.sqrt(t.x*t.x+t.y*t.y),r=_s((d-s)/this.a,l,c,M,f),e=z(this.long0+Math.atan2(t.x,-1*t.y)),t.x=e,t.y=r,t):Math.abs(this.sin_p12+1)<=u?(d=this.a*cs(l,c,M,f,n),s=Math.sqrt(t.x*t.x+t.y*t.y),r=_s((s-d)/this.a,l,c,M,f),e=z(this.long0+Math.atan2(t.x,t.y)),t.x=e,t.y=r,t):(s=Math.sqrt(t.x*t.x+t.y*t.y),y=Math.atan2(t.x,t.y),p=ms(this.a,this.e,this.sin_p12),_=Math.cos(y),g=-(x=this.e*this.cos_p12*_)*x/(1-this.es),v=3*this.es*(1-g)*this.sin_p12*this.cos_p12*_/(1-this.es),N=1-g*(w=(b=s/p)-g*(1+g)*Math.pow(b,3)/6-v*(1+3*g)*Math.pow(b,4)/24)*w/2-b*w*w*w/6,m=Math.asin(this.sin_p12*Math.cos(w)+this.cos_p12*Math.sin(w)*_),e=z(this.long0+Math.asin(Math.sin(y)*Math.sin(w)/Math.cos(m))),E=Math.sin(m),r=Math.atan2((E-this.es*N*this.sin_p12)*Math.tan(m),E*(1-this.es)),t.x=e,t.y=r,t)},names:["Azimuthal_Equidistant","aeqd"]};var Qs={init:function(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0)},forward:function(t){var s,i,a,h,e,n,r,o=t.x,l=t.y;return a=z(o-this.long0),s=Math.sin(l),i=Math.cos(l),h=Math.cos(a),((e=this.sin_p14*s+this.cos_p14*i*h)>0||Math.abs(e)<=u)&&(n=1*this.a*i*Math.sin(a),r=this.y0+1*this.a*(this.cos_p14*s-this.sin_p14*i*h)),t.x=n,t.y=r,t},inverse:function(t){var s,i,a,h,e,r,o;return t.x-=this.x0,t.y-=this.y0,s=Math.sqrt(t.x*t.x+t.y*t.y),i=Ps(s/this.a),a=Math.sin(i),h=Math.cos(i),r=this.long0,Math.abs(s)<=u?(o=this.lat0,t.x=r,t.y=o,t):(o=Ps(h*this.sin_p14+t.y*a*this.cos_p14/s),e=Math.abs(this.lat0)-n,Math.abs(e)<=u?(r=this.lat0>=0?z(this.long0+Math.atan2(t.x,-t.y)):z(this.long0-Math.atan2(-t.x,t.y)),t.x=r,t.y=o,t):(r=z(this.long0+Math.atan2(t.x*a,s*this.cos_p14*h-t.y*this.sin_p14*a)),t.x=r,t.y=o,t))},names:["ortho"]},Ws={FRONT:1,RIGHT:2,BACK:3,LEFT:4,TOP:5,BOTTOM:6},Hs={AREA_0:1,AREA_1:2,AREA_2:3,AREA_3:4};function Xs(t,s,i,a){var h;return t<u?(a.value=Hs.AREA_0,h=0):(h=Math.atan2(s,i),Math.abs(h)<=f?a.value=Hs.AREA_0:h>f&&h<=n+f?(a.value=Hs.AREA_1,h-=n):h>n+f||h<=-(n+f)?(a.value=Hs.AREA_2,h=h>=0?h-p:h+p):(a.value=Hs.AREA_3,h+=n)),h}function Ks(t,s){var i=t+s;return i<-p?i+=d:i>+p&&(i-=d),i}var Js={init:function(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Quadrilateralized Spherical Cube",this.lat0>=n-f/2?this.face=Ws.TOP:this.lat0<=-(n-f/2)?this.face=Ws.BOTTOM:Math.abs(this.long0)<=f?this.face=Ws.FRONT:Math.abs(this.long0)<=n+f?this.face=this.long0>0?Ws.RIGHT:Ws.LEFT:this.face=Ws.BACK,0!==this.es&&(this.one_minus_f=1-(this.a-this.b)/this.a,this.one_minus_f_squared=this.one_minus_f*this.one_minus_f)},forward:function(t){var s,i,a,h,e,r,o={x:0,y:0},l={value:0};if(t.x-=this.long0,s=0!==this.es?Math.atan(this.one_minus_f_squared*Math.tan(t.y)):t.y,i=t.x,this.face===Ws.TOP)h=n-s,i>=f&&i<=n+f?(l.value=Hs.AREA_0,a=i-n):i>n+f||i<=-(n+f)?(l.value=Hs.AREA_1,a=i>0?i-p:i+p):i>-(n+f)&&i<=-f?(l.value=Hs.AREA_2,a=i+n):(l.value=Hs.AREA_3,a=i);else if(this.face===Ws.BOTTOM)h=n+s,i>=f&&i<=n+f?(l.value=Hs.AREA_0,a=-i+n):i<f&&i>=-f?(l.value=Hs.AREA_1,a=-i):i<-f&&i>=-(n+f)?(l.value=Hs.AREA_2,a=-i-n):(l.value=Hs.AREA_3,a=i>0?-i+p:-i-p);else{var u,c,M,d,m,y;this.face===Ws.RIGHT?i=Ks(i,+n):this.face===Ws.BACK?i=Ks(i,+p):this.face===Ws.LEFT&&(i=Ks(i,-n)),d=Math.sin(s),m=Math.cos(s),y=Math.sin(i),u=m*Math.cos(i),c=m*y,M=d,this.face===Ws.FRONT?a=Xs(h=Math.acos(u),M,c,l):this.face===Ws.RIGHT?a=Xs(h=Math.acos(c),M,-u,l):this.face===Ws.BACK?a=Xs(h=Math.acos(-u),M,-c,l):this.face===Ws.LEFT?a=Xs(h=Math.acos(-c),M,u,l):(h=a=0,l.value=Hs.AREA_0)}return r=Math.atan(12/p*(a+Math.acos(Math.sin(a)*Math.cos(f))-n)),e=Math.sqrt((1-Math.cos(h))/(Math.cos(r)*Math.cos(r))/(1-Math.cos(Math.atan(1/Math.cos(a))))),l.value===Hs.AREA_1?r+=n:l.value===Hs.AREA_2?r+=p:l.value===Hs.AREA_3&&(r+=1.5*p),o.x=e*Math.cos(r),o.y=e*Math.sin(r),o.x=o.x*this.a+this.x0,o.y=o.y*this.a+this.y0,t.x=o.x,t.y=o.y,t},inverse:function(t){var s,i,a,h,e,r,o,l,u,c,M,f,d={lam:0,phi:0},m={value:0};if(t.x=(t.x-this.x0)/this.a,t.y=(t.y-this.y0)/this.a,i=Math.atan(Math.sqrt(t.x*t.x+t.y*t.y)),s=Math.atan2(t.y,t.x),t.x>=0&&t.x>=Math.abs(t.y)?m.value=Hs.AREA_0:t.y>=0&&t.y>=Math.abs(t.x)?(m.value=Hs.AREA_1,s-=n):t.x<0&&-t.x>=Math.abs(t.y)?(m.value=Hs.AREA_2,s=s<0?s+p:s-p):(m.value=Hs.AREA_3,s+=n),u=p/12*Math.tan(s),e=Math.sin(u)/(Math.cos(u)-1/Math.sqrt(2)),r=Math.atan(e),(o=1-(a=Math.cos(s))*a*(h=Math.tan(i))*h*(1-Math.cos(Math.atan(1/Math.cos(r)))))<-1?o=-1:o>1&&(o=1),this.face===Ws.TOP)l=Math.acos(o),d.phi=n-l,m.value===Hs.AREA_0?d.lam=r+n:m.value===Hs.AREA_1?d.lam=r<0?r+p:r-p:m.value===Hs.AREA_2?d.lam=r-n:d.lam=r;else if(this.face===Ws.BOTTOM)l=Math.acos(o),d.phi=l-n,m.value===Hs.AREA_0?d.lam=-r+n:m.value===Hs.AREA_1?d.lam=-r:m.value===Hs.AREA_2?d.lam=-r-n:d.lam=r<0?-r-p:-r+p;else{var y,_,x;u=(y=o)*y,_=(u+=(x=u>=1?0:Math.sqrt(1-u)*Math.sin(r))*x)>=1?0:Math.sqrt(1-u),m.value===Hs.AREA_1?(u=_,_=-x,x=u):m.value===Hs.AREA_2?(_=-_,x=-x):m.value===Hs.AREA_3&&(u=_,_=x,x=-u),this.face===Ws.RIGHT?(u=y,y=-_,_=u):this.face===Ws.BACK?(y=-y,_=-_):this.face===Ws.LEFT&&(u=y,y=_,_=-u),d.phi=Math.acos(-x)-n,d.lam=Math.atan2(_,y),this.face===Ws.RIGHT?d.lam=Ks(d.lam,-n):this.face===Ws.BACK?d.lam=Ks(d.lam,-p):this.face===Ws.LEFT&&(d.lam=Ks(d.lam,+n))}return 0!==this.es&&(c=d.phi<0?1:0,M=Math.tan(d.phi),f=this.b/Math.sqrt(M*M+this.one_minus_f_squared),d.phi=Math.atan(Math.sqrt(this.a*this.a-f*f)/(this.one_minus_f*f)),c&&(d.phi=-d.phi)),d.lam+=this.long0,t.x=d.lam,t.y=d.phi,t},names:["Quadrilateralized Spherical Cube","Quadrilateralized_Spherical_Cube","qsc"]},Vs=[[1,2.2199e-17,-715515e-10,31103e-10],[.9986,-482243e-9,-24897e-9,-13309e-10],[.9954,-83103e-8,-448605e-10,-9.86701e-7],[.99,-.00135364,-59661e-9,36777e-10],[.9822,-.00167442,-449547e-11,-572411e-11],[.973,-.00214868,-903571e-10,1.8736e-8],[.96,-.00305085,-900761e-10,164917e-11],[.9427,-.00382792,-653386e-10,-26154e-10],[.9216,-.00467746,-10457e-8,481243e-11],[.8962,-.00536223,-323831e-10,-543432e-11],[.8679,-.00609363,-113898e-9,332484e-11],[.835,-.00698325,-640253e-10,9.34959e-7],[.7986,-.00755338,-500009e-10,9.35324e-7],[.7597,-.00798324,-35971e-9,-227626e-11],[.7186,-.00851367,-701149e-10,-86303e-10],[.6732,-.00986209,-199569e-9,191974e-10],[.6213,-.010418,883923e-10,624051e-11],[.5722,-.00906601,182e-6,624051e-11],[.5322,-.00677797,275608e-9,624051e-11]],Zs=[[-5.20417e-18,.0124,1.21431e-18,-8.45284e-11],[.062,.0124,-1.26793e-9,4.22642e-10],[.124,.0124,5.07171e-9,-1.60604e-9],[.186,.0123999,-1.90189e-8,6.00152e-9],[.248,.0124002,7.10039e-8,-2.24e-8],[.31,.0123992,-2.64997e-7,8.35986e-8],[.372,.0124029,9.88983e-7,-3.11994e-7],[.434,.0123893,-369093e-11,-4.35621e-7],[.4958,.0123198,-102252e-10,-3.45523e-7],[.5571,.0121916,-154081e-10,-5.82288e-7],[.6176,.0119938,-241424e-10,-5.25327e-7],[.6769,.011713,-320223e-10,-5.16405e-7],[.7346,.0113541,-397684e-10,-6.09052e-7],[.7903,.0109107,-489042e-10,-104739e-11],[.8435,.0103431,-64615e-9,-1.40374e-9],[.8936,.00969686,-64636e-9,-8547e-9],[.9394,.00840947,-192841e-9,-42106e-10],[.9761,.00616527,-256e-6,-42106e-10],[1,.00328947,-319159e-9,-42106e-10]],Ys=.8487,$s=1.3523,ti=M/5,si=1/ti,ii=18,ai=function(t,s){return t[0]+s*(t[1]+s*(t[2]+s*t[3]))},hi=function(t,s){return t[1]+s*(2*t[2]+3*s*t[3])};var ei={init:function(){this.x0=this.x0||0,this.y0=this.y0||0,this.long0=this.long0||0,this.es=0,this.title=this.title||"Robinson"},forward:function(t){var s=z(t.x-this.long0),i=Math.abs(t.y),a=Math.floor(i*ti);a<0?a=0:a>=ii&&(a=ii-1),i=M*(i-si*a);var h={x:ai(Vs[a],i)*s,y:ai(Zs[a],i)};return t.y<0&&(h.y=-h.y),h.x=h.x*this.a*Ys+this.x0,h.y=h.y*this.a*$s+this.y0,h},inverse:function(t){var s={x:(t.x-this.x0)/(this.a*Ys),y:Math.abs(t.y-this.y0)/(this.a*$s)};if(s.y>=1)s.x/=Vs[ii][0],s.y=t.y<0?-n:n;else{var i=Math.floor(s.y*ii);for(i<0?i=0:i>=ii&&(i=ii-1);;)if(Zs[i][0]>s.y)--i;else{if(!(Zs[i+1][0]<=s.y))break;++i}var a=Zs[i],h=5*(s.y-a[0])/(Zs[i+1][0]-a[0]);h=function(t,s,i,a){for(var h=s;a;--a){var e=t(h);if(h-=e,Math.abs(e)<i)break}return h}(function(t){return(ai(a,t)-s.y)/hi(a,t)},h,u,100),s.x/=ai(Vs[i],h),s.y=(5*i+h)*c,t.y<0&&(s.y=-s.y)}return s.x=z(s.x+this.long0),s},names:["Robinson","robin"]};var ni={init:function(){this.name="geocent"},forward:function(t){return nt(t,this.es,this.a)},inverse:function(t){return rt(t,this.es,this.a,this.b)},names:["Geocentric","geocentric","geocent","Geocent"]},ri={N_POLE:0,S_POLE:1,EQUIT:2,OBLIQ:3},oi={h:{def:1e5,num:!0},azi:{def:0,num:!0,degrees:!0},tilt:{def:0,num:!0,degrees:!0},long0:{def:0,num:!0},lat0:{def:0,num:!0}};var li={init:function(){if(Object.keys(oi).forEach(function(t){if(void 0===this[t])this[t]=oi[t].def;else{if(oi[t].num&&isNaN(this[t]))throw new Error("Invalid parameter value, must be numeric "+t+" = "+this[t]);oi[t].num&&(this[t]=parseFloat(this[t]))}oi[t].degrees&&(this[t]=this[t]*c)}.bind(this)),Math.abs(Math.abs(this.lat0)-n)<u?this.mode=this.lat0<0?ri.S_POLE:ri.N_POLE:Math.abs(this.lat0)<u?this.mode=ri.EQUIT:(this.mode=ri.OBLIQ,this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0)),this.pn1=this.h/this.a,this.pn1<=0||this.pn1>1e10)throw new Error("Invalid height");this.p=1+this.pn1,this.rp=1/this.p,this.h1=1/this.pn1,this.pfact=(this.p+1)*this.h1,this.es=0;var t=this.tilt,s=this.azi;this.cg=Math.cos(s),this.sg=Math.sin(s),this.cw=Math.cos(t),this.sw=Math.sin(t)},forward:function(t){t.x-=this.long0;var s,i,a,h,e=Math.sin(t.y),n=Math.cos(t.y),r=Math.cos(t.x);switch(this.mode){case ri.OBLIQ:i=this.sinph0*e+this.cosph0*n*r;break;case ri.EQUIT:i=n*r;break;case ri.S_POLE:i=-e;break;case ri.N_POLE:i=e}switch(s=(i=this.pn1/(this.p-i))*n*Math.sin(t.x),this.mode){case ri.OBLIQ:i*=this.cosph0*e-this.sinph0*n*r;break;case ri.EQUIT:i*=e;break;case ri.N_POLE:i*=-n*r;break;case ri.S_POLE:i*=n*r}return h=1/((a=i*this.cg+s*this.sg)*this.sw*this.h1+this.cw),s=(s*this.cg-i*this.sg)*this.cw*h,i=a*h,t.x=s*this.a,t.y=i*this.a,t},inverse:function(t){t.x/=this.a,t.y/=this.a;var s,i,a,h={x:t.x,y:t.y};a=1/(this.pn1-t.y*this.sw),s=this.pn1*t.x*a,i=this.pn1*t.y*this.cw*a,t.x=s*this.cg+i*this.sg,t.y=i*this.cg-s*this.sg;var e=Xt(t.x,t.y);if(Math.abs(e)<u)h.x=0,h.y=t.y;else{var n,r;switch(r=1-e*e*this.pfact,r=(this.p-Math.sqrt(r))/(this.pn1/e+e/this.pn1),n=Math.sqrt(1-r*r),this.mode){case ri.OBLIQ:h.y=Math.asin(n*this.sinph0+t.y*r*this.cosph0/e),t.y=(n-this.sinph0*Math.sin(h.y))*e,t.x*=r*this.cosph0;break;case ri.EQUIT:h.y=Math.asin(t.y*r/e),t.y=n*e,t.x*=r;break;case ri.N_POLE:h.y=Math.asin(n),t.y=-t.y;break;case ri.S_POLE:h.y=-Math.asin(n)}h.x=Math.atan2(t.x,t.y)}return t.x=h.x+this.long0,t.y=h.y,t},names:["Tilted_Perspective","tpers"]};var ui={init:function(){if(this.flip_axis="x"===this.sweep?1:0,this.h=Number(this.h),this.radius_g_1=this.h/this.a,this.radius_g_1<=0||this.radius_g_1>1e10)throw new Error;if(this.radius_g=1+this.radius_g_1,this.C=this.radius_g*this.radius_g-1,0!==this.es){var t=1-this.es,s=1/t;this.radius_p=Math.sqrt(t),this.radius_p2=t,this.radius_p_inv2=s,this.shape="ellipse"}else this.radius_p=1,this.radius_p2=1,this.radius_p_inv2=1,this.shape="sphere";this.title||(this.title="Geostationary Satellite View")},forward:function(t){var s,i,a,h,e=t.x,n=t.y;if(e-=this.long0,"ellipse"===this.shape){n=Math.atan(this.radius_p2*Math.tan(n));var r=this.radius_p/Xt(this.radius_p*Math.cos(n),Math.sin(n));if(i=r*Math.cos(e)*Math.cos(n),a=r*Math.sin(e)*Math.cos(n),h=r*Math.sin(n),(this.radius_g-i)*i-a*a-h*h*this.radius_p_inv2<0)return t.x=Number.NaN,t.y=Number.NaN,t;s=this.radius_g-i,this.flip_axis?(t.x=this.radius_g_1*Math.atan(a/Xt(h,s)),t.y=this.radius_g_1*Math.atan(h/s)):(t.x=this.radius_g_1*Math.atan(a/s),t.y=this.radius_g_1*Math.atan(h/Xt(a,s)))}else"sphere"===this.shape&&(s=Math.cos(n),i=Math.cos(e)*s,a=Math.sin(e)*s,h=Math.sin(n),s=this.radius_g-i,this.flip_axis?(t.x=this.radius_g_1*Math.atan(a/Xt(h,s)),t.y=this.radius_g_1*Math.atan(h/s)):(t.x=this.radius_g_1*Math.atan(a/s),t.y=this.radius_g_1*Math.atan(h/Xt(a,s))));return t.x=t.x*this.a,t.y=t.y*this.a,t},inverse:function(t){var s,i,a,h,e=-1,n=0,r=0;if(t.x=t.x/this.a,t.y=t.y/this.a,"ellipse"===this.shape){this.flip_axis?(r=Math.tan(t.y/this.radius_g_1),n=Math.tan(t.x/this.radius_g_1)*Xt(1,r)):(n=Math.tan(t.x/this.radius_g_1),r=Math.tan(t.y/this.radius_g_1)*Xt(1,n));var o=r/this.radius_p;if(s=n*n+o*o+e*e,(a=(i=2*this.radius_g*e)*i-4*s*this.C)<0)return t.x=Number.NaN,t.y=Number.NaN,t;h=(-i-Math.sqrt(a))/(2*s),e=this.radius_g+h*e,n*=h,r*=h,t.x=Math.atan2(n,e),t.y=Math.atan(r*Math.cos(t.x)/e),t.y=Math.atan(this.radius_p_inv2*Math.tan(t.y))}else if("sphere"===this.shape){if(this.flip_axis?(r=Math.tan(t.y/this.radius_g_1),n=Math.tan(t.x/this.radius_g_1)*Math.sqrt(1+r*r)):(n=Math.tan(t.x/this.radius_g_1),r=Math.tan(t.y/this.radius_g_1)*Math.sqrt(1+n*n)),s=n*n+r*r+e*e,(a=(i=2*this.radius_g*e)*i-4*s*this.C)<0)return t.x=Number.NaN,t.y=Number.NaN,t;h=(-i-Math.sqrt(a))/(2*s),e=this.radius_g+h*e,n*=h,r*=h,t.x=Math.atan2(n,e),t.y=Math.atan(r*Math.cos(t.x)/e)}return t.x=t.x+this.long0,t},names:["Geostationary Satellite View","Geostationary_Satellite","geos"]},ci=1.340264,Mi=-.081106,fi=893e-6,di=.003796,pi=Math.sqrt(3)/2;var mi={init:function(){this.es=0,this.long0=void 0!==this.long0?this.long0:0},forward:function(t){var s=z(t.x-this.long0),i=t.y,a=Math.asin(pi*Math.sin(i)),h=a*a,e=h*h*h;return t.x=s*Math.cos(a)/(pi*(ci+3*Mi*h+e*(7*fi+9*di*h))),t.y=a*(ci+Mi*h+e*(fi+di*h)),t.x=this.a*t.x+this.x0,t.y=this.a*t.y+this.y0,t},inverse:function(t){t.x=(t.x-this.x0)/this.a,t.y=(t.y-this.y0)/this.a;var s,i,a,h,e=t.y;for(h=0;h<12&&(e-=a=(e*(ci+Mi*(s=e*e)+(i=s*s*s)*(fi+di*s))-t.y)/(ci+3*Mi*s+i*(7*fi+9*di*s)),!(Math.abs(a)<1e-9));++h);return i=(s=e*e)*s*s,t.x=pi*t.x*(ci+3*Mi*s+i*(7*fi+9*di*s))/Math.cos(e),t.y=Math.asin(Math.sin(e)/pi),t.x=z(t.x+this.long0),t},names:["eqearth","Equal Earth","Equal_Earth"]},yi=1e-10;function _i(t){var s,i,a,h=z(t.x-(this.long0||0)),e=t.y;return s=this.am1+this.m1-Ut(e,i=Math.sin(e),a=Math.cos(e),this.en),i=a*h/(s*Math.sqrt(1-this.es*i*i)),t.x=s*Math.sin(i),t.y=this.am1-s*Math.cos(i),t.x=this.a*t.x+(this.x0||0),t.y=this.a*t.y+(this.y0||0),t}function xi(t){var s,i,a,h;if(t.x=(t.x-(this.x0||0))/this.a,t.y=(t.y-(this.y0||0))/this.a,i=Xt(t.x,t.y=this.am1-t.y),h=Qt(this.am1+this.m1-i,this.es,this.en),(s=Math.abs(h))<n)s=Math.sin(h),a=i*Math.atan2(t.x,t.y)*Math.sqrt(1-this.es*s*s)/Math.cos(h);else{if(!(Math.abs(s-n)<=yi))throw new Error;a=0}return t.x=z(a+(this.long0||0)),t.y=ys(h),t}function gi(t){var s,i,a=z(t.x-(this.long0||0)),h=t.y;return i=this.cphi1+this.phi1-h,Math.abs(i)>yi?(t.x=i*Math.sin(s=a*Math.cos(h)/i),t.y=this.cphi1-i*Math.cos(s)):t.x=t.y=0,t.x=this.a*t.x+(this.x0||0),t.y=this.a*t.y+(this.y0||0),t}function vi(t){var s,i;t.x=(t.x-(this.x0||0))/this.a,t.y=(t.y-(this.y0||0))/this.a;var a=Xt(t.x,t.y=this.cphi1-t.y);if(i=this.cphi1+this.phi1-a,Math.abs(i)>n)throw new Error;return s=Math.abs(Math.abs(i)-n)<=yi?0:a*Math.atan2(t.x,t.y)/Math.cos(i),t.x=z(s+(this.long0||0)),t.y=ys(i),t}var bi,wi={init:function(){var t;if(this.phi1=this.lat1,Math.abs(this.phi1)<yi)throw new Error;this.es?(this.en=Dt(this.es),this.m1=Ut(this.phi1,this.am1=Math.sin(this.phi1),t=Math.cos(this.phi1),this.en),this.am1=t/(Math.sqrt(1-this.es*this.am1*this.am1)*this.am1),this.inverse=xi,this.forward=_i):(Math.abs(this.phi1)+yi>=n?this.cphi1=0:this.cphi1=1/Math.tan(this.phi1),this.inverse=vi,this.forward=gi)},names:["bonne","Bonne (Werner lat_1=90)"]};return vt.defaultDatum="WGS84",vt.Proj=et,vt.WGS84=new vt.Proj("WGS84"),vt.Point=zt,vt.toPoint=dt,vt.defs=q,vt.nadgrid=function(t,s){var i=new DataView(s),a=function(t){var s=t.getInt32(8,!1);return 11!==s&&(11!==(s=t.getInt32(8,!0))&&console.warn("Failed to detect nadgrid endian-ness, defaulting to little-endian"),!0)}(i),h=function(t,s){return{nFields:t.getInt32(8,s),nSubgridFields:t.getInt32(24,s),nSubgrids:t.getInt32(40,s),shiftType:st(t,56,64).trim(),fromSemiMajorAxis:t.getFloat64(120,s),fromSemiMinorAxis:t.getFloat64(136,s),toSemiMajorAxis:t.getFloat64(152,s),toSemiMinorAxis:t.getFloat64(168,s)}}(i,a),e={header:h,subgrids:function(t,s,i){for(var a=176,h=[],e=0;e<s.nSubgrids;e++){var n=at(t,a,i),r=ht(t,a,n,i),o=Math.round(1+(n.upperLongitude-n.lowerLongitude)/n.longitudeInterval),l=Math.round(1+(n.upperLatitude-n.lowerLatitude)/n.latitudeInterval);h.push({ll:[tt(n.lowerLongitude),tt(n.lowerLatitude)],del:[tt(n.longitudeInterval),tt(n.latitudeInterval)],lim:[o,l],count:n.gridNodeCount,cvs:it(r)}),a+=176+16*n.gridNodeCount}return h}(i,h,a)};return Y[t]=e,e},vt.transform=yt,vt.mgrs=It,vt.version="2.12.0",(bi=vt).Proj.projections.add(Wt),bi.Proj.projections.add(Yt),bi.Proj.projections.add(ts),bi.Proj.projections.add(hs),bi.Proj.projections.add(es),bi.Proj.projections.add(ns),bi.Proj.projections.add(os),bi.Proj.projections.add(ls),bi.Proj.projections.add(us),bi.Proj.projections.add(xs),bi.Proj.projections.add(Cs),bi.Proj.projections.add(Ss),bi.Proj.projections.add(Is),bi.Proj.projections.add(ks),bi.Proj.projections.add(qs),bi.Proj.projections.add(Ls),bi.Proj.projections.add(js),bi.Proj.projections.add(Gs),bi.Proj.projections.add(Bs),bi.Proj.projections.add(zs),bi.Proj.projections.add(Fs),bi.Proj.projections.add(Ds),bi.Proj.projections.add(Us),bi.Proj.projections.add(Qs),bi.Proj.projections.add(Js),bi.Proj.projections.add(ei),bi.Proj.projections.add(ni),bi.Proj.projections.add(li),bi.Proj.projections.add(ui),bi.Proj.projections.add(mi),bi.Proj.projections.add(wi),vt});

},{}],207:[function(require,module,exports){
"use strict";function _toConsumableArray(t){return _arrayWithoutHoles(t)||_iterableToArray(t)||_unsupportedIterableToArray(t)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(t,e){if(t){if("string"==typeof t)return _arrayLikeToArray(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(t,e):void 0}}function _iterableToArray(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function _arrayWithoutHoles(t){if(Array.isArray(t))return _arrayLikeToArray(t)}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,_toPropertyKey(n.key),n)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}!function(t,e){"object"==("undefined"==typeof exports?"undefined":_typeof(exports))&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).RBush=e()}(void 0,function(){function t(t,r,i,a,o){e(t,r,i||0,a||t.length-1,o||n)}function e(t,n,i,a,o){for(;a>i;){if(a-i>600){var h=a-i+1,l=n-i+1,u=Math.log(h),s=.5*Math.exp(2*u/3),f=.5*Math.sqrt(u*s*(h-s)/h)*(l-h/2<0?-1:1);e(t,n,Math.max(i,Math.floor(n-l*s/h+f)),Math.min(a,Math.floor(n+(h-l)*s/h+f)),o)}var c=t[n],m=i,d=a;for(r(t,i,n),o(t[a],c)>0&&r(t,i,a);m<d;){for(r(t,m,d),m++,d--;o(t[m],c)<0;)m++;for(;o(t[d],c)>0;)d--}0===o(t[i],c)?r(t,i,d):r(t,++d,a),d<=n&&(i=d+1),n<=d&&(a=d-1)}}function r(t,e,r){var n=t[e];t[e]=t[r],t[r]=n}function n(t,e){return t<e?-1:t>e?1:0}function i(t,e,r){if(!r)return e.indexOf(t);for(var n=0;n<e.length;n++)if(r(t,e[n]))return n;return-1}function a(t,e){o(t,0,t.children.length,e,t)}function o(t,e,r,n,i){i||(i=p(null)),i.minX=1/0,i.minY=1/0,i.maxX=-1/0,i.maxY=-1/0;for(var a=e;a<r;a++){var o=t.children[a];h(i,t.leaf?n(o):o)}return i}function h(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function l(t,e){return t.minX-e.minX}function u(t,e){return t.minY-e.minY}function s(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function f(t){return t.maxX-t.minX+(t.maxY-t.minY)}function c(t,e){var r=Math.max(t.minX,e.minX),n=Math.max(t.minY,e.minY),i=Math.min(t.maxX,e.maxX),a=Math.min(t.maxY,e.maxY);return Math.max(0,i-r)*Math.max(0,a-n)}function m(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function d(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function p(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function y(e,r,n,i,a){for(var o=[r,n];o.length;)if(!((n=o.pop())-(r=o.pop())<=i)){var h=r+Math.ceil((n-r)/i/2)*i;t(e,h,r,n,a),o.push(r,h,h,n)}}return function(){return _createClass(function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:9;_classCallCheck(this,t),this._maxEntries=Math.max(4,e),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()},[{key:"all",value:function(){return this._all(this.data,[])}},{key:"search",value:function(t){var e=this.data,r=[];if(!d(t,e))return r;for(var n=this.toBBox,i=[];e;){for(var a=0;a<e.children.length;a++){var o=e.children[a],h=e.leaf?n(o):o;d(t,h)&&(e.leaf?r.push(o):m(t,h)?this._all(o,r):i.push(o))}e=i.pop()}return r}},{key:"collides",value:function(t){var e=this.data;if(!d(t,e))return!1;for(var r=[];e;){for(var n=0;n<e.children.length;n++){var i=e.children[n],a=e.leaf?this.toBBox(i):i;if(d(t,a)){if(e.leaf||m(t,a))return!0;r.push(i)}}e=r.pop()}return!1}},{key:"load",value:function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0;e<t.length;e++)this.insert(t[e]);return this}var r=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===r.height)this._splitRoot(this.data,r);else{if(this.data.height<r.height){var n=this.data;this.data=r,r=n}this._insert(r,this.data.height-r.height-1,!0)}else this.data=r;return this}},{key:"insert",value:function(t){return t&&this._insert(t,this.data.height-1),this}},{key:"clear",value:function(){return this.data=p([]),this}},{key:"remove",value:function(t,e){if(!t)return this;for(var r,n,a,o=this.data,h=this.toBBox(t),l=[],u=[];o||l.length;){if(o||(o=l.pop(),n=l[l.length-1],r=u.pop(),a=!0),o.leaf){var s=i(t,o.children,e);if(-1!==s)return o.children.splice(s,1),l.push(o),this._condense(l),this}a||o.leaf||!m(o,h)?n?(r++,o=n.children[r],a=!1):o=null:(l.push(o),u.push(r),r=0,n=o,o=o.children[0])}return this}},{key:"toBBox",value:function(t){return t}},{key:"compareMinX",value:function(t,e){return t.minX-e.minX}},{key:"compareMinY",value:function(t,e){return t.minY-e.minY}},{key:"toJSON",value:function(){return this.data}},{key:"fromJSON",value:function(t){return this.data=t,this}},{key:"_all",value:function(t,e){for(var r=[];t;)t.leaf?e.push.apply(e,_toConsumableArray(t.children)):r.push.apply(r,_toConsumableArray(t.children)),t=r.pop();return e}},{key:"_build",value:function(t,e,r,n){var i,o=r-e+1,h=this._maxEntries;if(o<=h)return a(i=p(t.slice(e,r+1)),this.toBBox),i;n||(n=Math.ceil(Math.log(o)/Math.log(h)),h=Math.ceil(o/Math.pow(h,n-1))),(i=p([])).leaf=!1,i.height=n;var l=Math.ceil(o/h),u=l*Math.ceil(Math.sqrt(h));y(t,e,r,u,this.compareMinX);for(var s=e;s<=r;s+=u){var f=Math.min(s+u-1,r);y(t,s,f,l,this.compareMinY);for(var c=s;c<=f;c+=l){var m=Math.min(c+l-1,f);i.children.push(this._build(t,c,m,n-1))}}return a(i,this.toBBox),i}},{key:"_chooseSubtree",value:function(t,e,r,n){for(;n.push(e),!e.leaf&&n.length-1!==r;){for(var i=void 0,a=1/0,o=1/0,h=0;h<e.children.length;h++){var l=e.children[h],u=s(l),f=(c=t,m=l,(Math.max(m.maxX,c.maxX)-Math.min(m.minX,c.minX))*(Math.max(m.maxY,c.maxY)-Math.min(m.minY,c.minY))-u);f<o?(o=f,a=u<a?u:a,i=l):f===o&&u<a&&(a=u,i=l)}e=i||e.children[0]}var c,m;return e}},{key:"_insert",value:function(t,e,r){var n=r?t:this.toBBox(t),i=[],a=this._chooseSubtree(n,this.data,e,i);for(a.children.push(t),h(a,n);e>=0&&i[e].children.length>this._maxEntries;)this._split(i,e),e--;this._adjustParentBBoxes(n,i,e)}},{key:"_split",value:function(t,e){var r=t[e],n=r.children.length,i=this._minEntries;this._chooseSplitAxis(r,i,n);var o=this._chooseSplitIndex(r,i,n),h=p(r.children.splice(o,r.children.length-o));h.height=r.height,h.leaf=r.leaf,a(r,this.toBBox),a(h,this.toBBox),e?t[e-1].children.push(h):this._splitRoot(r,h)}},{key:"_splitRoot",value:function(t,e){this.data=p([t,e]),this.data.height=t.height+1,this.data.leaf=!1,a(this.data,this.toBBox)}},{key:"_chooseSplitIndex",value:function(t,e,r){for(var n,i=1/0,a=1/0,h=e;h<=r-e;h++){var l=o(t,0,h,this.toBBox),u=o(t,h,r,this.toBBox),f=c(l,u),m=s(l)+s(u);f<i?(i=f,n=h,a=m<a?m:a):f===i&&m<a&&(a=m,n=h)}return n||r-e}},{key:"_chooseSplitAxis",value:function(t,e,r){var n=t.leaf?this.compareMinX:l,i=t.leaf?this.compareMinY:u;this._allDistMargin(t,e,r,n)<this._allDistMargin(t,e,r,i)&&t.children.sort(n)}},{key:"_allDistMargin",value:function(t,e,r,n){t.children.sort(n);for(var i=this.toBBox,a=o(t,0,e,i),l=o(t,r-e,r,i),u=f(a)+f(l),s=e;s<r-e;s++){var c=t.children[s];h(a,t.leaf?i(c):c),u+=f(a)}for(var m=r-e-1;m>=e;m--){var d=t.children[m];h(l,t.leaf?i(d):d),u+=f(l)}return u}},{key:"_adjustParentBBoxes",value:function(t,e,r){for(var n=r;n>=0;n--)h(e[n],t)}},{key:"_condense",value:function(t){for(var e,r=t.length-1;r>=0;r--)0===t[r].children.length?r>0?(e=t[r-1].children).splice(e.indexOf(t[r]),1):this.clear():a(t[r],this.toBBox)}}])}()});

},{}],208:[function(require,module,exports){
"use strict";var _Map=_interopRequireDefault(require("ol/Map.js")),_OSM=_interopRequireDefault(require("ol/source/OSM.js")),_Tile=_interopRequireDefault(require("ol/layer/Tile.js")),_View=_interopRequireDefault(require("ol/View.js")),_Image=_interopRequireDefault(require("ol/layer/Image.js")),_ImageStatic=_interopRequireDefault(require("ol/source/ImageStatic.js")),_Projection=_interopRequireDefault(require("ol/proj/Projection.js")),_size=_interopRequireDefault(require("ol/size")),_Vector=_interopRequireDefault(require("ol/layer/Vector.js")),_Vector2=_interopRequireDefault(require("ol/source/Vector.js")),_Style=_interopRequireDefault(require("ol/style/Style.js")),_Text=_interopRequireDefault(require("ol/style/Text.js")),_Fill=_interopRequireDefault(require("ol/style/Fill.js")),_Feature=_interopRequireDefault(require("ol/Feature.js")),_Point=_interopRequireDefault(require("ol/geom/Point.js")),_proj=require("ol/proj"),_proj2=require("ol/proj/proj4");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var proj4=require("proj4");function ajouter_mosa(e){map.addLayer(new _Image.default({source:new _ImageStatic.default({url:"/images/mosaiques/"+type+"/"+e+".png",imageExtent:[-619652.074,-5062818.338,916347.926,-3526818.338],projection:projection,interpolate:!1}),opacity:1,visible:!1,heure:e,toujoursAfficher:!1}))}proj4.defs("EPSG:3106001","+title=thomas +proj=stere +lat_0=90 +lat_ts=45 +lon_0=0 +k=1 +x_0=0 +y_0=0 +ellps=WGS84 +datum=WGS84 +units=m +no_defs"),(0,_proj2.register)(proj4),window.projection=new _Projection.default({code:"EPSG:3106001"}),window.map=new _Map.default({target:"map",layers:[new _Tile.default({source:new _OSM.default,visible:!0,toujoursAfficher:!0})],view:new _View.default({center:(0,_proj.transform)([148847,-436e4],projection,"EPSG:3857"),zoom:5.9})}),map.addLayer(new _Vector.default({source:new _Vector2.default({features:[new _Feature.default({geometry:new _Point.default(map.getView().getCenter())})]}),style:new _Style.default({text:new _Text.default({font:"50px sans-serif",text:"Image\nindisponible",fill:new _Fill.default({color:"black"})})}),toujoursAfficher:!1,visible:!1,nom:"filigrane"})),map.on("moveend",function(e){map.getLayers().forEach(function(e){"filigrane"==e.get("nom")&&e.getSource().getFeatures()[0].getGeometry().setCoordinates(map.getView().getCenter())})}),window.ajouter_mosa=ajouter_mosa;

},{"ol/Feature.js":13,"ol/Map.js":18,"ol/View.js":33,"ol/geom/Point.js":72,"ol/layer/Image.js":113,"ol/layer/Tile.js":116,"ol/layer/Vector.js":118,"ol/proj":123,"ol/proj/Projection.js":124,"ol/proj/proj4":128,"ol/size":167,"ol/source/ImageStatic.js":169,"ol/source/OSM.js":170,"ol/source/Vector.js":176,"ol/style/Fill.js":188,"ol/style/Style.js":195,"ol/style/Text.js":196,"proj4":206}]},{},[208]);
